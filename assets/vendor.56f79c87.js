var qz={value:()=>{}};function bO(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new v0(n)}function v0(e){this._=e}function Hz(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}v0.prototype=bO.prototype={constructor:v0,on:function(e,t){var n=this._,r=Hz(e+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(e=r[o]).type)&&(i=Wz(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=r[o]).type)n[i]=xO(n[i],e.name,t);else if(t==null)for(i in n)n[i]=xO(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new v0(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function Wz(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function xO(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=qz,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var uv="http://www.w3.org/1999/xhtml",wO={svg:"http://www.w3.org/2000/svg",xhtml:uv,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function b0(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),wO.hasOwnProperty(t)?{space:wO[t],local:e}:e}function Gz(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===uv&&t.documentElement.namespaceURI===uv?t.createElement(e):t.createElementNS(n,e)}}function Yz(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function _O(e){var t=b0(e);return(t.local?Yz:Gz)(t)}function Vz(){}function lv(e){return e==null?Vz:function(){return this.querySelector(e)}}function Xz(e){typeof e!="function"&&(e=lv(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=new Array(a),u,l,c=0;c<a;++c)(u=o[c])&&(l=e.call(u,u.__data__,c,o))&&("__data__"in u&&(l.__data__=u.__data__),s[c]=l);return new rr(r,this._parents)}function Kz(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Jz(){return[]}function EO(e){return e==null?Jz:function(){return this.querySelectorAll(e)}}function Zz(e){return function(){return Kz(e.apply(this,arguments))}}function Qz(e){typeof e=="function"?e=Zz(e):e=EO(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a=t[o],s=a.length,u,l=0;l<s;++l)(u=a[l])&&(r.push(e.call(u,u.__data__,l,a)),i.push(u));return new rr(r,i)}function AO(e){return function(){return this.matches(e)}}function $O(e){return function(t){return t.matches(e)}}var eU=Array.prototype.find;function tU(e){return function(){return eU.call(this.children,e)}}function nU(){return this.firstElementChild}function rU(e){return this.select(e==null?nU:tU(typeof e=="function"?e:$O(e)))}var iU=Array.prototype.filter;function oU(){return Array.from(this.children)}function aU(e){return function(){return iU.call(this.children,e)}}function sU(e){return this.selectAll(e==null?oU:aU(typeof e=="function"?e:$O(e)))}function uU(e){typeof e!="function"&&(e=AO(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],u,l=0;l<a;++l)(u=o[l])&&e.call(u,u.__data__,l,o)&&s.push(u);return new rr(r,this._parents)}function SO(e){return new Array(e.length)}function lU(){return new rr(this._enter||this._groups.map(SO),this._parents)}function x0(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}x0.prototype={constructor:x0,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function cU(e){return function(){return e}}function fU(e,t,n,r,i,o){for(var a=0,s,u=t.length,l=o.length;a<l;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new x0(e,o[a]);for(;a<u;++a)(s=t[a])&&(i[a]=s)}function dU(e,t,n,r,i,o,a){var s,u,l=new Map,c=t.length,f=o.length,d=new Array(c),h;for(s=0;s<c;++s)(u=t[s])&&(d[s]=h=a.call(u,u.__data__,s,t)+"",l.has(h)?i[s]=u:l.set(h,u));for(s=0;s<f;++s)h=a.call(e,o[s],s,o)+"",(u=l.get(h))?(r[s]=u,u.__data__=o[s],l.delete(h)):n[s]=new x0(e,o[s]);for(s=0;s<c;++s)(u=t[s])&&l.get(d[s])===u&&(i[s]=u)}function hU(e){return e.__data__}function gU(e,t){if(!arguments.length)return Array.from(this,hU);var n=t?dU:fU,r=this._parents,i=this._groups;typeof e!="function"&&(e=cU(e));for(var o=i.length,a=new Array(o),s=new Array(o),u=new Array(o),l=0;l<o;++l){var c=r[l],f=i[l],d=f.length,h=pU(e.call(c,c&&c.__data__,l,r)),g=h.length,p=s[l]=new Array(g),m=a[l]=new Array(g),y=u[l]=new Array(d);n(c,f,p,m,y,h,t);for(var v=0,b=0,x,w;v<g;++v)if(x=p[v]){for(v>=b&&(b=v+1);!(w=m[b])&&++b<g;);x._next=w||null}}return a=new rr(a,r),a._enter=s,a._exit=u,a}function pU(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function mU(){return new rr(this._exit||this._groups.map(SO),this._parents)}function yU(e,t,n){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function vU(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),u=0;u<a;++u)for(var l=n[u],c=r[u],f=l.length,d=s[u]=new Array(f),h,g=0;g<f;++g)(h=l[g]||c[g])&&(d[g]=h);for(;u<i;++u)s[u]=n[u];return new rr(s,this._parents)}function bU(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function xU(e){e||(e=wU);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,u=i[o]=new Array(s),l,c=0;c<s;++c)(l=a[c])&&(u[c]=l);u.sort(t)}return new rr(i,this._parents).order()}function wU(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function _U(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function EU(){return Array.from(this)}function AU(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function $U(){let e=0;for(const t of this)++e;return e}function SU(){return!this.node()}function CU(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&e.call(s,s.__data__,o,i);return this}function OU(e){return function(){this.removeAttribute(e)}}function FU(e){return function(){this.removeAttributeNS(e.space,e.local)}}function kU(e,t){return function(){this.setAttribute(e,t)}}function DU(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function MU(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function TU(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function NU(e,t){var n=b0(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?FU:OU:typeof t=="function"?n.local?TU:MU:n.local?DU:kU)(n,t))}function CO(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function RU(e){return function(){this.style.removeProperty(e)}}function jU(e,t,n){return function(){this.style.setProperty(e,t,n)}}function LU(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function PU(e,t,n){return arguments.length>1?this.each((t==null?RU:typeof t=="function"?LU:jU)(e,t,n==null?"":n)):Uu(this.node(),e)}function Uu(e,t){return e.style.getPropertyValue(t)||CO(e).getComputedStyle(e,null).getPropertyValue(t)}function IU(e){return function(){delete this[e]}}function BU(e,t){return function(){this[e]=t}}function zU(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function UU(e,t){return arguments.length>1?this.each((t==null?IU:typeof t=="function"?zU:BU)(e,t)):this.node()[e]}function OO(e){return e.trim().split(/^|\s+/)}function cv(e){return e.classList||new FO(e)}function FO(e){this._node=e,this._names=OO(e.getAttribute("class")||"")}FO.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function kO(e,t){for(var n=cv(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function DO(e,t){for(var n=cv(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function qU(e){return function(){kO(this,e)}}function HU(e){return function(){DO(this,e)}}function WU(e,t){return function(){(t.apply(this,arguments)?kO:DO)(this,e)}}function GU(e,t){var n=OO(e+"");if(arguments.length<2){for(var r=cv(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?WU:t?qU:HU)(n,t))}function YU(){this.textContent=""}function VU(e){return function(){this.textContent=e}}function XU(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function KU(e){return arguments.length?this.each(e==null?YU:(typeof e=="function"?XU:VU)(e)):this.node().textContent}function JU(){this.innerHTML=""}function ZU(e){return function(){this.innerHTML=e}}function QU(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function eq(e){return arguments.length?this.each(e==null?JU:(typeof e=="function"?QU:ZU)(e)):this.node().innerHTML}function tq(){this.nextSibling&&this.parentNode.appendChild(this)}function nq(){return this.each(tq)}function rq(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function iq(){return this.each(rq)}function oq(e){var t=typeof e=="function"?e:_O(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function aq(){return null}function sq(e,t){var n=typeof e=="function"?e:_O(e),r=t==null?aq:typeof t=="function"?t:lv(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function uq(){var e=this.parentNode;e&&e.removeChild(this)}function lq(){return this.each(uq)}function cq(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fq(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function dq(e){return this.select(e?fq:cq)}function hq(e){return arguments.length?this.property("__data__",e):this.node().__data__}function gq(e){return function(t){e.call(this,t,this.__data__)}}function pq(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function mq(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function yq(e,t,n){return function(){var r=this.__on,i,o=gq(t);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function vq(e,t,n){var r=pq(e+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var u=0,l=s.length,c;u<l;++u)for(i=0,c=s[u];i<o;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(s=t?yq:mq,i=0;i<o;++i)this.each(s(r[i],t,n));return this}function MO(e,t,n){var r=CO(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function bq(e,t){return function(){return MO(this,e,t)}}function xq(e,t){return function(){return MO(this,e,t.apply(this,arguments))}}function wq(e,t){return this.each((typeof t=="function"?xq:bq)(e,t))}function*_q(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var TO=[null];function rr(e,t){this._groups=e,this._parents=t}function Lc(){return new rr([[document.documentElement]],TO)}function Eq(){return this}rr.prototype=Lc.prototype={constructor:rr,select:Xz,selectAll:Qz,selectChild:rU,selectChildren:sU,filter:uU,data:gU,enter:lU,exit:mU,join:yU,merge:vU,selection:Eq,order:bU,sort:xU,call:_U,nodes:EU,node:AU,size:$U,empty:SU,each:CU,attr:NU,style:PU,property:UU,classed:GU,text:KU,html:eq,raise:nq,lower:iq,append:oq,insert:sq,remove:lq,clone:dq,datum:hq,on:vq,dispatch:wq,[Symbol.iterator]:_q};function _3e(e){return typeof e=="string"?new rr([[document.querySelector(e)]],[document.documentElement]):new rr([[e]],TO)}function fv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function NO(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Pc(){}var Ic=.7,w0=1/Ic,qu="\\s*([+-]?\\d+)\\s*",Bc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",wi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Aq=/^#([0-9a-f]{3,8})$/,$q=new RegExp("^rgb\\("+[qu,qu,qu]+"\\)$"),Sq=new RegExp("^rgb\\("+[wi,wi,wi]+"\\)$"),Cq=new RegExp("^rgba\\("+[qu,qu,qu,Bc]+"\\)$"),Oq=new RegExp("^rgba\\("+[wi,wi,wi,Bc]+"\\)$"),Fq=new RegExp("^hsl\\("+[Bc,wi,wi]+"\\)$"),kq=new RegExp("^hsla\\("+[Bc,wi,wi,Bc]+"\\)$"),RO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fv(Pc,zc,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:jO,formatHex:jO,formatHsl:Dq,formatRgb:LO,toString:LO});function jO(){return this.rgb().formatHex()}function Dq(){return UO(this).formatHsl()}function LO(){return this.rgb().formatRgb()}function zc(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Aq.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?PO(t):n===3?new ir(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?_0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?_0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=$q.exec(e))?new ir(t[1],t[2],t[3],1):(t=Sq.exec(e))?new ir(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Cq.exec(e))?_0(t[1],t[2],t[3],t[4]):(t=Oq.exec(e))?_0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Fq.exec(e))?zO(t[1],t[2]/100,t[3]/100,1):(t=kq.exec(e))?zO(t[1],t[2]/100,t[3]/100,t[4]):RO.hasOwnProperty(e)?PO(RO[e]):e==="transparent"?new ir(NaN,NaN,NaN,0):null}function PO(e){return new ir(e>>16&255,e>>8&255,e&255,1)}function _0(e,t,n,r){return r<=0&&(e=t=n=NaN),new ir(e,t,n,r)}function Mq(e){return e instanceof Pc||(e=zc(e)),e?(e=e.rgb(),new ir(e.r,e.g,e.b,e.opacity)):new ir}function dv(e,t,n,r){return arguments.length===1?Mq(e):new ir(e,t,n,r==null?1:r)}function ir(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}fv(ir,dv,NO(Pc,{brighter:function(e){return e=e==null?w0:Math.pow(w0,e),new ir(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Ic:Math.pow(Ic,e),new ir(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:IO,formatHex:IO,formatRgb:BO,toString:BO}));function IO(){return"#"+hv(this.r)+hv(this.g)+hv(this.b)}function BO(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function hv(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function zO(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new _i(e,t,n,r)}function UO(e){if(e instanceof _i)return new _i(e.h,e.s,e.l,e.opacity);if(e instanceof Pc||(e=zc(e)),!e)return new _i;if(e instanceof _i)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new _i(a,s,u,e.opacity)}function Tq(e,t,n,r){return arguments.length===1?UO(e):new _i(e,t,n,r==null?1:r)}function _i(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}fv(_i,Tq,NO(Pc,{brighter:function(e){return e=e==null?w0:Math.pow(w0,e),new _i(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ic:Math.pow(Ic,e),new _i(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ir(gv(e>=240?e-240:e+120,i,r),gv(e,i,r),gv(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function gv(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var qO=e=>()=>e;function Nq(e,t){return function(n){return e+n*t}}function Rq(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function jq(e){return(e=+e)==1?HO:function(t,n){return n-t?Rq(t,n,e):qO(isNaN(t)?n:t)}}function HO(e,t){var n=t-e;return n?Nq(e,n):qO(isNaN(e)?t:e)}var WO=function e(t){var n=jq(t);function r(i,o){var a=n((i=dv(i)).r,(o=dv(o)).r),s=n(i.g,o.g),u=n(i.b,o.b),l=HO(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function ra(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var pv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mv=new RegExp(pv.source,"g");function Lq(e){return function(){return e}}function Pq(e){return function(t){return e(t)+""}}function Iq(e,t){var n=pv.lastIndex=mv.lastIndex=0,r,i,o,a=-1,s=[],u=[];for(e=e+"",t=t+"";(r=pv.exec(e))&&(i=mv.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,u.push({i:a,x:ra(r,i)})),n=mv.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?Pq(u[0].x):Lq(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}var GO=180/Math.PI,yv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function YO(e,t,n,r,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*GO,skewX:Math.atan(u)*GO,scaleX:a,scaleY:s}}var E0;function Bq(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?yv:YO(t.a,t.b,t.c,t.d,t.e,t.f)}function zq(e){return e==null||(E0||(E0=document.createElementNS("http://www.w3.org/2000/svg","g")),E0.setAttribute("transform",e),!(e=E0.transform.baseVal.consolidate()))?yv:(e=e.matrix,YO(e.a,e.b,e.c,e.d,e.e,e.f))}function VO(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push("translate(",null,t,null,n);g.push({i:p-4,x:ra(l,f)},{i:p-2,x:ra(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function a(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:ra(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:ra(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push(i(h)+"scale(",null,",",null,")");g.push({i:p-4,x:ra(l,f)},{i:p-2,x:ra(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),a(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var g=-1,p=d.length,m;++g<p;)f[(m=d[g]).i]=m.x(h);return f.join("")}}}var Uq=VO(Bq,"px, ","px)","deg)"),qq=VO(zq,", ",")",")"),Hu=0,Uc=0,qc=0,XO=1e3,A0,Hc,$0=0,ds=0,S0=0,Wc=typeof performance=="object"&&performance.now?performance:Date,KO=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function vv(){return ds||(KO(Hq),ds=Wc.now()+S0)}function Hq(){ds=0}function C0(){this._call=this._time=this._next=null}C0.prototype=JO.prototype={constructor:C0,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?vv():+n)+(t==null?0:+t),!this._next&&Hc!==this&&(Hc?Hc._next=this:A0=this,Hc=this),this._call=e,this._time=n,bv()},stop:function(){this._call&&(this._call=null,this._time=1/0,bv())}};function JO(e,t,n){var r=new C0;return r.restart(e,t,n),r}function Wq(){vv(),++Hu;for(var e=A0,t;e;)(t=ds-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Hu}function ZO(){ds=($0=Wc.now())+S0,Hu=Uc=0;try{Wq()}finally{Hu=0,Yq(),ds=0}}function Gq(){var e=Wc.now(),t=e-$0;t>XO&&(S0-=t,$0=e)}function Yq(){for(var e,t=A0,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:A0=n);Hc=e,bv(r)}function bv(e){if(!Hu){Uc&&(Uc=clearTimeout(Uc));var t=e-ds;t>24?(e<1/0&&(Uc=setTimeout(ZO,e-Wc.now()-S0)),qc&&(qc=clearInterval(qc))):(qc||($0=Wc.now(),qc=setInterval(Gq,XO)),Hu=1,KO(ZO))}}function QO(e,t,n){var r=new C0;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var Vq=bO("start","end","cancel","interrupt"),Xq=[],e3=0,t3=1,xv=2,O0=3,n3=4,wv=5,F0=6;function k0(e,t,n,r,i,o){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;Kq(e,n,{name:t,index:r,group:i,on:Vq,tween:Xq,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:e3})}function _v(e,t){var n=Ur(e,t);if(n.state>e3)throw new Error("too late; already scheduled");return n}function Ei(e,t){var n=Ur(e,t);if(n.state>O0)throw new Error("too late; already running");return n}function Ur(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Kq(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=JO(o,0,n.time);function o(l){n.state=t3,n.timer.restart(a,n.delay,n.time),n.delay<=l&&a(l-n.delay)}function a(l){var c,f,d,h;if(n.state!==t3)return u();for(c in r)if(h=r[c],h.name===n.name){if(h.state===O0)return QO(a);h.state===n3?(h.state=F0,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[c]):+c<t&&(h.state=F0,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[c])}if(QO(function(){n.state===O0&&(n.state=n3,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=xv,n.on.call("start",e,e.__data__,n.index,n.group),n.state===xv){for(n.state=O0,i=new Array(d=n.tween.length),c=0,f=-1;c<d;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++f]=h);i.length=f+1}}function s(l){for(var c=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(u),n.state=wv,1),f=-1,d=i.length;++f<d;)i[f].call(e,c);n.state===wv&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){n.state=F0,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function Jq(e,t){var n=e.__transition,r,i,o=!0,a;if(!!n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){o=!1;continue}i=r.state>xv&&r.state<wv,r.state=F0,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}o&&delete e.__transition}}function Zq(e){return this.each(function(){Jq(this,e)})}function Qq(e,t){var n,r;return function(){var i=Ei(this,e),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function eH(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=Ei(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===t){i[u]=s;break}u===l&&i.push(s)}o.tween=i}}function tH(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ur(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?Qq:eH)(n,e,t))}function Ev(e,t,n){var r=e._id;return e.each(function(){var i=Ei(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Ur(i,r).value[t]}}function r3(e,t){var n;return(typeof t=="number"?ra:t instanceof zc?WO:(n=zc(t))?(t=n,WO):Iq)(e,t)}function nH(e){return function(){this.removeAttribute(e)}}function rH(e){return function(){this.removeAttributeNS(e.space,e.local)}}function iH(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function oH(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function aH(e,t,n){var r,i,o;return function(){var a,s=n(this),u;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),u=s+"",a===u?null:a===r&&u===i?o:(i=u,o=t(r=a,s)))}}function sH(e,t,n){var r,i,o;return function(){var a,s=n(this),u;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),u=s+"",a===u?null:a===r&&u===i?o:(i=u,o=t(r=a,s)))}}function uH(e,t){var n=b0(e),r=n==="transform"?qq:r3;return this.attrTween(e,typeof t=="function"?(n.local?sH:aH)(n,r,Ev(this,"attr."+e,t)):t==null?(n.local?rH:nH)(n):(n.local?oH:iH)(n,r,t))}function lH(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function cH(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function fH(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&cH(e,o)),n}return i._value=t,i}function dH(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&lH(e,o)),n}return i._value=t,i}function hH(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=b0(e);return this.tween(n,(r.local?fH:dH)(r,t))}function gH(e,t){return function(){_v(this,e).delay=+t.apply(this,arguments)}}function pH(e,t){return t=+t,function(){_v(this,e).delay=t}}function mH(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?gH:pH)(t,e)):Ur(this.node(),t).delay}function yH(e,t){return function(){Ei(this,e).duration=+t.apply(this,arguments)}}function vH(e,t){return t=+t,function(){Ei(this,e).duration=t}}function bH(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?yH:vH)(t,e)):Ur(this.node(),t).duration}function xH(e,t){if(typeof t!="function")throw new Error;return function(){Ei(this,e).ease=t}}function wH(e){var t=this._id;return arguments.length?this.each(xH(t,e)):Ur(this.node(),t).ease}function _H(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ei(this,e).ease=n}}function EH(e){if(typeof e!="function")throw new Error;return this.each(_H(this._id,e))}function AH(e){typeof e!="function"&&(e=AO(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],u,l=0;l<a;++l)(u=o[l])&&e.call(u,u.__data__,l,o)&&s.push(u);return new yo(r,this._parents,this._name,this._id)}function $H(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u=t[s],l=n[s],c=u.length,f=a[s]=new Array(c),d,h=0;h<c;++h)(d=u[h]||l[h])&&(f[h]=d);for(;s<r;++s)a[s]=t[s];return new yo(a,this._parents,this._name,this._id)}function SH(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function CH(e,t,n){var r,i,o=SH(t)?_v:Ei;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}function OH(e,t){var n=this._id;return arguments.length<2?Ur(this.node(),n).on.on(e):this.each(CH(n,e,t))}function FH(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function kH(){return this.on("end.remove",FH(this._id))}function DH(e){var t=this._name,n=this._id;typeof e!="function"&&(e=lv(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],u=s.length,l=o[a]=new Array(u),c,f,d=0;d<u;++d)(c=s[d])&&(f=e.call(c,c.__data__,d,s))&&("__data__"in c&&(f.__data__=c.__data__),l[d]=f,k0(l[d],t,n,d,l,Ur(c,n)));return new yo(o,this._parents,t,n)}function MH(e){var t=this._name,n=this._id;typeof e!="function"&&(e=EO(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var u=r[s],l=u.length,c,f=0;f<l;++f)if(c=u[f]){for(var d=e.call(c,c.__data__,f,u),h,g=Ur(c,n),p=0,m=d.length;p<m;++p)(h=d[p])&&k0(h,t,n,p,d,g);o.push(d),a.push(c)}return new yo(o,a,t,n)}var TH=Lc.prototype.constructor;function NH(){return new TH(this._groups,this._parents)}function RH(e,t){var n,r,i;return function(){var o=Uu(this,e),a=(this.style.removeProperty(e),Uu(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}function i3(e){return function(){this.style.removeProperty(e)}}function jH(e,t,n){var r,i=n+"",o;return function(){var a=Uu(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}function LH(e,t,n){var r,i,o;return function(){var a=Uu(this,e),s=n(this),u=s+"";return s==null&&(u=s=(this.style.removeProperty(e),Uu(this,e))),a===u?null:a===r&&u===i?o:(i=u,o=t(r=a,s))}}function PH(e,t){var n,r,i,o="style."+t,a="end."+o,s;return function(){var u=Ei(this,e),l=u.on,c=u.value[o]==null?s||(s=i3(t)):void 0;(l!==n||i!==c)&&(r=(n=l).copy()).on(a,i=c),u.on=r}}function IH(e,t,n){var r=(e+="")==="transform"?Uq:r3;return t==null?this.styleTween(e,RH(e,r)).on("end.style."+e,i3(e)):typeof t=="function"?this.styleTween(e,LH(e,r,Ev(this,"style."+e,t))).each(PH(this._id,e)):this.styleTween(e,jH(e,r,t),n).on("end.style."+e,null)}function BH(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function zH(e,t,n){var r,i;function o(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&BH(e,a,n)),r}return o._value=t,o}function UH(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,zH(e,t,n==null?"":n))}function qH(e){return function(){this.textContent=e}}function HH(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function WH(e){return this.tween("text",typeof e=="function"?HH(Ev(this,"text",e)):qH(e==null?"":e+""))}function GH(e){return function(t){this.textContent=e.call(this,t)}}function YH(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&GH(i)),t}return r._value=e,r}function VH(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,YH(e))}function XH(){for(var e=this._name,t=this._id,n=o3(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,u,l=0;l<s;++l)if(u=a[l]){var c=Ur(u,t);k0(u,e,n,l,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new yo(r,this._parents,e,n)}function KH(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},u={value:function(){--i==0&&o()}};n.each(function(){var l=Ei(this,r),c=l.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(u)),l.on=t}),i===0&&o()})}var JH=0;function yo(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function o3(){return++JH}var vo=Lc.prototype;yo.prototype={constructor:yo,select:DH,selectAll:MH,selectChild:vo.selectChild,selectChildren:vo.selectChildren,filter:AH,merge:$H,selection:NH,transition:XH,call:vo.call,nodes:vo.nodes,node:vo.node,size:vo.size,empty:vo.empty,each:vo.each,on:OH,attr:uH,attrTween:hH,style:IH,styleTween:UH,text:WH,textTween:VH,remove:kH,tween:tH,delay:mH,duration:bH,ease:wH,easeVarying:EH,end:KH,[Symbol.iterator]:vo[Symbol.iterator]};function ZH(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var QH={time:null,delay:0,duration:250,ease:ZH};function eW(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function tW(e){var t,n;e instanceof yo?(t=e._id,e=e._name):(t=o3(),(n=QH).time=vv(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,u,l=0;l<s;++l)(u=a[l])&&k0(u,e,t,l,a,n||eW(u,t));return new yo(r,this._parents,e,t)}Lc.prototype.interrupt=Zq;Lc.prototype.transition=tW;/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var nW=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),rW=Object.prototype.hasOwnProperty;function Av(e,t){return rW.call(e,t)}function $v(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var r in e)Av(e,r)&&n.push(r);return n}function or(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Sv(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function hs(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function a3(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Cv(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Cv(e[t]))return!0}else if(typeof e=="object"){for(var r=$v(e),i=r.length,t=0;t<i;t++)if(Cv(e[r[t]]))return!0}}return!1}function s3(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i!="undefined"&&n.push(r+": "+i)}return n.join(`
`)}var u3=function(e){nW(t,e);function t(n,r,i,o,a){var s=this.constructor,u=e.call(this,s3(n,{name:r,index:i,operation:o,tree:a}))||this;return u.name=r,u.index=i,u.operation=o,u.tree=a,Object.setPrototypeOf(u,s.prototype),u.message=s3(n,{name:r,index:i,operation:o,tree:a}),u}return t}(Error),st=u3,iW=or,Wu={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=D0(n,this.path);r&&(r=or(r));var i=gs(n,{op:"remove",path:this.from}).removed;return gs(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=D0(n,this.from);return gs(n,{op:"add",path:this.path,value:or(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Gc(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},oW={add:function(e,t,n){return Sv(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Wu.move,copy:Wu.copy,test:Wu.test,_get:Wu._get};function D0(e,t){if(t=="")return e;var n={op:"_get",path:t};return gs(e,n),n.value}function gs(e,t,n,r,i,o){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):T0(t,0)),t.path===""){var a={newDocument:e};if(t.op==="add")return a.newDocument=t.value,a;if(t.op==="replace")return a.newDocument=t.value,a.removed=e,a;if(t.op==="move"||t.op==="copy")return a.newDocument=D0(e,t.from),t.op==="move"&&(a.removed=e),a;if(t.op==="test"){if(a.test=Gc(e,t.value),a.test===!1)throw new st("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}else{if(t.op==="remove")return a.removed=e,a.newDocument=null,a;if(t.op==="_get")return t.value=e,a;if(n)throw new st("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}}else{r||(e=or(e));var s=t.path||"",u=s.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,g=void 0;for(typeof n=="function"?g=n:g=T0;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=a3(h)),i&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&g(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!Sv(h))throw new st("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);Sv(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new st("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var a=oW[t.op].call(t,l,h,e);if(a.test===!1)throw new st("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(c>=f){var a=Wu[t.op].call(t,l,h,e);if(a.test===!1)throw new st("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new st("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function M0(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new st("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=or(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=gs(e,t[a],n,!0,i,a),e=o[a].newDocument;return o.newDocument=e,o}function aW(e,t,n){var r=gs(e,t);if(r.test===!1)throw new st("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function T0(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new st("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Wu[e.op]){if(typeof e.path!="string")throw new st("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new st('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new st("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new st("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Cv(e.value))throw new st("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new st("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new st("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var a={op:"_get",path:e.from,value:void 0},s=l3([a],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new st("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new st("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function l3(e,t,n){try{if(!Array.isArray(e))throw new st("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)M0(or(t),or(e),n||!0);else{n=n||T0;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof st)return i;throw i}}function Gc(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,o,a;if(n&&r){if(o=e.length,o!=t.length)return!1;for(i=o;i--!=0;)if(!Gc(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var s=Object.keys(e);if(o=s.length,o!==Object.keys(t).length)return!1;for(i=o;i--!=0;)if(!t.hasOwnProperty(s[i]))return!1;for(i=o;i--!=0;)if(a=s[i],!Gc(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}var sW=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:st,deepClone:iW,getValueByPointer:D0,applyOperation:gs,applyPatch:M0,applyReducer:aW,validator:T0,validate:l3,_areEquals:Gc});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var Ov=new WeakMap,uW=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),lW=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function cW(e){return Ov.get(e)}function fW(e,t){return e.observers.get(t)}function dW(e,t){e.observers.delete(t.callback)}function hW(e,t){t.unobserve()}function gW(e,t){var n=[],r,i=cW(e);if(!i)i=new uW(e),Ov.set(e,i);else{var o=fW(i,t);r=o&&o.observer}if(r)return r;if(r={},i.value=or(e),t){r.callback=t,r.next=null;var a=function(){Fv(r)},s=function(){clearTimeout(r.next),r.next=setTimeout(a)};typeof window!="undefined"&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return r.patches=n,r.object=e,r.unobserve=function(){Fv(r),clearTimeout(r.next),dW(i,r),typeof window!="undefined"&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},i.observers.set(t,new lW(t,r)),r}function Fv(e,t){t===void 0&&(t=!1);var n=Ov.get(e.object);kv(n.value,e.object,e.patches,"",t),e.patches.length&&M0(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function kv(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=$v(t),a=$v(e),s=!1,u=a.length-1;u>=0;u--){var l=a[u],c=e[l];if(Av(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?kv(c,f,n,r+"/"+hs(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+hs(l),value:or(c)}),n.push({op:"replace",path:r+"/"+hs(l),value:or(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+hs(l),value:or(c)}),n.push({op:"remove",path:r+"/"+hs(l)}),s=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&o.length==a.length))for(var u=0;u<o.length;u++){var l=o[u];!Av(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+hs(l),value:or(t[l])})}}}function pW(e,t,n){n===void 0&&(n=!1);var r=[];return kv(e,t,r,"",n),r}var mW=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:hW,observe:gW,generate:Fv,compare:pW});Object.assign({},sW,mW,{JsonPatchError:u3,deepClone:or,escapePathComponent:hs,unescapePathComponent:a3});var yW=/("(?:[^\\"]|\\.)*")|[:,]/g,Dv=function(t,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function a(s,u,l){var c,f,d,h,g,p,m,y,v,b,x,w;if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),x=JSON.stringify(s,o),x===void 0)return x;if(m=i-u.length-l,x.length<=m&&(v=x.replace(yW,function(E,_){return _||E+" "}),v.length<=m))return v;if(o!=null&&(s=JSON.parse(x),o=void 0),typeof s=="object"&&s!==null){if(y=u+r,d=[],f=0,Array.isArray(s))for(b="[",c="]",m=s.length;f<m;f++)d.push(a(s[f],y,f===m-1?0:1)||"null");else for(b="{",c="}",p=Object.keys(s),m=p.length;f<m;f++)h=p[f],g=JSON.stringify(h)+": ",w=a(s[h],y,g.length+(f===m-1?0:1)),w!==void 0&&d.push(g+w);if(d.length>0)return[b,r+d.join(`,
`+y),c].join(`
`+u)}return x}(t,"",0)},ia={exports:{}};const vW="2.0.0",bW=256,xW=Number.MAX_SAFE_INTEGER||9007199254740991,wW=16;var N0={SEMVER_SPEC_VERSION:vW,MAX_LENGTH:bW,MAX_SAFE_INTEGER:xW,MAX_SAFE_COMPONENT_LENGTH:wW};const _W=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var R0=_W;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=N0,r=R0;t=e.exports={};const i=t.re=[],o=t.src=[],a=t.t={};let s=0;const u=(l,c,f)=>{const d=s++;r(d,c),a[l]=d,o[d]=c,i[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${o[a.NUMERICIDENTIFIER]}|${o[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${o[a.NUMERICIDENTIFIERLOOSE]}|${o[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${o[a.PRERELEASEIDENTIFIER]}(?:\\.${o[a.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${o[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[a.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${o[a.BUILDIDENTIFIER]}(?:\\.${o[a.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${o[a.MAINVERSION]}${o[a.PRERELEASE]}?${o[a.BUILD]}?`),u("FULL",`^${o[a.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${o[a.MAINVERSIONLOOSE]}${o[a.PRERELEASELOOSE]}?${o[a.BUILD]}?`),u("LOOSE",`^${o[a.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${o[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${o[a.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:${o[a.PRERELEASE]})?${o[a.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:${o[a.PRERELEASELOOSE]})?${o[a.BUILD]}?)?)?`),u("XRANGE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",o[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${o[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${o[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${o[a.LONECARET]}${o[a.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${o[a.LONECARET]}${o[a.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${o[a.GTLT]}\\s*(${o[a.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]}|${o[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${o[a.XRANGEPLAIN]})\\s+-\\s+(${o[a.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${o[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[a.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(ia,ia.exports);const EW=["includePrerelease","loose","rtl"],AW=e=>e?typeof e!="object"?{loose:!0}:EW.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var j0=AW;const c3=/^[0-9]+$/,f3=(e,t)=>{const n=c3.test(e),r=c3.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},$W=(e,t)=>f3(t,e);var Mv={compareIdentifiers:f3,rcompareIdentifiers:$W};const L0=R0,{MAX_LENGTH:d3,MAX_SAFE_INTEGER:P0}=N0,{re:h3,t:g3}=ia.exports,SW=j0,{compareIdentifiers:Yc}=Mv;class qr{constructor(t,n){if(n=SW(n),t instanceof qr){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>d3)throw new TypeError(`version is longer than ${d3} characters`);L0("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?h3[g3.LOOSE]:h3[g3.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>P0||this.major<0)throw new TypeError("Invalid major version");if(this.minor>P0||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>P0||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const o=+i;if(o>=0&&o<P0)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(L0("SemVer.compare",this.version,this.options,t),!(t instanceof qr)){if(typeof t=="string"&&t===this.version)return 0;t=new qr(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof qr||(t=new qr(t,this.options)),Yc(this.major,t.major)||Yc(this.minor,t.minor)||Yc(this.patch,t.patch)}comparePre(t){if(t instanceof qr||(t=new qr(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(L0("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Yc(r,i)}while(++n)}compareBuild(t){t instanceof qr||(t=new qr(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(L0("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Yc(r,i)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var pn=qr;const{MAX_LENGTH:CW}=N0,{re:p3,t:m3}=ia.exports,y3=pn,OW=j0,FW=(e,t)=>{if(t=OW(t),e instanceof y3)return e;if(typeof e!="string"||e.length>CW||!(t.loose?p3[m3.LOOSE]:p3[m3.FULL]).test(e))return null;try{return new y3(e,t)}catch(r){return null}};var Gu=FW;const kW=Gu,DW=(e,t)=>{const n=kW(e,t);return n?n.version:null};var MW=DW;const TW=Gu,NW=(e,t)=>{const n=TW(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var RW=NW;const jW=pn,LW=(e,t,n,r)=>{typeof n=="string"&&(r=n,n=void 0);try{return new jW(e,n).inc(t,r).version}catch(i){return null}};var PW=LW;const v3=pn,IW=(e,t,n)=>new v3(e,n).compare(new v3(t,n));var Hr=IW;const BW=Hr,zW=(e,t,n)=>BW(e,t,n)===0;var Tv=zW;const b3=Gu,UW=Tv,qW=(e,t)=>{if(UW(e,t))return null;{const n=b3(e),r=b3(t),i=n.prerelease.length||r.prerelease.length,o=i?"pre":"",a=i?"prerelease":"";for(const s in n)if((s==="major"||s==="minor"||s==="patch")&&n[s]!==r[s])return o+s;return a}};var HW=qW;const WW=pn,GW=(e,t)=>new WW(e,t).major;var YW=GW;const VW=pn,XW=(e,t)=>new VW(e,t).minor;var KW=XW;const JW=pn,ZW=(e,t)=>new JW(e,t).patch;var QW=ZW;const eG=Gu,tG=(e,t)=>{const n=eG(e,t);return n&&n.prerelease.length?n.prerelease:null};var nG=tG;const rG=Hr,iG=(e,t,n)=>rG(t,e,n);var oG=iG;const aG=Hr,sG=(e,t)=>aG(e,t,!0);var uG=sG;const x3=pn,lG=(e,t,n)=>{const r=new x3(e,n),i=new x3(t,n);return r.compare(i)||r.compareBuild(i)};var Nv=lG;const cG=Nv,fG=(e,t)=>e.sort((n,r)=>cG(n,r,t));var dG=fG;const hG=Nv,gG=(e,t)=>e.sort((n,r)=>hG(r,n,t));var pG=gG;const mG=Hr,yG=(e,t,n)=>mG(e,t,n)>0;var I0=yG;const vG=Hr,bG=(e,t,n)=>vG(e,t,n)<0;var Rv=bG;const xG=Hr,wG=(e,t,n)=>xG(e,t,n)!==0;var w3=wG;const _G=Hr,EG=(e,t,n)=>_G(e,t,n)>=0;var jv=EG;const AG=Hr,$G=(e,t,n)=>AG(e,t,n)<=0;var Lv=$G;const SG=Tv,CG=w3,OG=I0,FG=jv,kG=Rv,DG=Lv,MG=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return SG(e,n,r);case"!=":return CG(e,n,r);case">":return OG(e,n,r);case">=":return FG(e,n,r);case"<":return kG(e,n,r);case"<=":return DG(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var _3=MG;const TG=pn,NG=Gu,{re:B0,t:z0}=ia.exports,RG=(e,t)=>{if(e instanceof TG)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(B0[z0.COERCE]);else{let r;for(;(r=B0[z0.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||r.index+r[0].length!==n.index+n[0].length)&&(n=r),B0[z0.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;B0[z0.COERCERTL].lastIndex=-1}return n===null?null:NG(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var jG=RG,LG=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}},PG=De;De.Node=ps;De.create=De;function De(e){var t=this;if(t instanceof De||(t=new De),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}De.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};De.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};De.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};De.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)BG(this,arguments[e]);return this.length};De.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)zG(this,arguments[e]);return this.length};De.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};De.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};De.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next};De.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev};De.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};De.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};De.prototype.map=function(e,t){t=t||this;for(var n=new De,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n};De.prototype.mapReverse=function(e,t){t=t||this;for(var n=new De,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n};De.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n};De.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n};De.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};De.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};De.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new De;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n};De.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new De;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n};De.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var o=[],r=0;i&&r<t;r++)o.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=IG(this,i,n[r]);return o};De.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function IG(e,t,n){var r=t===e.head?new ps(n,null,t,e):new ps(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function BG(e,t){e.tail=new ps(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function zG(e,t){e.head=new ps(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function ps(e,t,n,r){if(!(this instanceof ps))return new ps(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{LG(De)}catch(e){}const UG=PG,ms=Symbol("max"),bo=Symbol("length"),Yu=Symbol("lengthCalculator"),Vc=Symbol("allowStale"),ys=Symbol("maxAge"),xo=Symbol("dispose"),E3=Symbol("noDisposeOnSet"),Ot=Symbol("lruList"),Wr=Symbol("cache"),A3=Symbol("updateAgeOnGet"),Pv=()=>1;class qG{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[ms]=t.max||1/0;const n=t.length||Pv;if(this[Yu]=typeof n!="function"?Pv:n,this[Vc]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[ys]=t.maxAge||0,this[xo]=t.dispose,this[E3]=t.noDisposeOnSet||!1,this[A3]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[ms]=t||1/0,Xc(this)}get max(){return this[ms]}set allowStale(t){this[Vc]=!!t}get allowStale(){return this[Vc]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[ys]=t,Xc(this)}get maxAge(){return this[ys]}set lengthCalculator(t){typeof t!="function"&&(t=Pv),t!==this[Yu]&&(this[Yu]=t,this[bo]=0,this[Ot].forEach(n=>{n.length=this[Yu](n.value,n.key),this[bo]+=n.length})),Xc(this)}get lengthCalculator(){return this[Yu]}get length(){return this[bo]}get itemCount(){return this[Ot].length}rforEach(t,n){n=n||this;for(let r=this[Ot].tail;r!==null;){const i=r.prev;$3(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[Ot].head;r!==null;){const i=r.next;$3(this,t,r,n),r=i}}keys(){return this[Ot].toArray().map(t=>t.key)}values(){return this[Ot].toArray().map(t=>t.value)}reset(){this[xo]&&this[Ot]&&this[Ot].length&&this[Ot].forEach(t=>this[xo](t.key,t.value)),this[Wr]=new Map,this[Ot]=new UG,this[bo]=0}dump(){return this[Ot].map(t=>U0(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Ot]}set(t,n,r){if(r=r||this[ys],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,o=this[Yu](n,t);if(this[Wr].has(t)){if(o>this[ms])return Vu(this,this[Wr].get(t)),!1;const u=this[Wr].get(t).value;return this[xo]&&(this[E3]||this[xo](t,u.value)),u.now=i,u.maxAge=r,u.value=n,this[bo]+=o-u.length,u.length=o,this.get(t),Xc(this),!0}const a=new HG(t,n,o,i,r);return a.length>this[ms]?(this[xo]&&this[xo](t,n),!1):(this[bo]+=a.length,this[Ot].unshift(a),this[Wr].set(t,this[Ot].head),Xc(this),!0)}has(t){if(!this[Wr].has(t))return!1;const n=this[Wr].get(t).value;return!U0(this,n)}get(t){return Iv(this,t,!0)}peek(t){return Iv(this,t,!1)}pop(){const t=this[Ot].tail;return t?(Vu(this,t),t.value):null}del(t){Vu(this,this[Wr].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],o=i.e||0;if(o===0)this.set(i.k,i.v);else{const a=o-n;a>0&&this.set(i.k,i.v,a)}}}prune(){this[Wr].forEach((t,n)=>Iv(this,n,!1))}}const Iv=(e,t,n)=>{const r=e[Wr].get(t);if(r){const i=r.value;if(U0(e,i)){if(Vu(e,r),!e[Vc])return}else n&&(e[A3]&&(r.value.now=Date.now()),e[Ot].unshiftNode(r));return i.value}},U0=(e,t)=>{if(!t||!t.maxAge&&!e[ys])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[ys]&&n>e[ys]},Xc=e=>{if(e[bo]>e[ms])for(let t=e[Ot].tail;e[bo]>e[ms]&&t!==null;){const n=t.prev;Vu(e,t),t=n}},Vu=(e,t)=>{if(t){const n=t.value;e[xo]&&e[xo](n.key,n.value),e[bo]-=n.length,e[Wr].delete(n.key),e[Ot].removeNode(t)}};class HG{constructor(t,n,r,i,o){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=o||0}}const $3=(e,t,n,r)=>{let i=n.value;U0(e,i)&&(Vu(e,n),e[Vc]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var WG=qG;class Kc{constructor(t,n){if(n=YG(n),t instanceof Kc)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new Kc(t.raw,n);if(t instanceof Bv)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const r=this.set[0];if(this.set=this.set.filter(i=>!C3(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(const i of this.set)if(i.length===1&&ZG(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const r=`parseRange:${Object.keys(this.options).join(",")}:${t}`,i=S3.get(r);if(i)return i;const o=this.options.loose,a=o?Vt[Bt.HYPHENRANGELOOSE]:Vt[Bt.HYPHENRANGE];t=t.replace(a,uY(this.options.includePrerelease)),dt("hyphen replace",t),t=t.replace(Vt[Bt.COMPARATORTRIM],XG),dt("comparator trim",t,Vt[Bt.COMPARATORTRIM]),t=t.replace(Vt[Bt.TILDETRIM],KG),t=t.replace(Vt[Bt.CARETTRIM],JG),t=t.split(/\s+/).join(" ");const s=o?Vt[Bt.COMPARATORLOOSE]:Vt[Bt.COMPARATOR],u=t.split(" ").map(f=>QG(f,this.options)).join(" ").split(/\s+/).map(f=>sY(f,this.options)).filter(this.options.loose?f=>!!f.match(s):()=>!0).map(f=>new Bv(f,this.options));u.length;const l=new Map;for(const f of u){if(C3(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return S3.set(r,c),c}intersects(t,n){if(!(t instanceof Kc))throw new TypeError("a Range is required");return this.set.some(r=>O3(r,n)&&t.set.some(i=>O3(i,n)&&r.every(o=>i.every(a=>o.intersects(a,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new VG(t,this.options)}catch(n){return!1}for(let n=0;n<this.set.length;n++)if(lY(this.set[n],t,this.options))return!0;return!1}}var Gr=Kc;const GG=WG,S3=new GG({max:1e3}),YG=j0,Bv=H0,dt=R0,VG=pn,{re:Vt,t:Bt,comparatorTrimReplace:XG,tildeTrimReplace:KG,caretTrimReplace:JG}=ia.exports,C3=e=>e.value==="<0.0.0-0",ZG=e=>e.value==="",O3=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every(o=>i.intersects(o,t)),i=r.pop();return n},QG=(e,t)=>(dt("comp",e,t),e=nY(e,t),dt("caret",e),e=eY(e,t),dt("tildes",e),e=iY(e,t),dt("xrange",e),e=aY(e,t),dt("stars",e),e),mn=e=>!e||e.toLowerCase()==="x"||e==="*",eY=(e,t)=>e.trim().split(/\s+/).map(n=>tY(n,t)).join(" "),tY=(e,t)=>{const n=t.loose?Vt[Bt.TILDELOOSE]:Vt[Bt.TILDE];return e.replace(n,(r,i,o,a,s)=>{dt("tilde",e,r,i,o,a,s);let u;return mn(i)?u="":mn(o)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:mn(a)?u=`>=${i}.${o}.0 <${i}.${+o+1}.0-0`:s?(dt("replaceTilde pr",s),u=`>=${i}.${o}.${a}-${s} <${i}.${+o+1}.0-0`):u=`>=${i}.${o}.${a} <${i}.${+o+1}.0-0`,dt("tilde return",u),u})},nY=(e,t)=>e.trim().split(/\s+/).map(n=>rY(n,t)).join(" "),rY=(e,t)=>{dt("caret",e,t);const n=t.loose?Vt[Bt.CARETLOOSE]:Vt[Bt.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(i,o,a,s,u)=>{dt("caret",e,i,o,a,s,u);let l;return mn(o)?l="":mn(a)?l=`>=${o}.0.0${r} <${+o+1}.0.0-0`:mn(s)?o==="0"?l=`>=${o}.${a}.0${r} <${o}.${+a+1}.0-0`:l=`>=${o}.${a}.0${r} <${+o+1}.0.0-0`:u?(dt("replaceCaret pr",u),o==="0"?a==="0"?l=`>=${o}.${a}.${s}-${u} <${o}.${a}.${+s+1}-0`:l=`>=${o}.${a}.${s}-${u} <${o}.${+a+1}.0-0`:l=`>=${o}.${a}.${s}-${u} <${+o+1}.0.0-0`):(dt("no pr"),o==="0"?a==="0"?l=`>=${o}.${a}.${s}${r} <${o}.${a}.${+s+1}-0`:l=`>=${o}.${a}.${s}${r} <${o}.${+a+1}.0-0`:l=`>=${o}.${a}.${s} <${+o+1}.0.0-0`),dt("caret return",l),l})},iY=(e,t)=>(dt("replaceXRanges",e,t),e.split(/\s+/).map(n=>oY(n,t)).join(" ")),oY=(e,t)=>{e=e.trim();const n=t.loose?Vt[Bt.XRANGELOOSE]:Vt[Bt.XRANGE];return e.replace(n,(r,i,o,a,s,u)=>{dt("xRange",e,r,i,o,a,s,u);const l=mn(o),c=l||mn(a),f=c||mn(s),d=f;return i==="="&&d&&(i=""),u=t.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&d?(c&&(a=0),s=0,i===">"?(i=">=",c?(o=+o+1,a=0,s=0):(a=+a+1,s=0)):i==="<="&&(i="<",c?o=+o+1:a=+a+1),i==="<"&&(u="-0"),r=`${i+o}.${a}.${s}${u}`):c?r=`>=${o}.0.0${u} <${+o+1}.0.0-0`:f&&(r=`>=${o}.${a}.0${u} <${o}.${+a+1}.0-0`),dt("xRange return",r),r})},aY=(e,t)=>(dt("replaceStars",e,t),e.trim().replace(Vt[Bt.STAR],"")),sY=(e,t)=>(dt("replaceGTE0",e,t),e.trim().replace(Vt[t.includePrerelease?Bt.GTE0PRE:Bt.GTE0],"")),uY=e=>(t,n,r,i,o,a,s,u,l,c,f,d,h)=>(mn(r)?n="":mn(i)?n=`>=${r}.0.0${e?"-0":""}`:mn(o)?n=`>=${r}.${i}.0${e?"-0":""}`:a?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,mn(l)?u="":mn(c)?u=`<${+l+1}.0.0-0`:mn(f)?u=`<${l}.${+c+1}.0-0`:d?u=`<=${l}.${c}.${f}-${d}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),lY=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let r=0;r<e.length;r++)if(dt(e[r].semver),e[r].semver!==Bv.ANY&&e[r].semver.prerelease.length>0){const i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0},Jc=Symbol("SemVer ANY");class q0{static get ANY(){return Jc}constructor(t,n){if(n=cY(n),t instanceof q0){if(t.loose===!!n.loose)return t;t=t.value}Uv("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===Jc?this.value="":this.value=this.operator+this.semver.version,Uv("comp",this)}parse(t){const n=this.options.loose?F3[k3.COMPARATORLOOSE]:F3[k3.COMPARATOR],r=t.match(n);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new D3(r[2],this.options.loose):this.semver=Jc}toString(){return this.value}test(t){if(Uv("Comparator.test",t,this.options.loose),this.semver===Jc||t===Jc)return!0;if(typeof t=="string")try{t=new D3(t,this.options)}catch(n){return!1}return zv(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof q0))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new M3(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new M3(this.value,n).test(t.semver);const r=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),o=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=zv(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=zv(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||i||o&&a||s||u}}var H0=q0;const cY=j0,{re:F3,t:k3}=ia.exports,zv=_3,Uv=R0,D3=pn,M3=Gr,fY=Gr,dY=(e,t,n)=>{try{t=new fY(t,n)}catch(r){return!1}return t.test(e)};var W0=dY;const hY=Gr,gY=(e,t)=>new hY(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var pY=gY;const mY=pn,yY=Gr,vY=(e,t,n)=>{let r=null,i=null,o=null;try{o=new yY(t,n)}catch(a){return null}return e.forEach(a=>{o.test(a)&&(!r||i.compare(a)===-1)&&(r=a,i=new mY(r,n))}),r};var bY=vY;const xY=pn,wY=Gr,_Y=(e,t,n)=>{let r=null,i=null,o=null;try{o=new wY(t,n)}catch(a){return null}return e.forEach(a=>{o.test(a)&&(!r||i.compare(a)===1)&&(r=a,i=new xY(r,n))}),r};var EY=_Y;const qv=pn,AY=Gr,T3=I0,$Y=(e,t)=>{e=new AY(e,t);let n=new qv("0.0.0");if(e.test(n)||(n=new qv("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){const i=e.set[r];let o=null;i.forEach(a=>{const s=new qv(a.semver.version);switch(a.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!o||T3(s,o))&&(o=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),o&&(!n||T3(n,o))&&(n=o)}return n&&e.test(n)?n:null};var SY=$Y;const CY=Gr,OY=(e,t)=>{try{return new CY(e,t).range||"*"}catch(n){return null}};var FY=OY;const kY=pn,N3=H0,{ANY:DY}=N3,MY=Gr,TY=W0,R3=I0,j3=Rv,NY=Lv,RY=jv,jY=(e,t,n,r)=>{e=new kY(e,r),t=new MY(t,r);let i,o,a,s,u;switch(n){case">":i=R3,o=NY,a=j3,s=">",u=">=";break;case"<":i=j3,o=RY,a=R3,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(TY(e,t,r))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,d=null;if(c.forEach(h=>{h.semver===DY&&(h=new N3(">=0.0.0")),f=f||h,d=d||h,i(h.semver,f.semver,r)?f=h:a(h.semver,d.semver,r)&&(d=h)}),f.operator===s||f.operator===u||(!d.operator||d.operator===s)&&o(e,d.semver))return!1;if(d.operator===u&&a(e,d.semver))return!1}return!0};var Hv=jY;const LY=Hv,PY=(e,t,n)=>LY(e,t,">",n);var IY=PY;const BY=Hv,zY=(e,t,n)=>BY(e,t,"<",n);var UY=zY;const L3=Gr,qY=(e,t,n)=>(e=new L3(e,n),t=new L3(t,n),e.intersects(t));var HY=qY;const WY=W0,GY=Hr;var YY=(e,t,n)=>{const r=[];let i=null,o=null;const a=e.sort((c,f)=>GY(c,f,n));for(const c of a)WY(c,t,n)?(o=c,i||(i=c)):(o&&r.push([i,o]),o=null,i=null);i&&r.push([i,null]);const s=[];for(const[c,f]of r)c===f?s.push(c):!f&&c===a[0]?s.push("*"):f?c===a[0]?s.push(`<=${f}`):s.push(`${c} - ${f}`):s.push(`>=${c}`);const u=s.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const P3=Gr,G0=H0,{ANY:Wv}=G0,Zc=W0,Gv=Hr,VY=(e,t,n={})=>{if(e===t)return!0;e=new P3(e,n),t=new P3(t,n);let r=!1;e:for(const i of e.set){for(const o of t.set){const a=XY(i,o,n);if(r=r||a!==null,a)continue e}if(r)return!1}return!0},XY=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===Wv){if(t.length===1&&t[0].semver===Wv)return!0;n.includePrerelease?e=[new G0(">=0.0.0-0")]:e=[new G0(">=0.0.0")]}if(t.length===1&&t[0].semver===Wv){if(n.includePrerelease)return!0;t=[new G0(">=0.0.0")]}const r=new Set;let i,o;for(const h of e)h.operator===">"||h.operator===">="?i=I3(i,h,n):h.operator==="<"||h.operator==="<="?o=B3(o,h,n):r.add(h.semver);if(r.size>1)return null;let a;if(i&&o){if(a=Gv(i.semver,o.semver,n),a>0)return null;if(a===0&&(i.operator!==">="||o.operator!=="<="))return null}for(const h of r){if(i&&!Zc(h,String(i),n)||o&&!Zc(h,String(o),n))return null;for(const g of t)if(!Zc(h,String(g),n))return!1;return!0}let s,u,l,c,f=o&&!n.includePrerelease&&o.semver.prerelease.length?o.semver:!1,d=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&o.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of t){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",i){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(s=I3(i,h,n),s===h&&s!==i)return!1}else if(i.operator===">="&&!Zc(i.semver,String(h),n))return!1}if(o){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(u=B3(o,h,n),u===h&&u!==o)return!1}else if(o.operator==="<="&&!Zc(o.semver,String(h),n))return!1}if(!h.operator&&(o||i)&&a!==0)return!1}return!(i&&l&&!o&&a!==0||o&&c&&!i&&a!==0||d||f)},I3=(e,t,n)=>{if(!e)return t;const r=Gv(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},B3=(e,t,n)=>{if(!e)return t;const r=Gv(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};var KY=VY;const Yv=ia.exports;var z3={re:Yv.re,src:Yv.src,tokens:Yv.t,SEMVER_SPEC_VERSION:N0.SEMVER_SPEC_VERSION,SemVer:pn,compareIdentifiers:Mv.compareIdentifiers,rcompareIdentifiers:Mv.rcompareIdentifiers,parse:Gu,valid:MW,clean:RW,inc:PW,diff:HW,major:YW,minor:KW,patch:QW,prerelease:nG,compare:Hr,rcompare:oG,compareLoose:uG,compareBuild:Nv,sort:dG,rsort:pG,gt:I0,lt:Rv,eq:Tv,neq:w3,gte:jv,lte:Lv,cmp:_3,coerce:jG,Comparator:H0,Range:Gr,satisfies:W0,toComparators:pY,maxSatisfying:bY,minSatisfying:EY,minVersion:SY,validRange:FY,outside:Hv,gtr:IY,ltr:UY,intersects:HY,simplifyRange:YY,subset:KY};function jn(e,t,n){return e.fields=t||[],e.fname=n,e}function ut(e){return e==null?null:e.fname}function Xt(e){return e==null?null:e.fields}function U3(e){return e.length===1?JY(e[0]):ZY(e)}const JY=e=>function(t){return t[e]},ZY=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function I(e){throw Error(e)}function Y0(e){const t=[],n=e.length;let r=null,i=0,o="",a,s,u;e=e+"";function l(){t.push(o+e.substring(a,s)),o="",a=s+1}for(a=s=0;s<n;++s)if(u=e[s],u==="\\")o+=e.substring(a,s),o+=e.substring(++s,++s),a=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;a===i&&u==='"'||a===i&&u==="'"?(a=s+1,r=u):u==="."&&!i?s>a?l():a=s+1:u==="["?(s>a&&l(),i=a=s+1):u==="]"&&(i||I("Access path missing open bracket: "+e),i>0&&l(),i=0,a=s+1)}return i&&I("Access path missing closing bracket: "+e),r&&I("Access path missing closing quote: "+e),s>a&&(s++,l()),t}function Ln(e,t,n){const r=Y0(e);return e=r.length===1?r[0]:e,jn((n&&n.get||U3)(r),[e],t||e)}const Qc=Ln("id"),yn=jn(e=>e,[],"identity"),oa=jn(()=>0,[],"zero"),Xu=jn(()=>1,[],"one"),_r=jn(()=>!0,[],"true"),aa=jn(()=>!1,[],"false");function QY(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const q3=0,Vv=1,H3=2,W3=3,G3=4;function Y3(e,t,n=QY){let r=e||q3;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=Vv&&n(t||"error","ERROR",arguments),this},warn(){return r>=H3&&n(t||"warn","WARN",arguments),this},info(){return r>=W3&&n(t||"log","INFO",arguments),this},debug(){return r>=G3&&n(t||"log","DEBUG",arguments),this}}}var Q=Array.isArray;function se(e){return e===Object(e)}const V3=e=>e!=="__proto__";function V0(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=eV(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;ef(t,r,n[r],i)}return t},{})}function ef(e,t,n,r){if(!V3(t))return;let i,o;if(se(n)&&!Q(n)){o=se(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?ef(o,i,n[i]):V3(i)&&(o[i]=n[i])}else e[t]=n}function eV(e,t){if(e==null)return t;const n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function _e(e){return e[e.length-1]}function Kt(e){return e==null||e===""?null:+e}const X3=e=>t=>e*Math.exp(t),K3=e=>t=>Math.log(e*t),J3=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),Z3=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,X0=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function K0(e,t,n,r){const i=n(e[0]),o=n(_e(e)),a=(o-i)*t;return[r(i-a),r(o-a)]}function Q3(e,t){return K0(e,t,Kt,yn)}function eF(e,t){var n=Math.sign(e[0]);return K0(e,t,K3(n),X3(n))}function tF(e,t,n){return K0(e,t,X0(n),X0(1/n))}function nF(e,t,n){return K0(e,t,J3(n),Z3(n))}function J0(e,t,n,r,i){const o=r(e[0]),a=r(_e(e)),s=t!=null?r(t):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function Xv(e,t,n){return J0(e,t,n,Kt,yn)}function Kv(e,t,n){const r=Math.sign(e[0]);return J0(e,t,n,K3(r),X3(r))}function Z0(e,t,n,r){return J0(e,t,n,X0(r),X0(1/r))}function Jv(e,t,n,r){return J0(e,t,n,J3(r),Z3(r))}function rF(e){return 1+~~(new Date(e).getMonth()/3)}function iF(e){return 1+~~(new Date(e).getUTCMonth()/3)}function oe(e){return e!=null?Q(e)?e:[e]:[]}function oF(e,t,n){let r=e[0],i=e[1],o;return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function me(e){return typeof e=="function"}const tV="descending";function Zv(e,t,n){n=n||{},t=oe(t)||[];const r=[],i=[],o={},a=n.comparator||nV;return oe(e).forEach((s,u)=>{s!=null&&(r.push(t[u]===tV?-1:1),i.push(s=me(s)?s:Ln(s,null,n)),(Xt(s)||[]).forEach(l=>o[l]=1))}),i.length===0?null:jn(a(i,r),Object.keys(o))}const Q0=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),nV=(e,t)=>e.length===1?rV(e[0],t[0]):iV(e,t,e.length),rV=(e,t)=>function(n,r){return Q0(e(n),e(r))*t},iV=(e,t,n)=>(t.push(0),function(r,i){let o,a=0,s=-1;for(;a===0&&++s<n;)o=e[s],a=Q0(o(r),o(i));return a*t[s]});function Jt(e){return me(e)?e:()=>e}function Qv(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function ge(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function Ai(e,t){let n=0,r,i,o,a;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=a=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>a&&(a=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=a=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>a&&(a=i))}return[o,a]}function aF(e,t){const n=e.length;let r=-1,i,o,a,s,u;if(t==null){for(;++r<n;)if(o=e[r],o!=null&&o>=o){i=a=o;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)o=e[r],o!=null&&(i>o&&(i=o,s=r),a<o&&(a=o,u=r))}else{for(;++r<n;)if(o=t(e[r],r,e),o!=null&&o>=o){i=a=o;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)o=t(e[r],r,e),o!=null&&(i>o&&(i=o,s=r),a<o&&(a=o,u=r))}return[s,u]}const oV=Object.prototype.hasOwnProperty;function ae(e,t){return oV.call(e,t)}const eg={};function Ku(e){let t={},n;function r(o){return ae(t,o)&&t[o]!==eg}const i={size:0,empty:0,object:t,has:r,get(o){return r(o)?t[o]:void 0},set(o,a){return r(o)||(++i.size,t[o]===eg&&--i.empty),t[o]=a,this},delete(o){return r(o)&&(--i.size,++i.empty,t[o]=eg),this},clear(){i.size=i.empty=0,i.object=t={}},test(o){return arguments.length?(n=o,i):n},clean(){const o={};let a=0;for(const s in t){const u=t[s];u!==eg&&(!n||!n(u))&&(o[s]=u,++a)}i.size=a,i.empty=0,i.object=t=o}};return e&&Object.keys(e).forEach(o=>{i.set(o,e[o])}),i}function sF(e,t,n,r,i,o){if(!n&&n!==0)return o;const a=+n;let s=e[0],u=_e(e),l;u<s&&(l=s,s=u,u=l),l=Math.abs(t-s);const c=Math.abs(u-t);return l<c&&l<=a?r:c<=a?i:o}function q(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),ge(r,n)}function Ju(e,t,n,r){let i=t[0],o=t[t.length-1],a;return i>o&&(a=i,i=o,o=a),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function eb(e){return typeof e=="boolean"}function sa(e){return Object.prototype.toString.call(e)==="[object Date]"}function uF(e){return e&&me(e[Symbol.iterator])}function ua(e){return typeof e=="number"}function lF(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Fe(e){return typeof e=="string"}function tb(e,t,n){e&&(e=t?oe(e).map(s=>s.replace(/\\(.)/g,"$1")):oe(e));const r=e&&e.length,i=n&&n.get||U3,o=s=>i(t?[s]:Y0(s));let a;if(!r)a=function(){return""};else if(r===1){const s=o(e[0]);a=function(u){return""+s(u)}}else{const s=e.map(o);a=function(u){let l=""+s[0](u),c=0;for(;++c<r;)l+="|"+s[c](u);return l}}return jn(a,e,"key")}function cF(e,t){const n=e[0],r=_e(e),i=+t;return i?i===1?r:n+i*(r-n):n}const aV=1e4;function fF(e){e=+e||aV;let t,n,r;const i=()=>{t={},n={},r=0},o=(a,s)=>(++r>e&&(n=t,t={},r=1),t[a]=s);return i(),{clear:i,has:a=>ae(t,a)||ae(n,a),get:a=>ae(t,a)?t[a]:ae(n,a)?o(a,n[a]):void 0,set:(a,s)=>ae(t,a)?t[a]=s:o(a,s)}}function dF(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const a=r||new t.constructor(i+o);let s=0,u=0,l=0;for(;s<i&&u<o;++l)a[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<i;++s,++l)a[l]=t[s];for(;u<o;++u,++l)a[l]=n[u];return a}function tf(e,t){let n="";for(;--t>=0;)n+=e;return n}function hF(e,t,n,r){const i=n||" ",o=e+"",a=t-o.length;return a<=0?o:r==="left"?tf(i,a)+o:r==="center"?tf(i,~~(a/2))+o+tf(i,Math.ceil(a/2)):o+tf(i,a)}function nf(e){return e&&_e(e)-e[0]||0}function ne(e){return Q(e)?"["+e.map(ne)+"]":se(e)||Fe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function nb(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const sV=e=>ua(e)||sa(e)?e:Date.parse(e);function rb(e,t){return t=t||sV,e==null||e===""?null:t(e)}function ib(e){return e==null||e===""?null:e+""}function Yr(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function gF(e,t,n,r){const i=r!=null?r:"\u2026",o=e+"",a=o.length,s=Math.max(0,t-i.length);return a<=t?o:n==="left"?i+o.slice(a-s):n==="center"?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i}function la(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var pF={},ob={},ab=34,rf=10,sb=13;function mF(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function uV(e,t){var n=mF(e);return function(r,i){return t(n(r),i,e)}}function yF(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Pn(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function lV(e){return e<0?"-"+Pn(-e,6):e>9999?"+"+Pn(e,6):Pn(e,4)}function cV(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":lV(e.getUTCFullYear())+"-"+Pn(e.getUTCMonth()+1,2)+"-"+Pn(e.getUTCDate(),2)+(i?"T"+Pn(t,2)+":"+Pn(n,2)+":"+Pn(r,2)+"."+Pn(i,3)+"Z":r?"T"+Pn(t,2)+":"+Pn(n,2)+":"+Pn(r,2)+"Z":n||t?"T"+Pn(t,2)+":"+Pn(n,2)+"Z":"")}function fV(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,g,p=i(f,function(m,y){if(h)return h(m,y-1);g=m,h=d?uV(m,d):mF(m)});return p.columns=g||[],p}function i(f,d){var h=[],g=f.length,p=0,m=0,y,v=g<=0,b=!1;f.charCodeAt(g-1)===rf&&--g,f.charCodeAt(g-1)===sb&&--g;function x(){if(v)return ob;if(b)return b=!1,pF;var E,_=p,$;if(f.charCodeAt(_)===ab){for(;p++<g&&f.charCodeAt(p)!==ab||f.charCodeAt(++p)===ab;);return(E=p)>=g?v=!0:($=f.charCodeAt(p++))===rf?b=!0:$===sb&&(b=!0,f.charCodeAt(p)===rf&&++p),f.slice(_+1,E-1).replace(/""/g,'"')}for(;p<g;){if(($=f.charCodeAt(E=p++))===rf)b=!0;else if($===sb)b=!0,f.charCodeAt(p)===rf&&++p;else if($!==n)continue;return f.slice(_,E)}return v=!0,f.slice(_,g)}for(;(y=x())!==ob;){for(var w=[];y!==pF&&y!==ob;)w.push(y),y=x();d&&(w=d(w,m++))==null||h.push(w)}return h}function o(f,d){return f.map(function(h){return d.map(function(g){return c(h[g])}).join(e)})}function a(f,d){return d==null&&(d=yF(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function s(f,d){return d==null&&(d=yF(f)),o(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?cV(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:a,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}function dV(e){return e}function hV(e){if(e==null)return dV;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],a=e.translate[1];return function(s,u){u||(t=n=0);var l=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*r+o,f[1]=(n+=s[1])*i+a;l<c;)f[l]=s[l],++l;return f}}function gV(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function pV(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return vF(e,n)})}:vF(e,t)}function vF(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,o=bF(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:o}:r==null?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function bF(e,t){var n=hV(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,g=d.length;h<g;++h)f.push(n(d[h],h));c<0&&gV(f,g)}function o(c){return n(c)}function a(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=a(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(s)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=a(c.arcs);break;case"MultiLineString":d=c.arcs.map(a);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function mV(e,t){var n={},r={},i={},o=[],a=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++a],t[a]=l,t[c]=d)}),t.forEach(function(l){var c=s(l),f=c[0],d=c[1],h,g;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,g=r[d]){delete r[g.start];var p=g===h?h:h.concat(g);r[p.start=h.start]=i[p.end=g.end]=p}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,g=i[f]){delete i[g.end];var m=g===h?h:g.concat(h);r[m.start=g.start]=i[m.end=h.end]=m}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function s(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function yV(e){return bF(e,vV.apply(this,arguments))}function vV(e,t,n){var r,i,o;if(arguments.length>1)r=bV(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:mV(e,r)}}function bV(e,t,n){var r=[],i=[],o;function a(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:o})}function s(f){f.forEach(a)}function u(f){f.forEach(s)}function l(f){f.forEach(u)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":s(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}var xV=Math.sqrt(50),wV=Math.sqrt(10),_V=Math.sqrt(2);function EV(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=xV?i*=10:o>=wV?i*=5:o>=_V&&(i*=2),t<e?-i:i}function AV(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function tg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Zu(e){return e=tg(Math.abs(e)),e?e[1]:NaN}function $V(e,t){return function(n,r){for(var i=n.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function SV(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var CV=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function of(e){if(!(t=CV.exec(e)))throw new Error("invalid format: "+e);var t;return new ub({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}of.prototype=ub.prototype;function ub(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ub.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function OV(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var xF;function FV(e,t){var n=tg(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(xF=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+tg(e,Math.max(0,t+o-1))[0]}function wF(e,t){var n=tg(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var _F={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:AV,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>wF(e*100,t),r:wF,s:FV,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function EF(e){return e}var AF=Array.prototype.map,$F=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function SF(e){var t=e.grouping===void 0||e.thousands===void 0?EF:$V(AF.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?EF:SV(AF.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=of(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,v=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(v=!0,w="g"):_F[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var E=p==="$"?n:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",_=p==="$"?r:/[%p]/.test(w)?a:"",$=_F[w],C=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function O(A){var D=E,F=_,T,S,M;if(w==="c")F=$(A)+F,A="";else{A=+A;var P=A<0||1/A<0;if(A=isNaN(A)?u:$(Math.abs(A),b),x&&(A=OV(A)),P&&+A==0&&g!=="+"&&(P=!1),D=(P?g==="("?g:s:g==="-"||g==="("?"":g)+D,F=(w==="s"?$F[8+xF/3]:"")+F+(P&&g==="("?")":""),C){for(T=-1,S=A.length;++T<S;)if(M=A.charCodeAt(T),48>M||M>57){F=(M===46?i+A.slice(T+1):A.slice(T))+F,A=A.slice(0,T);break}}}v&&!m&&(A=t(A,1/0));var B=D.length+A.length+F.length,H=B<y?new Array(y-B+1).join(d):"";switch(v&&m&&(A=t(H+A,H.length?y-F.length:1/0),H=""),h){case"<":A=D+A+F+H;break;case"=":A=D+H+A+F;break;case"^":A=H.slice(0,B=H.length>>1)+D+A+F+H.slice(B);break;default:A=H+D+A+F;break}return o(A)}return O.toString=function(){return f+""},O}function c(f,d){var h=l((f=of(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(Zu(d)/3)))*3,p=Math.pow(10,-g),m=$F[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var ng,CF,OF;kV({thousands:",",grouping:[3],currency:["$",""]});function kV(e){return ng=SF(e),CF=ng.format,OF=ng.formatPrefix,ng}function DV(e){return Math.max(0,-Zu(Math.abs(e)))}function MV(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Zu(t)/3)))*3-Zu(Math.abs(e)))}function TV(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Zu(t)-Zu(e))+1}var lb=new Date,cb=new Date;function Ft(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return e(o=new Date(+o)),o},i.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var u=[],l;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},i.filter=function(o){return Ft(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(i.count=function(o,a){return lb.setTime(+o),cb.setTime(+a),e(lb),e(cb),Math.floor(n(lb,cb))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?function(a){return r(a)%o==0}:function(a){return i.count(0,a)%o==0}):i}),i}var fb=Ft(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});fb.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ft(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):fb};var FF=fb;const af=1e3,ca=af*60,sf=ca*60,db=sf*24,kF=db*7;var NV=Ft(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*af)},function(e,t){return(t-e)/af},function(e){return e.getUTCSeconds()}),DF=NV,RV=Ft(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*af)},function(e,t){e.setTime(+e+t*ca)},function(e,t){return(t-e)/ca},function(e){return e.getMinutes()}),jV=RV,LV=Ft(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*af-e.getMinutes()*ca)},function(e,t){e.setTime(+e+t*sf)},function(e,t){return(t-e)/sf},function(e){return e.getHours()}),PV=LV,IV=Ft(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ca)/db,e=>e.getDate()-1),rg=IV;function vs(e){return Ft(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*ca)/kF})}var MF=vs(0);vs(1);vs(2);vs(3);vs(4);vs(5);vs(6);var BV=Ft(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),TF=BV,NF=Ft(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});NF.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ft(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var zV=NF,UV=Ft(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*ca)},function(e,t){return(t-e)/ca},function(e){return e.getUTCMinutes()}),qV=UV,HV=Ft(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*sf)},function(e,t){return(t-e)/sf},function(e){return e.getUTCHours()}),WV=HV,GV=Ft(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/db},function(e){return e.getUTCDate()-1}),ig=GV;function bs(e){return Ft(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/kF})}var RF=bs(0);bs(1);bs(2);bs(3);bs(4);bs(5);bs(6);var YV=Ft(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),jF=YV,LF=Ft(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});LF.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ft(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var VV=LF;function XV(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function KV(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=JV(e));function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=r(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:r,center:o,right:i}}function JV(e){return(t,n)=>XV(e(t),n)}var ZV=Math.sqrt(50),QV=Math.sqrt(10),eX=Math.sqrt(2);function PF(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=ZV?i*=10:o>=QV?i*=5:o>=eX&&(i*=2),t<e?-i:i}const zt="year",In="quarter",Zt="month",xt="week",Bn="date",Qt="day",$i="dayofyear",ar="hours",sr="minutes",Er="seconds",Vr="milliseconds",hb=[zt,In,Zt,xt,Bn,Qt,$i,ar,sr,Er,Vr],gb=hb.reduce((e,t,n)=>(e[t]=1+n,e),{});function pb(e){const t=oe(e).slice(),n={};return t.length||I("Missing time unit."),t.forEach(i=>{ae(gb,i)?n[i]=1:I("Invalid time unit: ".concat(i,"."))}),(n[xt]||n[Qt]?1:0)+(n[In]||n[Zt]||n[Bn]?1:0)+(n[$i]?1:0)>1&&I("Incompatible time units: ".concat(e)),t.sort((i,o)=>gb[i]-gb[o]),t}const tX={[zt]:"%Y ",[In]:"Q%q ",[Zt]:"%b ",[Bn]:"%d ",[xt]:"W%U ",[Qt]:"%a ",[$i]:"%j ",[ar]:"%H:00",[sr]:"00:%M",[Er]:":%S",[Vr]:".%L",["".concat(zt,"-").concat(Zt)]:"%Y-%m ",["".concat(zt,"-").concat(Zt,"-").concat(Bn)]:"%Y-%m-%d ",["".concat(ar,"-").concat(sr)]:"%H:%M"};function IF(e,t){const n=ge({},tX,t),r=pb(e),i=r.length;let o="",a=0,s,u;for(a=0;a<i;)for(s=r.length;s>a;--s)if(u=r.slice(a,s).join("-"),n[u]!=null){o+=n[u],a=s;break}return o.trim()}const xs=new Date;function mb(e){return xs.setFullYear(e),xs.setMonth(0),xs.setDate(1),xs.setHours(0,0,0,0),xs}function BF(e){return UF(new Date(e))}function zF(e){return yb(new Date(e))}function UF(e){return rg.count(mb(e.getFullYear())-1,e)}function yb(e){return MF.count(mb(e.getFullYear())-1,e)}function vb(e){return mb(e).getDay()}function nX(e,t,n,r,i,o,a){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,o,a);return s.setFullYear(e),s}return new Date(e,t,n,r,i,o,a)}function qF(e){return WF(new Date(e))}function HF(e){return bb(new Date(e))}function WF(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return ig.count(t-1,e)}function bb(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return RF.count(t-1,e)}function xb(e){return xs.setTime(Date.UTC(e,0,1)),xs.getUTCDay()}function rX(e,t,n,r,i,o,a){if(0<=e&&e<100){const s=new Date(Date.UTC(-1,t,n,r,i,o,a));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,r,i,o,a))}function GF(e,t,n,r,i){const o=t||1,a=_e(e),s=(y,v,b)=>(b=b||y,iX(n[b],r[b],y===a&&o,v)),u=new Date,l=Yr(e),c=l[zt]?s(zt):Jt(2012),f=l[Zt]?s(Zt):l[In]?s(In):oa,d=l[xt]&&l[Qt]?s(Qt,1,xt+Qt):l[xt]?s(xt,1):l[Qt]?s(Qt,1):l[Bn]?s(Bn,1):l[$i]?s($i,1):Xu,h=l[ar]?s(ar):oa,g=l[sr]?s(sr):oa,p=l[Er]?s(Er):oa,m=l[Vr]?s(Vr):oa;return function(y){u.setTime(+y);const v=c(u);return i(v,f(u),d(u,v),h(u),g(u),p(u),m(u))}}function iX(e,t,n,r){const i=n<=1?e:r?(o,a)=>r+n*Math.floor((e(o,a)-r)/n):(o,a)=>n*Math.floor(e(o,a)/n);return t?(o,a)=>t(i(o,a),a):i}function Qu(e,t,n){return t+e*7-(n+6)%7}const oX={[zt]:e=>e.getFullYear(),[In]:e=>Math.floor(e.getMonth()/3),[Zt]:e=>e.getMonth(),[Bn]:e=>e.getDate(),[ar]:e=>e.getHours(),[sr]:e=>e.getMinutes(),[Er]:e=>e.getSeconds(),[Vr]:e=>e.getMilliseconds(),[$i]:e=>UF(e),[xt]:e=>yb(e),[xt+Qt]:(e,t)=>Qu(yb(e),e.getDay(),vb(t)),[Qt]:(e,t)=>Qu(1,e.getDay(),vb(t))},aX={[In]:e=>3*e,[xt]:(e,t)=>Qu(e,0,vb(t))};function YF(e,t){return GF(e,t||1,oX,aX,nX)}const sX={[zt]:e=>e.getUTCFullYear(),[In]:e=>Math.floor(e.getUTCMonth()/3),[Zt]:e=>e.getUTCMonth(),[Bn]:e=>e.getUTCDate(),[ar]:e=>e.getUTCHours(),[sr]:e=>e.getUTCMinutes(),[Er]:e=>e.getUTCSeconds(),[Vr]:e=>e.getUTCMilliseconds(),[$i]:e=>WF(e),[xt]:e=>bb(e),[Qt]:(e,t)=>Qu(1,e.getUTCDay(),xb(t)),[xt+Qt]:(e,t)=>Qu(bb(e),e.getUTCDay(),xb(t))},uX={[In]:e=>3*e,[xt]:(e,t)=>Qu(e,0,xb(t))};function VF(e,t){return GF(e,t||1,sX,uX,rX)}const lX={[zt]:zV,[In]:TF.every(3),[Zt]:TF,[xt]:MF,[Bn]:rg,[Qt]:rg,[$i]:rg,[ar]:PV,[sr]:jV,[Er]:DF,[Vr]:FF},cX={[zt]:VV,[In]:jF.every(3),[Zt]:jF,[xt]:RF,[Bn]:ig,[Qt]:ig,[$i]:ig,[ar]:WV,[sr]:qV,[Er]:DF,[Vr]:FF};function el(e){return lX[e]}function tl(e){return cX[e]}function XF(e,t,n){return e?e.offset(t,n):void 0}function KF(e,t,n){return XF(el(e),t,n)}function JF(e,t,n){return XF(tl(e),t,n)}function ZF(e,t,n,r){return e?e.range(t,n,r):void 0}function QF(e,t,n,r){return ZF(el(e),t,n,r)}function ek(e,t,n,r){return ZF(tl(e),t,n,r)}const uf=1e3,lf=uf*60,cf=lf*60,og=cf*24,fX=og*7,tk=og*30,wb=og*365,nk=[zt,Zt,Bn,ar,sr,Er,Vr],ff=nk.slice(0,-1),df=ff.slice(0,-1),hf=df.slice(0,-1),dX=hf.slice(0,-1),hX=[zt,xt],rk=[zt,Zt],ik=[zt],gf=[[ff,1,uf],[ff,5,5*uf],[ff,15,15*uf],[ff,30,30*uf],[df,1,lf],[df,5,5*lf],[df,15,15*lf],[df,30,30*lf],[hf,1,cf],[hf,3,3*cf],[hf,6,6*cf],[hf,12,12*cf],[dX,1,og],[hX,1,fX],[rk,1,tk],[rk,3,3*tk],[ik,1,wb]];function ok(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(nf(t))/n;let i=KV(s=>s[2]).right(gf,r),o,a;return i===gf.length?(o=ik,a=PF(t[0]/wb,t[1]/wb,n)):i?(i=gf[r/gf[i-1][2]<gf[i][2]/r?i-1:i],o=i[0],a=i[1]):(o=nk,a=Math.max(PF(t[0],t[1],n),1)),{units:o,step:a}}var _b=new Date,Eb=new Date;function wo(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return e(o=new Date(+o)),o},i.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var u=[],l;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},i.filter=function(o){return wo(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(i.count=function(o,a){return _b.setTime(+o),Eb.setTime(+a),e(_b),e(Eb),Math.floor(n(_b,Eb))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?function(a){return r(a)%o==0}:function(a){return i.count(0,a)%o==0}):i}),i}const gX=1e3,Ab=gX*60,pX=Ab*60,$b=pX*24,ak=$b*7;var mX=wo(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ab)/$b,e=>e.getDate()-1),sk=mX;function ws(e){return wo(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ab)/ak})}var yX=ws(0),Sb=ws(1);ws(2);ws(3);var pf=ws(4);ws(5);ws(6);var uk=wo(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});uk.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:wo(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var mf=uk,vX=wo(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/$b},function(e){return e.getUTCDate()-1}),lk=vX;function _s(e){return wo(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/ak})}var bX=_s(0),Cb=_s(1);_s(2);_s(3);var yf=_s(4);_s(5);_s(6);var ck=wo(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});ck.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:wo(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var vf=ck;function Ob(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Fb(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function bf(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function fk(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=xf(i),c=wf(i),f=xf(o),d=wf(o),h=xf(a),g=wf(a),p=xf(s),m=wf(s),y=xf(u),v=wf(u),b={a:P,A:B,b:H,B:ie,c:null,d:yk,e:yk,f:UX,g:ZX,G:eK,H:IX,I:BX,j:zX,L:vk,m:qX,M:HX,p:le,q:he,Q:Ak,s:$k,S:WX,u:GX,U:YX,V:VX,w:XX,W:KX,x:null,X:null,y:JX,Y:QX,Z:tK,"%":Ek},x={a:Ae,A:$e,b:Pe,B:It,c:null,d:xk,e:xk,f:oK,g:pK,G:yK,H:nK,I:rK,j:iK,L:wk,m:aK,M:sK,p:tr,q:Nn,Q:Ak,s:$k,S:uK,u:lK,U:cK,V:fK,w:dK,W:hK,x:null,X:null,y:gK,Y:mK,Z:vK,"%":Ek},w={a:O,A,b:D,B:F,c:T,d:pk,e:pk,f:RX,g:gk,G:hk,H:mk,I:mk,j:DX,L:NX,m:kX,M:MX,p:C,q:FX,Q:LX,s:PX,S:TX,u:AX,U:$X,V:SX,w:EX,W:CX,x:S,X:M,y:gk,Y:hk,Z:OX,"%":jX};b.x=E(n,b),b.X=E(r,b),b.c=E(t,b),x.x=E(n,x),x.X=E(r,x),x.c=E(t,x);function E(R,W){return function(V){var k=[],xe=-1,X=0,Oe=R.length,we,Yt,wr;for(V instanceof Date||(V=new Date(+V));++xe<Oe;)R.charCodeAt(xe)===37&&(k.push(R.slice(X,xe)),(Yt=dk[we=R.charAt(++xe)])!=null?we=R.charAt(++xe):Yt=we==="e"?" ":"0",(wr=W[we])&&(we=wr(V,Yt)),k.push(we),X=xe+1);return k.push(R.slice(X,xe)),k.join("")}}function _(R,W){return function(V){var k=bf(1900,void 0,1),xe=$(k,R,V+="",0),X,Oe;if(xe!=V.length)return null;if("Q"in k)return new Date(k.Q);if("s"in k)return new Date(k.s*1e3+("L"in k?k.L:0));if(W&&!("Z"in k)&&(k.Z=0),"p"in k&&(k.H=k.H%12+k.p*12),k.m===void 0&&(k.m="q"in k?k.q:0),"V"in k){if(k.V<1||k.V>53)return null;"w"in k||(k.w=1),"Z"in k?(X=Fb(bf(k.y,0,1)),Oe=X.getUTCDay(),X=Oe>4||Oe===0?Cb.ceil(X):Cb(X),X=lk.offset(X,(k.V-1)*7),k.y=X.getUTCFullYear(),k.m=X.getUTCMonth(),k.d=X.getUTCDate()+(k.w+6)%7):(X=Ob(bf(k.y,0,1)),Oe=X.getDay(),X=Oe>4||Oe===0?Sb.ceil(X):Sb(X),X=sk.offset(X,(k.V-1)*7),k.y=X.getFullYear(),k.m=X.getMonth(),k.d=X.getDate()+(k.w+6)%7)}else("W"in k||"U"in k)&&("w"in k||(k.w="u"in k?k.u%7:"W"in k?1:0),Oe="Z"in k?Fb(bf(k.y,0,1)).getUTCDay():Ob(bf(k.y,0,1)).getDay(),k.m=0,k.d="W"in k?(k.w+6)%7+k.W*7-(Oe+5)%7:k.w+k.U*7-(Oe+6)%7);return"Z"in k?(k.H+=k.Z/100|0,k.M+=k.Z%100,Fb(k)):Ob(k)}}function $(R,W,V,k){for(var xe=0,X=W.length,Oe=V.length,we,Yt;xe<X;){if(k>=Oe)return-1;if(we=W.charCodeAt(xe++),we===37){if(we=W.charAt(xe++),Yt=w[we in dk?W.charAt(xe++):we],!Yt||(k=Yt(R,V,k))<0)return-1}else if(we!=V.charCodeAt(k++))return-1}return k}function C(R,W,V){var k=l.exec(W.slice(V));return k?(R.p=c.get(k[0].toLowerCase()),V+k[0].length):-1}function O(R,W,V){var k=h.exec(W.slice(V));return k?(R.w=g.get(k[0].toLowerCase()),V+k[0].length):-1}function A(R,W,V){var k=f.exec(W.slice(V));return k?(R.w=d.get(k[0].toLowerCase()),V+k[0].length):-1}function D(R,W,V){var k=y.exec(W.slice(V));return k?(R.m=v.get(k[0].toLowerCase()),V+k[0].length):-1}function F(R,W,V){var k=p.exec(W.slice(V));return k?(R.m=m.get(k[0].toLowerCase()),V+k[0].length):-1}function T(R,W,V){return $(R,t,W,V)}function S(R,W,V){return $(R,n,W,V)}function M(R,W,V){return $(R,r,W,V)}function P(R){return a[R.getDay()]}function B(R){return o[R.getDay()]}function H(R){return u[R.getMonth()]}function ie(R){return s[R.getMonth()]}function le(R){return i[+(R.getHours()>=12)]}function he(R){return 1+~~(R.getMonth()/3)}function Ae(R){return a[R.getUTCDay()]}function $e(R){return o[R.getUTCDay()]}function Pe(R){return u[R.getUTCMonth()]}function It(R){return s[R.getUTCMonth()]}function tr(R){return i[+(R.getUTCHours()>=12)]}function Nn(R){return 1+~~(R.getUTCMonth()/3)}return{format:function(R){var W=E(R+="",b);return W.toString=function(){return R},W},parse:function(R){var W=_(R+="",!1);return W.toString=function(){return R},W},utcFormat:function(R){var W=E(R+="",x);return W.toString=function(){return R},W},utcParse:function(R){var W=_(R+="",!0);return W.toString=function(){return R},W}}}var dk={"-":"",_:" ","0":"0"},kt=/^\s*\d+/,xX=/^%/,wX=/[\\^$*+?|[\]().{}]/g;function Me(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function _X(e){return e.replace(wX,"\\$&")}function xf(e){return new RegExp("^(?:"+e.map(_X).join("|")+")","i")}function wf(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function EX(e,t,n){var r=kt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function AX(e,t,n){var r=kt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function $X(e,t,n){var r=kt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function SX(e,t,n){var r=kt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function CX(e,t,n){var r=kt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function hk(e,t,n){var r=kt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function gk(e,t,n){var r=kt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function OX(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function FX(e,t,n){var r=kt.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function kX(e,t,n){var r=kt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function pk(e,t,n){var r=kt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function DX(e,t,n){var r=kt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function mk(e,t,n){var r=kt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function MX(e,t,n){var r=kt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function TX(e,t,n){var r=kt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function NX(e,t,n){var r=kt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function RX(e,t,n){var r=kt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function jX(e,t,n){var r=xX.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function LX(e,t,n){var r=kt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function PX(e,t,n){var r=kt.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function yk(e,t){return Me(e.getDate(),t,2)}function IX(e,t){return Me(e.getHours(),t,2)}function BX(e,t){return Me(e.getHours()%12||12,t,2)}function zX(e,t){return Me(1+sk.count(mf(e),e),t,3)}function vk(e,t){return Me(e.getMilliseconds(),t,3)}function UX(e,t){return vk(e,t)+"000"}function qX(e,t){return Me(e.getMonth()+1,t,2)}function HX(e,t){return Me(e.getMinutes(),t,2)}function WX(e,t){return Me(e.getSeconds(),t,2)}function GX(e){var t=e.getDay();return t===0?7:t}function YX(e,t){return Me(yX.count(mf(e)-1,e),t,2)}function bk(e){var t=e.getDay();return t>=4||t===0?pf(e):pf.ceil(e)}function VX(e,t){return e=bk(e),Me(pf.count(mf(e),e)+(mf(e).getDay()===4),t,2)}function XX(e){return e.getDay()}function KX(e,t){return Me(Sb.count(mf(e)-1,e),t,2)}function JX(e,t){return Me(e.getFullYear()%100,t,2)}function ZX(e,t){return e=bk(e),Me(e.getFullYear()%100,t,2)}function QX(e,t){return Me(e.getFullYear()%1e4,t,4)}function eK(e,t){var n=e.getDay();return e=n>=4||n===0?pf(e):pf.ceil(e),Me(e.getFullYear()%1e4,t,4)}function tK(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Me(t/60|0,"0",2)+Me(t%60,"0",2)}function xk(e,t){return Me(e.getUTCDate(),t,2)}function nK(e,t){return Me(e.getUTCHours(),t,2)}function rK(e,t){return Me(e.getUTCHours()%12||12,t,2)}function iK(e,t){return Me(1+lk.count(vf(e),e),t,3)}function wk(e,t){return Me(e.getUTCMilliseconds(),t,3)}function oK(e,t){return wk(e,t)+"000"}function aK(e,t){return Me(e.getUTCMonth()+1,t,2)}function sK(e,t){return Me(e.getUTCMinutes(),t,2)}function uK(e,t){return Me(e.getUTCSeconds(),t,2)}function lK(e){var t=e.getUTCDay();return t===0?7:t}function cK(e,t){return Me(bX.count(vf(e)-1,e),t,2)}function _k(e){var t=e.getUTCDay();return t>=4||t===0?yf(e):yf.ceil(e)}function fK(e,t){return e=_k(e),Me(yf.count(vf(e),e)+(vf(e).getUTCDay()===4),t,2)}function dK(e){return e.getUTCDay()}function hK(e,t){return Me(Cb.count(vf(e)-1,e),t,2)}function gK(e,t){return Me(e.getUTCFullYear()%100,t,2)}function pK(e,t){return e=_k(e),Me(e.getUTCFullYear()%100,t,2)}function mK(e,t){return Me(e.getUTCFullYear()%1e4,t,4)}function yK(e,t){var n=e.getUTCDay();return e=n>=4||n===0?yf(e):yf.ceil(e),Me(e.getUTCFullYear()%1e4,t,4)}function vK(){return"+0000"}function Ek(){return"%"}function Ak(e){return+e}function $k(e){return Math.floor(+e/1e3)}var nl,Sk,Ck,Ok,Fk;bK({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function bK(e){return nl=fk(e),Sk=nl.format,Ck=nl.parse,Ok=nl.utcFormat,Fk=nl.utcParse,nl}function _f(e){const t={};return n=>t[n]||(t[n]=e(n))}function xK(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=wK(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+a}}function wK(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function kk(e){const t=_f(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=of(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return xK(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,a){a=of(a==null?",f":a);const s=EV(r,i,o),u=Math.max(Math.abs(r),Math.abs(i));let l;if(a.precision==null)switch(a.type){case"s":return isNaN(l=MV(s,u))||(a.precision=l),n(a,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=TV(s,u))||(a.precision=l-(a.type==="e"));break}case"f":case"%":{isNaN(l=DV(s))||(a.precision=l-(a.type==="%")*2);break}}return t(a)}}}let kb;Dk();function Dk(){return kb=kk({format:CF,formatPrefix:OF})}function Mk(e){return kk(SF(e))}function ag(e){return arguments.length?kb=Mk(e):kb}function Tk(e,t,n){n=n||{},se(n)||I("Invalid time multi-format specifier: ".concat(n));const r=t(Er),i=t(sr),o=t(ar),a=t(Bn),s=t(xt),u=t(Zt),l=t(In),c=t(zt),f=e(n[Vr]||".%L"),d=e(n[Er]||":%S"),h=e(n[sr]||"%I:%M"),g=e(n[ar]||"%I %p"),p=e(n[Bn]||n[Qt]||"%a %d"),m=e(n[xt]||"%b %d"),y=e(n[Zt]||"%B"),v=e(n[In]||"%B"),b=e(n[zt]||"%Y");return x=>(r(x)<x?f:i(x)<x?d:o(x)<x?h:a(x)<x?g:u(x)<x?s(x)<x?p:m:c(x)<x?l(x)<x?y:v:b)(x)}function Nk(e){const t=_f(e.format),n=_f(e.utcFormat);return{timeFormat:r=>Fe(r)?t(r):Tk(t,el,r),utcFormat:r=>Fe(r)?n(r):Tk(n,tl,r),timeParse:_f(e.parse),utcParse:_f(e.utcParse)}}let Db;Rk();function Rk(){return Db=Nk({format:Sk,parse:Ck,utcFormat:Ok,utcParse:Fk})}function jk(e){return Nk(fk(e))}function Ef(e){return arguments.length?Db=jk(e):Db}const Mb=(e,t)=>ge({},e,t);function Lk(e,t){const n=e?Mk(e):ag(),r=t?jk(t):Ef();return Mb(n,r)}function Tb(e,t){const n=arguments.length;return n&&n!==2&&I("defaultLocale expects either zero or two arguments."),n?Mb(ag(e),Ef(t)):Mb(ag(),Ef())}function _K(){return Dk(),Rk(),Tb()}const EK=/^(data:|([A-Za-z]+:)?\/\/)/,AK=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,$K=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Pk="file://";function SK(e,t){return n=>({options:n||{},sanitize:OK,load:CK,fileAccess:!!t,file:FK(t),http:DK(e)})}async function CK(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function OK(e,t){t=ge({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,a;const s=AK.test(e.replace($K,""));(e==null||typeof e!="string"||!s)&&I("Sanitize failure, invalid URI: "+ne(e));const u=EK.test(e);return(a=t.baseURL)&&!u&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),o=(i=e.startsWith(Pk))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(Pk.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function FK(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):kK}async function kK(){I("No file system access.")}function DK(e){return e?async function(t,n){const r=ge({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?me(o[i])?o[i]():o.text():I(o.status+""+o.statusText)}:MK}async function MK(){I("No HTTP fetch method available.")}const TK=e=>e!=null&&e===e,NK=e=>e==="true"||e==="false"||e===!0||e===!1,RK=e=>!Number.isNaN(Date.parse(e)),Ik=e=>!Number.isNaN(+e)&&!(e instanceof Date),jK=e=>Ik(e)&&Number.isInteger(+e),Nb={boolean:nb,integer:Kt,number:Kt,date:rb,string:ib,unknown:yn},sg=[NK,jK,Ik,RK],LK=["boolean","integer","number","date"];function Bk(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=sg.length,i=sg.map((o,a)=>a+1);for(let o=0,a=0,s,u;o<n;++o)for(u=t?e[o][t]:e[o],s=0;s<r;++s)if(i[s]&&TK(u)&&!sg[s](u)&&(i[s]=0,++a,a===sg.length))return"string";return LK[i.reduce((o,a)=>o===0?a:o,0)-1]}function zk(e,t){return t.reduce((n,r)=>(n[r]=Bk(e,r),n),{})}function Uk(e){const t=function(n,r){const i={delimiter:e};return Rb(n,r?ge(r,i):i)};return t.responseType="text",t}function Rb(e,t){return t.header&&(e=t.header.map(ne).join(t.delimiter)+`
`+e),fV(t.delimiter).parse(e+"")}Rb.responseType="text";function PK(e){return typeof Buffer=="function"&&me(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function jb(e,t){const n=t&&t.property?Ln(t.property):yn;return se(e)&&!PK(e)?IK(n(e),t):n(JSON.parse(e))}jb.responseType="json";function IK(e,t){return!Q(e)&&uF(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const BK={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function qk(e,t){let n,r,i,o;return e=jb(e,t),t&&t.feature?(n=pV,i=t.feature):t&&t.mesh?(n=yV,i=t.mesh,o=BK[t.filter]):I("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):I("Invalid TopoJSON object: "+i),r&&r.features||[r]}qk.responseType="json";const ug={dsv:Rb,csv:Uk(","),tsv:Uk("	"),json:jb,topojson:qk};function Lb(e,t){return arguments.length>1?(ug[e]=t,this):ae(ug,e)?ug[e]:null}function Hk(e){const t=Lb(e);return t&&t.responseType||"text"}function Wk(e,t,n,r){t=t||{};const i=Lb(t.type||"json");return i||I("Unknown data format type: "+t.type),e=i(e,t),t.parse&&zK(e,t.parse,n,r),ae(e,"columns")&&delete e.columns,e}function zK(e,t,n,r){if(!e.length)return;const i=Ef();n=n||i.timeParse,r=r||i.utcParse;let o=e.columns||Object.keys(e[0]),a,s,u,l,c,f;t==="auto"&&(t=zk(e,o)),o=Object.keys(t);const d=o.map(h=>{const g=t[h];let p,m;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),m=p[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(p[0]==="utc"?r:n)(m);if(!Nb[g])throw Error("Illegal format pattern: "+h+":"+g);return Nb[g]});for(u=0,c=e.length,f=o.length;u<c;++u)for(a=e[u],l=0;l<f;++l)s=o[l],a[s]=d[l](a[s])}const lg=SK(typeof fetch!="undefined"&&fetch,null);function cg(e){const t=e||yn,n=[],r={};return n.add=i=>{const o=t(i);return r[o]||(r[o]=1,n.push(i)),n},n.remove=i=>{const o=t(i);if(r[o]){r[o]=0;const a=n.indexOf(i);a>=0&&n.splice(a,1)}return n},n}async function fg(e,t){try{await t(e)}catch(n){e.error(n)}}const Gk=Symbol("vega_id");let UK=1;function dg(e){return!!(e&&ee(e))}function ee(e){return e[Gk]}function Yk(e,t){return e[Gk]=t,e}function Le(e){const t=e===Object(e)?e:{data:e};return ee(t)?t:Yk(t,UK++)}function Pb(e){return hg(e,Le({}))}function hg(e,t){for(const n in e)t[n]=e[n];return t}function Vk(e,t){return Yk(t,ee(e))}function Es(e,t){return e?t?(n,r)=>e(n,r)||ee(t(n))-ee(t(r)):(n,r)=>e(n,r)||ee(n)-ee(r):null}function Xk(e){return e&&e.constructor===As}function As(){const e=[],t=[],n=[],r=[],i=[];let o=null,a=!1;return{constructor:As,insert(s){const u=oe(s),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(s){const u=me(s)?r:t,l=oe(s),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(s,u,l){const c={field:u,value:Jt(l)};return me(s)?(c.filter=s,i.push(c)):(c.tuple=s,n.push(c)),this},encode(s,u){return me(s)?i.push({filter:s,field:u}):n.push({tuple:s,field:u}),this},clean(s){return o=s,this},reflow(){return a=!0,this},pulse(s,u){const l={},c={};let f,d,h,g,p,m;for(f=0,d=u.length;f<d;++f)l[ee(u[f])]=1;for(f=0,d=t.length;f<d;++f)p=t[f],l[ee(p)]=-1;for(f=0,d=r.length;f<d;++f)g=r[f],u.forEach(v=>{g(v)&&(l[ee(v)]=-1)});for(f=0,d=e.length;f<d;++f)p=e[f],m=ee(p),l[m]?l[m]=1:s.add.push(Le(e[f]));for(f=0,d=u.length;f<d;++f)p=u[f],l[ee(p)]<0&&s.rem.push(p);function y(v,b,x){x?v[b]=x(v):s.encode=b,a||(c[ee(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],p=h.tuple,g=h.field,m=l[ee(p)],m>0&&(y(p,g,h.value),s.modifies(g));for(f=0,d=i.length;f<d;++f)h=i[f],g=h.filter,u.forEach(v=>{g(v)&&l[ee(v)]>0&&y(v,h.field,h.value)}),s.modifies(h.field);if(a)s.mod=t.length||r.length?u.filter(v=>l[ee(v)]>0):u.slice();else for(m in c)s.mod.push(c[m]);return(o||o==null&&(t.length||r.length))&&s.clean(!0),s}}}const gg="_:mod:_";function pg(){Object.defineProperty(this,gg,{writable:!0,value:{}})}pg.prototype={set(e,t,n,r){const i=this,o=i[e],a=i[gg];return t!=null&&t>=0?(o[t]!==n||r)&&(o[t]=n,a[t+":"+e]=-1,a[e]=-1):(o!==n||r)&&(i[e]=n,a[e]=Q(n)?1+n.length:-1),i},modified(e,t){const n=this[gg];if(arguments.length){if(Q(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[gg]={},this}};let qK=0;const HK="pulse",WK=new pg,GK=1,YK=2;function Ye(e,t,n,r){this.id=++qK,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function Kk(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Ye.prototype={targets(){return this._targets||(this._targets=cg(Qc))},set(e){return this.value!==e?(this.value=e,1):0},skip:Kk(GK),modified:Kk(YK),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new pg,i=this._argops=this._argops||[],o=[];let a,s,u,l;const c=(f,d,h)=>{h instanceof Ye?(h!==this&&(t&&h.targets().add(this),o.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(a in e)if(s=e[a],a===HK)oe(s).forEach(f=>{f instanceof Ye?f!==this&&(f.targets().add(this),o.push(f)):I("Pulse parameters must be operator instances.")}),this.source=s;else if(Q(s))for(r.set(a,-1,Array(u=s.length)),l=0;l<u;++l)c(a,l,s[l]);else c(a,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||WK,n=this._argops;let r,i,o,a;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function VK(e,t,n,r){let i=1,o;return e instanceof Ye?o=e:e&&e.prototype instanceof Ye?o=new e:me(e)?o=new Ye(null,e):(i=0,o=new Ye(e,t)),this.rank(o),i&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o}function XK(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let KK=0;function mg(e,t,n){this.id=++KK,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function fa(e,t,n){return new mg(e,t,n)}mg.prototype={_filter:_r,_apply:yn,targets(){return this._targets||(this._targets=cg(Qc))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=fa(e);return this.targets().add(t),t},apply(e){const t=fa(null,e);return this.targets().add(t),t},merge(){const e=fa();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=fa();return this.targets().add(fa(null,null,Qv(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(fa(null,null,()=>n=!0)),t.targets().add(fa(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=_r,this._targets=null}};function JK(e,t,n,r){const i=this,o=fa(n,r),a=function(l){l.dataflow=i;try{o.receive(l)}catch(c){i.error(c)}finally{i.run()}};let s;typeof e=="string"&&typeof document!="undefined"?s=document.querySelectorAll(e):s=oe(e);const u=s.length;for(let l=0;l<u;++l)s[l].addEventListener(t,a);return o}function ZK(e,t){const n=this.locale();return Wk(e,t,n.timeParse,n.utcParse)}function QK(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function eJ(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:Hk(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}}async function tJ(e,t,n){const r=this,i=r._pending||nJ(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove(_r).insert(o.data||[])),i.done(),o}function nJ(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const rJ={skip:!0};function iJ(e,t,n,r,i){return(e instanceof Ye?aJ:oJ)(this,e,t,n,r,i),this}function oJ(e,t,n,r,i,o){const a=ge({},o,rJ);let s,u;me(n)||(n=Jt(n)),r===void 0?s=l=>e.touch(n(l)):me(r)?(u=new Ye(null,r,i,!1),s=l=>{u.evaluate(l);const c=n(l),f=u.value;Xk(f)?e.pulse(c,f,o):e.update(c,f,a)}):s=l=>e.update(n(l),r,a),t.apply(s)}function aJ(e,t,n,r,i,o){if(r===void 0)t.targets().add(n);else{const a=o||{},s=new Ye(null,sJ(n,r),i,!1);s.modified(a.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function sJ(e,t){return t=me(t)?t:Jt(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function uJ(e){e.rank=++this._rank}function lJ(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&I("Cycle detected in dataflow graph.")}const yg={},Si=1<<0,da=1<<1,_o=1<<2,cJ=Si|da,Jk=Si|_o,rl=Si|da|_o,Zk=1<<3,Af=1<<4,Qk=1<<5,eD=1<<6;function ha(e,t,n){this.dataflow=e,this.stamp=t==null?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Ib(e,t){const n=[];return la(e,t,r=>n.push(r)),n}function tD(e,t){const n={};return e.visit(t,r=>{n[ee(r)]=1}),r=>n[ee(r)]?null:r}function vg(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}ha.prototype={StopPropagation:yg,ADD:Si,REM:da,MOD:_o,ADD_REM:cJ,ADD_MOD:Jk,ALL:rl,REFLOW:Zk,SOURCE:Af,NO_SOURCE:Qk,NO_FIELDS:eD,fork(e){return new ha(this.dataflow).init(this,e)},clone(){const e=this.fork(rl);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(rl|Af)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new ha(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&eD)&&(n.fields=e.fields),t&Si?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&da?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&_o?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&Qk?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||rl;return t&Si&&this.add.length||t&da&&this.rem.length||t&_o&&this.mod.length},reflow(e){if(e)return this.fork(rl).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(_o,tD(this,Si))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return Q(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?Q(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Si&&(n.addF=vg(n.addF,t)),e&da&&(n.remF=vg(n.remF,t)),e&_o&&(n.modF=vg(n.modF,t)),e&Af&&(n.srcF=vg(n.srcF,t)),n},materialize(e){e=e||rl;const t=this;return e&Si&&t.addF&&(t.add=Ib(t.add,t.addF),t.addF=null),e&da&&t.remF&&(t.rem=Ib(t.rem,t.remF),t.remF=null),e&_o&&t.modF&&(t.mod=Ib(t.mod,t.modF),t.modF=null),e&Af&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&Af)return la(n.source,n.srcF,r),n;e&Si&&la(n.add,n.addF,r),e&da&&la(n.rem,n.remF,r),e&_o&&la(n.mod,n.modF,r);const i=n.source;if(e&Zk&&i){const o=n.add.length+n.mod.length;o===i.length||(o?la(i,tD(n,Jk),r):la(i,n.srcF,r))}return n}};function Bb(e,t,n,r){const i=this,o=n.length;let a=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let s=0;s<o;++s){const u=n[s];if(u.stamp===t){if(u.fields){const l=i.fields||(i.fields={});for(const c in u.fields)l[c]=1}u.changed(i.ADD)&&(a|=i.ADD),u.changed(i.REM)&&(a|=i.REM),u.changed(i.MOD)&&(a|=i.MOD)}}this.changes=a}q(Bb,ha,{fork(e){const t=new ha(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?Q(e)?e.some(r=>n[r]):n[e]:0},filter(){I("MultiPulse does not support filtering.")},materialize(){I("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});async function fJ(e,t,n){const r=this,i=[];if(r._pulse)return nD(r);if(r._pending&&await r._pending,t&&await fg(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new ha(r,o,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=cg(Qc);let a=0,s,u,l;try{for(;r._heap.size()>0;){if(s=r._heap.pop(),s.rank!==s.qrank){r._enqueue(s,!0);continue}u=s.run(r._getPulse(s,e)),u.then?u=await u:u.async&&(i.push(u.async),u=yg),u!==yg&&s._targets&&s._targets.forEach(c=>r._enqueue(c)),++a}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${a} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await fg(r,c[f].callback)}return n&&await fg(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function dJ(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function hJ(e,t,n){return this._pulse?nD(this):(this.evaluate(e,t,n),this)}function gJ(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function nD(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function pJ(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function mJ(e,t){const n=e.source,r=this._clock;return n&&Q(n)?new Bb(this,r,n.map(i=>i.pulse),t):this._input[e.id]||yJ(this._pulse,n&&n.pulse)}function yJ(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==yg&&(e.source=t.source),e)}const zb={skip:!1,force:!1};function vJ(e,t){const n=t||zb;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function bJ(e,t,n){const r=n||zb;return(e.set(t)||r.force)&&this.touch(e,r),this}function xJ(e,t,n){this.touch(e,n||zb);const r=new ha(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function wJ(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),rD(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,_J(t,0,e)):r=n,r}}}function rD(e,t,n,r){let i,o;const a=e[n];for(;n>t;){if(o=n-1>>1,i=e[o],r(a,i)<0){e[n]=i,n=o;continue}break}return e[n]=a}function _J(e,t,n){const r=t,i=e.length,o=e[t];let a=(t<<1)+1,s;for(;a<i;)s=a+1,s<i&&n(e[a],e[s])>=0&&(a=s),e[t]=e[a],t=a,a=(t<<1)+1;return e[t]=o,rD(e,r,t,n)}function il(){this.logger(Y3()),this.logLevel(Vv),this._clock=0,this._rank=0,this._locale=Tb();try{this._loader=lg()}catch(e){}this._touched=cg(Qc),this._input={},this._pulse=null,this._heap=wJ((e,t)=>e.qrank-t.qrank),this._postrun=[]}function $f(e){return function(){return this._log[e].apply(this,arguments)}}il.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:$f("error"),warn:$f("warn"),info:$f("info"),debug:$f("debug"),logLevel:$f("level"),cleanThreshold:1e4,add:VK,connect:XK,rank:uJ,rerank:lJ,pulse:xJ,touch:vJ,update:bJ,changeset:As,ingest:QK,parse:ZK,preload:tJ,request:eJ,events:JK,on:iJ,evaluate:fJ,run:hJ,runAsync:dJ,runAfter:gJ,_enqueue:pJ,_getPulse:mJ};function N(e,t){Ye.call(this,e,null,t)}q(N,Ye,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const ol={};function iD(e){const t=oD(e);return t&&t.Definition||null}function oD(e){return e=e&&e.toLowerCase(),ae(ol,e)?ol[e]:null}function Ub(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function EJ(e){return e===null?NaN:+e}function*AJ(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}function $J(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i));else{let a=-1;for(let s of e)(s=t(s,++a,e))!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i))}if(n>1)return o/(n-1)}function SJ(e,t){const n=$J(e,t);return n&&Math.sqrt(n)}function aD(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function sD(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function uD(e,t,n=0,r=e.length-1,i=Ub){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),g=Math.min(r,Math.floor(t+(u-l)*f/u+d));uD(e,t,h,g,i)}const o=e[t];let a=n,s=r;for(Sf(e,n,t),i(e[r],o)>0&&Sf(e,n,r);a<s;){for(Sf(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}i(e[n],o)===0?Sf(e,n,s):(++s,Sf(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Sf(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function qb(e,t,n){if(e=Float64Array.from(AJ(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return sD(e);if(t>=1)return aD(e);var r,i=(r-1)*t,o=Math.floor(i),a=aD(uD(e,o).subarray(0,o+1)),s=sD(e.subarray(o+1));return a+(s-a)*(i-o)}}function CJ(e,t,n=EJ){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(i-o)}}function OJ(e,t){return qb(e,.5,t)}function*lD(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function Hb(e,t,n){const r=Float64Array.from(lD(e,n));return r.sort(Ub),t.map(i=>CJ(r,i))}function Wb(e,t){return Hb(e,[.25,.5,.75],t)}function Gb(e,t){const n=e.length,r=SJ(e,t),i=Wb(e,t),o=(i[2]-i[0])/1.34,a=Math.min(r,o)||r||Math.abs(i[0])||1;return 1.06*a*Math.pow(n,-.2)}function cD(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o=e.extent[0],a=e.extent[1],s,u,l,c,f,d;const h=e.span||a-o||Math.abs(o)||1;if(e.step)s=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);s=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,s=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/s)>t;)s*=n;for(f=0,d=i.length;f<d;++f)c=s/i[f],c>=l&&h/c<=t&&(s=c)}c=Math.log(s);const g=c>=0?0:~~(-c/r)+1,p=Math.pow(n,-g-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/s+p)*s,o=o<c?c-s:c,a=Math.ceil(a/s)*s),{start:o,stop:a===o?o+s:a,step:s}}var Ar=Math.random;function FJ(e){Ar=e}function fD(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(lD(e,r)),o=i.length,a=t;let s,u,l,c;for(l=0,c=Array(a);l<a;++l){for(s=0,u=0;u<o;++u)s+=i[~~(Ar()*o)];c[l]=s/o}return c.sort(Ub),[qb(c,n/2),qb(c,1-n/2)]}function dD(e,t,n,r){r=r||(d=>d);const i=e.length,o=new Float64Array(i);let a=0,s=1,u=r(e[0]),l=u,c=u+t,f;for(;s<i;++s){if(f=r(e[s]),f>=c){for(l=(u+l)/2;a<s;++a)o[a]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;a<s;++a)o[a]=l;return n?kJ(o,t+t/4):o}function kJ(e,t){const n=e.length;let r=0,i=1,o,a;for(;e[r]===e[i];)++i;for(;i<n;){for(o=i+1;e[i]===e[o];)++o;if(e[i]-e[i-1]<t){for(a=i+(r+o-i-i>>1);a<i;)e[a++]=e[i];for(;a>i;)e[a--]=e[r]}r=i,i=o}return e}function DJ(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function MJ(e,t){t==null&&(t=e,e=0);let n,r,i;const o={min(a){return arguments.length?(n=a||0,i=r-n,o):n},max(a){return arguments.length?(r=a||0,i=r-n,o):r},sample(){return n+Math.floor(i*Ar())},pdf(a){return a===Math.floor(a)&&a>=n&&a<r?1/i:0},cdf(a){const s=Math.floor(a);return s<n?0:s>=r?1:(s-n+1)/i},icdf(a){return a>=0&&a<=1?n-1+Math.floor(a*i):NaN}};return o.min(e).max(t)}const hD=Math.sqrt(2*Math.PI),TJ=Math.SQRT2;let Cf=NaN;function bg(e,t){e=e||0,t=t==null?1:t;let n=0,r=0,i,o;if(Cf===Cf)n=Cf,Cf=NaN;else{do n=Ar()*2-1,r=Ar()*2-1,i=n*n+r*r;while(i===0||i>1);o=Math.sqrt(-2*Math.log(i)/i),n*=o,Cf=r*o}return e+n*t}function Yb(e,t,n){n=n==null?1:n;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*hD)}function xg(e,t,n){t=t||0,n=n==null?1:n;const r=(e-t)/n,i=Math.abs(r);let o;if(i>37)o=0;else{const a=Math.exp(-i*i/2);let s;i<7.07106781186547?(s=.0352624965998911*i+.700383064443688,s=s*i+6.37396220353165,s=s*i+33.912866078383,s=s*i+112.079291497871,s=s*i+221.213596169931,s=s*i+220.206867912376,o=a*s,s=.0883883476483184*i+1.75566716318264,s=s*i+16.064177579207,s=s*i+86.7807322029461,s=s*i+296.564248779674,s=s*i+637.333633378831,s=s*i+793.826512519948,s=s*i+440.413735824752,o=o/s):(s=i+.65,s=i+4/s,s=i+3/s,s=i+2/s,s=i+1/s,o=a/s/2.506628274631)}return r>0?1-o:o}function wg(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*TJ*NJ(2*e-1)}function NJ(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function Vb(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o==null?1:o,i):r},sample:()=>bg(n,r),pdf:o=>Yb(o,n,r),cdf:o=>xg(o,n,r),icdf:o=>wg(o,n,r)};return i.mean(e).stdev(t)}function Xb(e,t){const n=Vb();let r=0;const i={data(o){return arguments.length?(e=o,r=o?o.length:0,i.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=Gb(e)),i):t},sample(){return e[~~(Ar()*r)]+t*n.sample()},pdf(o){let a=0,s=0;for(;s<r;++s)a+=n.pdf((o-e[s])/t);return a/t/r},cdf(o){let a=0,s=0;for(;s<r;++s)a+=n.cdf((o-e[s])/t);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function Kb(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+bg()*t)}function Jb(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*hD*e)}function Zb(e,t,n){return xg(Math.log(e),t,n)}function Qb(e,t,n){return Math.exp(wg(e,t,n))}function gD(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o==null?1:o,i):r},sample:()=>Kb(n,r),pdf:o=>Jb(o,n,r),cdf:o=>Zb(o,n,r),icdf:o=>Qb(o,n,r)};return i.mean(e).stdev(t)}function pD(e,t){let n=0,r;function i(a){const s=[];let u=0,l;for(l=0;l<n;++l)u+=s[l]=a[l]==null?1:+a[l];for(l=0;l<n;++l)s[l]/=u;return s}const o={weights(a){return arguments.length?(r=i(t=a||[]),o):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),o.weights(t)):e},sample(){const a=Ar();let s=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(a<u){s=e[l];break}return s.sample()},pdf(a){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].pdf(a);return s},cdf(a){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].cdf(a);return s},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function ex(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*Ar()}function tx(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function nx(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function rx(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function mD(e,t){let n,r;const i={min(o){return arguments.length?(n=o||0,i):n},max(o){return arguments.length?(r=o==null?1:o,i):r},sample:()=>ex(n,r),pdf:o=>tx(o,n,r),cdf:o=>nx(o,n,r),icdf:o=>rx(o,n,r)};return t==null&&(t=e==null?1:e,e=0),i.min(e).max(t)}function Of(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function _g(e,t,n,r){e=e.filter(h=>{let g=t(h),p=n(h);return g!=null&&(g=+g)>=g&&p!=null&&(p=+p)>=p}),r&&e.sort((h,g)=>t(h)-t(g));const i=e.length,o=new Float64Array(i),a=new Float64Array(i);let s=0,u=0,l=0,c,f,d;for(d of e)o[s]=c=+t(d),a[s]=f=+n(d),++s,u+=(c-u)/s,l+=(f-l)/s;for(s=0;s<i;++s)o[s]-=u,a[s]-=l;return[o,a,u,l]}function Ff(e,t,n,r){let i=-1,o,a;for(const s of e)o=t(s),a=n(s),o!=null&&(o=+o)>=o&&a!=null&&(a=+a)>=a&&r(o,a,++i)}function al(e,t,n,r,i){let o=0,a=0;return Ff(e,t,n,(s,u)=>{const l=u-i(s),c=u-r;o+=l*l,a+=c*c}),1-o/a}function ix(e,t,n){let r=0,i=0,o=0,a=0,s=0;Ff(e,t,n,(c,f)=>{++s,r+=(c-r)/s,i+=(f-i)/s,o+=(c*f-o)/s,a+=(c*c-a)/s});const u=Of(r,i,o,a),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:al(e,t,n,i,l)}}function yD(e,t,n){let r=0,i=0,o=0,a=0,s=0;Ff(e,t,n,(c,f)=>{++s,c=Math.log(c),r+=(c-r)/s,i+=(f-i)/s,o+=(c*f-o)/s,a+=(c*c-a)/s});const u=Of(r,i,o,a),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:al(e,t,n,i,l)}}function vD(e,t,n){const[r,i,o,a]=_g(e,t,n);let s=0,u=0,l=0,c=0,f=0,d,h,g;Ff(e,t,n,(v,b)=>{d=r[f++],h=Math.log(b),g=d*b,s+=(b*h-s)/f,u+=(g-u)/f,l+=(g*h-l)/f,c+=(d*g-c)/f});const[p,m]=Of(u/a,s/a,l/a,c/a),y=v=>Math.exp(p+m*(v-o));return{coef:[Math.exp(p-m*o),m],predict:y,rSquared:al(e,t,n,a,y)}}function bD(e,t,n){let r=0,i=0,o=0,a=0,s=0,u=0;Ff(e,t,n,(f,d)=>{const h=Math.log(f),g=Math.log(d);++u,r+=(h-r)/u,i+=(g-i)/u,o+=(h*g-o)/u,a+=(h*h-a)/u,s+=(d-s)/u});const l=Of(r,i,o,a),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:al(e,t,n,s,c)}}function ox(e,t,n){const[r,i,o,a]=_g(e,t,n),s=r.length;let u=0,l=0,c=0,f=0,d=0,h,g,p,m;for(h=0;h<s;)g=r[h],p=i[h++],m=g*g,u+=(m-u)/h,l+=(m*g-l)/h,c+=(m*m-c)/h,f+=(g*p-f)/h,d+=(m*p-d)/h;const y=c-u*u,v=u*y-l*l,b=(d*u-f*l)/v,x=(f*y-d*l)/v,w=-b*u,E=_=>(_=_-o,b*_*_+x*_+w+a);return{coef:[w-x*o+b*o*o+a,x-2*b*o,b],predict:E,rSquared:al(e,t,n,a,E)}}function xD(e,t,n,r){if(r===1)return ix(e,t,n);if(r===2)return ox(e,t,n);const[i,o,a,s]=_g(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,g,p,m;for(d=0;d<f;++d){for(g=0,p=0;g<u;++g)p+=Math.pow(i[g],d)*o[g];for(l.push(p),m=new Float64Array(f),h=0;h<f;++h){for(g=0,p=0;g<u;++g)p+=Math.pow(i[g],d+h);m[h]=p}c.push(m)}c.push(l);const y=jJ(c),v=b=>{b-=a;let x=s+y[0]+y[1]*b+y[2]*b*b;for(d=3;d<f;++d)x+=y[d]*Math.pow(b,d);return x};return{coef:RJ(f,y,-a,s),predict:v,rSquared:al(e,t,n,s,v)}}function RJ(e,t,n,r){const i=Array(e);let o,a,s,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],u=1,i[o]+=s,a=1;a<=o;++a)u*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*u;return i[0]+=r,i}function jJ(e){const t=e.length-1,n=[];let r,i,o,a,s;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(o=r;o<t+1;++o)s=e[o][r],e[o][r]=e[o][a],e[o][a]=s;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,o=i+1;o<t;++o)s+=e[o][i]*n[o];n[i]=(e[t][i]-s)/e[i][i]}return n}const wD=2,_D=1e-12;function ED(e,t,n,r){const[i,o,a,s]=_g(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=wD;){const g=[0,l-1];for(let m=0;m<u;++m){const y=i[m],v=g[0],b=g[1],x=y-i[v]>i[b]-y?v:b;let w=0,E=0,_=0,$=0,C=0;const O=1/Math.abs(i[x]-y||1);for(let F=v;F<=b;++F){const T=i[F],S=o[F],M=LJ(Math.abs(y-T)*O)*d[F],P=T*M;w+=M,E+=P,_+=S*M,$+=S*P,C+=T*P}const[A,D]=Of(E/w,_/w,$/w,C/w);c[m]=A+D*y,f[m]=Math.abs(o[m]-c[m]),PJ(i,m+1,g)}if(h===wD)break;const p=OJ(f);if(Math.abs(p)<_D)break;for(let m=0,y,v;m<u;++m)y=f[m]/(6*p),d[m]=y>=1?_D:(v=1-y*y)*v}return IJ(i,c,a,s)}function LJ(e){return(e=1-e*e*e)*e*e}function PJ(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}function IJ(e,t,n,r){const i=e.length,o=[];let a=0,s=0,u=[],l;for(;a<i;++a)l=e[a]+n,u[0]===l?u[1]+=(t[a]-u[1])/++s:(s=0,u[1]+=r,u=[l,t[a]],o.push(u));return u[1]+=r,o}const BJ=.5*Math.PI/180;function Eg(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=p=>[p,e(p)],o=t[0],a=t[1],s=a-o,u=s/r,l=[i(o)],c=[];if(n===r){for(let p=1;p<r;++p)l.push(i(o+p/n*s));return l.push(i(a)),l}else{c.push(i(a));for(let p=n;--p>0;)c.push(i(o+p/n*s))}let f=l[0],d=c[c.length-1];const h=1/s,g=zJ(f[1],c);for(;d;){const p=i((f[0]+d[0])/2);p[0]-f[0]>=u&&UJ(f,p,d,h,g)>BJ?c.push(p):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function zJ(e,t){let n=e,r=e;const i=t.length;for(let o=0;o<i;++o){const a=t[o][1];a<n&&(n=a),a>r&&(r=a)}return 1/(r-n)}function UJ(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-a)}function AD(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function qJ(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=HJ(e));function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=r(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:r,center:o,right:i}}function HJ(e){return(t,n)=>AD(e(t),n)}function*WJ(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}function ax(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function sx(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function $D(e,t,n=0,r=e.length-1,i=AD){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),g=Math.min(r,Math.floor(t+(u-l)*f/u+d));$D(e,t,h,g,i)}const o=e[t];let a=n,s=r;for(kf(e,n,t),i(e[r],o)>0&&kf(e,n,r);a<s;){for(kf(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}i(e[n],o)===0?kf(e,n,s):(++s,kf(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function kf(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function GJ(e,t,n){if(e=Float64Array.from(WJ(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return sx(e);if(t>=1)return ax(e);var r,i=(r-1)*t,o=Math.floor(i),a=ax($D(e,o).subarray(0,o+1)),s=sx(e.subarray(o+1));return a+(s-a)*(i-o)}}function YJ(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function VJ(e,t){return GJ(e,.5,t)}function SD(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function XJ(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function ux(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:XJ(e)}function CD(e,t,n){return n||e+(t?"_"+t:"")}const lx=()=>{},KJ={init:lx,add:lx,rem:lx,idx:0},Df={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Mf=Object.keys(Df);function JJ(e,t){return n=>ge({name:e,out:n||e},KJ,t)}Mf.forEach(e=>{Df[e]=JJ(e,Df[e])});function OD(e,t){return Df[e](t)}function FD(e,t){return e.idx-t.idx}function ZJ(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{!r.req||r.req.forEach(i=>{t[i]||n(t[i]=Df[i]())})};return e.forEach(n),Object.values(t).sort(FD)}function QJ(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function eZ(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function tZ(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function nZ(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function kD(e,t){const n=t||yn,r=ZJ(e),i=e.slice().sort(FD);function o(a){this._ops=r,this._out=i,this.cell=a,this.init()}return o.prototype.init=QJ,o.prototype.add=eZ,o.prototype.rem=tZ,o.prototype.set=nZ,o.prototype.get=n,o.fields=e.map(a=>a.out),o}function cx(e){this._key=e?Ln(e):ee,this.reset()}const Ut=cx.prototype;Ut.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Ut.add=function(e){this._add.push(e)};Ut.rem=function(e){this._rem.push(e)};Ut.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),a={};let s,u,l;for(s=0;s<i;++s)a[n(t[s])]=1;for(s=0,u=0;s<r;++s)a[n(l=e[s])]?a[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o};Ut.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,o;for(;--r>=0;)o=e(t[r])+"",ae(n,o)||(n[o]=1,++i);return i};Ut.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=aF(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Ut.argmin=function(e){return this.extent(e)[0]||{}};Ut.argmax=function(e){return this.extent(e)[1]||{}};Ut.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Ut.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Ut.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Wb(this.values(),e),this._get=e),this._q};Ut.q1=function(e){return this.quartile(e)[0]};Ut.q2=function(e){return this.quartile(e)[1]};Ut.q3=function(e){return this.quartile(e)[2]};Ut.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=fD(this.values(),1e3,.05,e),this._get=e),this._ci};Ut.ci0=function(e){return this.ci(e)[0]};Ut.ci1=function(e){return this.ci(e)[1]};function ga(e){N.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}ga.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Mf},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};q(ga,N,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function o(s){let u,l,c,f;for(u in s)for(c=s[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}o(e._prev),o(t);function a(s,u,l){const c=n[l],f=r[l++];for(const d in f){const h=s?s+"|"+d:d;u[c]=f[d],l<i?a(h,u,l):t[h]||e.cell(h,u)}}a("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const y=oe(Xt(m)),v=y.length;let b=0,x;for(;b<v;++b)r[x=y[b]]||(r[x]=1,t.push(x))}this._dims=oe(e.groupby),this._dnames=this._dims.map(m=>{const y=ut(m);return i(m),n.push(y),y}),this.cellkey=e.key?e.key:ux(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],a=e.ops||["count"],s=e.as||[],u=o.length,l={};let c,f,d,h,g,p;for(u!==a.length&&I("Unmatched number of fields and aggregate ops."),p=0;p<u;++p){if(c=o[p],f=a[p],c==null&&f!=="count"&&I("Null aggregate field specified."),h=ut(c),g=CD(f,h,s[p]),n.push(g),f==="count"){this._counts.push(g);continue}d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(OD(f,g))}return this._measures=this._measures.map(m=>kD(m,m.field)),{}},cellkey:ux(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let o=0;o<i;++o)n.agg[o]=new r[o](n)}return n.store&&(n.data=new cx),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let a=0;a<i;++a)o[n[a]]=r[a](e);return t?Vk(t.tuple,o):Le(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,o=r.length;i<o;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,a=e.rem,s=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&a.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?a:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const rZ=1e-14;function fx(e){N.call(this,null,e)}fx.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};q(fx,N,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,o=r.step,a=e.as||["bin0","bin1"],s=a[0],u=a[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(Xt(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[s]=f,c[u]=f==null?null:i+o*(1+(f-i)/o)}:c=>c[s]=r(c)),t.modifies(n?a:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=cD(e),r=n.step;let i=n.start,o=i+Math.ceil((n.stop-i)/r)*r,a,s;(a=e.anchor)!=null&&(s=a-(i+r*Math.floor((a-i)/r)),i+=s,o+=s);const u=function(l){let c=Kt(t(l));return c==null?null:c<i?-1/0:c>o?1/0:(c=Math.max(i,Math.min(c,o-r)),i+r*Math.floor(rZ+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=jn(u,Xt(t),e.name||"bin_"+ut(t))}});function DD(e,t,n){const r=e;let i=t||[],o=n||[],a={},s=0;return{add:u=>o.push(u),remove:u=>a[r(u)]=++s,size:()=>i.length,data:(u,l)=>(s&&(i=i.filter(c=>!a[r(c)]),a={},s=0),l&&u&&i.sort(u),o.length&&(i=u?dF(u,i,o.sort(u)):i.concat(o),o=[]),i)}}function dx(e){N.call(this,[],e)}dx.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};q(dx,N,{transform(e,t){const n=t.fork(t.ALL),r=DD(ee,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(Es(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function MD(e){Ye.call(this,null,iZ,e)}q(MD,Ye);function iZ(e){return this.value&&!e.modified()?this.value:Zv(e.fields,e.orders)}function hx(e){N.call(this,null,e)}hx.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function oZ(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}q(hx,N,{transform(e,t){const n=f=>d=>{for(var h=oZ(s(d),e.case,o)||[],g,p=0,m=h.length;p<m;++p)a.test(g=h[p])||f(g)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,a=this._stop,s=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=r[s],l=n[s]||0,!u&&l?(r[s]=u=Le({}),u[i]=s,u[o]=l,a.add.push(u)):l===0?(u&&a.rem.push(u),n[s]=null,r[s]=null):u[o]!==l&&(u[o]=l,a.mod.push(u));return a.modifies(t)}});function gx(e){N.call(this,null,e)}gx.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};q(gx,N,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=aZ(s,i,o,e.filter||_r)):n.mod=s,n.source=this.value,n.modifies(r)}});function aZ(e,t,n,r){for(var i=[],o={},a=e.length,s=0,u,l;s<a;++s)for(o[t]=l=e[s],u=0;u<a;++u)o[n]=e[u],r(o)&&(i.push(Le(o)),o={},o[t]=l);return i}const TD={kde:Xb,mixture:pD,normal:Vb,lognormal:gD,uniform:mD},sZ="distributions",ND="function",uZ="field";function RD(e,t){const n=e[ND];ae(TD,n)||I("Unknown distribution function: "+n);const r=TD[n]();for(const i in e)i===uZ?r.data((e.from||t()).map(e[i])):i===sZ?r[i](e[i].map(o=>RD(o,t))):typeof r[i]===ND&&r[i](e[i]);return r}function px(e){N.call(this,null,e)}const jD=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],lZ={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:jD},{name:"weights",type:"number",array:!0}]};px.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:jD.concat(lZ)},{name:"as",type:"string",array:!0,default:["value","density"]}]};q(px,N,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=RD(e.distribution,cZ(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let a=e.method||"pdf";a!=="pdf"&&a!=="cdf"&&I("Invalid density method: "+a),!e.extent&&!r.data&&I("Missing density extent parameter."),a=r[a];const s=e.as||["value","density"],u=e.extent||Ai(r.data()),l=Eg(a,u,i,o).map(c=>{const f={};return f[s[0]]=c[0],f[s[1]]=c[1],Le(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function cZ(e){return()=>e.materialize(e.SOURCE).source}function LD(e,t){return e?e.map((n,r)=>t[r]||ut(n)):null}function mx(e,t,n){const r=[],i=f=>f(u);let o,a,s,u,l,c;if(t==null)r.push(e.map(n));else for(o={},a=0,s=e.length;a<s;++a)u=e[a],l=t.map(i),c=o[l],c||(o[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const PD="bin";function yx(e){N.call(this,null,e)}yx.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:PD}]};const fZ=(e,t)=>nf(Ai(e,t))/30;q(yx,N,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=mx(t.source,e.groupby,yn),i=e.smooth||!1,o=e.field,a=e.step||fZ(n,o),s=Es((g,p)=>o(g)-o(p)),u=e.as||PD,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const g=r[d].sort(s);h=-1;for(const p of dD(g,a,i,o))p<c&&(c=p),p>f&&(f=p),g[++h][u]=p}return this.value={start:c,stop:f,step:a},t.reflow(!0).modifies(u)}});function ID(e){Ye.call(this,null,dZ,e),this.modified(!0)}q(ID,Ye);function dZ(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:jn(n=>t(n,e),Xt(t),ut(t))}function vx(e){N.call(this,[void 0,void 0],e)}vx.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};q(vx,N,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],a=n[1];if((i||o==null)&&(o=1/0,a=-1/0),t.visit(i?t.SOURCE:t.ADD,s=>{const u=Kt(r(s));u!=null&&(u<o&&(o=u),u>a&&(a=u))}),!Number.isFinite(o)||!Number.isFinite(a)){let s=ut(r);s&&(s=` for field "${s}"`),t.dataflow.warn(`Infinite extent${s}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]}});function bx(e,t){Ye.call(this,e),this.parent=t,this.count=0}q(bx,Ye,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function Ag(e){N.call(this,{},e),this._keys=Ku();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}q(Ag,N,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let o=ae(i,e)&&i[e],a,s;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(s=r||(s=this._group[e])&&s.tuple,a=n.dataflow,o=new bx(n.fork(n.NO_SOURCE),this),a.add(o).connect(t(a,e,s)),i[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,a=e.modified("key"),s=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=ee(u),c=o.get(l);c!==void 0&&(o.delete(l),s(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);o.set(ee(u),l),s(l).add(u)}),a||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=ee(u),c=o.get(l),f=r(u);c===f?s(f).mod(u):(o.set(l,f),s(c).rem(u),s(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{s(o.get(ee(u))).mod(u)}),a&&t.visit(t.REFLOW,u=>{const l=ee(u),c=o.get(l),f=r(u);c!==f&&(o.set(l,f),s(c).rem(u),s(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function BD(e){Ye.call(this,null,hZ,e)}q(BD,Ye);function hZ(e){return this.value&&!e.modified()?this.value:Q(e.name)?oe(e.name).map(t=>Ln(t)):Ln(e.name,e.as)}function xx(e){N.call(this,Ku(),e)}xx.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};q(xx,N,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,a=i.rem,s=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=ee(f);r.has(d)?r.delete(d):a.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):r.set(ee(f),1)});function c(f){const d=ee(f),h=u(f,e),g=r.get(d);h&&g?(r.delete(d),o.push(f)):!h&&!g?(r.set(d,1),a.push(f)):l&&h&&!g&&s.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function wx(e){N.call(this,[],e)}wx.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};q(wx,N,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=LD(r,e.as||[]),o=e.index||null,a=i.length;return n.rem=this.value,t.visit(t.SOURCE,s=>{const u=r.map(g=>g(s)),l=u.reduce((g,p)=>Math.max(g,p.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Pb(s),f=0;f<a;++f)d[i[f]]=(h=u[f][c])==null?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}});function _x(e){N.call(this,[],e)}_x.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};q(_x,N,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(ut),o=e.as||["key","value"],a=o[0],s=o[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Pb(l),f[a]=i[c],f[s]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function Ex(e){N.call(this,null,e)}Ex.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};q(Ex,N,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,a=>a[r]=n(a,e))}});function zD(e){N.call(this,[],e)}q(zD,N,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,o=e.size-i.length,a,s,u;if(o>0){for(a=[];--o>=0;)a.push(u=Le(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a}else s=i.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,i=i.slice(-o);return n.source=this.value=i,n}});const $g={value:"value",median:VJ,mean:YJ,min:sx,max:ax},gZ=[];function Ax(e){N.call(this,[],e)}Ax.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function pZ(e){var t=e.method||$g.value,n;if($g[t]==null)I("Unrecognized imputation method: "+t);else return t===$g.value?(n=e.value!==void 0?e.value:0,()=>n):$g[t]}function mZ(e){const t=e.field;return n=>n?t(n):NaN}q(Ax,N,{transform(e,t){var n=t.fork(t.ALL),r=pZ(e),i=mZ(e),o=ut(e.field),a=ut(e.key),s=(e.groupby||[]).map(ut),u=yZ(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,g,p,m,y,v,b,x,w;for(m=0,b=u.length;m<b;++m)for(d=u[m],g=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(p=u.domain[v],w={_impute:!0},y=0,x=g.length;y<x;++y)w[s[y]]=g[y];w[a]=p,w[o]=Number.isNaN(h)?h=r(d,i):h,l.push(Le(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function yZ(e,t,n,r){var i=y=>y(m),o=[],a=r?r.slice():[],s={},u={},l,c,f,d,h,g,p,m;for(a.forEach((y,v)=>s[y]=v+1),d=0,p=e.length;d<p;++d)m=e[d],g=n(m),h=s[g]||(s[g]=a.push(g)),c=(l=t?t.map(i):gZ)+"",(f=u[c])||(f=u[c]=[],o.push(f),f.values=l),f[h-1]=m;return o.domain=a,o}function $x(e){ga.call(this,e)}$x.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Mf},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};q($x,ga,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(i=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{ge(o,i[n.cellkey(o)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function Sx(e){N.call(this,null,e)}Sx.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};q(Sx,N,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=mx(r,e.groupby,e.field),o=(e.groupby||[]).map(ut),a=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;s!=="pdf"&&s!=="cdf"&&I("Invalid density method: "+s),e.resolve==="shared"&&(c||(c=Ai(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const g=Xb(h,a)[s],p=e.counts?h.length:1,m=c||Ai(h);Eg(g,m,f,d).forEach(y=>{const v={};for(let b=0;b<o.length;++b)v[o[b]]=h.dims[b];v[u[0]]=y[0],v[u[1]]=y[1]*p,l.push(Le(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function UD(e){Ye.call(this,null,vZ,e)}q(UD,Ye);function vZ(e){return this.value&&!e.modified()?this.value:tb(e.fields,e.flat)}function qD(e){N.call(this,[],e),this._pending=null}q(qD,N,{transform(e,t){const n=t.dataflow;return this._pending?Cx(this,t,this._pending):bZ(e)?t.StopPropagation:e.values?Cx(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=oe(i.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(r=>Cx(this,t,oe(r.data)))}});function bZ(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Cx(e,t,n){n.forEach(Le);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function Ox(e){N.call(this,{},e)}Ox.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};q(Ox,N,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=e.default==null?null:e.default,a=e.modified(),s=n.length;let u=a?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,s>1&&!c&&I('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==s*d&&I('The "as" parameter has too few output field names.'),c=c||i.map(ut),f=function(g){for(var p=0,m=0,y,v;p<s;++p)if(v=r.get(n[p](g)),v==null)for(y=0;y<d;++y,++m)g[c[m]]=o;else for(y=0;y<d;++y,++m)g[c[m]]=i[y](v)}):(c||I("Missing output field names."),f=function(g){for(var p=0,m;p<s;++p)m=r.get(n[p](g)),g[c[p]]=m==null?o:m}),a?l=t.reflow(!0):(h=n.some(g=>t.modified(g.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function HD(e){Ye.call(this,null,xZ,e)}q(HD,Ye);function xZ(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,o,a;for(o=0;o<n;++o)a=t[o],a[0]<r&&(r=a[0]),a[1]>i&&(i=a[1]);return[r,i]}function WD(e){Ye.call(this,null,wZ,e)}q(WD,Ye);function wZ(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function GD(e){N.call(this,null,e)}q(GD,N,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Fx(e){ga.call(this,e)}Fx.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Mf,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};q(Fx,ga,{_transform:ga.prototype.transform,transform(e,t){return this._transform(_Z(e,t),t)}});function _Z(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",o=Xt(n).concat(Xt(r)),a=AZ(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map(()=>i),fields:a.map(s=>EZ(s,n,r,o)),as:a.map(s=>s+""),modified:e.modified.bind(e)}}function EZ(e,t,n,r){return jn(i=>t(i)===e?n(i):NaN,r,e+"")}function AZ(e,t,n){const r={},i=[];return n.visit(n.SOURCE,o=>{const a=e(o);r[a]||(r[a]=1,i.push(a))}),i.sort(Q0),t?i.slice(0,t):i}function YD(e){Ag.call(this,e)}q(YD,Ag,{transform(e,t){const n=e.subflow,r=e.field,i=o=>this.subflow(ee(o),n,t,o);return(e.modified("field")||r&&t.modified(Xt(r)))&&I("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,o=>{const a=i(o);r(o).forEach(s=>a.mod(s))}),t.visit(t.ADD,o=>{const a=i(o);r(o).forEach(s=>a.add(Le(s)))}),t.visit(t.REM,o=>{const a=i(o);r(o).forEach(s=>a.rem(s))})):(t.visit(t.MOD,o=>i(o).mod(o)),t.visit(t.ADD,o=>i(o).add(o)),t.visit(t.REM,o=>i(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function kx(e){N.call(this,null,e)}kx.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};q(kx,N,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=LD(e.fields,e.as||[]),o=r?(s,u)=>$Z(s,u,r,i):hg;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,s=>{const u=ee(s);n.rem.push(a[u]),a[u]=null}),t.visit(t.ADD,s=>{const u=o(s,Le({}));a[ee(s)]=u,n.add.push(u)}),t.visit(t.MOD,s=>{n.mod.push(o(s,a[ee(s)]))}),n}});function $Z(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}function VD(e){N.call(this,null,e)}q(VD,N,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Dx(e){N.call(this,null,e)}Dx.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const SZ=1e-14;q(Dx,N,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,o=mx(i,e.groupby,e.field),a=(e.groupby||[]).map(ut),s=[],u=e.step||.01,l=e.probs||SD(u/2,1-SZ,u),c=l.length;return o.forEach(f=>{const d=Hb(f,l);for(let h=0;h<c;++h){const g={};for(let p=0;p<a.length;++p)g[a[p]]=f.dims[p];g[r[0]]=l[h],g[r[1]]=d[h],s.push(Le(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}});function XD(e){N.call(this,null,e)}q(XD,N,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const o=ee(i);n.rem.push(r[o]),r[o]=null}),t.visit(t.ADD,i=>{const o=Pb(i);r[ee(i)]=o,n.add.push(o)}),t.visit(t.MOD,i=>{const o=r[ee(i)];for(const a in i)o[a]=i[a],n.modifies(a);n.mod.push(o)})),n}});function Mx(e){N.call(this,[],e),this.count=0}Mx.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};q(Mx,N,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce((c,f)=>(c[ee(f)]=1,c),{});let a=this.value,s=this.count,u=0;function l(c){let f,d;a.length<i?a.push(c):(d=~~((s+1)*Ar()),d<a.length&&d>=u&&(f=a[d],o[ee(f)]&&n.rem.push(f),a[d]=c)),++s}if(t.rem.length&&(t.visit(t.REM,c=>{const f=ee(c);o[f]&&(o[f]=-1,n.rem.push(c)),--s}),a=a.filter(c=>o[ee(c)]!==-1)),(t.rem.length||r)&&a.length<i&&t.source&&(u=s=a.length,t.visit(t.SOURCE,c=>{o[ee(c)]||l(c)}),u=-1),r&&a.length>i){const c=a.length-i;for(let f=0;f<c;++f)o[ee(a[f])]=-1,n.rem.push(a[f]);a=a.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[ee(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=a.filter(c=>!o[ee(c)])),this.count=s,this.value=n.source=a,n}});function Tx(e){N.call(this,null,e)}Tx.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};q(Tx,N,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=SD(e.start,e.stop,e.step||1).map(i=>{const o={};return o[r]=i,Le(o)}),n.add=t.add.concat(this.value),n}});function KD(e){N.call(this,null,e),this.modified(!0)}q(KD,N,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Nx(e){N.call(this,null,e)}const JD=["unit0","unit1"];Nx.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:hb,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:JD}]};q(Nx,N,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",o=this._floor(e,t),a=(i?tl:el)(o.unit).offset,s=e.as||JD,u=s[0],l=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(Xt(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,g=>{const p=n(g);let m,y;p==null?(g[u]=null,r&&(g[l]=null)):(g[u]=m=y=o(p),r&&(g[l]=y=a(m,c)),m<f&&(f=m),y>d&&(d=y))}),o.start=f,o.stop=d,t.modifies(r?s:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:ok({extent:e.extent||Ai(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=pb(r),a=this.value||{},s=(n?VF:YF)(o,i);return s.unit=_e(o),s.units=o,s.step=i,s.start=a.start,s.stop=a.stop,this.value=s}});function ZD(e){N.call(this,Ku(),e)}q(ZD,N,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=s=>i.set(r(s),s);let a=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,s=>i.delete(r(s))),t.visit(t.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function QD(e){N.call(this,null,e)}q(QD,N,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Es(e.sort)):t.source).map(e.field))}});function CZ(e,t,n,r){const i=Tf[e](t,n);return{init:i.init||oa,update:function(o,a){a[r]=i.next(o)}}}const Tf={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=Tf.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||I("ntile num must be greater than zero.");const n=Tf.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||I("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=OZ(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function OZ(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const FZ=Object.keys(Tf);function eM(e){const t=oe(e.ops),n=oe(e.fields),r=oe(e.params),i=oe(e.as),o=this.outputs=[],a=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(h){oe(Xt(h)).forEach(g=>s[g]=1)}d(e.sort),t.forEach((h,g)=>{const p=n[g],m=ut(p),y=CD(h,m,i[g]);if(d(p),o.push(y),ae(Tf,h))a.push(CZ(h,n[g],r[g],y));else{if(p==null&&h!=="count"&&I("Null aggregate field specified."),h==="count"){l.push(y);return}f=!1;let v=u[m];v||(v=u[m]=[],v.field=p,c.push(v)),v.push(OD(h,y))}}),(l.length||c.length)&&(this.cell=kZ(c,l,f)),this.inputs=Object.keys(s)}const tM=eM.prototype;tM.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};tM.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(i[a]);for(a=e.p1;a<e.i1;++a)n.add(i[a]);n.set(t)}for(a=0;a<o;++a)r[a].update(e,t)};function kZ(e,t,n){e=e.map(u=>kD(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new e[a](r);if(r.store)var s=r.data=new cx;return r.add=function(u){if(r.num+=1,!n){s&&s.add(u);for(let l=0;l<i;++l)o[l].add(o[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){s&&s.rem(u);for(let l=0;l<i;++l)o[l].rem(o[l].get(u),u)}},r.set=function(u){let l,c;for(s&&s.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},r.init=function(){r.num=0,s&&s.reset();for(let u=0;u<i;++u)o[u].init()},r}function Rx(e){N.call(this,{},e),this._mlen=0,this._mods=[]}Rx.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:FZ.concat(Mf)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};q(Rx,N,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=Es(e.sort),i=ux(e.groupby),o=s=>this.group(i(s));let a=this.state;(!a||n)&&(a=this.state=new eM(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,s=>o(s).add(s))):(t.visit(t.REM,s=>o(s).remove(s)),t.visit(t.ADD,s=>o(s).add(s)));for(let s=0,u=this._mlen;s<u;++s)DZ(this._mods[s],a,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=DD(ee),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function DZ(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=e.data(n),u=s.length,l=o?qJ(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||Jt(-1)};t.init();for(let f=0;f<u;++f)MZ(c,a,f,u),o&&TZ(c,l),t.update(c,s[f])}function MZ(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function TZ(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}var NZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:ga,bin:fx,collect:dx,compare:MD,countpattern:hx,cross:gx,density:px,dotbin:yx,expression:ID,extent:vx,facet:Ag,field:BD,filter:xx,flatten:wx,fold:_x,formula:Ex,generate:zD,impute:Ax,joinaggregate:$x,kde:Sx,key:UD,load:qD,lookup:Ox,multiextent:HD,multivalues:WD,params:GD,pivot:Fx,prefacet:YD,project:kx,proxy:VD,quantile:Dx,relay:XD,sample:Mx,sequence:Tx,sieve:KD,subflow:bx,timeunit:Nx,tupleindex:ZD,values:QD,window:Rx});const jx=Math.PI,Lx=2*jx,$s=1e-6,RZ=Lx-$s;function Px(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ss(){return new Px}Px.prototype=Ss.prototype={constructor:Px,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-e,u=r-t,l=o-e,c=a-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>$s)if(!(Math.abs(c*s-u*l)>$s)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-o,h=r-a,g=s*s+u*u,p=d*d+h*h,m=Math.sqrt(g),y=Math.sqrt(f),v=i*Math.tan((jx-Math.acos((g+f-p)/(2*m*y)))/2),b=v/y,x=v/m;Math.abs(b-1)>$s&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*s)+","+(this._y1=t+x*u)}},arc:function(e,t,n,r,i,o){e=+e,t=+t,n=+n,o=!!o;var a=n*Math.cos(r),s=n*Math.sin(r),u=e+a,l=t+s,c=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>$s||Math.abs(this._y1-l)>$s)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%Lx+Lx),f>RZ?this._+="A"+n+","+n+",0,1,"+c+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>$s&&(this._+="A"+n+","+n+",0,"+ +(f>=jx)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function Ie(e){return function(){return e}}var nM=Math.abs,en=Math.atan2,Cs=Math.cos,jZ=Math.max,Ix=Math.min,Ci=Math.sin,sl=Math.sqrt,tn=1e-12,ul=Math.PI,Sg=ul/2,rM=2*ul;function LZ(e){return e>1?0:e<-1?ul:Math.acos(e)}function iM(e){return e>=1?Sg:e<=-1?-Sg:Math.asin(e)}function PZ(e){return e.innerRadius}function IZ(e){return e.outerRadius}function BZ(e){return e.startAngle}function zZ(e){return e.endAngle}function UZ(e){return e&&e.padAngle}function qZ(e,t,n,r,i,o,a,s){var u=n-e,l=r-t,c=a-i,f=s-o,d=f*u-c*l;if(!(d*d<tn))return d=(c*(t-o)-f*(e-i))/d,[e+d*u,t+d*l]}function Cg(e,t,n,r,i,o,a){var s=e-n,u=t-r,l=(a?o:-o)/sl(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,g=n+c,p=r+f,m=(d+g)/2,y=(h+p)/2,v=g-d,b=p-h,x=v*v+b*b,w=i-o,E=d*p-g*h,_=(b<0?-1:1)*sl(jZ(0,w*w*x-E*E)),$=(E*b-v*_)/x,C=(-E*v-b*_)/x,O=(E*b+v*_)/x,A=(-E*v+b*_)/x,D=$-m,F=C-y,T=O-m,S=A-y;return D*D+F*F>T*T+S*S&&($=O,C=A),{cx:$,cy:C,x01:-c,y01:-f,x11:$*(i/w-1),y11:C*(i/w-1)}}function HZ(){var e=PZ,t=IZ,n=Ie(0),r=null,i=BZ,o=zZ,a=UZ,s=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-Sg,g=o.apply(this,arguments)-Sg,p=nM(g-h),m=g>h;if(s||(s=l=Ss()),d<f&&(c=d,d=f,f=c),!(d>tn))s.moveTo(0,0);else if(p>rM-tn)s.moveTo(d*Cs(h),d*Ci(h)),s.arc(0,0,d,h,g,!m),f>tn&&(s.moveTo(f*Cs(g),f*Ci(g)),s.arc(0,0,f,g,h,m));else{var y=h,v=g,b=h,x=g,w=p,E=p,_=a.apply(this,arguments)/2,$=_>tn&&(r?+r.apply(this,arguments):sl(f*f+d*d)),C=Ix(nM(d-f)/2,+n.apply(this,arguments)),O=C,A=C,D,F;if($>tn){var T=iM($/f*Ci(_)),S=iM($/d*Ci(_));(w-=T*2)>tn?(T*=m?1:-1,b+=T,x-=T):(w=0,b=x=(h+g)/2),(E-=S*2)>tn?(S*=m?1:-1,y+=S,v-=S):(E=0,y=v=(h+g)/2)}var M=d*Cs(y),P=d*Ci(y),B=f*Cs(x),H=f*Ci(x);if(C>tn){var ie=d*Cs(v),le=d*Ci(v),he=f*Cs(b),Ae=f*Ci(b),$e;if(p<ul&&($e=qZ(M,P,he,Ae,ie,le,B,H))){var Pe=M-$e[0],It=P-$e[1],tr=ie-$e[0],Nn=le-$e[1],R=1/Ci(LZ((Pe*tr+It*Nn)/(sl(Pe*Pe+It*It)*sl(tr*tr+Nn*Nn)))/2),W=sl($e[0]*$e[0]+$e[1]*$e[1]);O=Ix(C,(f-W)/(R-1)),A=Ix(C,(d-W)/(R+1))}}E>tn?A>tn?(D=Cg(he,Ae,M,P,d,A,m),F=Cg(ie,le,B,H,d,A,m),s.moveTo(D.cx+D.x01,D.cy+D.y01),A<C?s.arc(D.cx,D.cy,A,en(D.y01,D.x01),en(F.y01,F.x01),!m):(s.arc(D.cx,D.cy,A,en(D.y01,D.x01),en(D.y11,D.x11),!m),s.arc(0,0,d,en(D.cy+D.y11,D.cx+D.x11),en(F.cy+F.y11,F.cx+F.x11),!m),s.arc(F.cx,F.cy,A,en(F.y11,F.x11),en(F.y01,F.x01),!m))):(s.moveTo(M,P),s.arc(0,0,d,y,v,!m)):s.moveTo(M,P),!(f>tn)||!(w>tn)?s.lineTo(B,H):O>tn?(D=Cg(B,H,ie,le,f,-O,m),F=Cg(M,P,he,Ae,f,-O,m),s.lineTo(D.cx+D.x01,D.cy+D.y01),O<C?s.arc(D.cx,D.cy,O,en(D.y01,D.x01),en(F.y01,F.x01),!m):(s.arc(D.cx,D.cy,O,en(D.y01,D.x01),en(D.y11,D.x11),!m),s.arc(0,0,f,en(D.cy+D.y11,D.cx+D.x11),en(F.cy+F.y11,F.cx+F.x11),m),s.arc(F.cx,F.cy,O,en(F.y11,F.x11),en(F.y01,F.x01),!m))):s.arc(0,0,f,x,b,m)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-ul/2;return[Cs(c)*l,Ci(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Ie(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Ie(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:Ie(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:Ie(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:Ie(+l),u):i},u.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Ie(+l),u):o},u.padAngle=function(l){return arguments.length?(a=typeof l=="function"?l:Ie(+l),u):a},u.context=function(l){return arguments.length?(s=l==null?null:l,u):s},u}function oM(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function aM(e){this._context=e}aM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Bx(e){return new aM(e)}function sM(e){return e[0]}function uM(e){return e[1]}function lM(e,t){var n=Ie(!0),r=null,i=Bx,o=null;e=typeof e=="function"?e:e===void 0?sM:Ie(e),t=typeof t=="function"?t:t===void 0?uM:Ie(t);function a(s){var u,l=(s=oM(s)).length,c,f=!1,d;for(r==null&&(o=i(d=Ss())),u=0;u<=l;++u)!(u<l&&n(c=s[u],u,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(c,u,s),+t(c,u,s));if(d)return o=null,d+""||null}return a.x=function(s){return arguments.length?(e=typeof s=="function"?s:Ie(+s),a):e},a.y=function(s){return arguments.length?(t=typeof s=="function"?s:Ie(+s),a):t},a.defined=function(s){return arguments.length?(n=typeof s=="function"?s:Ie(!!s),a):n},a.curve=function(s){return arguments.length?(i=s,r!=null&&(o=i(r)),a):i},a.context=function(s){return arguments.length?(s==null?r=o=null:o=i(r=s),a):r},a}function cM(e,t,n){var r=null,i=Ie(!0),o=null,a=Bx,s=null;e=typeof e=="function"?e:e===void 0?sM:Ie(+e),t=typeof t=="function"?t:Ie(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?uM:Ie(+n);function u(c){var f,d,h,g=(c=oM(c)).length,p,m=!1,y,v=new Array(g),b=new Array(g);for(o==null&&(s=a(y=Ss())),f=0;f<=g;++f){if(!(f<g&&i(p=c[f],f,c))===m)if(m=!m)d=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=f-1;h>=d;--h)s.point(v[h],b[h]);s.lineEnd(),s.areaEnd()}m&&(v[f]=+e(p,f,c),b[f]=+t(p,f,c),s.point(r?+r(p,f,c):v[f],n?+n(p,f,c):b[f]))}if(y)return s=null,y+""||null}function l(){return lM().defined(i).curve(a).context(o)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Ie(+c),r=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Ie(+c),u):e},u.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Ie(+c),u):r},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Ie(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Ie(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Ie(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(c){return arguments.length?(i=typeof c=="function"?c:Ie(!!c),u):i},u.curve=function(c){return arguments.length?(a=c,o!=null&&(s=a(o)),u):a},u.context=function(c){return arguments.length?(c==null?o=s=null:s=a(o=c),u):o},u}var WZ={draw:function(e,t){var n=Math.sqrt(t/ul);e.moveTo(n,0),e.arc(0,0,n,0,rM)}};function GZ(e,t){var n=null;e=typeof e=="function"?e:Ie(e||WZ),t=typeof t=="function"?t:Ie(t===void 0?64:+t);function r(){var i;if(n||(n=i=Ss()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:Ie(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:Ie(+i),r):t},r.context=function(i){return arguments.length?(n=i==null?null:i,r):n},r}function pa(){}function Og(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Fg(e){this._context=e}Fg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Og(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Og(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function YZ(e){return new Fg(e)}function fM(e){this._context=e}fM.prototype={areaStart:pa,areaEnd:pa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Og(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function VZ(e){return new fM(e)}function dM(e){this._context=e}dM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Og(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function XZ(e){return new dM(e)}function hM(e,t){this._basis=new Fg(e),this._beta=t}hM.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,a=t[n]-i,s=-1,u;++s<=n;)u=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(r+u*o),this._beta*t[s]+(1-this._beta)*(i+u*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var KZ=function e(t){function n(r){return t===1?new Fg(r):new hM(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function kg(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function zx(e,t){this._context=e,this._k=(1-t)/6}zx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:kg(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:kg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var JZ=function e(t){function n(r){return new zx(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Ux(e,t){this._context=e,this._k=(1-t)/6}Ux.prototype={areaStart:pa,areaEnd:pa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:kg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ZZ=function e(t){function n(r){return new Ux(r,t)}return n.tension=function(r){return e(+r)},n}(0);function qx(e,t){this._context=e,this._k=(1-t)/6}qx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:kg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var QZ=function e(t){function n(r){return new qx(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Hx(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>tn){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>tn){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function gM(e,t){this._context=e,this._alpha=t}gM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Hx(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var eQ=function e(t){function n(r){return t?new gM(r,t):new zx(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function pM(e,t){this._context=e,this._alpha=t}pM.prototype={areaStart:pa,areaEnd:pa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Hx(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var tQ=function e(t){function n(r){return t?new pM(r,t):new Ux(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function mM(e,t){this._context=e,this._alpha=t}mM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Hx(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var nQ=function e(t){function n(r){return t?new mM(r,t):new qx(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function yM(e){this._context=e}yM.prototype={areaStart:pa,areaEnd:pa,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function rQ(e){return new yM(e)}function vM(e){return e<0?-1:1}function bM(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(vM(o)+vM(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function xM(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Wx(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function Dg(e){this._context=e}Dg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Wx(this,this._t0,xM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Wx(this,xM(this,n=bM(this,e,t)),n);break;default:Wx(this,this._t0,n=bM(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function wM(e){this._context=new _M(e)}(wM.prototype=Object.create(Dg.prototype)).point=function(e,t){Dg.prototype.point.call(this,t,e)};function _M(e){this._context=e}_M.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function iQ(e){return new Dg(e)}function oQ(e){return new wM(e)}function EM(e){this._context=e}EM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=AM(e),i=AM(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function AM(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),a=new Array(n);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function aQ(e){return new EM(e)}function Mg(e,t){this._context=e,this._t=t}Mg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function sQ(e){return new Mg(e,.5)}function uQ(e){return new Mg(e,0)}function lQ(e){return new Mg(e,1)}function ll(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const cQ=()=>typeof Image!="undefined"?Image:null;function Gx(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Yx(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=fQ(e));function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=r(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:r,center:o,right:i}}function fQ(e){return(t,n)=>Gx(e(t),n)}function $M(e){return e===null?NaN:+e}const dQ=Yx(Gx),Vx=dQ.right;Yx($M).center;var Nf=Vx,Xx=Math.sqrt(50),Kx=Math.sqrt(10),Jx=Math.sqrt(2);function Zx(e,t,n){var r,i=-1,o,a,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(o=e,e=t,t=o),(s=SM(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,a=new Array(o=l-u+1);++i<o;)a[i]=(u+i)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,a=new Array(o=l-u+1);++i<o;)a[i]=(u+i)/s}return r&&a.reverse(),a}function SM(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Xx?10:o>=Kx?5:o>=Jx?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Xx?10:o>=Kx?5:o>=Jx?2:1)}function Qx(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Xx?i*=10:o>=Kx?i*=5:o>=Jx&&(i*=2),t<e?-i:i}function hQ(e,t,n=$M){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(i-o)}}function gQ(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function Oi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ma(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const e2=Symbol("implicit");function t2(){var e=new Map,t=[],n=[],r=e2;function i(o){var a=o+"",s=e.get(a);if(!s){if(r!==e2)return r;e.set(a,s=t.push(o))}return n[(s-1)%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Map;for(const a of o){const s=a+"";e.has(s)||e.set(s,t.push(a))}return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return t2(t,n).unknown(r)},Oi.apply(i,arguments),i}function cl(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Rf(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ya(){}var Os=.7,fl=1/Os,dl="\\s*([+-]?\\d+)\\s*",jf="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pQ=/^#([0-9a-f]{3,8})$/,mQ=new RegExp("^rgb\\("+[dl,dl,dl]+"\\)$"),yQ=new RegExp("^rgb\\("+[Fi,Fi,Fi]+"\\)$"),vQ=new RegExp("^rgba\\("+[dl,dl,dl,jf]+"\\)$"),bQ=new RegExp("^rgba\\("+[Fi,Fi,Fi,jf]+"\\)$"),xQ=new RegExp("^hsl\\("+[jf,Fi,Fi]+"\\)$"),wQ=new RegExp("^hsla\\("+[jf,Fi,Fi,jf]+"\\)$"),CM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};cl(ya,Lf,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:OM,formatHex:OM,formatHsl:_Q,formatRgb:FM,toString:FM});function OM(){return this.rgb().formatHex()}function _Q(){return NM(this).formatHsl()}function FM(){return this.rgb().formatRgb()}function Lf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=pQ.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?kM(t):n===3?new qt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Tg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Tg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mQ.exec(e))?new qt(t[1],t[2],t[3],1):(t=yQ.exec(e))?new qt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vQ.exec(e))?Tg(t[1],t[2],t[3],t[4]):(t=bQ.exec(e))?Tg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=xQ.exec(e))?TM(t[1],t[2]/100,t[3]/100,1):(t=wQ.exec(e))?TM(t[1],t[2]/100,t[3]/100,t[4]):CM.hasOwnProperty(e)?kM(CM[e]):e==="transparent"?new qt(NaN,NaN,NaN,0):null}function kM(e){return new qt(e>>16&255,e>>8&255,e&255,1)}function Tg(e,t,n,r){return r<=0&&(e=t=n=NaN),new qt(e,t,n,r)}function n2(e){return e instanceof ya||(e=Lf(e)),e?(e=e.rgb(),new qt(e.r,e.g,e.b,e.opacity)):new qt}function Ng(e,t,n,r){return arguments.length===1?n2(e):new qt(e,t,n,r==null?1:r)}function qt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}cl(qt,Ng,Rf(ya,{brighter:function(e){return e=e==null?fl:Math.pow(fl,e),new qt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Os:Math.pow(Os,e),new qt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:DM,formatHex:DM,formatRgb:MM,toString:MM}));function DM(){return"#"+r2(this.r)+r2(this.g)+r2(this.b)}function MM(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function r2(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function TM(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ki(e,t,n,r)}function NM(e){if(e instanceof ki)return new ki(e.h,e.s,e.l,e.opacity);if(e instanceof ya||(e=Lf(e)),!e)return new ki;if(e instanceof ki)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new ki(a,s,u,e.opacity)}function i2(e,t,n,r){return arguments.length===1?NM(e):new ki(e,t,n,r==null?1:r)}function ki(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}cl(ki,i2,Rf(ya,{brighter:function(e){return e=e==null?fl:Math.pow(fl,e),new ki(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Os:Math.pow(Os,e),new ki(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new qt(o2(e>=240?e-240:e+120,i,r),o2(e,i,r),o2(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function o2(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const RM=Math.PI/180,jM=180/Math.PI,Rg=18,LM=.96422,PM=1,IM=.82521,BM=4/29,hl=6/29,zM=3*hl*hl,EQ=hl*hl*hl;function UM(e){if(e instanceof Di)return new Di(e.l,e.a,e.b,e.opacity);if(e instanceof Eo)return qM(e);e instanceof qt||(e=n2(e));var t=c2(e.r),n=c2(e.g),r=c2(e.b),i=s2((.2225045*t+.7168786*n+.0606169*r)/PM),o,a;return t===n&&n===r?o=a=i:(o=s2((.4360747*t+.3850649*n+.1430804*r)/LM),a=s2((.0139322*t+.0971045*n+.7141733*r)/IM)),new Di(116*i-16,500*(o-i),200*(i-a),e.opacity)}function a2(e,t,n,r){return arguments.length===1?UM(e):new Di(e,t,n,r==null?1:r)}function Di(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}cl(Di,a2,Rf(ya,{brighter:function(e){return new Di(this.l+Rg*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Di(this.l-Rg*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=LM*u2(t),e=PM*u2(e),n=IM*u2(n),new qt(l2(3.1338561*t-1.6168667*e-.4906146*n),l2(-.9787684*t+1.9161415*e+.033454*n),l2(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function s2(e){return e>EQ?Math.pow(e,1/3):e/zM+BM}function u2(e){return e>hl?e*e*e:zM*(e-BM)}function l2(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function c2(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function AQ(e){if(e instanceof Eo)return new Eo(e.h,e.c,e.l,e.opacity);if(e instanceof Di||(e=UM(e)),e.a===0&&e.b===0)return new Eo(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*jM;return new Eo(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function f2(e,t,n,r){return arguments.length===1?AQ(e):new Eo(e,t,n,r==null?1:r)}function Eo(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function qM(e){if(isNaN(e.h))return new Di(e.l,0,0,e.opacity);var t=e.h*RM;return new Di(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}cl(Eo,f2,Rf(ya,{brighter:function(e){return new Eo(this.h,this.c,this.l+Rg*(e==null?1:e),this.opacity)},darker:function(e){return new Eo(this.h,this.c,this.l-Rg*(e==null?1:e),this.opacity)},rgb:function(){return qM(this).rgb()}}));var HM=-.14861,d2=1.78277,h2=-.29227,jg=-.90649,Pf=1.97294,WM=Pf*jg,GM=Pf*d2,YM=d2*h2-jg*HM;function $Q(e){if(e instanceof Fs)return new Fs(e.h,e.s,e.l,e.opacity);e instanceof qt||(e=n2(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(YM*r+WM*t-GM*n)/(YM+WM-GM),o=r-i,a=(Pf*(n-i)-h2*o)/jg,s=Math.sqrt(a*a+o*o)/(Pf*i*(1-i)),u=s?Math.atan2(a,o)*jM-120:NaN;return new Fs(u<0?u+360:u,s,i,e.opacity)}function g2(e,t,n,r){return arguments.length===1?$Q(e):new Fs(e,t,n,r==null?1:r)}function Fs(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}cl(Fs,g2,Rf(ya,{brighter:function(e){return e=e==null?fl:Math.pow(fl,e),new Fs(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Os:Math.pow(Os,e),new Fs(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*RM,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new qt(255*(t+n*(HM*r+d2*i)),255*(t+n*(h2*r+jg*i)),255*(t+n*(Pf*r)),this.opacity)}}));function VM(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function XM(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return VM((n-r/t)*t,a,i,o,s)}}function KM(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return VM((n-r/t)*t,i,o,a,s)}}var Lg=e=>()=>e;function JM(e,t){return function(n){return e+n*t}}function SQ(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Pg(e,t){var n=t-e;return n?JM(e,n>180||n<-180?n-360*Math.round(n/360):n):Lg(isNaN(e)?t:e)}function CQ(e){return(e=+e)==1?Dt:function(t,n){return n-t?SQ(t,n,e):Lg(isNaN(t)?n:t)}}function Dt(e,t){var n=t-e;return n?JM(e,n):Lg(isNaN(e)?t:e)}var p2=function e(t){var n=CQ(t);function r(i,o){var a=n((i=Ng(i)).r,(o=Ng(o)).r),s=n(i.g,o.g),u=n(i.b,o.b),l=Dt(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function ZM(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Ng(t[a]),r[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return r=e(r),i=e(i),o=e(o),s.opacity=1,function(u){return s.r=r(u),s.g=i(u),s.b=o(u),s+""}}}var OQ=ZM(XM),FQ=ZM(KM);function m2(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function QM(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function kQ(e,t){return(QM(t)?m2:e5)(e,t)}function e5(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=ks(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function t5(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Xr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function n5(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=ks(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var y2=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,v2=new RegExp(y2.source,"g");function DQ(e){return function(){return e}}function MQ(e){return function(t){return e(t)+""}}function r5(e,t){var n=y2.lastIndex=v2.lastIndex=0,r,i,o,a=-1,s=[],u=[];for(e=e+"",t=t+"";(r=y2.exec(e))&&(i=v2.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,u.push({i:a,x:Xr(r,i)})),n=v2.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?MQ(u[0].x):DQ(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function ks(e,t){var n=typeof t,r;return t==null||n==="boolean"?Lg(t):(n==="number"?Xr:n==="string"?(r=Lf(t))?(t=r,p2):r5:t instanceof Lf?p2:t instanceof Date?t5:QM(t)?m2:Array.isArray(t)?e5:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?n5:Xr)(e,t)}function TQ(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function NQ(e,t){var n=Pg(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function Ig(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var i5=180/Math.PI,b2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function o5(e,t,n,r,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*i5,skewX:Math.atan(u)*i5,scaleX:a,scaleY:s}}var Bg;function RQ(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?b2:o5(t.a,t.b,t.c,t.d,t.e,t.f)}function jQ(e){return e==null||(Bg||(Bg=document.createElementNS("http://www.w3.org/2000/svg","g")),Bg.setAttribute("transform",e),!(e=Bg.transform.baseVal.consolidate()))?b2:(e=e.matrix,o5(e.a,e.b,e.c,e.d,e.e,e.f))}function a5(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push("translate(",null,t,null,n);g.push({i:p-4,x:Xr(l,f)},{i:p-2,x:Xr(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function a(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Xr(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Xr(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push(i(h)+"scale(",null,",",null,")");g.push({i:p-4,x:Xr(l,f)},{i:p-2,x:Xr(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),a(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var g=-1,p=d.length,m;++g<p;)f[(m=d[g]).i]=m.x(h);return f.join("")}}}var LQ=a5(RQ,"px, ","px)","deg)"),PQ=a5(jQ,", ",")",")"),IQ=1e-12;function s5(e){return((e=Math.exp(e))+1/e)/2}function BQ(e){return((e=Math.exp(e))-1/e)/2}function zQ(e){return((e=Math.exp(2*e))-1)/(e+1)}var UQ=function e(t,n,r){function i(o,a){var s=o[0],u=o[1],l=o[2],c=a[0],f=a[1],d=a[2],h=c-s,g=f-u,p=h*h+g*g,m,y;if(p<IQ)y=Math.log(d/l)/t,m=function(_){return[s+_*h,u+_*g,l*Math.exp(t*_*y)]};else{var v=Math.sqrt(p),b=(d*d-l*l+r*p)/(2*l*n*v),x=(d*d-l*l-r*p)/(2*d*n*v),w=Math.log(Math.sqrt(b*b+1)-b),E=Math.log(Math.sqrt(x*x+1)-x);y=(E-w)/t,m=function(_){var $=_*y,C=s5(w),O=l/(n*v)*(C*zQ(t*$+w)-BQ(w));return[s+O*h,u+O*g,l*C/s5(t*$+w)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return i.rho=function(o){var a=Math.max(.001,+o),s=a*a,u=s*s;return e(a,s,u)},i}(Math.SQRT2,2,4);function u5(e){return function(t,n){var r=e((t=i2(t)).h,(n=i2(n)).h),i=Dt(t.s,n.s),o=Dt(t.l,n.l),a=Dt(t.opacity,n.opacity);return function(s){return t.h=r(s),t.s=i(s),t.l=o(s),t.opacity=a(s),t+""}}}var qQ=u5(Pg),HQ=u5(Dt);function WQ(e,t){var n=Dt((e=a2(e)).l,(t=a2(t)).l),r=Dt(e.a,t.a),i=Dt(e.b,t.b),o=Dt(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=o(a),e+""}}function l5(e){return function(t,n){var r=e((t=f2(t)).h,(n=f2(n)).h),i=Dt(t.c,n.c),o=Dt(t.l,n.l),a=Dt(t.opacity,n.opacity);return function(s){return t.h=r(s),t.c=i(s),t.l=o(s),t.opacity=a(s),t+""}}}var GQ=l5(Pg),YQ=l5(Dt);function c5(e){return function t(n){n=+n;function r(i,o){var a=e((i=g2(i)).h,(o=g2(o)).h),s=Dt(i.s,o.s),u=Dt(i.l,o.l),l=Dt(i.opacity,o.opacity);return function(c){return i.h=a(c),i.s=s(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}var VQ=c5(Pg),XQ=c5(Dt);function x2(e,t){t===void 0&&(t=e,e=ks);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(a){var s=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return o[s](a-s)}}function KQ(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var JQ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:ks,interpolateArray:kQ,interpolateBasis:XM,interpolateBasisClosed:KM,interpolateDate:t5,interpolateDiscrete:TQ,interpolateHue:NQ,interpolateNumber:Xr,interpolateNumberArray:m2,interpolateObject:n5,interpolateRound:Ig,interpolateString:r5,interpolateTransformCss:LQ,interpolateTransformSvg:PQ,interpolateZoom:UQ,interpolateRgb:p2,interpolateRgbBasis:OQ,interpolateRgbBasisClosed:FQ,interpolateHsl:qQ,interpolateHslLong:HQ,interpolateLab:WQ,interpolateHcl:GQ,interpolateHclLong:YQ,interpolateCubehelix:VQ,interpolateCubehelixLong:XQ,piecewise:x2,quantize:KQ});function ZQ(e){return function(){return e}}function w2(e){return+e}var f5=[0,1];function zn(e){return e}function _2(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:ZQ(isNaN(t)?NaN:.5)}function QQ(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function eee(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=_2(i,r),o=n(a,o)):(r=_2(r,i),o=n(o,a)),function(s){return o(r(s))}}function tee(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=_2(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(s){var u=Nf(e,s,1,r)-1;return o[u](i[u](s))}}function If(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function zg(){var e=f5,t=f5,n=ks,r,i,o,a=zn,s,u,l;function c(){var d=Math.min(e.length,t.length);return a!==zn&&(a=QQ(e[0],e[d-1])),s=d>2?tee:eee,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=s(e.map(r),t,n)))(r(a(d)))}return f.invert=function(d){return a(i((l||(l=s(t,e.map(r),Xr)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,w2),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Ig,c()},f.clamp=function(d){return arguments.length?(a=d?!0:zn,c()):a!==zn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return r=d,i=h,c()}}function d5(){return zg()(zn,zn)}function nee(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ug(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function gl(e){return e=Ug(Math.abs(e)),e?e[1]:NaN}function ree(e,t){return function(n,r){for(var i=n.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function iee(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var oee=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function qg(e){if(!(t=oee.exec(e)))throw new Error("invalid format: "+e);var t;return new E2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}qg.prototype=E2.prototype;function E2(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}E2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function aee(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var h5;function see(e,t){var n=Ug(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(h5=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Ug(e,Math.max(0,t+o-1))[0]}function g5(e,t){var n=Ug(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var p5={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:nee,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>g5(e*100,t),r:g5,s:see,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function m5(e){return e}var y5=Array.prototype.map,v5=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function uee(e){var t=e.grouping===void 0||e.thousands===void 0?m5:ree(y5.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?m5:iee(y5.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=qg(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,v=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(v=!0,w="g"):p5[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var E=p==="$"?n:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",_=p==="$"?r:/[%p]/.test(w)?a:"",$=p5[w],C=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function O(A){var D=E,F=_,T,S,M;if(w==="c")F=$(A)+F,A="";else{A=+A;var P=A<0||1/A<0;if(A=isNaN(A)?u:$(Math.abs(A),b),x&&(A=aee(A)),P&&+A==0&&g!=="+"&&(P=!1),D=(P?g==="("?g:s:g==="-"||g==="("?"":g)+D,F=(w==="s"?v5[8+h5/3]:"")+F+(P&&g==="("?")":""),C){for(T=-1,S=A.length;++T<S;)if(M=A.charCodeAt(T),48>M||M>57){F=(M===46?i+A.slice(T+1):A.slice(T))+F,A=A.slice(0,T);break}}}v&&!m&&(A=t(A,1/0));var B=D.length+A.length+F.length,H=B<y?new Array(y-B+1).join(d):"";switch(v&&m&&(A=t(H+A,H.length?y-F.length:1/0),H=""),h){case"<":A=D+A+F+H;break;case"=":A=D+H+A+F;break;case"^":A=H.slice(0,B=H.length>>1)+D+A+F+H.slice(B);break;default:A=H+D+A+F;break}return o(A)}return O.toString=function(){return f+""},O}function c(f,d){var h=l((f=qg(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(gl(d)/3)))*3,p=Math.pow(10,-g),m=v5[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var Hg,A2,b5;lee({thousands:",",grouping:[3],currency:["$",""]});function lee(e){return Hg=uee(e),A2=Hg.format,b5=Hg.formatPrefix,Hg}function cee(e){return Math.max(0,-gl(Math.abs(e)))}function fee(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(gl(t)/3)))*3-gl(Math.abs(e)))}function dee(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,gl(t)-gl(e))+1}function x5(e,t,n,r){var i=Qx(e,t,n),o;switch(r=qg(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=fee(i,a))&&(r.precision=o),b5(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=dee(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=cee(i))&&(r.precision=o-(r.type==="%")*2);break}}return A2(r)}function Ds(e){var t=e.domain;return e.ticks=function(n){var r=t();return Zx(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return x5(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,a=r[i],s=r[o],u,l,c=10;for(s<a&&(l=a,a=s,s=l,l=i,i=o,o=l);c-- >0;){if(l=SM(a,s,n),l===u)return r[i]=a,r[o]=s,t(r);if(l>0)a=Math.floor(a/l)*l,s=Math.ceil(s/l)*l;else if(l<0)a=Math.ceil(a*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function w5(){var e=d5();return e.copy=function(){return If(e,w5())},Oi.apply(e,arguments),Ds(e)}function _5(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,w2),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return _5(e).unknown(t)},e=arguments.length?Array.from(e,w2):[0,1],Ds(n)}function E5(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],a;return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),e[n]=t.floor(i),e[r]=t.ceil(o),e}function A5(e){return Math.log(e)}function $5(e){return Math.exp(e)}function hee(e){return-Math.log(-e)}function gee(e){return-Math.exp(-e)}function pee(e){return isFinite(e)?+("1e"+e):e<0?0:e}function mee(e){return e===10?pee:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function yee(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function S5(e){return function(t){return-e(-t)}}function $2(e){var t=e(A5,$5),n=t.domain,r=10,i,o;function a(){return i=yee(r),o=mee(r),n()[0]<0?(i=S5(i),o=S5(o),e(hee,gee)):e(A5,$5),t}return t.base=function(s){return arguments.length?(r=+s,a()):r},t.domain=function(s){return arguments.length?(n(s),a()):n()},t.ticks=function(s){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=i(l),h=i(c),g,p,m,y=s==null?10:+s,v=[];if(!(r%1)&&h-d<y){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1,g=o(d);p<r;++p)if(m=g*p,!(m<l)){if(m>c)break;v.push(m)}}else for(;d<=h;++d)for(p=r-1,g=o(d);p>=1;--p)if(m=g*p,!(m<l)){if(m>c)break;v.push(m)}v.length*2<y&&(v=Zx(l,c,y))}else v=Zx(d,h,Math.min(h-d,y)).map(o);return f?v.reverse():v},t.tickFormat=function(s,u){if(u==null&&(u=r===10?".0e":","),typeof u!="function"&&(u=A2(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,r*s/t.ticks().length);return function(c){var f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=function(){return n(E5(n(),{floor:function(s){return o(Math.floor(i(s)))},ceil:function(s){return o(Math.ceil(i(s)))}}))},t}function C5(){var e=$2(zg()).domain([1,10]);return e.copy=function(){return If(e,C5()).base(e.base())},Oi.apply(e,arguments),e}function O5(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function F5(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function S2(e){var t=1,n=e(O5(t),F5(t));return n.constant=function(r){return arguments.length?e(O5(t=+r),F5(t)):t},Ds(n)}function k5(){var e=S2(zg());return e.copy=function(){return If(e,k5()).constant(e.constant())},Oi.apply(e,arguments)}function D5(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function vee(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function bee(e){return e<0?-e*e:e*e}function C2(e){var t=e(zn,zn),n=1;function r(){return n===1?e(zn,zn):n===.5?e(vee,bee):e(D5(n),D5(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Ds(t)}function O2(){var e=C2(zg());return e.copy=function(){return If(e,O2()).exponent(e.exponent())},Oi.apply(e,arguments),e}function xee(){return O2.apply(null,arguments).exponent(.5)}function M5(){var e=[],t=[],n=[],r;function i(){var a=0,s=Math.max(1,t.length);for(n=new Array(s-1);++a<s;)n[a-1]=hQ(e,a/s);return o}function o(a){return a==null||isNaN(a=+a)?r:t[Nf(n,a)]}return o.invertExtent=function(a){var s=t.indexOf(a);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Gx),i()},o.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},o.unknown=function(a){return arguments.length?(r=a,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return M5().domain(e).range(t).unknown(r)},Oi.apply(o,arguments)}function T5(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function a(u){return u!=null&&u<=u?i[Nf(r,u,0,n)]:o}function s(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return a}return a.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,s()):[e,t]},a.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,s()):i.slice()},a.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},a.unknown=function(u){return arguments.length&&(o=u),a},a.thresholds=function(){return r.slice()},a.copy=function(){return T5().domain([e,t]).range(i).unknown(o)},Oi.apply(Ds(a),arguments)}function N5(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[Nf(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var a=t.indexOf(o);return[e[a-1],e[a]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return N5().domain(e).range(t).unknown(n)},Oi.apply(i,arguments)}var F2=new Date,k2=new Date;function Mt(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return e(o=new Date(+o)),o},i.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var u=[],l;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},i.filter=function(o){return Mt(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(i.count=function(o,a){return F2.setTime(+o),k2.setTime(+a),e(F2),e(k2),Math.floor(n(F2,k2))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?function(a){return r(a)%o==0}:function(a){return i.count(0,a)%o==0}):i}),i}var D2=Mt(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});D2.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Mt(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):D2};var wee=D2;const Ao=1e3,$r=Ao*60,$o=$r*60,Ms=$o*24,M2=Ms*7,R5=Ms*30,T2=Ms*365;var _ee=Mt(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Ao)},function(e,t){return(t-e)/Ao},function(e){return e.getUTCSeconds()}),pl=_ee,Eee=Mt(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ao)},function(e,t){e.setTime(+e+t*$r)},function(e,t){return(t-e)/$r},function(e){return e.getMinutes()}),j5=Eee,Aee=Mt(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ao-e.getMinutes()*$r)},function(e,t){e.setTime(+e+t*$o)},function(e,t){return(t-e)/$o},function(e){return e.getHours()}),L5=Aee,$ee=Mt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*$r)/Ms,e=>e.getDate()-1),Wg=$ee;function Ts(e){return Mt(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*$r)/M2})}var N2=Ts(0),R2=Ts(1);Ts(2);Ts(3);var Bf=Ts(4);Ts(5);Ts(6);var See=Mt(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),P5=See,I5=Mt(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});I5.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Mt(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var Ns=I5,Cee=Mt(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*$r)},function(e,t){return(t-e)/$r},function(e){return e.getUTCMinutes()}),B5=Cee,Oee=Mt(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*$o)},function(e,t){return(t-e)/$o},function(e){return e.getUTCHours()}),z5=Oee,Fee=Mt(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Ms},function(e){return e.getUTCDate()-1}),Gg=Fee;function Rs(e){return Mt(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/M2})}var j2=Rs(0),L2=Rs(1);Rs(2);Rs(3);var zf=Rs(4);Rs(5);Rs(6);var kee=Mt(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),U5=kee,q5=Mt(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});q5.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Mt(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var js=q5;function H5(e,t,n,r,i,o){const a=[[pl,1,Ao],[pl,5,5*Ao],[pl,15,15*Ao],[pl,30,30*Ao],[o,1,$r],[o,5,5*$r],[o,15,15*$r],[o,30,30*$r],[i,1,$o],[i,3,3*$o],[i,6,6*$o],[i,12,12*$o],[r,1,Ms],[r,2,2*Ms],[n,1,M2],[t,1,R5],[t,3,3*R5],[e,1,T2]];function s(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),g=h?h.range(l,+c+1):[];return d?g.reverse():g}function u(l,c,f){const d=Math.abs(c-l)/f,h=Yx(([,,m])=>m).right(a,d);if(h===a.length)return e.every(Qx(l/T2,c/T2,f));if(h===0)return wee.every(Math.max(Qx(l,c,f),1));const[g,p]=a[d/a[h-1][2]<a[h][2]/d?h-1:h];return g.every(p)}return[s,u]}const[Dee,Mee]=H5(js,U5,j2,Gg,z5,B5),[Tee,Nee]=H5(Ns,P5,N2,Wg,L5,j5);function P2(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function I2(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Uf(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Ree(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=qf(i),c=Hf(i),f=qf(o),d=Hf(o),h=qf(a),g=Hf(a),p=qf(s),m=Hf(s),y=qf(u),v=Hf(u),b={a:P,A:B,b:H,B:ie,c:null,d:K5,e:K5,f:ite,g:gte,G:mte,H:tte,I:nte,j:rte,L:J5,m:ote,M:ate,p:le,q:he,Q:rT,s:iT,S:ste,u:ute,U:lte,V:cte,w:fte,W:dte,x:null,X:null,y:hte,Y:pte,Z:yte,"%":nT},x={a:Ae,A:$e,b:Pe,B:It,c:null,d:Q5,e:Q5,f:wte,g:Dte,G:Tte,H:vte,I:bte,j:xte,L:eT,m:_te,M:Ete,p:tr,q:Nn,Q:rT,s:iT,S:Ate,u:$te,U:Ste,V:Cte,w:Ote,W:Fte,x:null,X:null,y:kte,Y:Mte,Z:Nte,"%":nT},w={a:O,A,b:D,B:F,c:T,d:V5,e:V5,f:Jee,g:Y5,G:G5,H:X5,I:X5,j:Yee,L:Kee,m:Gee,M:Vee,p:C,q:Wee,Q:Qee,s:ete,S:Xee,u:Bee,U:zee,V:Uee,w:Iee,W:qee,x:S,X:M,y:Y5,Y:G5,Z:Hee,"%":Zee};b.x=E(n,b),b.X=E(r,b),b.c=E(t,b),x.x=E(n,x),x.X=E(r,x),x.c=E(t,x);function E(R,W){return function(V){var k=[],xe=-1,X=0,Oe=R.length,we,Yt,wr;for(V instanceof Date||(V=new Date(+V));++xe<Oe;)R.charCodeAt(xe)===37&&(k.push(R.slice(X,xe)),(Yt=W5[we=R.charAt(++xe)])!=null?we=R.charAt(++xe):Yt=we==="e"?" ":"0",(wr=W[we])&&(we=wr(V,Yt)),k.push(we),X=xe+1);return k.push(R.slice(X,xe)),k.join("")}}function _(R,W){return function(V){var k=Uf(1900,void 0,1),xe=$(k,R,V+="",0),X,Oe;if(xe!=V.length)return null;if("Q"in k)return new Date(k.Q);if("s"in k)return new Date(k.s*1e3+("L"in k?k.L:0));if(W&&!("Z"in k)&&(k.Z=0),"p"in k&&(k.H=k.H%12+k.p*12),k.m===void 0&&(k.m="q"in k?k.q:0),"V"in k){if(k.V<1||k.V>53)return null;"w"in k||(k.w=1),"Z"in k?(X=I2(Uf(k.y,0,1)),Oe=X.getUTCDay(),X=Oe>4||Oe===0?L2.ceil(X):L2(X),X=Gg.offset(X,(k.V-1)*7),k.y=X.getUTCFullYear(),k.m=X.getUTCMonth(),k.d=X.getUTCDate()+(k.w+6)%7):(X=P2(Uf(k.y,0,1)),Oe=X.getDay(),X=Oe>4||Oe===0?R2.ceil(X):R2(X),X=Wg.offset(X,(k.V-1)*7),k.y=X.getFullYear(),k.m=X.getMonth(),k.d=X.getDate()+(k.w+6)%7)}else("W"in k||"U"in k)&&("w"in k||(k.w="u"in k?k.u%7:"W"in k?1:0),Oe="Z"in k?I2(Uf(k.y,0,1)).getUTCDay():P2(Uf(k.y,0,1)).getDay(),k.m=0,k.d="W"in k?(k.w+6)%7+k.W*7-(Oe+5)%7:k.w+k.U*7-(Oe+6)%7);return"Z"in k?(k.H+=k.Z/100|0,k.M+=k.Z%100,I2(k)):P2(k)}}function $(R,W,V,k){for(var xe=0,X=W.length,Oe=V.length,we,Yt;xe<X;){if(k>=Oe)return-1;if(we=W.charCodeAt(xe++),we===37){if(we=W.charAt(xe++),Yt=w[we in W5?W.charAt(xe++):we],!Yt||(k=Yt(R,V,k))<0)return-1}else if(we!=V.charCodeAt(k++))return-1}return k}function C(R,W,V){var k=l.exec(W.slice(V));return k?(R.p=c.get(k[0].toLowerCase()),V+k[0].length):-1}function O(R,W,V){var k=h.exec(W.slice(V));return k?(R.w=g.get(k[0].toLowerCase()),V+k[0].length):-1}function A(R,W,V){var k=f.exec(W.slice(V));return k?(R.w=d.get(k[0].toLowerCase()),V+k[0].length):-1}function D(R,W,V){var k=y.exec(W.slice(V));return k?(R.m=v.get(k[0].toLowerCase()),V+k[0].length):-1}function F(R,W,V){var k=p.exec(W.slice(V));return k?(R.m=m.get(k[0].toLowerCase()),V+k[0].length):-1}function T(R,W,V){return $(R,t,W,V)}function S(R,W,V){return $(R,n,W,V)}function M(R,W,V){return $(R,r,W,V)}function P(R){return a[R.getDay()]}function B(R){return o[R.getDay()]}function H(R){return u[R.getMonth()]}function ie(R){return s[R.getMonth()]}function le(R){return i[+(R.getHours()>=12)]}function he(R){return 1+~~(R.getMonth()/3)}function Ae(R){return a[R.getUTCDay()]}function $e(R){return o[R.getUTCDay()]}function Pe(R){return u[R.getUTCMonth()]}function It(R){return s[R.getUTCMonth()]}function tr(R){return i[+(R.getUTCHours()>=12)]}function Nn(R){return 1+~~(R.getUTCMonth()/3)}return{format:function(R){var W=E(R+="",b);return W.toString=function(){return R},W},parse:function(R){var W=_(R+="",!1);return W.toString=function(){return R},W},utcFormat:function(R){var W=E(R+="",x);return W.toString=function(){return R},W},utcParse:function(R){var W=_(R+="",!0);return W.toString=function(){return R},W}}}var W5={"-":"",_:" ","0":"0"},Tt=/^\s*\d+/,jee=/^%/,Lee=/[\\^$*+?|[\]().{}]/g;function Te(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function Pee(e){return e.replace(Lee,"\\$&")}function qf(e){return new RegExp("^(?:"+e.map(Pee).join("|")+")","i")}function Hf(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Iee(e,t,n){var r=Tt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Bee(e,t,n){var r=Tt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function zee(e,t,n){var r=Tt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Uee(e,t,n){var r=Tt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function qee(e,t,n){var r=Tt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function G5(e,t,n){var r=Tt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Y5(e,t,n){var r=Tt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Hee(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Wee(e,t,n){var r=Tt.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Gee(e,t,n){var r=Tt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function V5(e,t,n){var r=Tt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Yee(e,t,n){var r=Tt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function X5(e,t,n){var r=Tt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Vee(e,t,n){var r=Tt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Xee(e,t,n){var r=Tt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Kee(e,t,n){var r=Tt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Jee(e,t,n){var r=Tt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Zee(e,t,n){var r=jee.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Qee(e,t,n){var r=Tt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function ete(e,t,n){var r=Tt.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function K5(e,t){return Te(e.getDate(),t,2)}function tte(e,t){return Te(e.getHours(),t,2)}function nte(e,t){return Te(e.getHours()%12||12,t,2)}function rte(e,t){return Te(1+Wg.count(Ns(e),e),t,3)}function J5(e,t){return Te(e.getMilliseconds(),t,3)}function ite(e,t){return J5(e,t)+"000"}function ote(e,t){return Te(e.getMonth()+1,t,2)}function ate(e,t){return Te(e.getMinutes(),t,2)}function ste(e,t){return Te(e.getSeconds(),t,2)}function ute(e){var t=e.getDay();return t===0?7:t}function lte(e,t){return Te(N2.count(Ns(e)-1,e),t,2)}function Z5(e){var t=e.getDay();return t>=4||t===0?Bf(e):Bf.ceil(e)}function cte(e,t){return e=Z5(e),Te(Bf.count(Ns(e),e)+(Ns(e).getDay()===4),t,2)}function fte(e){return e.getDay()}function dte(e,t){return Te(R2.count(Ns(e)-1,e),t,2)}function hte(e,t){return Te(e.getFullYear()%100,t,2)}function gte(e,t){return e=Z5(e),Te(e.getFullYear()%100,t,2)}function pte(e,t){return Te(e.getFullYear()%1e4,t,4)}function mte(e,t){var n=e.getDay();return e=n>=4||n===0?Bf(e):Bf.ceil(e),Te(e.getFullYear()%1e4,t,4)}function yte(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Te(t/60|0,"0",2)+Te(t%60,"0",2)}function Q5(e,t){return Te(e.getUTCDate(),t,2)}function vte(e,t){return Te(e.getUTCHours(),t,2)}function bte(e,t){return Te(e.getUTCHours()%12||12,t,2)}function xte(e,t){return Te(1+Gg.count(js(e),e),t,3)}function eT(e,t){return Te(e.getUTCMilliseconds(),t,3)}function wte(e,t){return eT(e,t)+"000"}function _te(e,t){return Te(e.getUTCMonth()+1,t,2)}function Ete(e,t){return Te(e.getUTCMinutes(),t,2)}function Ate(e,t){return Te(e.getUTCSeconds(),t,2)}function $te(e){var t=e.getUTCDay();return t===0?7:t}function Ste(e,t){return Te(j2.count(js(e)-1,e),t,2)}function tT(e){var t=e.getUTCDay();return t>=4||t===0?zf(e):zf.ceil(e)}function Cte(e,t){return e=tT(e),Te(zf.count(js(e),e)+(js(e).getUTCDay()===4),t,2)}function Ote(e){return e.getUTCDay()}function Fte(e,t){return Te(L2.count(js(e)-1,e),t,2)}function kte(e,t){return Te(e.getUTCFullYear()%100,t,2)}function Dte(e,t){return e=tT(e),Te(e.getUTCFullYear()%100,t,2)}function Mte(e,t){return Te(e.getUTCFullYear()%1e4,t,4)}function Tte(e,t){var n=e.getUTCDay();return e=n>=4||n===0?zf(e):zf.ceil(e),Te(e.getUTCFullYear()%1e4,t,4)}function Nte(){return"+0000"}function nT(){return"%"}function rT(e){return+e}function iT(e){return Math.floor(+e/1e3)}var Yg,oT,aT;Rte({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Rte(e){return Yg=Ree(e),oT=Yg.format,aT=Yg.utcFormat,Yg}function jte(e){return new Date(e)}function Lte(e){return e instanceof Date?+e:+new Date(+e)}function B2(e,t,n,r,i,o,a,s,u,l){var c=d5(),f=c.invert,d=c.domain,h=l(".%L"),g=l(":%S"),p=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),b=l("%B"),x=l("%Y");function w(E){return(u(E)<E?h:s(E)<E?g:a(E)<E?p:o(E)<E?m:r(E)<E?i(E)<E?y:v:n(E)<E?b:x)(E)}return c.invert=function(E){return new Date(f(E))},c.domain=function(E){return arguments.length?d(Array.from(E,Lte)):d().map(jte)},c.ticks=function(E){var _=d();return e(_[0],_[_.length-1],E==null?10:E)},c.tickFormat=function(E,_){return _==null?w:l(_)},c.nice=function(E){var _=d();return(!E||typeof E.range!="function")&&(E=t(_[0],_[_.length-1],E==null?10:E)),E?d(E5(_,E)):c},c.copy=function(){return If(c,B2(e,t,n,r,i,o,a,s,u,l))},c}function Pte(){return Oi.apply(B2(Tee,Nee,Ns,P5,N2,Wg,L5,j5,pl,oT).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Ite(){return Oi.apply(B2(Dee,Mee,js,U5,j2,Gg,z5,B5,pl,aT).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Vg(){var e=0,t=1,n,r,i,o,a=zn,s=!1,u;function l(f){return f==null||isNaN(f=+f)?u:a(i===0?.5:(f=(o(f)-n)*i,s?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(a=f,l):a};function c(f){return function(d){var h,g;return arguments.length?([h,g]=d,a=f(h,g),l):[a(0),a(1)]}}return l.range=c(ks),l.rangeRound=c(Ig),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function va(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function z2(){var e=Ds(Vg()(zn));return e.copy=function(){return va(e,z2())},ma.apply(e,arguments)}function sT(){var e=$2(Vg()).domain([1,10]);return e.copy=function(){return va(e,sT()).base(e.base())},ma.apply(e,arguments)}function uT(){var e=S2(Vg());return e.copy=function(){return va(e,uT()).constant(e.constant())},ma.apply(e,arguments)}function U2(){var e=C2(Vg());return e.copy=function(){return va(e,U2()).exponent(e.exponent())},ma.apply(e,arguments)}function Bte(){return U2.apply(null,arguments).exponent(.5)}function Xg(){var e=0,t=.5,n=1,r=1,i,o,a,s,u,l=zn,c,f=!1,d;function h(p){return isNaN(p=+p)?d:(p=.5+((p=+c(p))-o)*(r*p<r*o?s:u),l(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,n]=p,i=c(e=+e),o=c(t=+t),a=c(n=+n),s=i===o?0:.5/(o-i),u=o===a?0:.5/(a-o),r=o<i?-1:1,h):[e,t,n]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(l=p,h):l};function g(p){return function(m){var y,v,b;return arguments.length?([y,v,b]=m,l=x2(p,[y,v,b]),h):[l(0),l(.5),l(1)]}}return h.range=g(ks),h.rangeRound=g(Ig),h.unknown=function(p){return arguments.length?(d=p,h):d},function(p){return c=p,i=p(e),o=p(t),a=p(n),s=i===o?0:.5/(o-i),u=o===a?0:.5/(a-o),r=o<i?-1:1,h}}function lT(){var e=Ds(Xg()(zn));return e.copy=function(){return va(e,lT())},ma.apply(e,arguments)}function cT(){var e=$2(Xg()).domain([.1,1,10]);return e.copy=function(){return va(e,cT()).base(e.base())},ma.apply(e,arguments)}function fT(){var e=S2(Xg());return e.copy=function(){return va(e,fT()).constant(e.constant())},ma.apply(e,arguments)}function q2(){var e=C2(Xg());return e.copy=function(){return va(e,q2()).exponent(e.exponent())},ma.apply(e,arguments)}function zte(){return q2.apply(null,arguments).exponent(.5)}function H2(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const Ute="identity",ml="linear",So="log",Wf="pow",Gf="sqrt",Kg="symlog",Ls="time",Ps="utc",Mi="sequential",yl="diverging",vl="quantile",Jg="quantize",Zg="threshold",W2="ordinal",G2="point",dT="band",Y2="bin-ordinal",wt="continuous",Yf="discrete",Vf="discretizing",Sr="interpolating",V2="temporal";function qte(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function Hte(e){return function(t){const n=e.range();let r=t[0],i=t[1],o=-1,a,s,u,l;for(i<r&&(s=r,r=i,i=s),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(o<0&&(o=u),a=u);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function X2(){const e=t2().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,o,a=!1,s=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],g=H2(f,s,u);let p=r[d-0];i=(h-p)/(g||1),a&&(i=Math.floor(i)),p+=(h-p-i*(f-s))*l,o=i*(1-s),a&&(p=Math.round(p),o=Math.round(o));const m=gQ(f).map(y=>p+i*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),s=u,c()):s},e.paddingInner=function(f){return arguments.length?(s=Math.max(0,Math.min(1,f)),c()):s},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),g=h.length-1;let p=+f[0],m=+f[1],y,v,b;if(!(p!==p||m!==m)&&(m<p&&(b=p,p=m,m=b),!(m<h[0]||p>r[1-d])))return y=Math.max(0,Vx(h,p)-1),v=p===m?y:Vx(h,m)-1,p-h[y]>o+1e-10&&++y,d&&(b=y,y=g-v,v=g-b),y>v?void 0:t().slice(y,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return X2().domain(t()).range(r).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function hT(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return hT(t())},e}function Wte(){return hT(X2().paddingInner(1))}var Gte=Array.prototype.map;function Yte(e){return Gte.call(e,Kt)}const Vte=Array.prototype.slice;function gT(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(Nf(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=Yte(r),n):e.slice()},n.range=function(r){return arguments.length?(t=Vte.call(r),n):t.slice()},n.tickFormat=function(r,i){return x5(e[0],_e(e),r==null?10:r,i)},n.copy=function(){return gT().domain(n.domain()).range(n.range())},n}const Qg={};function Xte(e,t,n){const r=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?qte(o):o.invertExtent?Hte(o):void 0),o.type=e,o};return r.metadata=Yr(oe(n)),r}function Ne(e,t,n){return arguments.length>1?(Qg[e]=Xte(e,t,n),this):pT(e)?Qg[e]:void 0}Ne(Ute,_5);Ne(ml,w5,wt);Ne(So,C5,[wt,So]);Ne(Wf,O2,wt);Ne(Gf,xee,wt);Ne(Kg,k5,wt);Ne(Ls,Pte,[wt,V2]);Ne(Ps,Ite,[wt,V2]);Ne(Mi,z2,[wt,Sr]);Ne("".concat(Mi,"-").concat(ml),z2,[wt,Sr]);Ne("".concat(Mi,"-").concat(So),sT,[wt,Sr,So]);Ne("".concat(Mi,"-").concat(Wf),U2,[wt,Sr]);Ne("".concat(Mi,"-").concat(Gf),Bte,[wt,Sr]);Ne("".concat(Mi,"-").concat(Kg),uT,[wt,Sr]);Ne("".concat(yl,"-").concat(ml),lT,[wt,Sr]);Ne("".concat(yl,"-").concat(So),cT,[wt,Sr,So]);Ne("".concat(yl,"-").concat(Wf),q2,[wt,Sr]);Ne("".concat(yl,"-").concat(Gf),zte,[wt,Sr]);Ne("".concat(yl,"-").concat(Kg),fT,[wt,Sr]);Ne(vl,M5,[Vf,vl]);Ne(Jg,T5,Vf);Ne(Zg,N5,Vf);Ne(Y2,gT,[Yf,Vf]);Ne(W2,t2,Yf);Ne(dT,X2,Yf);Ne(G2,Wte,Yf);function pT(e){return ae(Qg,e)}function Is(e,t){const n=Qg[e];return n&&n.metadata[t]}function K2(e){return Is(e,wt)}function bl(e){return Is(e,Yf)}function J2(e){return Is(e,Vf)}function mT(e){return Is(e,So)}function Kte(e){return Is(e,V2)}function yT(e){return Is(e,Sr)}function vT(e){return Is(e,vl)}const Jte=["clamp","base","constant","exponent"];function bT(e,t){const n=t[0],r=_e(t)-n;return function(i){return e(n+i*r)}}function ep(e,t,n){return x2(Z2(t||"rgb",n),e)}function xT(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function wT(e,t,n){const r=n-t;let i,o,a;return!r||!Number.isFinite(r)?Jt(.5):(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=Ne(o)().domain([t,n]).range([0,1]),Jte.forEach(s=>e[s]?a[s](e[s]()):0),a)}function Z2(e,t){const n=JQ[Zte(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Zte(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const Qte={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},ene={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function _T(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function ET(e,t){for(const n in e)Q2(n,t(e[n]))}const AT={};ET(ene,_T);ET(Qte,e=>ep(_T(e)));function Q2(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(AT[e]=t,this):AT[e]}const tp="symbol",tne="discrete",nne="gradient",rne=e=>Q(e)?e.map(t=>String(t)):String(e),ine=(e,t)=>e[1]-t[1],one=(e,t)=>t[1]-e[1];function ew(e,t,n){let r;return ua(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(nf(e.domain())/n||1)))),se(t)&&(r=t.step,t=t.interval),Fe(t)&&(t=e.type===Ls?el(t):e.type==Ps?tl(t):I("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function $T(e,t,n){let r=e.range(),i=r[0],o=_e(r),a=ine;if(i>o&&(r=o,o=i,i=r,a=one),i=Math.floor(i),o=Math.ceil(o),t=t.map(s=>[s,e(s)]).filter(s=>i<=s[1]&&s[1]<=o).sort(a).map(s=>s[0]),n>0&&t.length>1){const s=[t[0],_e(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=s)}return t}function tw(e,t){return e.bins?$T(e,e.bins):e.ticks?e.ticks(t):e.domain()}function ST(e,t,n,r,i,o){const a=t.type;let s=rne;if(a===Ls||i===Ls)s=e.timeFormat(r);else if(a===Ps||i===Ps)s=e.utcFormat(r);else if(mT(a)){const u=e.formatFloat(r);if(o||t.bins)s=u;else{const l=CT(t,n,!1);s=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();s=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(s=e.format(r));return s}function CT(e,t,n){const r=tw(e,t),i=e.base(),o=Math.log(i),a=Math.max(1,i*t/r.length),s=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/o));return l*i<i-.5&&(l*=i),l<=a};return n?r.filter(s):s}const nw={[vl]:"quantiles",[Jg]:"thresholds",[Zg]:"domain"},OT={[vl]:"quantiles",[Jg]:"domain"};function FT(e,t){return e.bins?une(e.bins):e.type===So?CT(e,t,!0):nw[e.type]?sne(e[nw[e.type]]()):tw(e,t)}function ane(e,t,n){const r=t[OT[t.type]](),i=r.length;let o=i>1?r[1]-r[0]:r[0],a;for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return e.formatSpan(0,o,3*10,n)}function sne(e){const t=[-1/0].concat(e);return t.max=1/0,t}function une(e){const t=e.slice(0,-1);return t.max=_e(e),t}const lne=e=>nw[e.type]||e.bins;function kT(e,t,n,r,i,o,a){const s=OT[t.type]&&o!==Ls&&o!==Ps?ane(e,t,i):ST(e,t,n,i,o,a);return r===tp&&lne(t)?cne(s):r===tne?fne(s):dne(s)}const cne=e=>(t,n,r)=>{const i=DT(r[n+1],DT(r.max,1/0)),o=MT(t,e),a=MT(i,e);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},DT=(e,t)=>e!=null?e:t,fne=e=>(t,n)=>n?e(t):null,dne=e=>t=>e(t),MT=(e,t)=>Number.isFinite(e)?t(e):null;function hne(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+_e(t),o=i-r;if(e.type===Zg){const a=n?o/n:.1;r-=a,i+=a,o=i-r}return a=>(a-r)/o}function gne(e,t,n,r){const i=r||t.type;return Fe(n)&&Kte(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Ls?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Ps?e.utcFormat("%A, %d %B %Y, %X UTC"):kT(e,t,5,null,n,r,!0)}function TT(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=gne(e,t,n.format,n.formatType);if(J2(t.type)){const o=FT(t).slice(1).map(i),a=o.length;return"".concat(a," boundar").concat(a===1?"y":"ies",": ").concat(o.join(", "))}else if(bl(t.type)){const o=t.domain(),a=o.length,s=a>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return"".concat(a," value").concat(a===1?"":"s",": ").concat(s)}else{const o=t.domain();return"values from ".concat(i(o[0])," to ").concat(i(_e(o)))}}let NT=0;function pne(){NT=0}const np="p_";function rw(e){return e&&e.gradient}function RT(e,t,n){const r=e.gradient;let i=e.id,o=r==="radial"?np:"";return i||(i=e.id="gradient_"+NT++,r==="radial"?(e.x1=Ti(e.x1,.5),e.y1=Ti(e.y1,.5),e.r1=Ti(e.r1,0),e.x2=Ti(e.x2,.5),e.y2=Ti(e.y2,.5),e.r2=Ti(e.r2,.5),o=np):(e.x1=Ti(e.x1,0),e.y1=Ti(e.y1,0),e.x2=Ti(e.x2,1),e.y2=Ti(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function Ti(e,t){return e!=null?e:t}function jT(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,o){return n.push({offset:i,color:o}),r}}}const LT={basis:{curve:YZ},"basis-closed":{curve:VZ},"basis-open":{curve:XZ},bundle:{curve:KZ,tension:"beta",value:.85},cardinal:{curve:JZ,tension:"tension",value:0},"cardinal-open":{curve:QZ,tension:"tension",value:0},"cardinal-closed":{curve:ZZ,tension:"tension",value:0},"catmull-rom":{curve:eQ,tension:"alpha",value:.5},"catmull-rom-closed":{curve:tQ,tension:"alpha",value:.5},"catmull-rom-open":{curve:nQ,tension:"alpha",value:.5},linear:{curve:Bx},"linear-closed":{curve:rQ},monotone:{horizontal:oQ,vertical:iQ},natural:{curve:aQ},step:{curve:sQ},"step-after":{curve:lQ},"step-before":{curve:uQ}};function iw(e,t,n){var r=ae(LT,e)&&LT[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const mne={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Xf=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function xl(e){const t=[];let n,r,i,o,a,s,u,l,c,f;const d=e.slice().replace(Xf[0],"###$1").split(Xf[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(Xf[2],"$1###$2").replace(Xf[3],"$1###$2").split(Xf[4]),a=n.charAt(0),i=[a],l=0,f=r.length;l<f;++l)(o=+r[l])===o&&i.push(o);if(s=mne[a.toLowerCase()],i.length-1>s){const h=i.length;for(l=1,t.push([a].concat(i.slice(l,l+=s))),a=a==="M"?"L":a==="m"?"l":a;l<h;l+=s)t.push([a].concat(i.slice(l,l+s)))}else t.push(i)}return t}const ba=Math.PI/180,yne=1e-14,Bs=Math.PI/2,Ni=Math.PI*2,wl=Math.sqrt(3)/2;var ow={},aw={},PT=[].join;function vne(e,t,n,r,i,o,a,s,u){const l=PT.call(arguments);if(ow[l])return ow[l];const c=a*ba,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(s-e)*.5+f*(u-t)*.5,g=d*(u-t)*.5-f*(s-e)*.5;let p=h*h/(n*n)+g*g/(r*r);p>1&&(p=Math.sqrt(p),n*=p,r*=p);const m=d/n,y=f/n,v=-f/r,b=d/r,x=m*s+y*u,w=v*s+b*u,E=m*e+y*t,_=v*e+b*t,$=(E-x)*(E-x)+(_-w)*(_-w);let C=1/$-.25;C<0&&(C=0);let O=Math.sqrt(C);o==i&&(O=-O);const A=.5*(x+E)-O*(_-w),D=.5*(w+_)+O*(E-x),F=Math.atan2(w-D,x-A);let S=Math.atan2(_-D,E-A)-F;S<0&&o===1?S+=Ni:S>0&&o===0&&(S-=Ni);const M=Math.ceil(Math.abs(S/(Bs+.001))),P=[];for(let B=0;B<M;++B){const H=F+B*S/M,ie=F+(B+1)*S/M;P[B]=[A,D,H,ie,n,r,f,d]}return ow[l]=P}function bne(e){const t=PT.call(e);if(aw[t])return aw[t];var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];const c=l*a,f=-u*s,d=u*a,h=l*s,g=Math.cos(i),p=Math.sin(i),m=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(v*.5),x=8/3*b*b/Math.sin(v),w=n+g-x*p,E=r+p+x*g,_=n+m,$=r+y,C=_+x*y,O=$-x*m;return aw[t]=[c*w+f*E,d*w+h*E,c*C+f*O,d*C+h*O,c*_+f*$,d*_+h*$]}const Cr=["l",0,0,0,0,0,0,0];function xne(e,t,n){const r=Cr[0]=e[0];if(r==="a"||r==="A")Cr[1]=t*e[1],Cr[2]=n*e[2],Cr[3]=e[3],Cr[4]=e[4],Cr[5]=e[5],Cr[6]=t*e[6],Cr[7]=n*e[7];else if(r==="h"||r==="H")Cr[1]=t*e[1];else if(r==="v"||r==="V")Cr[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)Cr[i]=(i%2==1?t:n)*e[i];return Cr}function Kf(e,t,n,r,i,o){var a,s=null,u=0,l=0,c=0,f=0,d,h,g,p;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),o==null&&(o=i),e.beginPath&&e.beginPath();for(var m=0,y=t.length;m<y;++m){switch(a=t[m],(i!==1||o!==1)&&(a=xne(a,i,o)),a[0]){case"l":u+=a[1],l+=a[2],e.lineTo(u+n,l+r);break;case"L":u=a[1],l=a[2],e.lineTo(u+n,l+r);break;case"h":u+=a[1],e.lineTo(u+n,l+r);break;case"H":u=a[1],e.lineTo(u+n,l+r);break;case"v":l+=a[1],e.lineTo(u+n,l+r);break;case"V":l=a[1],e.lineTo(u+n,l+r);break;case"m":u+=a[1],l+=a[2],e.moveTo(u+n,l+r);break;case"M":u=a[1],l=a[2],e.moveTo(u+n,l+r);break;case"c":d=u+a[5],h=l+a[6],c=u+a[3],f=l+a[4],e.bezierCurveTo(u+a[1]+n,l+a[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=a[5],l=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+a[3],h=l+a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+a[1]+n,l+a[2]+r,d+n,h+r),c=u+a[1],f=l+a[2],u=d,l=h;break;case"S":d=a[3],h=a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,a[1]+n,a[2]+r,d+n,h+r),u=d,l=h,c=a[1],f=a[2];break;case"q":d=u+a[3],h=l+a[4],c=u+a[1],f=l+a[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=a[3],h=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,d+n,h+r),u=d,l=h,c=a[1],f=a[2];break;case"t":d=u+a[1],h=l+a[2],s[0].match(/[QqTt]/)===null?(c=u,f=l):s[0]==="t"?(c=2*u-g,f=2*l-p):s[0]==="q"&&(c=2*u-c,f=2*l-f),g=c,p=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+a[1],f=l+a[2];break;case"T":d=a[1],h=a[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":IT(e,u+n,l+r,[a[1],a[2],a[3],a[4],a[5],a[6]+u+n,a[7]+l+r]),u+=a[6],l+=a[7];break;case"A":IT(e,u+n,l+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),u=a[6],l=a[7];break;case"z":case"Z":e.closePath();break}s=a}}function IT(e,t,n,r){const i=vne(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){const a=bne(i[o]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const BT=.5773502691896257,zT={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Ni)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=wl*n,i=r-n*BT,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=wl*n,i=r-n*BT;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=wl*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=wl*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=wl*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=wl*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function UT(e){return ae(zT,e)?zT[e]:wne(e)}var sw={};function wne(e){if(!ae(sw,e)){const t=xl(e);sw[e]={draw:function(n,r){Kf(n,t,0,0,Math.sqrt(r)/2)}}}return sw[e]}const xa=.448084975506;function _ne(e){return e.x}function Ene(e){return e.y}function Ane(e){return e.width}function $ne(e){return e.height}function Co(e){return typeof e=="function"?e:()=>+e}function rp(e,t,n){return Math.max(t,Math.min(e,n))}function qT(){var e=_ne,t=Ene,n=Ane,r=$ne,i=Co(0),o=i,a=i,s=i,u=null;function l(c,f,d){var h,g=f!=null?f:+e.call(this,c),p=d!=null?d:+t.call(this,c),m=+n.call(this,c),y=+r.call(this,c),v=Math.min(m,y)/2,b=rp(+i.call(this,c),0,v),x=rp(+o.call(this,c),0,v),w=rp(+a.call(this,c),0,v),E=rp(+s.call(this,c),0,v);if(u||(u=h=Ss()),b<=0&&x<=0&&w<=0&&E<=0)u.rect(g,p,m,y);else{var _=g+m,$=p+y;u.moveTo(g+b,p),u.lineTo(_-x,p),u.bezierCurveTo(_-xa*x,p,_,p+xa*x,_,p+x),u.lineTo(_,$-E),u.bezierCurveTo(_,$-xa*E,_-xa*E,$,_-E,$),u.lineTo(g+w,$),u.bezierCurveTo(g+xa*w,$,g,$-xa*w,g,$-w),u.lineTo(g,p+b),u.bezierCurveTo(g,p+xa*b,g+xa*b,p,g+b,p),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Co(c),l):e},l.y=function(c){return arguments.length?(t=Co(c),l):t},l.width=function(c){return arguments.length?(n=Co(c),l):n},l.height=function(c){return arguments.length?(r=Co(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=Co(c),o=f!=null?Co(f):i,s=d!=null?Co(d):i,a=h!=null?Co(h):o,l):i},l.context=function(c){return arguments.length?(u=c==null?null:c,l):u},l}function HT(){var e,t,n,r,i=null,o,a,s,u;function l(f,d,h){const g=h/2;if(o){var p=s-d,m=f-a;if(p||m){var y=Math.sqrt(p*p+m*m),v=(p/=y)*u,b=(m/=y)*u,x=Math.atan2(m,p);i.moveTo(a-v,s-b),i.lineTo(f-p*g,d-m*g),i.arc(f,d,g,x-Math.PI,x),i.lineTo(a+v,s+b),i.arc(a,s,u,x,x+Math.PI)}else i.arc(f,d,g,0,Ni);i.closePath()}else o=1;a=f,s=d,u=g}function c(f){var d,h=f.length,g,p=!1,m;for(i==null&&(i=m=Ss()),d=0;d<=h;++d)!(d<h&&r(g=f[d],d,f))===p&&(p=!p)&&(o=0),p&&l(+e(g,d,f),+t(g,d,f),+n(g,d,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function Jf(e,t){return e!=null?e:t}const Zf=e=>e.x||0,Qf=e=>e.y||0,Sne=e=>e.width||0,Cne=e=>e.height||0,One=e=>(e.x||0)+(e.width||0),Fne=e=>(e.y||0)+(e.height||0),kne=e=>e.startAngle||0,Dne=e=>e.endAngle||0,Mne=e=>e.padAngle||0,Tne=e=>e.innerRadius||0,Nne=e=>e.outerRadius||0,Rne=e=>e.cornerRadius||0,jne=e=>Jf(e.cornerRadiusTopLeft,e.cornerRadius)||0,Lne=e=>Jf(e.cornerRadiusTopRight,e.cornerRadius)||0,Pne=e=>Jf(e.cornerRadiusBottomRight,e.cornerRadius)||0,Ine=e=>Jf(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Bne=e=>Jf(e.size,64),zne=e=>e.size||1,ip=e=>e.defined!==!1,Une=e=>UT(e.shape||"circle"),qne=HZ().startAngle(kne).endAngle(Dne).padAngle(Mne).innerRadius(Tne).outerRadius(Nne).cornerRadius(Rne),Hne=cM().x(Zf).y1(Qf).y0(Fne).defined(ip),Wne=cM().y(Qf).x1(Zf).x0(One).defined(ip),Gne=lM().x(Zf).y(Qf).defined(ip),Yne=qT().x(Zf).y(Qf).width(Sne).height(Cne).cornerRadius(jne,Lne,Pne,Ine),Vne=GZ().type(Une).size(Bne),Xne=HT().x(Zf).y(Qf).defined(ip).size(zne);function uw(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Kne(e,t){return qne.context(e)(t)}function Jne(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Wne:Hne).curve(iw(r,n.orient,n.tension)).context(e)(t)}function Zne(e,t){const n=t[0],r=n.interpolate||"linear";return Gne.curve(iw(r,n.orient,n.tension)).context(e)(t)}function _l(e,t,n,r){return Yne.context(e)(t,n,r)}function Qne(e,t){return(t.mark.shape||t.shape).context(e)(t)}function ere(e,t){return Vne.context(e)(t)}function tre(e,t){return Xne.context(e)(t)}var WT=1;function GT(){WT=1}function lw(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+WT++),a=i.clipping[o]||(i.clipping[o]={id:o});return me(r)?a.path=r(null):uw(n)?a.path=_l(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function _t(e){this.clear(),e&&this.union(e)}_t.prototype={clone(){return new _t(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*a+l,u*r+s*a+c,s*o-u*i+l,u*o+s*i+c,s*o-u*a+l,u*o+s*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function op(e){this.mark=e,this.bounds=this.bounds||new _t}function ap(e){op.call(this,e),this.items=this.items||[]}q(ap,op);function cw(e){this._pending=0,this._loader=e||lg()}function YT(e){e._pending+=1}function ed(e){e._pending-=1}cw.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return YT(t),t._loader.sanitize(e,{context:"href"}).then(n=>(ed(t),n)).catch(()=>(ed(t),null))},loadImage(e){const t=this,n=cQ();return YT(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const o=new n,a=ae(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(o.crossOrigin=a),o.onload=()=>ed(t),o.onerror=()=>ed(t),o.src=i,o}).catch(r=>(ed(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function Oo(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?nre(t,r):0))}return e}function nre(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const rre=Ni-1e-8;let sp,up,lp,zs,fw,cp,dw,hw;const wa=(e,t)=>sp.add(e,t),fp=(e,t)=>wa(up=e,lp=t),VT=e=>wa(e,sp.y1),XT=e=>wa(sp.x1,e),Us=(e,t)=>fw*e+dw*t,qs=(e,t)=>cp*e+hw*t,gw=(e,t)=>wa(Us(e,t),qs(e,t)),pw=(e,t)=>fp(Us(e,t),qs(e,t));function td(e,t){return sp=e,t?(zs=t*ba,fw=hw=Math.cos(zs),cp=Math.sin(zs),dw=-cp):(fw=hw=1,zs=cp=dw=0),ire}const ire={beginPath(){},closePath(){},moveTo:pw,lineTo:pw,rect(e,t,n,r){zs?(gw(e+n,t),gw(e+n,t+r),gw(e,t+r),pw(e,t)):(wa(e+n,t+r),fp(e,t))},quadraticCurveTo(e,t,n,r){const i=Us(e,t),o=qs(e,t),a=Us(n,r),s=qs(n,r);KT(up,i,a,VT),KT(lp,o,s,XT),fp(a,s)},bezierCurveTo(e,t,n,r,i,o){const a=Us(e,t),s=qs(e,t),u=Us(n,r),l=qs(n,r),c=Us(i,o),f=qs(i,o);JT(up,a,u,c,VT),JT(lp,s,l,f,XT),fp(c,f)},arc(e,t,n,r,i,o){if(r+=zs,i+=zs,up=n*Math.cos(i)+e,lp=n*Math.sin(i)+t,Math.abs(i-r)>rre)wa(e-n,t-n),wa(e+n,t+n);else{const a=l=>wa(n*Math.cos(l)+e,n*Math.sin(l)+t);let s,u;if(a(r),a(i),i!==r)if(r=r%Ni,r<0&&(r+=Ni),i=i%Ni,i<0&&(i+=Ni),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=Ni,s=r-r%Bs,u=0;u<4&&s>i;++u,s-=Bs)a(s);else for(s=r-r%Bs+Bs,u=0;u<4&&s<i;++u,s=s+Bs)a(s)}}};function KT(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function JT(e,t,n,r,i){const o=r-e+3*t-3*n,a=e+n-2*t,s=e-t;let u=0,l=0,c;Math.abs(o)>yne?(c=a*a+s*o,c>=0&&(c=Math.sqrt(c),u=(-a+c)/o,l=(-a-c)/o)):u=.5*s/a,0<u&&u<1&&i(ZT(u,e,t,n,r)),0<l&&l<1&&i(ZT(l,e,t,n,r))}function ZT(e,t,n,r,i){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*r+s*e*i}var _a=(_a=ll(1,1))?_a.getContext("2d"):null;const mw=new _t;function yw(e){return function(t,n){if(!_a)return!0;e(_a,t),mw.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=mw;for(let s=i;s<=a;++s)for(let u=r;u<=o;++u)if(_a.isPointInPath(u,s))return!0;return!1}}function vw(e,t){return t.contains(e.x||0,e.y||0)}function QT(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(mw.set(n,r,n+i,r+o))}function e6(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:r;return El(t,n,r,i,o)}function El(e,t,n,r,i){const{x1:o,y1:a,x2:s,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,g,p,m;for(m=0;m<4;++m){if(m===0&&(h=-l,g=-(o-t)),m===1&&(h=l,g=s-t),m===2&&(h=-c,g=-(a-n)),m===3&&(h=c,g=u-n),Math.abs(h)<1e-10&&g<0)return!1;if(p=g/h,h<0){if(p>d)return!1;p>f&&(f=p)}else if(h>0){if(p<f)return!1;p<d&&(d=p)}}return!0}function Al(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Kr(e,t){return e==null?t:e}function t6(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function ore(e,t,n){const r=n.width(),i=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+Kr(t.x1,.5)*r,n.y1+Kr(t.y1,.5)*i,Math.max(r,i)*Kr(t.r1,0),n.x1+Kr(t.x2,.5)*r,n.y1+Kr(t.y2,.5)*i,Math.max(r,i)*Kr(t.r2,.5));else{const a=Kr(t.x1,0),s=Kr(t.y1,0),u=Kr(t.x2,1),l=Kr(t.y2,0);if(a===u||s===l||r===i)o=e.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+u*r,n.y1+l*i);else{const c=ll(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=t6(f.createLinearGradient(a,s,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return t6(o,t.stops)}function n6(e,t,n){return rw(n)?ore(e,n,t.bounds):n}function dp(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=n6(e,t,t.fill),!0):!1}var are=[];function $l(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=n6(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||are),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function sre(e,t){return e.zindex-t.zindex||e.index-t.index}function bw(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,o;for(i=0,o=t.length;i<o;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(sre)}function Jr(e,t){var n=e.items,r,i;if(!n||!n.length)return;const o=bw(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function hp(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const o=bw(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function xw(e){return function(t,n,r){Jr(n,i=>{(!r||r.intersects(i.bounds))&&r6(e,t,i,i)})}}function ure(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&r6(e,t,n.items[0],n.items)}}function r6(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Al(t,n),n.fill&&dp(t,n,i)&&t.fill(),n.stroke&&$l(t,n,i)&&t.stroke()))}function gp(e){return e=e||_r,function(t,n,r,i,o,a){return r*=t.pixelRatio,i*=t.pixelRatio,hp(n,s=>{const u=s.bounds;if(!(u&&!u.contains(o,a)||!u)&&e(t,s,r,i,o,a))return s})}}function nd(e,t){return function(n,r,i,o){var a=Array.isArray(r)?r[0]:r,s=t==null?a.fill:t,u=a.stroke&&n.isPointInStroke,l,c;return u&&(l=a.strokeWidth,c=a.strokeCap,n.lineWidth=l!=null?l:1,n.lineCap=c!=null?c:"butt"),e(n,r)?!1:s&&n.isPointInPath(i,o)||u&&n.isPointInStroke(i,o)}}function ww(e){return gp(nd(e))}function Hs(e,t){return"translate("+e+","+t+")"}function _w(e){return"rotate("+e+")"}function lre(e,t){return"scale("+e+","+t+")"}function i6(e){return Hs(e.x||0,e.y||0)}function cre(e){return Hs(e.x||0,e.y||0)+(e.angle?" "+_w(e.angle):"")}function fre(e){return Hs(e.x||0,e.y||0)+(e.angle?" "+_w(e.angle):"")+(e.scaleX||e.scaleY?" "+lre(e.scaleX||1,e.scaleY||1):"")}function Ew(e,t,n){function r(a,s){a("transform",cre(s)),a("d",t(null,s))}function i(a,s){return t(td(a,s.angle),s),Oo(a,s).translate(s.x||0,s.y||0)}function o(a,s){var u=s.x||0,l=s.y||0,c=s.angle||0;a.translate(u,l),c&&a.rotate(c*=ba),a.beginPath(),t(a,s),c&&a.rotate(-c),a.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:xw(o),pick:ww(o),isect:n||yw(o)}}var dre=Ew("arc",Kne);function hre(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,o=1/0,a,s;--i>=0;)e[i].defined!==!1&&(s=Math.abs(e[i][r]-n),s<o&&(o=s,a=e[i]));return a}function gre(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,o,a;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],o=e[r].y-t[1],a=i*i+o*o,a<n))return e[r];return null}function pre(e,t){for(var n=e.length,r,i,o;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],o=r*r+i*i,r=e[n].size||1,o<r*r))return e[n];return null}function Aw(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(td(u),c),Oo(u,c[0]))}function o(u,l){u.beginPath(),t(u,l)}const a=nd(o);function s(u,l,c,f,d,h){var g=l.items,p=l.bounds;return!g||!g.length||p&&!p.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,a(u,g,c,f)?g[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:ure(o),pick:s,isect:vw,tip:n}}var mre=Aw("area",Jne,hre);function yre(e,t){var n=t.clip;e.save(),me(n)?(e.beginPath(),n(e),e.clip()):o6(e,t.group)}function o6(e,t){e.beginPath(),uw(t)?_l(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function a6(e){const t=Kr(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function vre(e,t){e("transform",i6(t))}function s6(e,t){const n=a6(t);e("d",_l(null,t,n,n))}function bre(e,t){e("class","background"),e("aria-hidden",!0),s6(e,t)}function xre(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?s6(e,t):e("d","")}function wre(e,t,n){const r=t.clip?lw(n,t,t):null;e("clip-path",r)}function _re(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Oo(e,t),e.translate(t.x||0,t.y||0)}function rd(e,t,n,r){const i=a6(t);e.beginPath(),_l(e,t,(n||0)+i,(r||0)+i)}const Ere=nd(rd),Are=nd(rd,!1),$re=nd(rd,!0);function Sre(e,t,n){Jr(t,r=>{const i=r.x||0,o=r.y||0,a=r.strokeForeground,s=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&s&&(rd(e,r,i,o),Al(e,r),r.fill&&dp(e,r,s)&&e.fill(),r.stroke&&!a&&$l(e,r,s)&&e.stroke()),e.save(),e.translate(i,o),r.clip&&o6(e,r),n&&n.translate(-i,-o),Jr(r,u=>{this.draw(e,u,n)}),n&&n.translate(i,o),e.restore(),a&&r.stroke&&s&&(rd(e,r,i,o),Al(e,r),$l(e,r,s)&&e.stroke())})}function Cre(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const a=n*e.pixelRatio,s=r*e.pixelRatio;return hp(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),g=f+(u.height||0),p=u.clip;if(p&&(i<c||i>h||o<f||o>g))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,p&&uw(u)&&!$re(e,u,a,s))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&Are(e,u,a,s)?(e.restore(),u):(l=hp(u,v=>Ore(v,c,f)?this.pick(v,n,r,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&Ere(e,u,a,s)&&(l=u),e.restore(),l||null)})}function Ore(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Fre={type:"group",tag:"g",nested:!1,attr:vre,bound:_re,draw:Sre,pick:Cre,isect:QT,content:wre,background:bre,foreground:xre},id={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function $w(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function Sw(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Cw(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function pp(e,t){return e==="center"?t/2:e==="right"?t:0}function mp(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function kre(e,t,n){const r=$w(t,n),i=Sw(t,r),o=Cw(t,r),a=(t.x||0)-pp(t.align,i),s=(t.y||0)-mp(t.baseline,o),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,id["xmlns:xlink"],"xlink:href"),e("transform",Hs(a,s)),e("width",i),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function Dre(e,t){const n=t.image,r=Sw(t,n),i=Cw(t,n),o=(t.x||0)-pp(t.align,r),a=(t.y||0)-mp(t.baseline,i);return e.set(o,a,o+r,a+i)}function Mre(e,t,n){Jr(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=$w(r,this);let o=Sw(r,i),a=Cw(r,i);if(o===0||a===0)return;let s=(r.x||0)-pp(r.align,o),u=(r.y||0)-mp(r.baseline,a),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,u+=(a-d)/2,a=d):(d=a*c,s+=(o-d)/2,o=d))),(i.complete||i.toDataURL)&&(Al(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,s,u,o,a))})}var Tre={type:"image",tag:"image",nested:!1,attr:kre,bound:Dre,draw:Mre,pick:gp(),isect:_r,get:$w,xOffset:pp,yOffset:mp},Nre=Aw("line",Zne,gre);function Rre(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",fre(t)),e("d",t.path)}function yp(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*ba,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=xl(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),Kf(e,u,0,0,o,a),e.rotate(-s),e.translate(-r,-i)):Kf(e,u,r,i,o,a)}function jre(e,t){return yp(td(e,t.angle),t)?e.set(0,0,0,0):Oo(e,t,!0)}var Lre={type:"path",tag:"path",nested:!1,attr:Rre,bound:jre,draw:xw(yp),pick:ww(yp),isect:yw(yp)};function Pre(e,t){e("d",_l(null,t))}function Ire(e,t){var n,r;return Oo(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function u6(e,t){e.beginPath(),_l(e,t)}var Bre={type:"rect",tag:"path",nested:!1,attr:Pre,bound:Ire,draw:xw(u6),pick:ww(u6),isect:QT};function zre(e,t){e("transform",i6(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Ure(e,t){var n,r;return Oo(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function l6(e,t,n){var r,i,o,a;return t.stroke&&$l(e,t,n)?(r=t.x||0,i=t.y||0,o=t.x2!=null?t.x2:r,a=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,a),!0):!1}function qre(e,t,n){Jr(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&l6(e,r,i)&&(Al(e,r),e.stroke())}})}function Hre(e,t,n,r){return e.isPointInStroke?l6(e,t,1)&&e.isPointInStroke(n,r):!1}var Wre={type:"rule",tag:"line",nested:!1,attr:zre,bound:Ure,draw:qre,pick:gp(Hre),isect:e6},Gre=Ew("shape",Qne),Yre=Ew("symbol",ere,vw);const c6=fF();var Ri={height:ji,measureWidth:Fw,estimateWidth:Ow,width:Ow,canvas:f6};f6(!0);function f6(e){Ri.width=e&&_a?Fw:Ow}function Ow(e,t){return d6(Aa(e,t),ji(e))}function d6(e,t){return~~(.8*e.length*t)}function Fw(e,t){return ji(e)<=0||!(t=Aa(e,t))?0:h6(t,vp(e))}function h6(e,t){const n=`(${t}) ${e}`;let r=c6.get(n);return r===void 0&&(_a.font=t,r=_a.measureText(e).width,c6.set(n,r)),r}function ji(e){return e.fontSize!=null?+e.fontSize||0:11}function Ea(e){return e.lineHeight!=null?e.lineHeight:ji(e)+2}function Vre(e){return Q(e)?e.length>1?e:e[0]:e}function od(e){return Vre(e.lineBreak&&e.text&&!Q(e.text)?e.text.split(e.lineBreak):e.text)}function kw(e){const t=od(e);return(Q(t)?t.length-1:0)*Ea(e)}function Aa(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Kre(e,n):n}function Xre(e){if(Ri.width===Fw){const t=vp(e);return n=>h6(n,t)}else{const t=ji(e);return n=>d6(n,t)}}function Kre(e,t){var n=+e.limit,r=Xre(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",o=e.dir==="rtl",a=0,s=t.length,u;if(n-=r(i),o){for(;a<s;)u=a+s>>>1,r(t.slice(u))>n?a=u+1:s=u;return i+t.slice(a)}else{for(;a<s;)u=1+(a+s>>>1),r(t.slice(0,u))<n?a=u:s=u-1;return t.slice(0,a)+i}}function ad(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function vp(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+ji(e)+"px "+ad(e,t)}function Dw(e){var t=e.baseline,n=ji(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Ea(e):t==="line-bottom"?.29*n-.5*Ea(e):0)}const Jre={left:"start",center:"middle",right:"end"},sd=new _t;function bp(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-Bs,t+=r*Math.cos(i),n+=r*Math.sin(i)),sd.x1=t,sd.y1=n,sd}function Zre(e,t){var n=t.dx||0,r=(t.dy||0)+Dw(t),i=bp(t),o=i.x1,a=i.y1,s=t.angle||0,u;e("text-anchor",Jre[t.align]||"start"),s?(u=Hs(o,a)+" "+_w(s),(n||r)&&(u+=" "+Hs(n,r))):u=Hs(o+n,a+r),e("transform",u)}function Mw(e,t,n){var r=Ri.height(t),i=t.align,o=bp(t),a=o.x1,s=o.y1,u=t.dx||0,l=(t.dy||0)+Dw(t)-Math.round(.8*r),c=od(t),f;if(Q(c)?(r+=Ea(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Ri.width(t,h)),0)):f=Ri.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=a,l+=s,u+f,l+r),t.angle&&!n)e.rotate(t.angle*ba,a,s);else if(n===2)return e.rotatedPoints(t.angle*ba,a,s);return e}function Qre(e,t,n){Jr(t,r=>{var i=r.opacity==null?1:r.opacity,o,a,s,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=vp(r),e.textAlign=r.align||"left",o=bp(r),a=o.x1,s=o.y1,r.angle&&(e.save(),e.translate(a,s),e.rotate(r.angle*ba),a=s=0),a+=r.dx||0,s+=(r.dy||0)+Dw(r),c=od(r),Al(e,r),Q(c))for(l=Ea(r),u=0;u<c.length;++u)f=Aa(r,c[u]),r.fill&&dp(e,r,i)&&e.fillText(f,a,s),r.stroke&&$l(e,r,i)&&e.strokeText(f,a,s),s+=l;else f=Aa(r,c),r.fill&&dp(e,r,i)&&e.fillText(f,a,s),r.stroke&&$l(e,r,i)&&e.strokeText(f,a,s);r.angle&&e.restore()}})}function eie(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=bp(t),s=a.x1,u=a.y1,l=Mw(sd,t,1),c=-t.angle*ba,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(s-f*s+d*u),g=d*i+f*o+(u-d*s-f*u);return l.contains(h,g)}function tie(e,t){const n=Mw(sd,e,2);return El(t,n[0],n[1],n[2],n[3])||El(t,n[0],n[1],n[4],n[5])||El(t,n[4],n[5],n[6],n[7])||El(t,n[2],n[3],n[6],n[7])}var nie={type:"text",tag:"text",nested:!1,attr:Zre,bound:Mw,draw:Qre,pick:gp(eie),isect:tie},rie=Aw("trail",tre,pre),ur={arc:dre,area:mre,group:Fre,image:Tre,line:Nre,path:Lre,rect:Bre,rule:Wre,shape:Gre,symbol:Yre,text:nie,trail:rie};function Tw(e,t,n){var r=ur[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new _t),e,n)}var g6={mark:null};function p6(e,t,n){var r=ur[e.marktype],i=r.bound,o=e.items,a=o&&o.length,s,u,l,c;if(r.nested)return a?l=o[0]:(g6.mark=e,l=g6),c=Tw(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new _t,a)for(s=0,u=o.length;s<u;++s)t.union(Tw(o[s],i,n));return e.bounds=t}const iie=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function m6(e,t){return JSON.stringify(e,iie,t)}function y6(e){const t=typeof e=="string"?JSON.parse(e):e;return v6(t)}function v6(e){var t=e.marktype,n=e.items,r,i,o;if(n)for(i=0,o=n.length;i<o;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&v6(n[i]);return t&&p6(e),e}function Nw(e){arguments.length?this.root=y6(e):(this.root=b6({marktype:"group",name:"root",role:"frame"}),this.root.items=[new ap(this.root)])}Nw.prototype={toJSON(e){return m6(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=b6(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function b6(e,t){const n={bounds:new _t,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function $a(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Rw(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Un(e,t,n,r){var i=e.childNodes[t],o;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=$a(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function Zr(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function x6(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function xp(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function oie(e,t,n,r){var i=e&&e.mark,o,a;if(i&&(o=ur[i.marktype]).tip){for(a=xp(t,n),a[0]-=r[0],a[1]-=r[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=o.tip(i.items,a)}return e}function Sa(e,t){this._active=null,this._handlers={},this._loader=e||lg(),this._tooltip=t||aie}function aie(e,t,n,r){e.element().setAttribute("title",r||"")}Sa.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),o=$a(null,"a");for(const a in r)o.setAttribute(a,r[a]);o.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=oie(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}}};function Li(e){this._el=null,this._bgcolor=null,this._loader=new cw(e)}Li.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(o=>{o&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const sie="keydown",uie="keypress",lie="keyup",w6="dragenter",wp="dragleave",_6="dragover",jw="mousedown",cie="mouseup",_p="mousemove",ud="mouseout",E6="mouseover",Ep="click",fie="dblclick",die="wheel",A6="mousewheel",Ap="touchstart",$p="touchmove",Sp="touchend",hie=[sie,uie,lie,w6,wp,_6,jw,cie,_p,ud,E6,Ep,fie,die,A6,Ap,$p,Sp],Lw=_p,ld=ud,Pw=Ep;function cd(e,t){Sa.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const gie=e=>e===Ap||e===$p||e===Sp?[Ap,$p,Sp]:[e];function $6(e,t){gie(t).forEach(n=>pie(e,n))}function pie(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function S6(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=o,this.fire(t,r),this.fire(e,r))}}function C6(e){return function(t){this.fire(e,t),this._active=null}}q(cd,Sa,{initialize(e,t,n){return this._canvas=e&&Rw(e,"canvas"),[Ep,jw,_p,ud,wp].forEach(r=>$6(this,r)),Sa.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:hie,DOMMouseScroll(e){this.fire(A6,e)},mousemove:S6(_p,E6,ud),dragover:S6(_6,w6,wp),mouseout:C6(ud),dragleave:C6(wp),mousedown(e){this._down=this._active,this.fire(jw,e)},click(e){this._down===this._active&&(this.fire(Ep,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Ap,e,!0)},touchmove(e){this.fire($p,e,!0)},touchend(e){this.fire(Sp,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===Pw&&r&&r.href?this.handleHref(t,r,r.href):(e===Lw||e===ld)&&this.handleTooltip(t,r,e!==ld),i)for(let o=0,a=i.length;o<a;++o)i[o].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&($6(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=xp(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const o=this.context();return ur[e.marktype].pick.call(this,o,e,t,n,r,i)}});function mie(){return typeof window!="undefined"&&window.devicePixelRatio||1}var yie=mie();function vie(e,t,n,r,i,o){const a=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,s=e.getContext("2d"),u=a?yie:i;e.width=t*u,e.height=n*u;for(const l in o)s[l]=o[l];return a&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1]),e}function Cp(e){Li.call(this,e),this._options={},this._redraw=!1,this._dirty=new _t,this._tempb=new _t}const O6=Li.prototype,bie=(e,t,n)=>new _t().set(0,0,t,n).translate(-e[0],-e[1]);function xie(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}q(Cp,Li,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:ll(1,1,this._options.type),e&&this._canvas&&(Zr(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),O6.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(O6.resize.call(this,e,t,n,r),this._canvas)vie(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||I("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=bie(n,r,i);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):xie(t,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),o.clear(),this},draw(e,t,n){const r=ur[t.marktype];t.clip&&yre(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,o=this.context();i.type!=="pdf"&&!i.externalContext&&o.clearRect(e,t,n,r),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});function Iw(e,t){Sa.call(this,e,t);const n=this;n._hrefHandler=Bw(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=Bw(n,(r,i)=>{n.handleTooltip(r,i,r.type!==ld)})}const Bw=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};q(Iw,Sa,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(Pw,this._hrefHandler),r.removeEventListener(Lw,this._tooltipHandler),r.removeEventListener(ld,this._tooltipHandler)),this._svg=r=e&&Rw(e,"svg"),r&&(r.addEventListener(Pw,this._hrefHandler),r.addEventListener(Lw,this._tooltipHandler),r.addEventListener(ld,this._tooltipHandler)),Sa.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const o={type:e,handler:t,listener:Bw(this,t)};(r[n]||(r[n]=[])).push(o),this._svg&&this._svg.addEventListener(n,o.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const F6="aria-hidden",zw="aria-label",Uw="role",qw="aria-roledescription",k6="graphics-object",Hw="graphics-symbol",D6=(e,t,n)=>({[Uw]:e,[qw]:t,[zw]:n||void 0}),wie=Yr(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),M6={axis:{desc:"axis",caption:Aie},legend:{desc:"legend",caption:$ie},"title-text":{desc:"title",caption:e=>`Title text '${j6(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${j6(e)}'`}},T6={ariaRole:Uw,ariaRoleDescription:qw,description:zw};function N6(e,t){const n=t.aria===!1;if(e(F6,n||void 0),n||t.description==null)for(const r in T6)e(T6[r],void 0);else{const r=t.mark.marktype;e(zw,t.description),e(Uw,t.ariaRole||(r==="group"?k6:Hw)),e(qw,t.ariaRoleDescription||`${r} mark`)}}function R6(e){return e.aria===!1?{[F6]:!0}:wie[e.role]?null:M6[e.role]?Eie(e,M6[e.role]):_ie(e)}function _ie(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return D6(n?k6:Hw,`${t} mark container`,e.description)}function Eie(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return D6(t.role||Hw,t.desc,n.description||r(n))}catch(n){return null}}function j6(e){return oe(e.text).join(" ")}function Aie(e){const t=e.datum,n=e.orient,r=t.title?L6(e):null,i=e.context,o=i.scales[t.scale].value,a=i.dataflow.locale(),s=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${bl(s)?"discrete":s} scale with ${TT(a,o,e)}`}function $ie(e){const t=e.datum,n=t.title?L6(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),a=e.context,s=a.scales[i[o[0]]].value,u=a.dataflow.locale();return Cie(r)+(n?` titled '${n}'`:"")+` for ${Sie(o)} with ${TT(u,s,e)}`}function L6(e){try{return oe(_e(e.items).items[0].text).join(" ")}catch(t){return null}}function Sie(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+_e(e)}function Cie(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const P6=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Oie=e=>P6(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Ww(){let e="",t="",n="";const r=[],i=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},a=(u,l)=>(l!=null&&(t+=` ${u}="${Oie(l)}"`),s),s={open(u,...l){o(u),t="<"+u;for(const c of l)for(const f in c)a(f,c[f]);return s},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),s},attr:a,text:u=>(n+=P6(u),s),toString:()=>e};return s}const I6=e=>B6(Ww(),e)+"";function B6(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const o=n[i];o.nodeType===3?e.text(o.nodeValue):B6(e,o)}}return e.close()}const Op={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},z6={fill:"none","stroke-miterlimit":10},fd=0,U6="http://www.w3.org/2000/xmlns/",Et=id.xmlns;function Gw(e){Li.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const Yw=Li.prototype;q(Gw,Li,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Un(e,0,"svg",Et),this._svg.setAttributeNS(U6,"xmlns",Et),this._svg.setAttributeNS(U6,"xmlns:xlink",id["xmlns:xlink"]),this._svg.setAttribute("version",id.version),this._svg.setAttribute("class","marks"),Zr(e,1),this._root=Un(this._svg,fd,"g",Et),Ca(this._root,z6),Zr(this._svg,fd+1)),this.background(this._bgcolor),Yw.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),Yw.background.apply(this,arguments)},resize(e,t,n,r){return Yw.resize.call(this,e,t,n,r),this._svg&&(Ca(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Un(e,fd,"rect",Et),Ca(n,{width:this._width,height:this._height,fill:t}));const r=I6(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Zr(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,a,s,u;for(a=0,s=e.length;a<s;++a)if(n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=ur[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,q6(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=o.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,q6(n,t)):this._update(o,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=ur[t.marktype],o=t.interactive===!1?"none":null,a=i.tag==="g";let s=null,u=0;const l=H6(t,e,n,"g",r);l.setAttribute("class",x6(t));const c=R6(t);for(const d in c)vn(l,d,c[d]);a||vn(l,"pointer-events",o),vn(l,"clip-path",t.clip?lw(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),g=H6(d,l,s,i.tag,r);h&&(this._update(i,g,d),a&&Die(this,g,d)),s=g,++u};return i.nested?t.items.length&&f(t.items[0]):Jr(t,f),Zr(l,u),l},_update(e,t,n){Fo=t,nn=t.__values__,N6(dd,n),e.attr(dd,n,this);const r=Tie[e.type];r&&r.call(this,e,t,n),Fo&&this.style(Fo,n)},style(e,t){if(t!=null)for(const n in Op){let r=n==="font"?ad(t):t[n];if(r===nn[n])continue;const i=Op[n];r==null?e.removeAttribute(i):(rw(r)&&(r=RT(r,this._defs.gradient,W6())),e.setAttribute(i,r+"")),nn[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Un(e,fd+1,"defs",Et)),r=Fie(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Un(e,fd+1,"defs",Et)),r=kie(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):Zr(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function q6(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function Fie(e,t,n){let r,i,o;if(t.gradient==="radial"){let a=Un(e,n++,"pattern",Et);Ca(a,{id:np+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Un(a,0,"rect",Et),Ca(a,{width:1,height:1,fill:`url(${W6()}#${t.id})`}),e=Un(e,n++,"radialGradient",Et),Ca(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Un(e,n++,"linearGradient",Et),Ca(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=Un(e,r,"stop",Et),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return Zr(e,r),n}function kie(e,t,n){let r;return e=Un(e,n,"clipPath",Et),e.setAttribute("id",t.id),t.path?(r=Un(e,0,"path",Et),r.setAttribute("d",t.path)):(r=Un(e,0,"rect",Et),Ca(r,{x:0,y:0,width:t.width,height:t.height})),Zr(e,1),n+1}function Die(e,t,n){t=t.lastChild.previousSibling;let r,i=0;Jr(n,o=>{r=e.mark(t,o,r),++i}),Zr(t,1+i)}function H6(e,t,n,r,i){let o=e._svg,a;if(!o&&(a=t.ownerDocument,o=$a(a,r,Et),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){const s=$a(a,"path",Et);o.appendChild(s),s.__data__=e;const u=$a(a,"g",Et);o.appendChild(u),u.__data__=e;const l=$a(a,"path",Et);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==i||Mie(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function Mie(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Fo=null,nn=null;const Tie={group(e,t,n){const r=Fo=t.childNodes[2];nn=r.__values__,e.foreground(dd,n,this),nn=t.__values__,Fo=t.childNodes[1],e.content(dd,n,this);const i=Fo=t.childNodes[0];e.background(dd,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==nn.events&&(vn(r,"pointer-events",o),vn(i,"pointer-events",o),nn.events=o),n.strokeForeground&&n.stroke){const a=n.fill;vn(r,"display",null),this.style(i,n),vn(i,"stroke",null),a&&(n.fill=null),nn=r.__values__,this.style(r,n),a&&(n.fill=a),Fo=null}else vn(r,"display","none")},image(e,t,n){n.smooth===!1?(Vw(t,"image-rendering","optimizeSpeed"),Vw(t,"image-rendering","pixelated")):Vw(t,"image-rendering",null)},text(e,t,n){const r=od(n);let i,o,a,s;Q(r)?(o=r.map(u=>Aa(n,u)),i=o.join(`
`),i!==nn.text&&(Zr(t,0),a=t.ownerDocument,s=Ea(n),o.forEach((u,l)=>{const c=$a(a,"tspan",Et);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",s)),t.appendChild(c)}),nn.text=i)):(o=Aa(n,r),o!==nn.text&&(t.textContent=o,nn.text=o)),vn(t,"font-family",ad(n)),vn(t,"font-size",ji(n)+"px"),vn(t,"font-style",n.fontStyle),vn(t,"font-variant",n.fontVariant),vn(t,"font-weight",n.fontWeight)}};function dd(e,t,n){t!==nn[e]&&(n?Nie(Fo,e,t,n):vn(Fo,e,t),nn[e]=t)}function Vw(e,t,n){n!==nn[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),nn[t]=n)}function Ca(e,t){for(const n in t)vn(e,n,t[n])}function vn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Nie(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function W6(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Xw(e){Li.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}q(Xw,Li,{svg(){return this._text},_render(e){const t=Ww();t.open("svg",ge({},id,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",z6,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=ur[t.marktype],r=n.tag,i=[N6,n.attr];e.open("g",{class:x6(t),"clip-path":t.clip?lw(this,t,t.group):null},R6(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const o=a=>{const s=this.href(a);if(s&&e.open("a",s),e.open(r,this.attr(t,a,i,r!=="g"?r:null)),r==="text"){const u=od(a);if(Q(u)){const l={x:0,dy:Ea(a)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Aa(a,u[c])).close()}else e.text(Aa(a,u))}else if(r==="g"){const u=a.strokeForeground,l=a.fill,c=a.stroke;u&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),Jr(a,f=>this.mark(e,f)),e.close(),u&&c?(l&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),l&&(a.fill=l)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):Jr(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},o=(a,s,u,l)=>{i[l||a]=s};return Array.isArray(n)?n.forEach(a=>a(o,t,this)):n(o,t,this),r&&Rie(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const o=t[i],a=o.stops;o.gradient==="radial"?(e.open("pattern",{id:np+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:i,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let s=0;s<a.length;++s)e.open("stop",{offset:a[s].offset,"stop-color":a[s].color}).close();e.close()}for(const i in n){const o=n[i];e.open("clipPath",{id:i}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});function Rie(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=ad(t),e["font-size"]=ji(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in Op){let a=t[o];const s=Op[o];a==="transparent"&&(s==="fill"||s==="stroke")||a!=null&&(rw(a)&&(a=RT(a,i.gradient,"")),e[s]=a)}return e}const G6="canvas",Y6="png",V6="svg",X6="none",Oa={Canvas:G6,PNG:Y6,SVG:V6,None:X6},Sl={};Sl[G6]=Sl[Y6]={renderer:Cp,headless:Cp,handler:cd};Sl[V6]={renderer:Gw,headless:Xw,handler:Iw};Sl[X6]={};function Fp(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Sl[e]=t,this):Sl[e]}function K6(e,t,n){const r=[],i=new _t().union(t),o=e.marktype;return o?J6(e,i,n,r):o==="group"?Z6(e,i,n,r):I("Intersect scene must be mark node or group item.")}function J6(e,t,n,r){if(jie(e,t,n)){const i=e.items,o=e.marktype,a=i.length;let s=0;if(o==="group")for(;s<a;++s)Z6(i[s],t,n,r);else for(const u=ur[o].isect;s<a;++s){const l=i[s];Q6(l,t,u)&&r.push(l)}}return r}function jie(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function Z6(e,t,n,r){n&&n(e.mark)&&Q6(e,t,ur.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let u=0;u<o;++u)J6(i[u],t,n,r);t.translate(a,s)}return r}function Q6(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const Kw=new _t;function e8(e){const t=e.clip;if(me(t))t(td(Kw.clear()));else if(t)Kw.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(Kw)}const Lie=1e-9;function Jw(e,t,n){return e===t?!0:n==="path"?t8(e,t):e instanceof Date&&t instanceof Date?+e==+t:ua(e)&&ua(t)?Math.abs(e-t)<=Lie:!e||!t||!se(e)&&!se(t)?e==t:Pie(e,t)}function t8(e,t){return Jw(xl(e),xl(t))}function Pie(e,t){var n=Object.keys(e),r=Object.keys(t),i,o;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),o=n.length-1;o>=0;o--)if(n[o]!=r[o])return!1;for(o=n.length-1;o>=0;o--)if(i=n[o],!Jw(e[i],t[i],i))return!1;return typeof e==typeof t}function Iie(){GT(),pne()}const Cl="top",Qr="left",ei="right",Fa="bottom",Bie="top-left",zie="top-right",Uie="bottom-left",qie="bottom-right",Zw="start",Qw="middle",bn="end",Hie="x",Wie="y",kp="group",e_="axis",t_="title",Gie="frame",Yie="scope",n_="legend",n8="row-header",r8="row-footer",i8="row-title",o8="column-header",a8="column-footer",s8="column-title",Vie="padding",Xie="symbol",u8="fit",Kie="fit-x",Jie="fit-y",Zie="pad",r_="none",Dp="all",i_="each",o_="flush",ka="column",Da="row";function l8(e){N.call(this,null,e)}q(l8,N,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=ur[i],a=o.bound;let s=r.bounds,u;if(o.nested)r.items.length&&n.dirty(r.items[0]),s=Mp(r,a),r.items.forEach(l=>{l.bounds.clear().union(s)});else if(i===kp||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),s.clear(),r.items.forEach(l=>s.union(Mp(l,a))),r.role){case e_:case n_:case t_:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{s.union(Mp(l,a))}),t.visit(t.MOD,l=>{u=u||s.alignsWith(l.bounds),n.dirty(l),s.union(Mp(l,a))}),u&&(s.clear(),r.items.forEach(l=>s.union(l.bounds)));return e8(r),t.modifies("bounds")}});function Mp(e,t,n){return t(e.bounds.clear(),e,n)}const c8=":vega_identifier:";function a_(e){N.call(this,0,e)}a_.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};q(a_,N,{transform(e,t){const n=Qie(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,o=>o[r]=o[r]||++i),n.set(this.value=i),t}});function Qie(e){return e._signals[c8]||(e._signals[c8]=e.add(0))}function f8(e){N.call(this,null,e)}q(f8,N,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,eoe(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===kp?ap:op;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function eoe(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function d8(e){N.call(this,null,e)}const h8={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!g8(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},g8=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),p8=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,o;n<r;i=o,++n)if(g8(i,o=e[n].bounds,t))return!0},toe=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},noe=(e,t,n)=>{var r=e.range(),i=new _t;return t===Cl||t===Fa?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),o=>i.encloses(o.bounds)},m8=e=>(e.forEach(t=>t.opacity=1),e),y8=(e,t)=>e.reflow(t.modified()).modifies("opacity");q(d8,N,{transform(e,t){const n=h8[e.method]||h8.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,o,a;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(m8(i),t=y8(t,e)),t;if(i=i.filter(toe),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),o=m8(i),t=y8(t,e),o.length>=3&&p8(o,r)){do o=n(o,r);while(o.length>=3&&p8(o,r));o.length<3&&!_e(i).opacity&&(o.length>1&&(_e(o).opacity=0),_e(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(a=noe(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{a(u)||(u.opacity=0)}));const s=o[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&s.union(u.bounds)}),t}});function v8(e){N.call(this,null,e)}q(v8,N,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const rn=new _t;function Ol(e,t,n){return e[t]===n?0:(e[t]=n,1)}function roe(e){var t=e.items[0].orient;return t===Qr||t===ei}function ioe(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function ooe(e,t,n,r){var i=t.items[0],o=i.datum,a=i.translate!=null?i.translate:.5,s=i.orient,u=ioe(o),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,g=o.title&&i.items[u[2]].items[0],p=i.titlePadding,m=i.bounds,y=g&&kw(g),v=0,b=0,x,w;switch(rn.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(i.items[x].bounds),(x=u[1])>-1&&m.union(i.items[x].bounds),s){case Cl:v=f||0,b=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),g&&Tp(e,g,w,p,y,0,-1,m);break;case Qr:v=-c,b=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),g&&Tp(e,g,w,p,y,1,-1,m);break;case ei:v=n+c,b=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),g&&Tp(e,g,w,p,y,1,1,m);break;case Fa:v=f||0,b=r+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),g&&Tp(e,g,w,p,0,0,1,m);break;default:v=i.x,b=i.y}return Oo(m.translate(v,b),i),Ol(i,"x",v+a)|Ol(i,"y",b+a)&&(i.bounds=rn,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function Tp(e,t,n,r,i,o,a,s){const u=t.bounds;if(t.auto){const l=a*(n+i+r);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}s.union(u)}const b8=(e,t)=>Math.floor(Math.min(e,t)),x8=(e,t)=>Math.ceil(Math.max(e,t));function aoe(e){var t=e.items,n=t.length,r=0,i,o;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],o=i.items,i.marktype===kp)switch(i.role){case e_:case n_:case t_:break;case n8:a.rowheaders.push(...o);break;case r8:a.rowfooters.push(...o);break;case o8:a.colheaders.push(...o);break;case a8:a.colfooters.push(...o);break;case i8:a.rowtitle=o[0];break;case s8:a.coltitle=o[0];break;default:a.marks.push(...o)}return a}function soe(e){return new _t().set(0,0,e.width||0,e.height||0)}function uoe(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function tt(e,t,n){const r=se(e)?e[t]:e;return r!=null?r:n!==void 0?n:0}function w8(e){return e<0?Math.ceil(-e):0}function _8(e,t,n){var r=!n.nodirty,i=n.bounds===o_?soe:uoe,o=rn.set(0,0,0,0),a=tt(n.align,ka),s=tt(n.align,Da),u=tt(n.padding,ka),l=tt(n.padding,Da),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),g=Array(c),p=0,m=Array(d),y=Array(f),v=0,b=Array(d),x=Array(d),w=Array(d),E,_,$,C,O,A,D,F,T,S,M;for(_=0;_<c;++_)g[_]=0;for(_=0;_<f;++_)y[_]=0;for(_=0;_<d;++_)A=t[_],O=w[_]=i(A),A.x=A.x||0,b[_]=0,A.y=A.y||0,x[_]=0,$=_%c,C=~~(_/c),p=Math.max(p,D=Math.ceil(O.x2)),v=Math.max(v,F=Math.ceil(O.y2)),g[$]=Math.max(g[$],D),y[C]=Math.max(y[C],F),h[_]=u+w8(O.x1),m[_]=l+w8(O.y1),r&&e.dirty(t[_]);for(_=0;_<d;++_)_%c==0&&(h[_]=0),_<c&&(m[_]=0);if(a===i_)for($=1;$<c;++$){for(M=0,_=$;_<d;_+=c)M<h[_]&&(M=h[_]);for(_=$;_<d;_+=c)h[_]=M+g[$-1]}else if(a===Dp){for(M=0,_=0;_<d;++_)_%c&&M<h[_]&&(M=h[_]);for(_=0;_<d;++_)_%c&&(h[_]=M+p)}else for(a=!1,$=1;$<c;++$)for(_=$;_<d;_+=c)h[_]+=g[$-1];if(s===i_)for(C=1;C<f;++C){for(M=0,_=C*c,E=_+c;_<E;++_)M<m[_]&&(M=m[_]);for(_=C*c;_<E;++_)m[_]=M+y[C-1]}else if(s===Dp){for(M=0,_=c;_<d;++_)M<m[_]&&(M=m[_]);for(_=c;_<d;++_)m[_]=M+v}else for(s=!1,C=1;C<f;++C)for(_=C*c,E=_+c;_<E;++_)m[_]+=y[C-1];for(T=0,_=0;_<d;++_)T=h[_]+(_%c?T:0),b[_]+=T-t[_].x;for($=0;$<c;++$)for(S=0,_=$;_<d;_+=c)S+=m[_],x[_]+=S-t[_].y;if(a&&tt(n.center,ka)&&f>1)for(_=0;_<d;++_)O=a===Dp?p:g[_%c],T=O-w[_].x2-t[_].x-b[_],T>0&&(b[_]+=T/2);if(s&&tt(n.center,Da)&&c!==1)for(_=0;_<d;++_)O=s===Dp?v:y[~~(_/c)],S=O-w[_].y2-t[_].y-x[_],S>0&&(x[_]+=S/2);for(_=0;_<d;++_)o.union(w[_].translate(b[_],x[_]));switch(T=tt(n.anchor,Hie),S=tt(n.anchor,Wie),tt(n.anchor,ka)){case bn:T-=o.width();break;case Qw:T-=o.width()/2}switch(tt(n.anchor,Da)){case bn:S-=o.height();break;case Qw:S-=o.height()/2}for(T=Math.round(T),S=Math.round(S),o.clear(),_=0;_<d;++_)t[_].mark.bounds.clear();for(_=0;_<d;++_)A=t[_],A.x+=b[_]+=T,A.y+=x[_]+=S,o.union(A.mark.bounds.union(A.bounds.translate(b[_],x[_]))),r&&e.dirty(A);return o}function loe(e,t,n){var r=aoe(t),i=r.marks,o=n.bounds===o_?coe:foe,a=n.offset,s=n.columns||i.length,u=s<=0?1:Math.ceil(i.length/s),l=u*s,c,f,d,h,g,p,m;const y=_8(e,i,n);y.empty()&&y.set(0,0,0,0),r.rowheaders&&(p=tt(n.headerBand,Da,null),c=Np(e,r.rowheaders,i,s,u,-tt(a,"rowHeader"),b8,0,o,"x1",0,s,1,p)),r.colheaders&&(p=tt(n.headerBand,ka,null),f=Np(e,r.colheaders,i,s,s,-tt(a,"columnHeader"),b8,1,o,"y1",0,1,s,p)),r.rowfooters&&(p=tt(n.footerBand,Da,null),d=Np(e,r.rowfooters,i,s,u,tt(a,"rowFooter"),x8,0,o,"x2",s-1,s,1,p)),r.colfooters&&(p=tt(n.footerBand,ka,null),h=Np(e,r.colfooters,i,s,s,tt(a,"columnFooter"),x8,1,o,"y2",l-s,1,s,p)),r.rowtitle&&(g=tt(n.titleAnchor,Da),m=tt(a,"rowTitle"),m=g===bn?d+m:c-m,p=tt(n.titleBand,Da,.5),E8(e,r.rowtitle,m,0,y,p)),r.coltitle&&(g=tt(n.titleAnchor,ka),m=tt(a,"columnTitle"),m=g===bn?h+m:f-m,p=tt(n.titleBand,ka,.5),E8(e,r.coltitle,m,1,y,p))}function coe(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function foe(e,t){return e.bounds[t]}function Np(e,t,n,r,i,o,a,s,u,l,c,f,d,h){var g=n.length,p=0,m=0,y,v,b,x,w,E,_,$,C;if(!g)return p;for(y=c;y<g;y+=f)n[y]&&(p=a(p,u(n[y],l)));if(!t.length)return p;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),p+=o,v=0,x=t.length;v<x;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(y=c,v=0,x=t.length;v<x;++v,y+=f){for(E=t[v],w=E.mark.bounds,b=y;b>=0&&(_=n[b])==null;b-=d);s?($=h==null?_.x:Math.round(_.bounds.x1+h*_.bounds.width()),C=p):($=p,C=h==null?_.y:Math.round(_.bounds.y1+h*_.bounds.height())),w.union(E.bounds.translate($-(E.x||0),C-(E.y||0))),E.x=$,E.y=C,e.dirty(E),m=a(m,w[l])}return m}function E8(e,t,n,r,i,o){if(!!t){e.dirty(t);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),t.bounds.translate(a-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=s,e.dirty(t)}}function doe(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function hoe(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function goe(e,t,n,r,i,o,a){const s=doe(n,t),u=hoe(e,s("offset",0)),l=s("anchor",Zw),c=l===bn?1:l===Qw?.5:0,f={align:i_,bounds:s("bounds",o_),columns:s("direction")==="vertical"?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case Qr:f.anchor={x:Math.floor(r.x1)-u,column:bn,y:c*(a||r.height()+2*r.y1),row:l};break;case ei:f.anchor={x:Math.ceil(r.x2)+u,y:c*(a||r.height()+2*r.y1),row:l};break;case Cl:f.anchor={y:Math.floor(i.y1)-u,row:bn,x:c*(o||i.width()+2*i.x1),column:l};break;case Fa:f.anchor={y:Math.ceil(i.y2)+u,x:c*(o||i.width()+2*i.x1),column:l};break;case Bie:f.anchor={x:u,y:u};break;case zie:f.anchor={x:o-u,y:u,column:bn};break;case Uie:f.anchor={x:u,y:a-u,row:bn};break;case qie:f.anchor={x:o-u,y:a-u,column:bn,row:bn};break}return f}function poe(e,t){var n=t.items[0],r=n.datum,i=n.orient,o=n.bounds,a=n.x,s=n.y,u,l;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),yoe(e,n,n.items[0].items[0]),o=moe(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),r.type===Xie&&voe(n.items[0].items[0].items[0].items),i!==r_&&(n.x=a=0,n.y=s=0),n.width=u,n.height=l,Oo(o.set(a,s,a+u,s+l),n),n.mark.bounds.clear().union(o),n}function moe(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function yoe(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(!t.datum.title)(i||o)&&hd(e,n,i,o);else{var a=t.items[1].items[0],s=a.anchor,u=t.titlePadding||0,l=r-a.x,c=r-a.y;switch(a.orient){case Qr:i+=Math.ceil(a.bounds.width())+u;break;case ei:case Fa:break;default:o+=a.bounds.height()+u}switch((i||o)&&hd(e,n,i,o),a.orient){case Qr:c+=Fl(t,n,a,s,1,1);break;case ei:l+=Fl(t,n,a,bn,0,0)+u,c+=Fl(t,n,a,s,1,1);break;case Fa:l+=Fl(t,n,a,s,0,0),c+=Fl(t,n,a,bn,-1,0,1)+u;break;default:l+=Fl(t,n,a,s,0,0)}(l||c)&&hd(e,a,l,c),(l=Math.round(a.bounds.x1-r))<0&&(hd(e,n,-l,0),hd(e,a,-l,0))}}function Fl(e,t,n,r,i,o,a){const s=e.datum.type!=="symbol",u=n.datum.vgrad,l=s&&(o||!u)&&!a?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,h=i<=0?0:kw(n);return Math.round(r===Zw?f:r===bn?d-h:.5*(c-h))}function hd(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function voe(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function boe(e,t,n,r,i){var o=t.items[0],a=o.frame,s=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=s===Qr||s===ei?r:n,g=0,p=0,m=0,y=0,v=0,b;if(a!==kp?s===Qr?(g=i.y2,h=i.y1):s===ei?(g=i.y1,h=i.y2):(g=i.x1,h=i.x2):s===Qr&&(g=r,h=0),b=u===Zw?g:u===bn?h:(g+h)/2,d&&d.text){switch(s){case Cl:case Fa:v=f.bounds.height()+c;break;case Qr:y=f.bounds.width()+c;break;case ei:y=-f.bounds.width()-c;break}rn.clear().union(d.bounds),rn.translate(y-(d.x||0),v-(d.y||0)),Ol(d,"x",y)|Ol(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(rn),d.mark.bounds.clear().union(rn),e.dirty(d)),rn.clear().union(d.bounds)}else rn.clear();switch(rn.union(f.bounds),s){case Cl:p=b,m=i.y1-rn.height()-l;break;case Qr:p=i.x1-rn.width()-l,m=b;break;case ei:p=i.x2+rn.width()+l,m=b;break;case Fa:p=b,m=i.y2+l;break;default:p=o.x,m=o.y}return Ol(o,"x",p)|Ol(o,"y",m)&&(rn.translate(p,m),e.dirty(o),o.bounds.clear().union(rn),t.bounds.clear().union(rn),e.dirty(o)),o.bounds}function A8(e){N.call(this,null,e)}q(A8,N,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&loe(n,r,e.layout),woe(n,r,e)}),xoe(e.mark.group)?t.reflow():t}});function xoe(e){return e&&e.mark.role!=="legend-entry"}function woe(e,t,n){var r=t.items,i=Math.max(0,t.width||0),o=Math.max(0,t.height||0),a=new _t().set(0,0,i,o),s=a.clone(),u=a.clone(),l=[],c,f,d,h,g,p;for(g=0,p=r.length;g<p;++g)switch(f=r[g],f.role){case e_:h=roe(f)?s:u,h.union(ooe(e,f,i,o));break;case t_:c=f;break;case n_:l.push(poe(e,f));break;case Gie:case Yie:case n8:case r8:case i8:case o8:case a8:case s8:s.union(f.bounds),u.union(f.bounds);break;default:a.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||ei,d!==r_&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const v=m[y];_8(e,v,goe(v,y,n.legends,s,u,i,o))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=v,e.dirty(y)),n.autosize&&n.autosize.type===u8)switch(y.orient){case Qr:case ei:a.add(v.x1,0).add(v.x2,0);break;case Cl:case Fa:a.add(0,v.y1).add(0,v.y2)}else a.union(v)})}a.union(s).union(u),c&&a.union(boe(e,c,i,o,a)),t.clip&&a.set(0,0,t.width||0,t.height||0),_oe(e,t,a,n)}function _oe(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let a=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===Vie){const g=e.padding();a-=g.left+g.right,s-=g.top+g.bottom}o===r_?(l=0,f=0,u=a,c=s):o===u8?(u=Math.max(0,a-l-d),c=Math.max(0,s-f-h)):o===Kie?(u=Math.max(0,a-l-d),s=c+f+h):o===Jie?(a=u+l+d,c=Math.max(0,s-f-h)):o===Zie&&(a=u+l+d,s=c+f+h),e._resizeView(a,s,u,c,[l,f],i.resize)}var Eoe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:l8,identifier:a_,mark:f8,overlap:d8,render:v8,viewlayout:A8});function $8(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function Aoe(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function s_(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function S8(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function gd(){}var pd=.7,Rp=1/pd,kl="\\s*([+-]?\\d+)\\s*",md="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Pi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$oe=/^#([0-9a-f]{3,8})$/,Soe=new RegExp("^rgb\\("+[kl,kl,kl]+"\\)$"),Coe=new RegExp("^rgb\\("+[Pi,Pi,Pi]+"\\)$"),Ooe=new RegExp("^rgba\\("+[kl,kl,kl,md]+"\\)$"),Foe=new RegExp("^rgba\\("+[Pi,Pi,Pi,md]+"\\)$"),koe=new RegExp("^hsl\\("+[md,Pi,Pi]+"\\)$"),Doe=new RegExp("^hsla\\("+[md,Pi,Pi,md]+"\\)$"),C8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};s_(gd,yd,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:O8,formatHex:O8,formatHsl:Moe,formatRgb:F8,toString:F8});function O8(){return this.rgb().formatHex()}function Moe(){return N8(this).formatHsl()}function F8(){return this.rgb().formatRgb()}function yd(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=$oe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?k8(t):n===3?new lr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?jp(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?jp(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Soe.exec(e))?new lr(t[1],t[2],t[3],1):(t=Coe.exec(e))?new lr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ooe.exec(e))?jp(t[1],t[2],t[3],t[4]):(t=Foe.exec(e))?jp(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=koe.exec(e))?T8(t[1],t[2]/100,t[3]/100,1):(t=Doe.exec(e))?T8(t[1],t[2]/100,t[3]/100,t[4]):C8.hasOwnProperty(e)?k8(C8[e]):e==="transparent"?new lr(NaN,NaN,NaN,0):null}function k8(e){return new lr(e>>16&255,e>>8&255,e&255,1)}function jp(e,t,n,r){return r<=0&&(e=t=n=NaN),new lr(e,t,n,r)}function Toe(e){return e instanceof gd||(e=yd(e)),e?(e=e.rgb(),new lr(e.r,e.g,e.b,e.opacity)):new lr}function u_(e,t,n,r){return arguments.length===1?Toe(e):new lr(e,t,n,r==null?1:r)}function lr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}s_(lr,u_,S8(gd,{brighter:function(e){return e=e==null?Rp:Math.pow(Rp,e),new lr(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?pd:Math.pow(pd,e),new lr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:D8,formatHex:D8,formatRgb:M8,toString:M8}));function D8(){return"#"+l_(this.r)+l_(this.g)+l_(this.b)}function M8(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function l_(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function T8(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ii(e,t,n,r)}function N8(e){if(e instanceof Ii)return new Ii(e.h,e.s,e.l,e.opacity);if(e instanceof gd||(e=yd(e)),!e)return new Ii;if(e instanceof Ii)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Ii(a,s,u,e.opacity)}function Noe(e,t,n,r){return arguments.length===1?N8(e):new Ii(e,t,n,r==null?1:r)}function Ii(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}s_(Ii,Noe,S8(gd,{brighter:function(e){return e=e==null?Rp:Math.pow(Rp,e),new Ii(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?pd:Math.pow(pd,e),new Ii(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new lr(c_(e>=240?e-240:e+120,i,r),c_(e,i,r),c_(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function c_(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var f_=e=>()=>e;function Roe(e,t){return function(n){return e+n*t}}function joe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Loe(e){return(e=+e)==1?R8:function(t,n){return n-t?joe(t,n,e):f_(isNaN(t)?n:t)}}function R8(e,t){var n=t-e;return n?Roe(e,n):f_(isNaN(e)?t:e)}var j8=function e(t){var n=Loe(t);function r(i,o){var a=n((i=u_(i)).r,(o=u_(o)).r),s=n(i.g,o.g),u=n(i.b,o.b),l=R8(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function Poe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function Ioe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Boe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=p_(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function zoe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function d_(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Uoe(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=p_(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var h_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,g_=new RegExp(h_.source,"g");function qoe(e){return function(){return e}}function Hoe(e){return function(t){return e(t)+""}}function Woe(e,t){var n=h_.lastIndex=g_.lastIndex=0,r,i,o,a=-1,s=[],u=[];for(e=e+"",t=t+"";(r=h_.exec(e))&&(i=g_.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,u.push({i:a,x:d_(r,i)})),n=g_.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?Hoe(u[0].x):qoe(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function p_(e,t){var n=typeof t,r;return t==null||n==="boolean"?f_(t):(n==="number"?d_:n==="string"?(r=yd(t))?(t=r,j8):Woe:t instanceof yd?j8:t instanceof Date?zoe:Ioe(t)?Poe:Array.isArray(t)?Boe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Uoe:d_)(e,t)}function Goe(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function L8(e){N.call(this,null,e)}q(L8,N,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,s=ew(o,a,e.minstep),u=e.format||ST(n,o,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?$T(o,e.values,s):tw(o,s);return i&&(r.rem=i),i=l.map((c,f)=>Le({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(Le({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function P8(e){N.call(this,null,e)}function Yoe(){return Le({})}function Voe(e){const t=Ku().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}q(P8,N,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Yoe,o=e.key||ee,a=this.value;return Q(r.encode)&&(r.encode=null),a&&(e.modified("key")||t.modified(o))&&I("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=Voe(o)),t.visit(t.ADD,s=>{const u=o(s);let l=a.get(u);l?l.exit?(a.empty--,r.add.push(l)):r.mod.push(l):(l=i(s),a.set(u,l),r.add.push(l)),l.datum=s,l.exit=!1}),t.visit(t.MOD,s=>{const u=o(s),l=a.get(u);l&&(l.datum=s,r.mod.push(l))}),t.visit(t.REM,s=>{const u=o(s),l=a.get(u);s===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++a.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}});function I8(e){N.call(this,null,e)}q(I8,N,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(Q(o))if(n.changed()||o.every(f=>i[f]))o=o[0],n.encode=null;else return t.StopPropagation;var a=o==="enter",s=i.update||aa,u=i.enter||aa,l=i.exit||aa,c=(o&&!a?i[o]:s)||aa;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),s(f,e)}),n.modifies(u.output),n.modifies(s.output),c!==aa&&c!==s&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==aa&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),a||c!==aa){const f=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function B8(e){N.call(this,[],e)}q(B8,N,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.type||tp,a=e.scale,s=+e.limit,u=ew(a,e.count==null?5:e.count,e.minstep),l=!!e.values||o===tp,c=e.format||kT(n,a,u,o,e.formatSpecifier,e.formatType,l),f=e.values||FT(a,u),d,h,g,p,m;return i&&(r.rem=i),o===tp?(s&&f.length>s?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,s-1),m=!0):i=f,me(g=e.size)?(!e.values&&a(i[0])===0&&(i=i.slice(1)),p=i.reduce((y,v)=>Math.max(y,g(v,e)),0)):g=Jt(p=g||8),i=i.map((y,v)=>Le({index:v,label:c(y,v,i),value:y,offset:p,size:g(y,e)})),m&&(m=f[i.length],i.push(Le({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:m,offset:p,size:g(m,e)})))):o===nne?(d=a.domain(),h=wT(a,d[0],_e(d)),f.length<3&&!e.values&&d[0]!==_e(d)&&(f=[d[0],_e(d)]),i=f.map((y,v)=>Le({index:v,label:c(y,v,f),value:y,perc:h(y)}))):(g=f.length-1,h=hne(a),i=f.map((y,v)=>Le({index:v,label:c(y,v,f),value:y,perc:v?h(y):0,perc2:v===g?1:h(f[v+1])}))),r.source=i,r.add=i,this.value=i,r}});const Xoe=e=>e.source.x,Koe=e=>e.source.y,Joe=e=>e.target.x,Zoe=e=>e.target.y;function m_(e){N.call(this,{},e)}m_.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};q(m_,N,{transform(e,t){var n=e.sourceX||Xoe,r=e.sourceY||Koe,i=e.targetX||Joe,o=e.targetY||Zoe,a=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=H8.get(u+"-"+s)||H8.get(u);return l||I("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[a]=l(n(c),r(c),i(c),o(c))}),t.reflow(e.modified()).modifies(a)}});const z8=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,Qoe=(e,t,n,r)=>z8(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),U8=(e,t,n,r)=>{var i=n-e,o=r-t,a=Math.sqrt(i*i+o*o)/2,s=180*Math.atan2(o,i)/Math.PI;return"M"+e+","+t+"A"+a+","+a+" "+s+" 0 1 "+n+","+r},eae=(e,t,n,r)=>U8(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),q8=(e,t,n,r)=>{const i=n-e,o=r-t,a=.2*(i+o),s=.2*(o-i);return"M"+e+","+t+"C"+(e+a)+","+(t+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},tae=(e,t,n,r)=>q8(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),nae=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,rae=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,iae=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*a+","+t*s+"L"+r*a+","+r*s},oae=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},aae=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},sae=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*o+"C"+u*i+","+u*o+" "+u*a+","+u*s+" "+r*a+","+r*s},H8=Ku({line:z8,"line-radial":Qoe,arc:U8,"arc-radial":eae,curve:q8,"curve-radial":tae,"orthogonal-horizontal":nae,"orthogonal-vertical":rae,"orthogonal-radial":iae,"diagonal-horizontal":oae,"diagonal-vertical":aae,"diagonal-radial":sae});function y_(e){N.call(this,null,e)}y_.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};q(y_,N,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],o=e.field||Xu,a=e.startAngle||0,s=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(o),c=l.length,f=a,d=(s-a)/Aoe(l),h=$8(c),g,p,m;for(e.sort&&h.sort((y,v)=>l[y]-l[v]),g=0;g<c;++g)m=l[h[g]],p=u[h[g]],p[r]=f,p[i]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const uae=5;function lae(e){const t=e.type;return!e.bins&&(t===ml||t===Wf||t===Gf)}function W8(e){return K2(e)&&e!==Mi}const cae=Yr(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function G8(e){N.call(this,null,e),this.modified(!0)}q(G8,N,{transform(e,t){var n=t.dataflow,r=this.value,i=fae(e);(!r||i!==r.type)&&(this.value=r=Ne(i)());for(i in e)if(!cae[i]){if(i==="padding"&&W8(r.type))continue;me(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return yae(r,e,mae(r,e,hae(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function fae(e){var t=e.type,n="",r;return t===Mi?Mi+"-"+ml:(dae(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?Mi+"-":r===3?yl+"-":""),(n+t||ml).toLowerCase())}function dae(e){const t=e.type;return K2(t)&&t!==Ls&&t!==Ps&&(e.scheme||e.range&&e.range.length&&e.range.every(Fe))}function hae(e,t,n){const r=gae(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,o=e.type,a=t.zero||t.zero===void 0&&lae(e),s,u;if(!i)return 0;if(W8(o)&&t.padding&&i[0]!==_e(i)&&(i=pae(o,i,t.range,t.padding,t.exponent,t.constant)),(a||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(s=(i=i.slice()).length-1||1,a&&(i[0]>0&&(i[0]=0),i[s]<0&&(i[s]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[s]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[s]?s+1:u<i[0]?0:s;l!==s&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(Y8(o,i,n)),o===W2&&e.unknown(t.domainImplicit?e2:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&ew(e,t.nice)||null),i.length}function gae(e,t,n){return t?(e.domain(Y8(e.type,t,n)),t.length):-1}function pae(e,t,n,r,i,o){var a=Math.abs(_e(n)-n[0]),s=a/(a-2*r),u=e===So?Kv(t,null,s):e===Gf?Z0(t,null,s,.5):e===Wf?Z0(t,null,s,i||1):e===Kg?Jv(t,null,s,o||1):Xv(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function Y8(e,t,n){if(mT(e)){var r=Math.abs(t.reduce((i,o)=>i+(o<0?-1:o>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+ne(t))}return t}function mae(e,t,n){let r=t.bins;if(r&&!Q(r)){const i=e.domain(),o=i[0],a=_e(i),s=r.step;let u=r.start==null?o:r.start,l=r.stop==null?a:r.stop;s||I("Scale bins parameter missing step property."),u<o&&(u=s*Math.ceil(o/s)),l>a&&(l=s*Math.floor(a/s)),r=$8(u,l+s/2,s)}return r?e.bins=r:e.bins&&delete e.bins,e.type===Y2&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function yae(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(t.rangeStep!=null)o=vae(r,t,n);else if(t.scheme&&(o=bae(r,t,n),me(o))){if(e.interpolator)return e.interpolator(o);I("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&yT(r))return e.interpolator(ep(v_(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(Z2(t.interpolate,t.interpolateGamma)):me(e.round)?e.round(i):me(e.rangeRound)&&e.interpolate(i?Goe:p_),o&&e.range(v_(o,t.reverse))}function vae(e,t,n){e!==dT&&e!==G2&&I("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===G2?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*H2(n,i,r)]}function bae(e,t,n){var r=t.schemeExtent,i,o;return Q(t.scheme)?o=ep(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),o=Q2(i),o||I("Unrecognized scheme name: ".concat(t.scheme))),n=e===Zg?n+1:e===Y2?n-1:e===vl||e===Jg?+t.schemeCount||uae:n,yT(e)?V8(o,r,t.reverse):me(o)?xT(V8(o,r),n):e===W2?o:o.slice(0,n)}function V8(e,t,n){return me(e)&&(t||n)?bT(e,v_(t||[0,1],n)):e}function v_(e,t){return t?e.slice().reverse():e}function X8(e){N.call(this,null,e)}q(X8,N,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Es(e.sort)),this.modified(n),t}});const K8="zero",J8="center",Z8="normalize",Q8=["y0","y1"];function b_(e){N.call(this,null,e)}b_.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:K8,values:[K8,J8,Z8]},{name:"as",type:"string",array:!0,length:2,default:Q8}]};q(b_,N,{transform(e,t){var n=e.as||Q8,r=n[0],i=n[1],o=Es(e.sort),a=e.field||Xu,s=e.offset===J8?xae:e.offset===Z8?wae:_ae,u,l,c,f;for(u=Eae(t.source,e.groupby,o,a),l=0,c=u.length,f=u.max;l<c;++l)s(u[l],f,a,r,i);return t.reflow(e.modified()).modifies(n)}});function xae(e,t,n,r,i){for(var o=(t-e.sum)/2,a=e.length,s=0,u;s<a;++s)u=e[s],u[r]=o,u[i]=o+=Math.abs(n(u))}function wae(e,t,n,r,i){for(var o=1/e.sum,a=0,s=e.length,u=0,l=0,c;u<s;++u)c=e[u],c[r]=a,c[i]=a=o*(l+=Math.abs(n(c)))}function _ae(e,t,n,r,i){for(var o=0,a=0,s=e.length,u=0,l,c;u<s;++u)c=e[u],l=+n(c),l<0?(c[r]=a,c[i]=a+=l):(c[r]=o,c[i]=o+=l)}function Eae(e,t,n,r){var i=[],o=p=>p(c),a,s,u,l,c,f,d,h,g;if(t==null)i.push(e.slice());else for(a={},s=0,u=e.length;s<u;++s)c=e[s],f=t.map(o),d=a[f],d||(a[f]=d=[],i.push(d)),d.push(c);for(f=0,g=0,l=i.length;f<l;++f){for(d=i[f],s=0,h=0,u=d.length;s<u;++s)h+=Math.abs(r(d[s]));d.sum=h,h>g&&(g=h),n&&d.sort(n)}return i.max=g,i}var Aae=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:L8,datajoin:P8,encode:I8,legendentries:B8,linkpath:m_,pie:y_,scale:G8,sortitems:X8,stack:b_}),$ae=Math.sqrt(50),Sae=Math.sqrt(10),Cae=Math.sqrt(2);function Oae(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=$ae?i*=10:o>=Sae?i*=5:o>=Cae&&(i*=2),t<e?-i:i}function Lp(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Ws(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function Fae(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}class Gs{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[r++]=s),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}function*kae(e){for(const t of e)yield*t}function eN(e){return Array.from(kae(e))}var pe=1e-6,tN=1e-12,be=Math.PI,lt=be/2,nN=be/4,cr=be*2,on=180/be,it=be/180,ze=Math.abs,Dl=Math.atan,ko=Math.atan2,ve=Math.cos,rN=Math.exp,Pp=Math.log,x_=Math.pow,ce=Math.sin,Or=Math.sign||function(e){return e>0?1:e<0?-1:0},qn=Math.sqrt,w_=Math.tan;function iN(e){return e>1?0:e<-1?be:Math.acos(e)}function Fr(e){return e>1?lt:e<-1?-lt:Math.asin(e)}function kr(){}function Ip(e,t){e&&aN.hasOwnProperty(e.type)&&aN[e.type](e,t)}var oN={Feature:function(e,t){Ip(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Ip(n[r].geometry,t)}},aN={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){__(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)__(n[r],t,0)},Polygon:function(e,t){sN(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)sN(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Ip(n[r],t)}};function __(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function sN(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)__(e[n],t,1);t.polygonEnd()}function Ml(e,t){e&&oN.hasOwnProperty(e.type)?oN[e.type](e,t):Ip(e,t)}function E_(e){return[ko(e[1],e[0]),Fr(e[2])]}function Tl(e){var t=e[0],n=e[1],r=ve(n);return[r*ve(t),r*ce(t),ce(n)]}function Bp(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function zp(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function A_(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Up(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function $_(e){var t=qn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function S_(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function C_(e,t){return[ze(e)>be?e+Math.round(-e/cr)*cr:e,t]}C_.invert=C_;function uN(e,t,n){return(e%=cr)?t||n?S_(cN(e),fN(t,n)):cN(e):t||n?fN(t,n):C_}function lN(e){return function(t,n){return t+=e,[t>be?t-cr:t<-be?t+cr:t,n]}}function cN(e){var t=lN(e);return t.invert=lN(-e),t}function fN(e,t){var n=ve(e),r=ce(e),i=ve(t),o=ce(t);function a(s,u){var l=ve(u),c=ve(s)*l,f=ce(s)*l,d=ce(u),h=d*n+c*r;return[ko(f*i-h*o,c*n-d*r),Fr(h*i+f*o)]}return a.invert=function(s,u){var l=ve(u),c=ve(s)*l,f=ce(s)*l,d=ce(u),h=d*i-f*o;return[ko(f*i+d*o,c*n+h*r),Fr(h*n-c*r)]},a}function Dae(e){e=uN(e[0]*it,e[1]*it,e.length>2?e[2]*it:0);function t(n){return n=e(n[0]*it,n[1]*it),n[0]*=on,n[1]*=on,n}return t.invert=function(n){return n=e.invert(n[0]*it,n[1]*it),n[0]*=on,n[1]*=on,n},t}function Mae(e,t,n,r,i,o){if(!!n){var a=ve(t),s=ce(t),u=r*n;i==null?(i=t+r*cr,o=t-u/2):(i=dN(a,i),o=dN(a,o),(r>0?i<o:i>o)&&(i+=r*cr));for(var l,c=i;r>0?c>o:c<o;c-=u)l=E_([a,-s*ve(c),-s*ce(c)]),e.point(l[0],l[1])}}function dN(e,t){t=Tl(t),t[0]-=e,$_(t);var n=iN(-t[1]);return((-t[2]<0?-n:n)+cr-pe)%cr}function hN(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:kr,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function qp(e,t){return ze(e[0]-t[0])<pe&&ze(e[1]-t[1])<pe}function Hp(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function gN(e,t,n,r,i){var o=[],a=[],s,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(qp(m,y)){if(!m[2]&&!y[2]){for(i.lineStart(),s=0;s<p;++s)i.point((m=g[s])[0],m[1]);i.lineEnd();return}y[0]+=2*pe}o.push(v=new Hp(m,g,null,!0)),a.push(v.o=new Hp(m,null,v,!1)),o.push(v=new Hp(y,g,null,!1)),a.push(v.o=new Hp(y,null,v,!0))}}),!!o.length){for(a.sort(t),pN(o),pN(a),s=0,u=a.length;s<u;++s)a[s].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)i.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function pN(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function O_(e){return ze(e[0])<=be?e[0]:Or(e[0])*((ze(e[0])+be)%cr-be)}function Tae(e,t){var n=O_(t),r=t[1],i=ce(r),o=[ce(n),-ve(n),0],a=0,s=0,u=new Gs;i===1?r=lt+pe:i===-1&&(r=-lt-pe);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],g=O_(h),p=h[1]/2+nN,m=ce(p),y=ve(p),v=0;v<d;++v,g=x,m=E,y=_,h=b){var b=f[v],x=O_(b),w=b[1]/2+nN,E=ce(w),_=ve(w),$=x-g,C=$>=0?1:-1,O=C*$,A=O>be,D=m*E;if(u.add(ko(D*C*ce(O),y*_+D*ve(O))),a+=A?$+C*cr:$,A^g>=n^x>=n){var F=zp(Tl(h),Tl(b));$_(F);var T=zp(o,F);$_(T);var S=(A^$>=0?-1:1)*Fr(T[2]);(r>S||r===S&&(F[0]||F[1]))&&(s+=A^$>=0?1:-1)}}return(a<-pe||a<pe&&u<-tN)^s&1}function mN(e,t,n,r){return function(i){var o=t(i),a=hN(),s=t(a),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=eN(c);var x=Tae(l,r);c.length?(u||(i.polygonStart(),u=!0),gN(c,Rae,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function g(x,w){o.point(x,w)}function p(){d.point=g,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(x,w){f.push([x,w]),s.point(x,w)}function v(){s.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=a.result(),E,_=w.length,$,C,O;if(f.pop(),l.push(f),f=null,!!_){if(x&1){if(C=w[0],($=C.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),E=0;E<$;++E)i.point((O=C[E])[0],O[1]);i.lineEnd()}return}_>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Nae))}}return d}}function Nae(e){return e.length>1}function Rae(e,t){return((e=e.x)[0]<0?e[1]-lt-pe:lt-e[1])-((t=t.x)[0]<0?t[1]-lt-pe:lt-t[1])}var yN=mN(function(){return!0},jae,Pae,[-be,-lt]);function jae(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,a){var s=o>0?be:-be,u=ze(o-t);ze(u-be)<pe?(e.point(t,n=(n+a)/2>0?lt:-lt),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),i=0):r!==s&&u>=be&&(ze(t-r)<pe&&(t-=r*pe),ze(o-s)<pe&&(o-=s*pe),n=Lae(t,n,o,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=o,n=a),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function Lae(e,t,n,r){var i,o,a=ce(e-n);return ze(a)>pe?Dl((ce(t)*(o=ve(r))*ce(n)-ce(r)*(i=ve(t))*ce(e))/(i*o*a)):(t+r)/2}function Pae(e,t,n,r){var i;if(e==null)i=n*lt,r.point(-be,i),r.point(0,i),r.point(be,i),r.point(be,0),r.point(be,-i),r.point(0,-i),r.point(-be,-i),r.point(-be,0),r.point(-be,i);else if(ze(e[0]-t[0])>pe){var o=e[0]<t[0]?be:-be;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function Iae(e){var t=ve(e),n=6*it,r=t>0,i=ze(t)>pe;function o(c,f,d,h){Mae(h,e,n,d,c,f)}function a(c,f){return ve(c)*ve(f)>t}function s(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var v=[m,y],b,x=a(m,y),w=r?x?0:l(m,y):x?l(m+(m<0?be:-be),y):0;if(!f&&(g=h=x)&&c.lineStart(),x!==h&&(b=u(f,v),(!b||qp(f,b)||qp(v,b))&&(v[2]=1)),x!==h)p=0,x?(c.lineStart(),b=u(v,f),c.point(b[0],b[1])):(b=u(f,v),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var E;!(w&d)&&(E=u(v,f,!0))&&(p=0,r?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}x&&(!f||!qp(f,v))&&c.point(v[0],v[1]),f=v,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=Tl(c),g=Tl(f),p=[1,0,0],m=zp(h,g),y=Bp(m,m),v=m[0],b=y-v*v;if(!b)return!d&&c;var x=t*y/b,w=-t*v/b,E=zp(p,m),_=Up(p,x),$=Up(m,w);A_(_,$);var C=E,O=Bp(_,C),A=Bp(C,C),D=O*O-A*(Bp(_,_)-1);if(!(D<0)){var F=qn(D),T=Up(C,(-O-F)/A);if(A_(T,_),T=E_(T),!d)return T;var S=c[0],M=f[0],P=c[1],B=f[1],H;M<S&&(H=S,S=M,M=H);var ie=M-S,le=ze(ie-be)<pe,he=le||ie<pe;if(!le&&B<P&&(H=P,P=B,B=H),he?le?P+B>0^T[1]<(ze(T[0]-S)<pe?P:B):P<=T[1]&&T[1]<=B:ie>be^(S<=T[0]&&T[0]<=M)){var Ae=Up(C,(-O+F)/A);return A_(Ae,_),[T,E_(Ae)]}}}function l(c,f){var d=r?e:be-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return mN(a,s,o,r?[0,-e]:[-be,e-be])}function Bae(e,t,n,r,i,o){var a=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-a,h=l-s,g;if(g=n-a,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=i-a,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=r-s,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=o-s,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=a+c*d,e[1]=s+c*h),f<1&&(t[0]=a+f*d,t[1]=s+f*h),!0}}}}}var vd=1e9,Wp=-vd;function vN(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function o(l,c,f,d){var h=0,g=0;if(l==null||(h=a(l,f))!==(g=a(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function a(l,c){return ze(l[0]-e)<pe?c>0?0:3:ze(l[0]-n)<pe?c>0?2:1:ze(l[1]-t)<pe?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=a(l,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=hN(),d,h,g,p,m,y,v,b,x,w,E,_={point:$,lineStart:D,lineEnd:F,polygonStart:O,polygonEnd:A};function $(S,M){i(S,M)&&c.point(S,M)}function C(){for(var S=0,M=0,P=h.length;M<P;++M)for(var B=h[M],H=1,ie=B.length,le=B[0],he,Ae,$e=le[0],Pe=le[1];H<ie;++H)he=$e,Ae=Pe,le=B[H],$e=le[0],Pe=le[1],Ae<=r?Pe>r&&($e-he)*(r-Ae)>(Pe-Ae)*(e-he)&&++S:Pe<=r&&($e-he)*(r-Ae)<(Pe-Ae)*(e-he)&&--S;return S}function O(){c=f,d=[],h=[],E=!0}function A(){var S=C(),M=E&&S,P=(d=eN(d)).length;(M||P)&&(l.polygonStart(),M&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),P&&gN(d,s,S,o,l),l.polygonEnd()),c=l,d=h=g=null}function D(){_.point=T,h&&h.push(g=[]),w=!0,x=!1,v=b=NaN}function F(){d&&(T(p,m),y&&x&&f.rejoin(),d.push(f.result())),_.point=$,x&&c.lineEnd()}function T(S,M){var P=i(S,M);if(h&&g.push([S,M]),w)p=S,m=M,y=P,w=!1,P&&(c.lineStart(),c.point(S,M));else if(P&&x)c.point(S,M);else{var B=[v=Math.max(Wp,Math.min(vd,v)),b=Math.max(Wp,Math.min(vd,b))],H=[S=Math.max(Wp,Math.min(vd,S)),M=Math.max(Wp,Math.min(vd,M))];Bae(B,H,e,t,n,r)?(x||(c.lineStart(),c.point(B[0],B[1])),c.point(H[0],H[1]),P||c.lineEnd(),E=!1):P&&(c.lineStart(),c.point(S,M),E=!1)}v=S,b=M,x=P}return _}}var bd=e=>e,F_=new Gs,k_=new Gs,bN,xN,D_,M_,Ma={point:kr,lineStart:kr,lineEnd:kr,polygonStart:function(){Ma.lineStart=zae,Ma.lineEnd=qae},polygonEnd:function(){Ma.lineStart=Ma.lineEnd=Ma.point=kr,F_.add(ze(k_)),k_=new Gs},result:function(){var e=F_/2;return F_=new Gs,e}};function zae(){Ma.point=Uae}function Uae(e,t){Ma.point=wN,bN=D_=e,xN=M_=t}function wN(e,t){k_.add(M_*e-D_*t),D_=e,M_=t}function qae(){wN(bN,xN)}var _N=Ma,Nl=1/0,Gp=Nl,xd=-Nl,Yp=xd,Hae={point:Wae,lineStart:kr,lineEnd:kr,polygonStart:kr,polygonEnd:kr,result:function(){var e=[[Nl,Gp],[xd,Yp]];return xd=Yp=-(Gp=Nl=1/0),e}};function Wae(e,t){e<Nl&&(Nl=e),e>xd&&(xd=e),t<Gp&&(Gp=t),t>Yp&&(Yp=t)}var Vp=Hae,T_=0,N_=0,wd=0,Xp=0,Kp=0,Rl=0,R_=0,j_=0,_d=0,EN,AN,Bi,zi,ti={point:Ys,lineStart:$N,lineEnd:SN,polygonStart:function(){ti.lineStart=Vae,ti.lineEnd=Xae},polygonEnd:function(){ti.point=Ys,ti.lineStart=$N,ti.lineEnd=SN},result:function(){var e=_d?[R_/_d,j_/_d]:Rl?[Xp/Rl,Kp/Rl]:wd?[T_/wd,N_/wd]:[NaN,NaN];return T_=N_=wd=Xp=Kp=Rl=R_=j_=_d=0,e}};function Ys(e,t){T_+=e,N_+=t,++wd}function $N(){ti.point=Gae}function Gae(e,t){ti.point=Yae,Ys(Bi=e,zi=t)}function Yae(e,t){var n=e-Bi,r=t-zi,i=qn(n*n+r*r);Xp+=i*(Bi+e)/2,Kp+=i*(zi+t)/2,Rl+=i,Ys(Bi=e,zi=t)}function SN(){ti.point=Ys}function Vae(){ti.point=Kae}function Xae(){CN(EN,AN)}function Kae(e,t){ti.point=CN,Ys(EN=Bi=e,AN=zi=t)}function CN(e,t){var n=e-Bi,r=t-zi,i=qn(n*n+r*r);Xp+=i*(Bi+e)/2,Kp+=i*(zi+t)/2,Rl+=i,i=zi*e-Bi*t,R_+=i*(Bi+e),j_+=i*(zi+t),_d+=i*3,Ys(Bi=e,zi=t)}var ON=ti;function FN(e){this._context=e}FN.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,cr);break}}},result:kr};var L_=new Gs,P_,kN,DN,Ed,Ad,Jp={point:kr,lineStart:function(){Jp.point=Jae},lineEnd:function(){P_&&MN(kN,DN),Jp.point=kr},polygonStart:function(){P_=!0},polygonEnd:function(){P_=null},result:function(){var e=+L_;return L_=new Gs,e}};function Jae(e,t){Jp.point=MN,kN=Ed=e,DN=Ad=t}function MN(e,t){Ed-=e,Ad-=t,L_.add(qn(Ed*Ed+Ad*Ad)),Ed=e,Ad=t}var TN=Jp;function NN(){this._string=[]}NN.prototype={_radius:4.5,_circle:RN(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=RN(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function RN(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function jN(e,t){var n=4.5,r,i;function o(a){return a&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),Ml(a,r(i))),i.result()}return o.area=function(a){return Ml(a,r(_N)),_N.result()},o.measure=function(a){return Ml(a,r(TN)),TN.result()},o.bounds=function(a){return Ml(a,r(Vp)),Vp.result()},o.centroid=function(a){return Ml(a,r(ON)),ON.result()},o.projection=function(a){return arguments.length?(r=a==null?(e=null,bd):(e=a).stream,o):e},o.context=function(a){return arguments.length?(i=a==null?(t=null,new NN):new FN(t=a),typeof n!="function"&&i.pointRadius(n),o):t},o.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(i.pointRadius(+a),+a),o):n},o.projection(e).context(t)}function Zp(e){return function(t){var n=new I_;for(var r in e)n[r]=e[r];return n.stream=t,n}}function I_(){}I_.prototype={constructor:I_,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function B_(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Ml(n,e.stream(Vp)),t(Vp.result()),r!=null&&e.clipExtent(r),e}function Qp(e,t,n){return B_(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),s=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([s,u])},n)}function z_(e,t,n){return Qp(e,[[0,0],t],n)}function U_(e,t,n){return B_(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),a=(i-o*(r[1][0]+r[0][0]))/2,s=-o*r[0][1];e.scale(150*o).translate([a,s])},n)}function q_(e,t,n){return B_(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),a=-o*r[0][0],s=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var LN=16,Zae=ve(30*it);function PN(e,t){return+t?ese(e,t):Qae(e)}function Qae(e){return Zp({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function ese(e,t){function n(r,i,o,a,s,u,l,c,f,d,h,g,p,m){var y=l-r,v=c-i,b=y*y+v*v;if(b>4*t&&p--){var x=a+d,w=s+h,E=u+g,_=qn(x*x+w*w+E*E),$=Fr(E/=_),C=ze(ze(E)-1)<pe||ze(o-f)<pe?(o+f)/2:ko(w,x),O=e(C,$),A=O[0],D=O[1],F=A-r,T=D-i,S=v*F-y*T;(S*S/b>t||ze((y*F+v*T)/b-.5)>.3||a*d+s*h+u*g<Zae)&&(n(r,i,o,a,s,u,A,D,C,x/=_,w/=_,E,p,m),m.point(A,D),n(A,D,C,x,w,E,l,c,f,d,h,g,p,m))}}return function(r){var i,o,a,s,u,l,c,f,d,h,g,p,m={point:y,lineStart:v,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=v}};function y($,C){$=e($,C),r.point($[0],$[1])}function v(){f=NaN,m.point=b,r.lineStart()}function b($,C){var O=Tl([$,C]),A=e($,C);n(f,d,c,h,g,p,f=A[0],d=A[1],c=$,h=O[0],g=O[1],p=O[2],LN,r),r.point(f,d)}function x(){m.point=y,r.lineEnd()}function w(){v(),m.point=E,m.lineEnd=_}function E($,C){b(i=$,C),o=f,a=d,s=h,u=g,l=p,m.point=b}function _(){n(f,d,c,h,g,p,o,a,i,s,u,l,LN,r),m.lineEnd=x,x()}return m}}var tse=Zp({point:function(e,t){this.stream.point(e*it,t*it)}});function nse(e){return Zp({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function rse(e,t,n,r,i){function o(a,s){return a*=r,s*=i,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*r,(n-s)/e*i]},o}function IN(e,t,n,r,i,o){if(!o)return rse(e,t,n,r,i);var a=ve(o),s=ce(o),u=a*e,l=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function g(p,m){return p*=r,m*=i,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[r*(c*p-f*m+d),i*(h-f*p-c*m)]},g}function Do(e){return BN(function(){return e})()}function BN(e){var t,n=150,r=480,i=250,o=0,a=0,s=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=yN,m=null,y,v,b,x=bd,w=.5,E,_,$,C,O;function A(S){return $(S[0]*it,S[1]*it)}function D(S){return S=$.invert(S[0],S[1]),S&&[S[0]*on,S[1]*on]}A.stream=function(S){return C&&O===S?C:C=tse(nse(c)(p(E(x(O=S)))))},A.preclip=function(S){return arguments.length?(p=S,g=void 0,T()):p},A.postclip=function(S){return arguments.length?(x=S,m=y=v=b=null,T()):x},A.clipAngle=function(S){return arguments.length?(p=+S?Iae(g=S*it):(g=null,yN),T()):g*on},A.clipExtent=function(S){return arguments.length?(x=S==null?(m=y=v=b=null,bd):vN(m=+S[0][0],y=+S[0][1],v=+S[1][0],b=+S[1][1]),T()):m==null?null:[[m,y],[v,b]]},A.scale=function(S){return arguments.length?(n=+S,F()):n},A.translate=function(S){return arguments.length?(r=+S[0],i=+S[1],F()):[r,i]},A.center=function(S){return arguments.length?(o=S[0]%360*it,a=S[1]%360*it,F()):[o*on,a*on]},A.rotate=function(S){return arguments.length?(s=S[0]%360*it,u=S[1]%360*it,l=S.length>2?S[2]%360*it:0,F()):[s*on,u*on,l*on]},A.angle=function(S){return arguments.length?(f=S%360*it,F()):f*on},A.reflectX=function(S){return arguments.length?(d=S?-1:1,F()):d<0},A.reflectY=function(S){return arguments.length?(h=S?-1:1,F()):h<0},A.precision=function(S){return arguments.length?(E=PN(_,w=S*S),T()):qn(w)},A.fitExtent=function(S,M){return Qp(A,S,M)},A.fitSize=function(S,M){return z_(A,S,M)},A.fitWidth=function(S,M){return U_(A,S,M)},A.fitHeight=function(S,M){return q_(A,S,M)};function F(){var S=IN(n,0,0,d,h,f).apply(null,t(o,a)),M=IN(n,r-S[0],i-S[1],d,h,f);return c=uN(s,u,l),_=S_(t,M),$=S_(c,_),E=PN(_,w),T()}function T(){return C=O=null,A}return function(){return t=e.apply(this,arguments),A.invert=t.invert&&D,F()}}function H_(e){var t=0,n=be/3,r=BN(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*it,n=o[1]*it):[t*on,n*on]},i}function ise(e){var t=ve(e);function n(r,i){return[r*t,ce(i)/t]}return n.invert=function(r,i){return[r/t,Fr(i*t)]},n}function ose(e,t){var n=ce(e),r=(n+ce(t))/2;if(ze(r)<pe)return ise(e);var i=1+n*(2*r-n),o=qn(i)/r;function a(s,u){var l=qn(i-2*r*ce(u))/r;return[l*ce(s*=r),o-l*ve(s)]}return a.invert=function(s,u){var l=o-u,c=ko(s,ze(l))*Or(l);return l*r<0&&(c-=be*Or(s)*Or(l)),[c/r,Fr((i-(s*s+l*l)*r*r)/(2*r))]},a}function em(){return H_(ose).scale(155.424).center([0,33.6442])}function zN(){return em().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function ase(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function sse(){var e,t,n=zN(),r,i=em().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,a=em().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],g=d[1];return u=null,r.point(h,g),u||(o.point(h,g),u)||(s.point(h,g),u)}c.invert=function(d){var h=n.scale(),g=n.translate(),p=(d[0]-g[0])/h,m=(d[1]-g[1])/h;return(m>=.12&&m<.234&&p>=-.425&&p<-.214?i:m>=.166&&m<.234&&p>=-.214&&p<-.115?a:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=ase([n.stream(t=d),i.stream(d),a.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),a.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),a.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),g=+d[0],p=+d[1];return r=n.translate(d).clipExtent([[g-.455*h,p-.238*h],[g+.455*h,p+.238*h]]).stream(l),o=i.translate([g-.307*h,p+.201*h]).clipExtent([[g-.425*h+pe,p+.12*h+pe],[g-.214*h-pe,p+.234*h-pe]]).stream(l),s=a.translate([g-.205*h,p+.212*h]).clipExtent([[g-.214*h+pe,p+.166*h+pe],[g-.115*h-pe,p+.234*h-pe]]).stream(l),f()},c.fitExtent=function(d,h){return Qp(c,d,h)},c.fitSize=function(d,h){return z_(c,d,h)},c.fitWidth=function(d,h){return U_(c,d,h)},c.fitHeight=function(d,h){return q_(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function UN(e){return function(t,n){var r=ve(t),i=ve(n),o=e(r*i);return o===1/0?[2,0]:[o*i*ce(t),o*ce(n)]}}function $d(e){return function(t,n){var r=qn(t*t+n*n),i=e(r),o=ce(i),a=ve(i);return[ko(t*o,r*a),Fr(r&&n*o/r)]}}var qN=UN(function(e){return qn(2/(1+e))});qN.invert=$d(function(e){return 2*Fr(e/2)});function use(){return Do(qN).scale(124.75).clipAngle(180-.001)}var HN=UN(function(e){return(e=iN(e))&&e/ce(e)});HN.invert=$d(function(e){return e});function lse(){return Do(HN).scale(79.4188).clipAngle(180-.001)}function tm(e,t){return[e,Pp(w_((lt+t)/2))]}tm.invert=function(e,t){return[e,2*Dl(rN(t))-lt]};function cse(){return WN(tm).scale(961/cr)}function WN(e){var t=Do(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,a=null,s,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=s=u=l=null:(a=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):a==null?null:[[a,s],[u,l]]};function c(){var f=be*r(),d=t(Dae(t.rotate()).invert([0,0]));return o(a==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===tm?[[Math.max(d[0]-f,a),s],[Math.min(d[0]+f,u),l]]:[[a,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function nm(e){return w_((lt+e)/2)}function fse(e,t){var n=ve(e),r=e===t?ce(e):Pp(n/ve(t))/Pp(nm(t)/nm(e)),i=n*x_(nm(e),r)/r;if(!r)return tm;function o(a,s){i>0?s<-lt+pe&&(s=-lt+pe):s>lt-pe&&(s=lt-pe);var u=i/x_(nm(s),r);return[u*ce(r*a),i-u*ve(r*a)]}return o.invert=function(a,s){var u=i-s,l=Or(r)*qn(a*a+u*u),c=ko(a,ze(u))*Or(u);return u*r<0&&(c-=be*Or(a)*Or(u)),[c/r,2*Dl(x_(i/l,1/r))-lt]},o}function dse(){return H_(fse).scale(109.5).parallels([30,30])}function rm(e,t){return[e,t]}rm.invert=rm;function hse(){return Do(rm).scale(152.63)}function gse(e,t){var n=ve(e),r=e===t?ce(e):(n-ve(t))/(t-e),i=n/r+e;if(ze(r)<pe)return rm;function o(a,s){var u=i-s,l=r*a;return[u*ce(l),i-u*ve(l)]}return o.invert=function(a,s){var u=i-s,l=ko(a,ze(u))*Or(u);return u*r<0&&(l-=be*Or(a)*Or(u)),[l/r,i-Or(r)*qn(a*a+u*u)]},o}function pse(){return H_(gse).scale(131.154).center([0,13.9389])}var Sd=1.340264,Cd=-.081106,Od=893e-6,Fd=.003796,im=qn(3)/2,mse=12;function GN(e,t){var n=Fr(im*ce(t)),r=n*n,i=r*r*r;return[e*ve(n)/(im*(Sd+3*Cd*r+i*(7*Od+9*Fd*r))),n*(Sd+Cd*r+i*(Od+Fd*r))]}GN.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,a,s,u;o<mse&&(s=n*(Sd+Cd*r+i*(Od+Fd*r))-t,u=Sd+3*Cd*r+i*(7*Od+9*Fd*r),n-=a=s/u,r=n*n,i=r*r*r,!(ze(a)<tN));++o);return[im*e*(Sd+3*Cd*r+i*(7*Od+9*Fd*r))/ve(n),Fr(ce(n)/im)]};function yse(){return Do(GN).scale(177.158)}function YN(e,t){var n=ve(t),r=ve(e)*n;return[n*ce(e)/r,ce(t)/r]}YN.invert=$d(Dl);function vse(){return Do(YN).scale(144.049).clipAngle(60)}function bse(){var e=1,t=0,n=0,r=1,i=1,o=0,a,s,u=null,l,c,f,d=1,h=1,g=Zp({point:function(x,w){var E=b([x,w]);this.stream.point(E[0],E[1])}}),p=bd,m,y;function v(){return d=e*r,h=e*i,m=y=null,b}function b(x){var w=x[0]*d,E=x[1]*h;if(o){var _=E*a-w*s;w=w*a+E*s,E=_}return[w+t,E+n]}return b.invert=function(x){var w=x[0]-t,E=x[1]-n;if(o){var _=E*a+w*s;w=w*a-E*s,E=_}return[w/d,E/h]},b.stream=function(x){return m&&y===x?m:m=g(p(y=x))},b.postclip=function(x){return arguments.length?(p=x,u=l=c=f=null,v()):p},b.clipExtent=function(x){return arguments.length?(p=x==null?(u=l=c=f=null,bd):vN(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),v()):u==null?null:[[u,l],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,v()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],v()):[t,n]},b.angle=function(x){return arguments.length?(o=x%360*it,s=ce(o),a=ve(o),v()):o*on},b.reflectX=function(x){return arguments.length?(r=x?-1:1,v()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,v()):i<0},b.fitExtent=function(x,w){return Qp(b,x,w)},b.fitSize=function(x,w){return z_(b,x,w)},b.fitWidth=function(x,w){return U_(b,x,w)},b.fitHeight=function(x,w){return q_(b,x,w)},b}function VN(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}VN.invert=function(e,t){var n=t,r=25,i;do{var o=n*n,a=o*o;n-=i=(n*(1.007226+o*(.015085+a*(-.044475+.028874*o-.005916*a)))-t)/(1.007226+o*(.015085*3+a*(-.044475*7+.028874*9*o-.005916*11*a)))}while(ze(i)>pe&&--r>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function xse(){return Do(VN).scale(175.295)}function XN(e,t){return[ve(t)*ce(e),ce(t)]}XN.invert=$d(Fr);function wse(){return Do(XN).scale(249.5).clipAngle(90+pe)}function KN(e,t){var n=ve(t),r=1+ve(e)*n;return[n*ce(e)/r,ce(t)/r]}KN.invert=$d(function(e){return 2*Dl(e)});function _se(){return Do(KN).scale(250).clipAngle(142)}function JN(e,t){return[Pp(w_((lt+t)/2)),-e]}JN.invert=function(e,t){return[-t,2*Dl(rN(e))-lt]};function Ese(){var e=WN(JN),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}class Ase{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[r++]=s),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}function*$se(e){for(const t of e)yield*t}function ZN(e){return Array.from($se(e))}var Xe=1e-6,Sse=1e-12,Se=Math.PI,Dr=Se/2,QN=Se/4,ni=Se*2,Mo=180/Se,fr=Se/180,ht=Math.abs,Cse=Math.atan,kd=Math.atan2,gt=Math.cos,pt=Math.sin,Ose=Math.sign||function(e){return e>0?1:e<0?-1:0},om=Math.sqrt;function Fse(e){return e>1?0:e<-1?Se:Math.acos(e)}function Dd(e){return e>1?Dr:e<-1?-Dr:Math.asin(e)}function Md(){}function am(e,t){e&&t4.hasOwnProperty(e.type)&&t4[e.type](e,t)}var e4={Feature:function(e,t){am(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)am(n[r].geometry,t)}},t4={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){W_(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)W_(n[r],t,0)},Polygon:function(e,t){n4(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)n4(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)am(n[r],t)}};function W_(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function n4(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)W_(e[n],t,1);t.polygonEnd()}function kse(e,t){e&&e4.hasOwnProperty(e.type)?e4[e.type](e,t):am(e,t)}function G_(e){return[kd(e[1],e[0]),Dd(e[2])]}function jl(e){var t=e[0],n=e[1],r=gt(n);return[r*gt(t),r*pt(t),pt(n)]}function sm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function um(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Y_(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function lm(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function V_(e){var t=om(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function X_(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function K_(e,t){return[ht(e)>Se?e+Math.round(-e/ni)*ni:e,t]}K_.invert=K_;function Dse(e,t,n){return(e%=ni)?t||n?X_(i4(e),o4(t,n)):i4(e):t||n?o4(t,n):K_}function r4(e){return function(t,n){return t+=e,[t>Se?t-ni:t<-Se?t+ni:t,n]}}function i4(e){var t=r4(e);return t.invert=r4(-e),t}function o4(e,t){var n=gt(e),r=pt(e),i=gt(t),o=pt(t);function a(s,u){var l=gt(u),c=gt(s)*l,f=pt(s)*l,d=pt(u),h=d*n+c*r;return[kd(f*i-h*o,c*n-d*r),Dd(h*i+f*o)]}return a.invert=function(s,u){var l=gt(u),c=gt(s)*l,f=pt(s)*l,d=pt(u),h=d*i-f*o;return[kd(f*i+d*o,c*n+h*r),Dd(h*n-c*r)]},a}function Mse(e,t,n,r,i,o){if(!!n){var a=gt(t),s=pt(t),u=r*n;i==null?(i=t+r*ni,o=t-u/2):(i=a4(a,i),o=a4(a,o),(r>0?i<o:i>o)&&(i+=r*ni));for(var l,c=i;r>0?c>o:c<o;c-=u)l=G_([a,-s*gt(c),-s*pt(c)]),e.point(l[0],l[1])}}function a4(e,t){t=jl(t),t[0]-=e,V_(t);var n=Fse(-t[1]);return((-t[2]<0?-n:n)+ni-Xe)%ni}function s4(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Md,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function cm(e,t){return ht(e[0]-t[0])<Xe&&ht(e[1]-t[1])<Xe}function fm(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function u4(e,t,n,r,i){var o=[],a=[],s,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(cm(m,y)){if(!m[2]&&!y[2]){for(i.lineStart(),s=0;s<p;++s)i.point((m=g[s])[0],m[1]);i.lineEnd();return}y[0]+=2*Xe}o.push(v=new fm(m,g,null,!0)),a.push(v.o=new fm(m,null,v,!1)),o.push(v=new fm(y,g,null,!1)),a.push(v.o=new fm(y,null,v,!0))}}),!!o.length){for(a.sort(t),l4(o),l4(a),s=0,u=a.length;s<u;++s)a[s].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)i.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function l4(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function J_(e){return ht(e[0])<=Se?e[0]:Ose(e[0])*((ht(e[0])+Se)%ni-Se)}function Tse(e,t){var n=J_(t),r=t[1],i=pt(r),o=[pt(n),-gt(n),0],a=0,s=0,u=new Ase;i===1?r=Dr+Xe:i===-1&&(r=-Dr-Xe);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],g=J_(h),p=h[1]/2+QN,m=pt(p),y=gt(p),v=0;v<d;++v,g=x,m=E,y=_,h=b){var b=f[v],x=J_(b),w=b[1]/2+QN,E=pt(w),_=gt(w),$=x-g,C=$>=0?1:-1,O=C*$,A=O>Se,D=m*E;if(u.add(kd(D*C*pt(O),y*_+D*gt(O))),a+=A?$+C*ni:$,A^g>=n^x>=n){var F=um(jl(h),jl(b));V_(F);var T=um(o,F);V_(T);var S=(A^$>=0?-1:1)*Dd(T[2]);(r>S||r===S&&(F[0]||F[1]))&&(s+=A^$>=0?1:-1)}}return(a<-Xe||a<Xe&&u<-Sse)^s&1}function c4(e,t,n,r){return function(i){var o=t(i),a=s4(),s=t(a),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=ZN(c);var x=Tse(l,r);c.length?(u||(i.polygonStart(),u=!0),u4(c,Rse,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function g(x,w){o.point(x,w)}function p(){d.point=g,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(x,w){f.push([x,w]),s.point(x,w)}function v(){s.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=a.result(),E,_=w.length,$,C,O;if(f.pop(),l.push(f),f=null,!!_){if(x&1){if(C=w[0],($=C.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),E=0;E<$;++E)i.point((O=C[E])[0],O[1]);i.lineEnd()}return}_>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Nse))}}return d}}function Nse(e){return e.length>1}function Rse(e,t){return((e=e.x)[0]<0?e[1]-Dr-Xe:Dr-e[1])-((t=t.x)[0]<0?t[1]-Dr-Xe:Dr-t[1])}var f4=c4(function(){return!0},jse,Pse,[-Se,-Dr]);function jse(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,a){var s=o>0?Se:-Se,u=ht(o-t);ht(u-Se)<Xe?(e.point(t,n=(n+a)/2>0?Dr:-Dr),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),i=0):r!==s&&u>=Se&&(ht(t-r)<Xe&&(t-=r*Xe),ht(o-s)<Xe&&(o-=s*Xe),n=Lse(t,n,o,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=o,n=a),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function Lse(e,t,n,r){var i,o,a=pt(e-n);return ht(a)>Xe?Cse((pt(t)*(o=gt(r))*pt(n)-pt(r)*(i=gt(t))*pt(e))/(i*o*a)):(t+r)/2}function Pse(e,t,n,r){var i;if(e==null)i=n*Dr,r.point(-Se,i),r.point(0,i),r.point(Se,i),r.point(Se,0),r.point(Se,-i),r.point(0,-i),r.point(-Se,-i),r.point(-Se,0),r.point(-Se,i);else if(ht(e[0]-t[0])>Xe){var o=e[0]<t[0]?Se:-Se;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function Ise(e){var t=gt(e),n=6*fr,r=t>0,i=ht(t)>Xe;function o(c,f,d,h){Mse(h,e,n,d,c,f)}function a(c,f){return gt(c)*gt(f)>t}function s(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var v=[m,y],b,x=a(m,y),w=r?x?0:l(m,y):x?l(m+(m<0?Se:-Se),y):0;if(!f&&(g=h=x)&&c.lineStart(),x!==h&&(b=u(f,v),(!b||cm(f,b)||cm(v,b))&&(v[2]=1)),x!==h)p=0,x?(c.lineStart(),b=u(v,f),c.point(b[0],b[1])):(b=u(f,v),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var E;!(w&d)&&(E=u(v,f,!0))&&(p=0,r?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}x&&(!f||!cm(f,v))&&c.point(v[0],v[1]),f=v,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=jl(c),g=jl(f),p=[1,0,0],m=um(h,g),y=sm(m,m),v=m[0],b=y-v*v;if(!b)return!d&&c;var x=t*y/b,w=-t*v/b,E=um(p,m),_=lm(p,x),$=lm(m,w);Y_(_,$);var C=E,O=sm(_,C),A=sm(C,C),D=O*O-A*(sm(_,_)-1);if(!(D<0)){var F=om(D),T=lm(C,(-O-F)/A);if(Y_(T,_),T=G_(T),!d)return T;var S=c[0],M=f[0],P=c[1],B=f[1],H;M<S&&(H=S,S=M,M=H);var ie=M-S,le=ht(ie-Se)<Xe,he=le||ie<Xe;if(!le&&B<P&&(H=P,P=B,B=H),he?le?P+B>0^T[1]<(ht(T[0]-S)<Xe?P:B):P<=T[1]&&T[1]<=B:ie>Se^(S<=T[0]&&T[0]<=M)){var Ae=lm(C,(-O+F)/A);return Y_(Ae,_),[T,G_(Ae)]}}}function l(c,f){var d=r?e:Se-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return c4(a,s,o,r?[0,-e]:[-Se,e-Se])}function Bse(e,t,n,r,i,o){var a=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-a,h=l-s,g;if(g=n-a,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=i-a,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=r-s,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=o-s,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=a+c*d,e[1]=s+c*h),f<1&&(t[0]=a+f*d,t[1]=s+f*h),!0}}}}}var Td=1e9,dm=-Td;function zse(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function o(l,c,f,d){var h=0,g=0;if(l==null||(h=a(l,f))!==(g=a(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function a(l,c){return ht(l[0]-e)<Xe?c>0?0:3:ht(l[0]-n)<Xe?c>0?2:1:ht(l[1]-t)<Xe?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=a(l,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=s4(),d,h,g,p,m,y,v,b,x,w,E,_={point:$,lineStart:D,lineEnd:F,polygonStart:O,polygonEnd:A};function $(S,M){i(S,M)&&c.point(S,M)}function C(){for(var S=0,M=0,P=h.length;M<P;++M)for(var B=h[M],H=1,ie=B.length,le=B[0],he,Ae,$e=le[0],Pe=le[1];H<ie;++H)he=$e,Ae=Pe,le=B[H],$e=le[0],Pe=le[1],Ae<=r?Pe>r&&($e-he)*(r-Ae)>(Pe-Ae)*(e-he)&&++S:Pe<=r&&($e-he)*(r-Ae)<(Pe-Ae)*(e-he)&&--S;return S}function O(){c=f,d=[],h=[],E=!0}function A(){var S=C(),M=E&&S,P=(d=ZN(d)).length;(M||P)&&(l.polygonStart(),M&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),P&&u4(d,s,S,o,l),l.polygonEnd()),c=l,d=h=g=null}function D(){_.point=T,h&&h.push(g=[]),w=!0,x=!1,v=b=NaN}function F(){d&&(T(p,m),y&&x&&f.rejoin(),d.push(f.result())),_.point=$,x&&c.lineEnd()}function T(S,M){var P=i(S,M);if(h&&g.push([S,M]),w)p=S,m=M,y=P,w=!1,P&&(c.lineStart(),c.point(S,M));else if(P&&x)c.point(S,M);else{var B=[v=Math.max(dm,Math.min(Td,v)),b=Math.max(dm,Math.min(Td,b))],H=[S=Math.max(dm,Math.min(Td,S)),M=Math.max(dm,Math.min(Td,M))];Bse(B,H,e,t,n,r)?(x||(c.lineStart(),c.point(B[0],B[1])),c.point(H[0],H[1]),P||c.lineEnd(),E=!1):P&&(c.lineStart(),c.point(S,M),E=!1)}v=S,b=M,x=P}return _}}var d4=e=>e,Ll=1/0,hm=Ll,Nd=-Ll,gm=Nd,Use={point:qse,lineStart:Md,lineEnd:Md,polygonStart:Md,polygonEnd:Md,result:function(){var e=[[Ll,hm],[Nd,gm]];return Nd=gm=-(hm=Ll=1/0),e}};function qse(e,t){e<Ll&&(Ll=e),e>Nd&&(Nd=e),t<hm&&(hm=t),t>gm&&(gm=t)}var h4=Use;function Z_(e){return function(t){var n=new Q_;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Q_(){}Q_.prototype={constructor:Q_,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function eE(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),kse(n,e.stream(h4)),t(h4.result()),r!=null&&e.clipExtent(r),e}function g4(e,t,n){return eE(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),s=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([s,u])},n)}function Hse(e,t,n){return g4(e,[[0,0],t],n)}function Wse(e,t,n){return eE(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),a=(i-o*(r[1][0]+r[0][0]))/2,s=-o*r[0][1];e.scale(150*o).translate([a,s])},n)}function Gse(e,t,n){return eE(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),a=-o*r[0][0],s=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var p4=16,Yse=gt(30*fr);function m4(e,t){return+t?Xse(e,t):Vse(e)}function Vse(e){return Z_({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Xse(e,t){function n(r,i,o,a,s,u,l,c,f,d,h,g,p,m){var y=l-r,v=c-i,b=y*y+v*v;if(b>4*t&&p--){var x=a+d,w=s+h,E=u+g,_=om(x*x+w*w+E*E),$=Dd(E/=_),C=ht(ht(E)-1)<Xe||ht(o-f)<Xe?(o+f)/2:kd(w,x),O=e(C,$),A=O[0],D=O[1],F=A-r,T=D-i,S=v*F-y*T;(S*S/b>t||ht((y*F+v*T)/b-.5)>.3||a*d+s*h+u*g<Yse)&&(n(r,i,o,a,s,u,A,D,C,x/=_,w/=_,E,p,m),m.point(A,D),n(A,D,C,x,w,E,l,c,f,d,h,g,p,m))}}return function(r){var i,o,a,s,u,l,c,f,d,h,g,p,m={point:y,lineStart:v,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=v}};function y($,C){$=e($,C),r.point($[0],$[1])}function v(){f=NaN,m.point=b,r.lineStart()}function b($,C){var O=jl([$,C]),A=e($,C);n(f,d,c,h,g,p,f=A[0],d=A[1],c=$,h=O[0],g=O[1],p=O[2],p4,r),r.point(f,d)}function x(){m.point=y,r.lineEnd()}function w(){v(),m.point=E,m.lineEnd=_}function E($,C){b(i=$,C),o=f,a=d,s=h,u=g,l=p,m.point=b}function _(){n(f,d,c,h,g,p,o,a,i,s,u,l,p4,r),m.lineEnd=x,x()}return m}}var Kse=Z_({point:function(e,t){this.stream.point(e*fr,t*fr)}});function Jse(e){return Z_({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function Zse(e,t,n,r,i){function o(a,s){return a*=r,s*=i,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*r,(n-s)/e*i]},o}function y4(e,t,n,r,i,o){if(!o)return Zse(e,t,n,r,i);var a=gt(o),s=pt(o),u=a*e,l=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function g(p,m){return p*=r,m*=i,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[r*(c*p-f*m+d),i*(h-f*p-c*m)]},g}function Qse(e){return eue(function(){return e})()}function eue(e){var t,n=150,r=480,i=250,o=0,a=0,s=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=f4,m=null,y,v,b,x=d4,w=.5,E,_,$,C,O;function A(S){return $(S[0]*fr,S[1]*fr)}function D(S){return S=$.invert(S[0],S[1]),S&&[S[0]*Mo,S[1]*Mo]}A.stream=function(S){return C&&O===S?C:C=Kse(Jse(c)(p(E(x(O=S)))))},A.preclip=function(S){return arguments.length?(p=S,g=void 0,T()):p},A.postclip=function(S){return arguments.length?(x=S,m=y=v=b=null,T()):x},A.clipAngle=function(S){return arguments.length?(p=+S?Ise(g=S*fr):(g=null,f4),T()):g*Mo},A.clipExtent=function(S){return arguments.length?(x=S==null?(m=y=v=b=null,d4):zse(m=+S[0][0],y=+S[0][1],v=+S[1][0],b=+S[1][1]),T()):m==null?null:[[m,y],[v,b]]},A.scale=function(S){return arguments.length?(n=+S,F()):n},A.translate=function(S){return arguments.length?(r=+S[0],i=+S[1],F()):[r,i]},A.center=function(S){return arguments.length?(o=S[0]%360*fr,a=S[1]%360*fr,F()):[o*Mo,a*Mo]},A.rotate=function(S){return arguments.length?(s=S[0]%360*fr,u=S[1]%360*fr,l=S.length>2?S[2]%360*fr:0,F()):[s*Mo,u*Mo,l*Mo]},A.angle=function(S){return arguments.length?(f=S%360*fr,F()):f*Mo},A.reflectX=function(S){return arguments.length?(d=S?-1:1,F()):d<0},A.reflectY=function(S){return arguments.length?(h=S?-1:1,F()):h<0},A.precision=function(S){return arguments.length?(E=m4(_,w=S*S),T()):om(w)},A.fitExtent=function(S,M){return g4(A,S,M)},A.fitSize=function(S,M){return Hse(A,S,M)},A.fitWidth=function(S,M){return Wse(A,S,M)},A.fitHeight=function(S,M){return Gse(A,S,M)};function F(){var S=y4(n,0,0,d,h,f).apply(null,t(o,a)),M=y4(n,r-S[0],i-S[1],d,h,f);return c=Dse(s,u,l),_=X_(t,M),$=X_(c,_),E=m4(_,w),T()}function T(){return C=O=null,A}return function(){return t=e.apply(this,arguments),A.invert=t.invert&&D,F()}}var tue=Math.abs,tE=Math.cos,pm=Math.sin,nue=1e-6,v4=Math.PI,nE=v4/2,b4=rue(2);function x4(e){return e>1?nE:e<-1?-nE:Math.asin(e)}function rue(e){return e>0?Math.sqrt(e):0}function iue(e,t){var n=e*pm(t),r=30,i;do t-=i=(t+pm(t)-n)/(1+tE(t));while(tue(i)>nue&&--r>0);return t/2}function oue(e,t,n){function r(i,o){return[e*i*tE(o=iue(n,o)),t*pm(o)]}return r.invert=function(i,o){return o=x4(o/t),[i/(e*tE(o)),x4((2*o+pm(2*o))/n)]},r}var aue=oue(b4/nE,b4,v4);function sue(){return Qse(aue).scale(169.529)}const uue=jN(),rE=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function lue(e,t){return function n(){const r=t();return r.type=e,r.path=jN().projection(r),r.copy=r.copy||function(){const i=n();return rE.forEach(o=>{r[o]&&i[o](r[o]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function iE(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(mm[e]=lue(e,t),this):mm[e]||null}function w4(e){return e&&e.path||uue}const mm={albers:zN,albersusa:sse,azimuthalequalarea:use,azimuthalequidistant:lse,conicconformal:dse,conicequalarea:em,conicequidistant:pse,equalEarth:yse,equirectangular:hse,gnomonic:vse,identity:bse,mercator:cse,mollweide:sue,naturalEarth1:xse,orthographic:wse,stereographic:_se,transversemercator:Ese};for(const e in mm)iE(e,mm[e]);var Ta=1e-6,_4=Math.abs,ym=Math.ceil;function E4(e,t,n){var r=Ws(e,t-Ta,n).concat(t);return function(i){return r.map(function(o){return[i,o]})}}function A4(e,t,n){var r=Ws(e,t-Ta,n).concat(t);return function(i){return r.map(function(o){return[o,i]})}}function cue(){var e,t,n,r,i,o,a,s,u=10,l=u,c=90,f=360,d,h,g,p,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return Ws(ym(r/c)*c,n,c).map(g).concat(Ws(ym(s/f)*f,a,f).map(p)).concat(Ws(ym(t/u)*u,e,u).filter(function(b){return _4(b%c)>Ta}).map(d)).concat(Ws(ym(o/l)*l,i,l).filter(function(b){return _4(b%f)>Ta}).map(h))}return y.lines=function(){return v().map(function(b){return{type:"LineString",coordinates:b}})},y.outline=function(){return{type:"Polygon",coordinates:[g(r).concat(p(a).slice(1),g(n).reverse().slice(1),p(s).reverse().slice(1))]}},y.extent=function(b){return arguments.length?y.extentMajor(b).extentMinor(b):y.extentMinor()},y.extentMajor=function(b){return arguments.length?(r=+b[0][0],n=+b[1][0],s=+b[0][1],a=+b[1][1],r>n&&(b=r,r=n,n=b),s>a&&(b=s,s=a,a=b),y.precision(m)):[[r,s],[n,a]]},y.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],o=+b[0][1],i=+b[1][1],t>e&&(b=t,t=e,e=b),o>i&&(b=o,o=i,i=b),y.precision(m)):[[t,o],[e,i]]},y.step=function(b){return arguments.length?y.stepMajor(b).stepMinor(b):y.stepMinor()},y.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],y):[c,f]},y.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],y):[u,l]},y.precision=function(b){return arguments.length?(m=+b,d=E4(o,i,90),h=A4(t,e,m),g=E4(s,a,90),p=A4(r,n,m),y):m},y.extentMajor([[-180,-90+Ta],[180,90-Ta]]).extentMinor([[-180,-80-Ta],[180,80+Ta]])}function oE(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function $4(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Rd(){}var jd=.7,vm=1/jd,Pl="\\s*([+-]?\\d+)\\s*",Ld="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ui="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fue=/^#([0-9a-f]{3,8})$/,due=new RegExp("^rgb\\("+[Pl,Pl,Pl]+"\\)$"),hue=new RegExp("^rgb\\("+[Ui,Ui,Ui]+"\\)$"),gue=new RegExp("^rgba\\("+[Pl,Pl,Pl,Ld]+"\\)$"),pue=new RegExp("^rgba\\("+[Ui,Ui,Ui,Ld]+"\\)$"),mue=new RegExp("^hsl\\("+[Ld,Ui,Ui]+"\\)$"),yue=new RegExp("^hsla\\("+[Ld,Ui,Ui,Ld]+"\\)$"),S4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};oE(Rd,aE,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:C4,formatHex:C4,formatHsl:vue,formatRgb:O4,toString:O4});function C4(){return this.rgb().formatHex()}function vue(){return T4(this).formatHsl()}function O4(){return this.rgb().formatRgb()}function aE(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=fue.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?F4(t):n===3?new dr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?bm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?bm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=due.exec(e))?new dr(t[1],t[2],t[3],1):(t=hue.exec(e))?new dr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=gue.exec(e))?bm(t[1],t[2],t[3],t[4]):(t=pue.exec(e))?bm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=mue.exec(e))?M4(t[1],t[2]/100,t[3]/100,1):(t=yue.exec(e))?M4(t[1],t[2]/100,t[3]/100,t[4]):S4.hasOwnProperty(e)?F4(S4[e]):e==="transparent"?new dr(NaN,NaN,NaN,0):null}function F4(e){return new dr(e>>16&255,e>>8&255,e&255,1)}function bm(e,t,n,r){return r<=0&&(e=t=n=NaN),new dr(e,t,n,r)}function bue(e){return e instanceof Rd||(e=aE(e)),e?(e=e.rgb(),new dr(e.r,e.g,e.b,e.opacity)):new dr}function sE(e,t,n,r){return arguments.length===1?bue(e):new dr(e,t,n,r==null?1:r)}function dr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}oE(dr,sE,$4(Rd,{brighter:function(e){return e=e==null?vm:Math.pow(vm,e),new dr(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?jd:Math.pow(jd,e),new dr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:k4,formatHex:k4,formatRgb:D4,toString:D4}));function k4(){return"#"+uE(this.r)+uE(this.g)+uE(this.b)}function D4(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function uE(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function M4(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new qi(e,t,n,r)}function T4(e){if(e instanceof qi)return new qi(e.h,e.s,e.l,e.opacity);if(e instanceof Rd||(e=aE(e)),!e)return new qi;if(e instanceof qi)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new qi(a,s,u,e.opacity)}function xue(e,t,n,r){return arguments.length===1?T4(e):new qi(e,t,n,r==null?1:r)}function qi(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}oE(qi,xue,$4(Rd,{brighter:function(e){return e=e==null?vm:Math.pow(vm,e),new qi(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?jd:Math.pow(jd,e),new qi(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new dr(lE(e>=240?e-240:e+120,i,r),lE(e,i,r),lE(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function lE(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function wue(){}const To=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function N4(){var e=1,t=1,n=s;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return o(u,l,d=>{n(d,u,l),_ue(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,g=c.length,p;h<g;++h)if(Eue((p=c[h])[0],d)!==-1){p.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function o(u,l,c){var f=new Array,d=new Array,h,g,p,m,y,v;for(h=g=-1,m=u[0]>=l,To[m<<1].forEach(b);++h<e-1;)p=m,m=u[h+1]>=l,To[p|m<<1].forEach(b);for(To[m<<0].forEach(b);++g<t-1;){for(h=-1,m=u[g*e+e]>=l,y=u[g*e]>=l,To[m<<1|y<<2].forEach(b);++h<e-1;)p=m,m=u[g*e+e+h+1]>=l,v=y,y=u[g*e+h+1]>=l,To[p|m<<1|y<<2|v<<3].forEach(b);To[m|y<<3].forEach(b)}for(h=-1,y=u[g*e]>=l,To[y<<2].forEach(b);++h<e-1;)v=y,y=u[g*e+h+1]>=l,To[y<<2|v<<3].forEach(b);To[y<<3].forEach(b);function b(x){var w=[x[0][0]+h,x[0][1]+g],E=[x[1][0]+h,x[1][1]+g],_=a(w),$=a(E),C,O;(C=d[_])?(O=f[$])?(delete d[C.end],delete f[O.start],C===O?(C.ring.push(E),c(C.ring)):f[C.start]=d[O.end]={start:C.start,end:O.end,ring:C.ring.concat(O.ring)}):(delete d[C.end],C.ring.push(E),d[C.end=$]=C):(C=f[$])?(O=d[_])?(delete f[C.start],delete d[O.end],C===O?(C.ring.push(E),c(C.ring)):f[O.start]=d[C.end]={start:O.start,end:C.end,ring:O.ring.concat(C.ring)}):(delete f[C.start],C.ring.unshift(w),f[C.start=_]=C):f[_]=d[$]={start:_,end:$,ring:[w,E]}}}function a(u){return u[0]*2+u[1]*(e+1)*4}function s(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],g=d|0,p=h|0,m,y=l[p*e+g];d>0&&d<e&&g===d&&(m=l[p*e+g-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&p===h&&(m=l[(p-1)*e+g],f[1]=h+(c-m)/(y-m)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||I("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?s:wue,r):n===s},r}function _ue(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function Eue(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=Aue(e,t[n]))return i;return 0}function Aue(e,t){for(var n=t[0],r=t[1],i=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var u=e[o],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if($ue(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function $ue(e,t,n){var r;return Sue(e,t,n)&&Cue(e[r=+(e[0]===t[0])],n[r],t[r])}function Sue(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function Cue(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function R4(e,t,n){return function(r){var i=Ai(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,u=t?Oae(o,a,e):s/(e+1);return Ws(o+u,a,u)}}function cE(e){N.call(this,null,e)}cE.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};q(cE,N,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||yn,o=N4().smooth(e.smooth!==!1),a=e.thresholds||Oue(r,i,e),s=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=o.size([c.width,c.height])(c.values,Q(a)?a:a(c.values));Fue(f,c,l,e),f.forEach(d=>{u.push(hg(l,Le(s!=null?{[s]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Oue(e,t,n){const r=R4(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>Lp(t(i).values)))}function Fue(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(me(i)&&(i=i(n,r)),me(o)&&(o=o(n,r)),(i===1||i==null)&&!o)return;const a=(ua(i)?i:i[0])||1,s=(ua(i)?i:i[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(j4(t,a,s,u,l))}function j4(e,t,n,r,i){const o=e.x1||0,a=e.y1||0,s=t*n<0;function u(f){f.forEach(l)}function l(f){s&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+r,f[1]=(f[1]-a)*n+i}return function(f){return f.coordinates.forEach(u),f}}function L4(e,t,n){const r=e>=0?e:Gb(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function fE(e){return me(e)?e:Jt(+e)}function P4(){var e=u=>u[0],t=u=>u[1],n=Xu,r=[-1,-1],i=960,o=500,a=2;function s(u,l){const c=L4(r[0],u,e)>>a,f=L4(r[1],u,t)>>a,d=c?c+2:0,h=f?f+2:0,g=2*d+(i>>a),p=2*h+(o>>a),m=new Float32Array(g*p),y=new Float32Array(g*p);let v=m;u.forEach(x=>{const w=d+(+e(x)>>a),E=h+(+t(x)>>a);w>=0&&w<g&&E>=0&&E<p&&(m[w+E*g]+=+n(x))}),c>0&&f>0?(Il(g,p,m,y,c),Bl(g,p,y,m,f),Il(g,p,m,y,c),Bl(g,p,y,m,f),Il(g,p,m,y,c),Bl(g,p,y,m,f)):c>0?(Il(g,p,m,y,c),Il(g,p,y,m,c),Il(g,p,m,y,c),v=y):f>0&&(Bl(g,p,m,y,f),Bl(g,p,y,m,f),Bl(g,p,m,y,f),v=y);const b=l?Math.pow(2,-2*a):1/Fae(v);for(let x=0,w=g*p;x<w;++x)v[x]*=b;return{values:v,scale:1<<a,width:g,height:p,x1:d,y1:h,x2:d+(i>>a),y2:h+(o>>a)}}return s.x=function(u){return arguments.length?(e=fE(u),s):e},s.y=function(u){return arguments.length?(t=fE(u),s):t},s.weight=function(u){return arguments.length?(n=fE(u),s):n},s.size=function(u){if(!arguments.length)return[i,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||I("invalid size"),i=l,o=c,s},s.cellSize=function(u){return arguments.length?((u=+u)>=1||I("invalid cell size"),a=Math.floor(Math.log(u)/Math.LN2),s):1<<a},s.bandwidth=function(u){return arguments.length?(u=oe(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&I("invalid bandwidth"),r=u,s):r},s}function Il(e,t,n,r,i){const o=(i<<1)+1;for(let a=0;a<t;++a)for(let s=0,u=0;s<e+i;++s)s<e&&(u+=n[s+a*e]),s>=i&&(s>=o&&(u-=n[s-o+a*e]),r[s-i+a*e]=u/Math.min(s+1,e-1+o-s,o))}function Bl(e,t,n,r,i){const o=(i<<1)+1;for(let a=0;a<e;++a)for(let s=0,u=0;s<t+i;++s)s<t&&(u+=n[a+s*e]),s>=i&&(s>=o&&(u-=n[a+(s-o)*e]),r[a+(s-i)*e]=u/Math.min(s+1,t-1+o-s,o))}function dE(e){N.call(this,null,e)}dE.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const kue=["x","y","weight","size","cellSize","bandwidth"];function I4(e,t){return kue.forEach(n=>t[n]!=null?e[n](t[n]):0),e}q(dE,N,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=Due(r,e.groupby),o=(e.groupby||[]).map(ut),a=I4(P4(),e),s=e.as||"grid",u=[];function l(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return u=i.map(c=>Le(l({[s]:a(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Due(e,t){var n=[],r=c=>c(s),i,o,a,s,u,l;if(t==null)n.push(e);else for(i={},o=0,a=e.length;o<a;++o)s=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function hE(e){N.call(this,null,e)}hE.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};q(hE,N,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=N4().smooth(e.smooth!==!1),i=e.values,o=e.thresholds||R4(e.count||10,e.nice,!!i),a=e.size,s,u;return i||(i=t.materialize(t.SOURCE).source,s=I4(P4(),e)(i,!0),u=j4(s,s.scale||1,s.scale||1,0,0),a=[s.width,s.height],i=s.values),o=Q(o)?o:o(i),i=r.size(a)(i,o),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(Le),n}});const gE="Feature",pE="FeatureCollection",Mue="MultiPoint";function mE(e){N.call(this,null,e)}mE.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};q(mE,N,{transform(e,t){var n=this._features,r=this._points,i=e.fields,o=i&&i[0],a=i&&i[1],s=e.geojson||!i&&yn,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Xt(s))||o&&t.modified(Xt(o))||a&&t.modified(Xt(a)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),s&&t.visit(u,c=>n.push(s(c))),o&&a&&(t.visit(u,c=>{var f=o(c),d=a(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:gE,geometry:{type:Mue,coordinates:r}})),this.value={type:pE,features:n}}});function yE(e){N.call(this,null,e)}yE.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};q(yE,N,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||yn,o=e.as||"path",a=n.SOURCE;!r||e.modified()?(this.value=r=w4(e.projection),n.materialize().reflow()):a=i===yn||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=Tue(r,e.pointRadius);return n.visit(a,u=>u[o]=r(i(u))),r.pointRadius(s),n.modifies(o)}});function Tue(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function vE(e){N.call(this,null,e)}vE.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};q(vE,N,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],a=o[0],s=o[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[a]=f[0],c[s]=f[1]):(c[a]=void 0,c[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}});function bE(e){N.call(this,null,e)}bE.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};q(bE,N,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return(!r||e.modified())&&(this.value=r=Nue(w4(e.projection),e.field||Ln("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,a=>a[i]=r),n.modifies(i)}});function Nue(e,t,n){const r=n==null?i=>e(t(i)):i=>{var o=e.pointRadius(),a=e.pointRadius(n)(t(i));return e.pointRadius(o),a};return r.context=i=>(e.context(i),r),r}function xE(e){N.call(this,[],e),this.generator=cue()}xE.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};q(xE,N,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const o in e)me(r[o])&&r[o](e[o]);return i=r(),n.length?t.mod.push(Vk(n[0],i)):t.add.push(Le(i)),n[0]=i,t}});function wE(e){N.call(this,null,e)}wE.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};q(wE,N,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||yn,o=jue(e.opacity,e),a=Rue(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?Lp(n.map(l=>Lp(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=ge({},l,u);r||(f.$max=Lp(c.values||[])),l[s]=Lue(c,f,a.dep?a:Jt(a(f)),o.dep?o:Jt(o(f)))}),t.reflow(!0).modifies(s)}});function Rue(e,t){let n;return me(e)?(n=r=>sE(e(r,t)),n.dep=B4(e)):n=Jt(sE(e||"#888")),n}function jue(e,t){let n;return me(e)?(n=r=>e(r,t),n.dep=B4(e)):e?n=Jt(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function B4(e){if(!me(e))return!1;const t=Yr(Xt(e));return t.$x||t.$y||t.$value||t.$max}function Lue(e,t,n,r){const i=e.width,o=e.height,a=e.x1||0,s=e.y1||0,u=e.x2||i,l=e.y2||o,c=e.values,f=c?m=>c[m]:oa,d=ll(u-a,l-s),h=d.getContext("2d"),g=h.getImageData(0,0,u-a,l-s),p=g.data;for(let m=s,y=0;m<l;++m){t.$y=m-s;for(let v=a,b=m*i;v<u;++v,y+=4){t.$x=v-a,t.$value=f(v+b);const x=n(t);p[y+0]=x.r,p[y+1]=x.g,p[y+2]=x.b,p[y+3]=~~(255*r(t))}}return h.putImageData(g,0,0),d}function z4(e){N.call(this,null,e),this.modified(!0)}q(z4,N,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Iue(e.type),rE.forEach(r=>{e[r]!=null&&U4(n,r,e[r])})):rE.forEach(r=>{e.modified(r)&&U4(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Pue(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Pue(e,t){const n=Bue(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Iue(e){const t=iE((e||"mercator").toLowerCase());return t||I("Unrecognized projection type: "+e),t()}function U4(e,t,n){me(e[t])&&e[t](n)}function Bue(e){return e=oe(e),e.length===1?e[0]:{type:pE,features:e.reduce((t,n)=>t.concat(zue(n)),[])}}function zue(e){return e.type===pE?e.features:oe(e).filter(t=>t!=null).map(t=>t.type===gE?t:{type:gE,geometry:t})}var Uue=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:hE,geojson:mE,geopath:yE,geopoint:vE,geoshape:bE,graticule:xE,heatmap:wE,isocontour:cE,kde2d:dE,projection:z4});function que(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var o,a=n.length,s,u=0,l=0;for(o=0;o<a;++o)s=n[o],u+=s.x,l+=s.y;for(u=(u/a-e)*r,l=(l/a-t)*r,o=0;o<a;++o)s=n[o],s.x-=u,s.y-=l}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(t=+o,i):t},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function Hue(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return q4(this.cover(t,n),t,n,e)}function q4(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o=e._root,a={data:r},s=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,g,p,m,y,v;if(!o)return e._root=a,e;for(;o.length;)if((p=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,i=o,!(o=o[y=m<<1|p]))return i[y]=a,e;if(h=+e._x.call(null,o.data),g=+e._y.call(null,o.data),t===h&&n===g)return a.next=o,i?i[y]=a:e._root=a,e;do i=i?i[y]=new Array(4):e._root=new Array(4),(p=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|p)==(v=(g>=d)<<1|h>=f));return i[v]=o,i[y]=a,e}function Wue(e){var t,n,r=e.length,i,o,a=new Array(r),s=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(a[n]=i,s[n]=o,i<u&&(u=i),i>c&&(c=i),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)q4(this,a[n],s[n],e[n]);return this}function Gue(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var a=i-n||1,s=this._root,u,l;n>e||e>=i||r>t||t>=o;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=s,s=u,a*=2,l){case 0:i=n+a,o=r+a;break;case 1:n=i-a,o=r+a;break;case 2:i=n+a,r=o-a;break;case 3:n=i-a,r=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function Yue(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Vue(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function xn(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Xue(e,t,n){var r,i=this._x0,o=this._y0,a,s,u,l,c=this._x1,f=this._y1,d=[],h=this._root,g,p;for(h&&d.push(new xn(h,i,o,c,f)),n==null?n=1/0:(i=e-n,o=t-n,c=e+n,f=t+n,n*=n);g=d.pop();)if(!(!(h=g.node)||(a=g.x0)>c||(s=g.y0)>f||(u=g.x1)<i||(l=g.y1)<o))if(h.length){var m=(a+u)/2,y=(s+l)/2;d.push(new xn(h[3],m,y,u,l),new xn(h[2],a,y,m,l),new xn(h[1],m,s,u,y),new xn(h[0],a,s,m,y)),(p=(t>=y)<<1|e>=m)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-p],d[d.length-1-p]=g)}else{var v=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=v*v+b*b;if(x<n){var w=Math.sqrt(n=x);i=e-w,o=t-w,c=e+w,f=t+w,r=h.data}}return r}function Kue(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,o,a=this._x0,s=this._y0,u=this._x1,l=this._y1,c,f,d,h,g,p,m,y;if(!n)return this;if(n.length)for(;;){if((g=c>=(d=(a+u)/2))?a=d:u=d,(p=f>=(h=(s+l)/2))?s=h:l=h,t=n,!(n=n[m=p<<1|g]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,y=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[m]=o:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[y]=n:this._root=n),this):(this._root=o,this)}function Jue(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Zue(){return this._root}function Que(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function ele(e){var t=[],n,r=this._root,i,o,a,s,u;for(r&&t.push(new xn(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,a=n.y0,s=n.x1,u=n.y1)&&r.length){var l=(o+s)/2,c=(a+u)/2;(i=r[3])&&t.push(new xn(i,l,c,s,u)),(i=r[2])&&t.push(new xn(i,o,c,l,u)),(i=r[1])&&t.push(new xn(i,l,a,s,c)),(i=r[0])&&t.push(new xn(i,o,a,l,c))}return this}function tle(e){var t=[],n=[],r;for(this._root&&t.push(new xn(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,a=r.x0,s=r.y0,u=r.x1,l=r.y1,c=(a+u)/2,f=(s+l)/2;(o=i[0])&&t.push(new xn(o,a,s,c,f)),(o=i[1])&&t.push(new xn(o,c,s,u,f)),(o=i[2])&&t.push(new xn(o,a,f,c,l)),(o=i[3])&&t.push(new xn(o,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function nle(e){return e[0]}function rle(e){return arguments.length?(this._x=e,this):this._x}function ile(e){return e[1]}function ole(e){return arguments.length?(this._y=e,this):this._y}function _E(e,t,n){var r=new EE(t==null?nle:t,n==null?ile:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function EE(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function H4(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var wn=_E.prototype=EE.prototype;wn.copy=function(){var e=new EE(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=H4(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=H4(r));return e};wn.add=Hue;wn.addAll=Wue;wn.cover=Gue;wn.data=Yue;wn.extent=Vue;wn.find=Xue;wn.remove=Kue;wn.removeAll=Jue;wn.root=Zue;wn.size=Que;wn.visit=ele;wn.visitAfter=tle;wn.x=rle;wn.y=ole;function _n(e){return function(){return e}}function Na(e){return(e()-.5)*1e-6}function ale(e){return e.x+e.vx}function sle(e){return e.y+e.vy}function ule(e){var t,n,r,i=1,o=1;typeof e!="function"&&(e=_n(e==null?1:+e));function a(){for(var l,c=t.length,f,d,h,g,p,m,y=0;y<o;++y)for(f=_E(t,ale,sle).visitAfter(s),l=0;l<c;++l)d=t[l],p=n[d.index],m=p*p,h=d.x+d.vx,g=d.y+d.vy,f.visit(v);function v(b,x,w,E,_){var $=b.data,C=b.r,O=p+C;if($){if($.index>d.index){var A=h-$.x-$.vx,D=g-$.y-$.vy,F=A*A+D*D;F<O*O&&(A===0&&(A=Na(r),F+=A*A),D===0&&(D=Na(r),F+=D*D),F=(O-(F=Math.sqrt(F)))/F*i,d.vx+=(A*=F)*(O=(C*=C)/(m+C)),d.vy+=(D*=F)*O,$.vx-=A*(O=1-O),$.vy-=D*O)}return}return x>h+O||E<h-O||w>g+O||_<g-O}}function s(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return a.initialize=function(l,c){t=l,r=c,u()},a.iterations=function(l){return arguments.length?(o=+l,a):o},a.strength=function(l){return arguments.length?(i=+l,a):i},a.radius=function(l){return arguments.length?(e=typeof l=="function"?l:_n(+l),u(),a):e},a}function lle(e){return e.index}function W4(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function cle(e){var t=lle,n=f,r,i=_n(30),o,a,s,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var y=0,v=e.length;y<c;++y)for(var b=0,x,w,E,_,$,C,O;b<v;++b)x=e[b],w=x.source,E=x.target,_=E.x+E.vx-w.x-w.vx||Na(l),$=E.y+E.vy-w.y-w.vy||Na(l),C=Math.sqrt(_*_+$*$),C=(C-o[b])/C*m*r[b],_*=C,$*=C,E.vx-=_*(O=u[b]),E.vy-=$*O,w.vx+=_*(O=1-O),w.vy+=$*O}function h(){if(!!a){var m,y=a.length,v=e.length,b=new Map(a.map((w,E)=>[t(w,E,a),w])),x;for(m=0,s=new Array(y);m<v;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=W4(b,x.source)),typeof x.target!="object"&&(x.target=W4(b,x.target)),s[x.source.index]=(s[x.source.index]||0)+1,s[x.target.index]=(s[x.target.index]||0)+1;for(m=0,u=new Array(v);m<v;++m)x=e[m],u[m]=s[x.source.index]/(s[x.source.index]+s[x.target.index]);r=new Array(v),g(),o=new Array(v),p()}}function g(){if(!!a)for(var m=0,y=e.length;m<y;++m)r[m]=+n(e[m],m,e)}function p(){if(!!a)for(var m=0,y=e.length;m<y;++m)o[m]=+i(e[m],m,e)}return d.initialize=function(m,y){a=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:_n(+m),g(),d):n},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:_n(+m),p(),d):i},d}var fle={value:()=>{}};function G4(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new xm(n)}function xm(e){this._=e}function dle(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}xm.prototype=G4.prototype={constructor:xm,on:function(e,t){var n=this._,r=dle(e+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(e=r[o]).type)&&(i=hle(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=r[o]).type)n[i]=Y4(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Y4(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new xm(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function hle(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Y4(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=fle,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var zl=0,Pd=0,Id=0,V4=1e3,wm,Bd,_m=0,Vs=0,Em=0,zd=typeof performance=="object"&&performance.now?performance:Date,X4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function K4(){return Vs||(X4(gle),Vs=zd.now()+Em)}function gle(){Vs=0}function AE(){this._call=this._time=this._next=null}AE.prototype=J4.prototype={constructor:AE,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?K4():+n)+(t==null?0:+t),!this._next&&Bd!==this&&(Bd?Bd._next=this:wm=this,Bd=this),this._call=e,this._time=n,$E()},stop:function(){this._call&&(this._call=null,this._time=1/0,$E())}};function J4(e,t,n){var r=new AE;return r.restart(e,t,n),r}function ple(){K4(),++zl;for(var e=wm,t;e;)(t=Vs-e._time)>=0&&e._call.call(null,t),e=e._next;--zl}function Z4(){Vs=(_m=zd.now())+Em,zl=Pd=0;try{ple()}finally{zl=0,yle(),Vs=0}}function mle(){var e=zd.now(),t=e-_m;t>V4&&(Em-=t,_m=e)}function yle(){for(var e,t=wm,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:wm=n);Bd=e,$E(r)}function $E(e){if(!zl){Pd&&(Pd=clearTimeout(Pd));var t=e-Vs;t>24?(e<1/0&&(Pd=setTimeout(Z4,e-zd.now()-Em)),Id&&(Id=clearInterval(Id))):(Id||(_m=zd.now(),Id=setInterval(mle,V4)),zl=1,X4(Z4))}}const vle=1664525,ble=1013904223,Q4=4294967296;function xle(){let e=1;return()=>(e=(vle*e+ble)%Q4)/Q4}function wle(e){return e.x}function _le(e){return e.y}var Ele=10,Ale=Math.PI*(3-Math.sqrt(5));function $le(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=J4(f),l=G4("tick","end"),c=xle();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(p){var m,y=e.length,v;p===void 0&&(p=1);for(var b=0;b<p;++b)for(n+=(o-n)*i,s.forEach(function(x){x(n)}),m=0;m<y;++m)v=e[m],v.fx==null?v.x+=v.vx*=a:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=a:(v.y=v.fy,v.vy=0);return t}function h(){for(var p=0,m=e.length,y;p<m;++p){if(y=e[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=Ele*Math.sqrt(.5+p),b=p*Ale;y.x=v*Math.cos(b),y.y=v*Math.sin(b)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(p){return p.initialize&&p.initialize(e,c),p}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(p){return arguments.length?(e=p,h(),s.forEach(g),t):e},alpha:function(p){return arguments.length?(n=+p,t):n},alphaMin:function(p){return arguments.length?(r=+p,t):r},alphaDecay:function(p){return arguments.length?(i=+p,t):+i},alphaTarget:function(p){return arguments.length?(o=+p,t):o},velocityDecay:function(p){return arguments.length?(a=1-p,t):1-a},randomSource:function(p){return arguments.length?(c=p,s.forEach(g),t):c},force:function(p,m){return arguments.length>1?(m==null?s.delete(p):s.set(p,g(m)),t):s.get(p)},find:function(p,m,y){var v=0,b=e.length,x,w,E,_,$;for(y==null?y=1/0:y*=y,v=0;v<b;++v)_=e[v],x=p-_.x,w=m-_.y,E=x*x+w*w,E<y&&($=_,y=E);return $},on:function(p,m){return arguments.length>1?(l.on(p,m),t):l.on(p)}}}function Sle(){var e,t,n,r,i=_n(-30),o,a=1,s=1/0,u=.81;function l(h){var g,p=e.length,m=_E(e,wle,_le).visitAfter(f);for(r=h,g=0;g<p;++g)t=e[g],m.visit(d)}function c(){if(!!e){var h,g=e.length,p;for(o=new Array(g),h=0;h<g;++h)p=e[h],o[p.index]=+i(p,h,e)}}function f(h){var g=0,p,m,y=0,v,b,x;if(h.length){for(v=b=x=0;x<4;++x)(p=h[x])&&(m=Math.abs(p.value))&&(g+=p.value,y+=m,v+=m*p.x,b+=m*p.y);h.x=v/y,h.y=b/y}else{p=h,p.x=p.data.x,p.y=p.data.y;do g+=o[p.data.index];while(p=p.next)}h.value=g}function d(h,g,p,m){if(!h.value)return!0;var y=h.x-t.x,v=h.y-t.y,b=m-g,x=y*y+v*v;if(b*b/u<x)return x<s&&(y===0&&(y=Na(n),x+=y*y),v===0&&(v=Na(n),x+=v*v),x<a&&(x=Math.sqrt(a*x)),t.vx+=y*h.value*r/x,t.vy+=v*h.value*r/x),!0;if(h.length||x>=s)return;(h.data!==t||h.next)&&(y===0&&(y=Na(n),x+=y*y),v===0&&(v=Na(n),x+=v*v),x<a&&(x=Math.sqrt(a*x)));do h.data!==t&&(b=o[h.data.index]*r/x,t.vx+=y*b,t.vy+=v*b);while(h=h.next)}return l.initialize=function(h,g){e=h,n=g,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:_n(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.distanceMax=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function Cle(e){var t=_n(.1),n,r,i;typeof e!="function"&&(e=_n(e==null?0:+e));function o(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*s}function a(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:_n(+s),a(),o):t},o.x=function(s){return arguments.length?(e=typeof s=="function"?s:_n(+s),a(),o):e},o}function Ole(e){var t=_n(.1),n,r,i;typeof e!="function"&&(e=_n(e==null?0:+e));function o(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*s}function a(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:_n(+s),a(),o):t},o.y=function(s){return arguments.length?(e=typeof s=="function"?s:_n(+s),a(),o):e},o}const eR={center:que,collide:ule,nbody:Sle,link:cle,x:Cle,y:Ole},Ud="forces",SE=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Fle=["static","iterations"],tR=["x","y","vx","vy"];function CE(e){N.call(this,null,e)}CE.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:tR}]};q(CE,N,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(SE),o=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&nR(n,e,0,t)):(this.value=n=Dle(t.source,e),n.on("tick",kle(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(Fle)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s=this._argops,u=0,l=s.length,c;u<l;++u)if(c=s[u],!(c.name!==Ud||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,o=r.length,a;i<o;++i)if(r[i].name==="links"&&(a=r[i].op.source)){n.pulse(a,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(tR)}});function kle(e,t){return()=>e.touch(t).run()}function Dle(e,t){const n=$le(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),nR(n,t,!0).on("end",()=>o=!0)}function nR(e,t,n,r){var i=oe(t.forces),o,a,s,u;for(o=0,a=SE.length;o<a;++o)s=SE[o],s!==Ud&&t.modified(s)&&e[s](t[s]);for(o=0,a=i.length;o<a;++o)u=Ud+o,s=n||t.modified(Ud,o)?Tle(i[o]):r&&Mle(i[o],r)?e.force(u):null,s&&e.force(u,s);for(a=e.numForces||0;o<a;++o)e.force(Ud+o,null);return e.numForces=i.length,e}function Mle(e,t){var n,r;for(n in e)if(me(r=e[n])&&t.modified(Xt(r)))return 1;return 0}function Tle(e){var t,n;ae(eR,e.force)||I("Unrecognized force: "+e.force),t=eR[e.force]();for(n in e)me(t[n])&&Nle(t[n],e[n],e);return t}function Nle(e,t,n){e(me(t)?r=>t(r,n):t)}var Rle=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:CE});function jle(e,t){return e.parent===t.parent?1:2}function Lle(e){return e.reduce(Ple,0)/e.length}function Ple(e,t){return e+t.x}function Ile(e){return 1+e.reduce(Ble,0)}function Ble(e,t){return Math.max(e,t.y)}function zle(e){for(var t;t=e.children;)e=t[0];return e}function Ule(e){for(var t;t=e.children;)e=t[t.length-1];return e}function qle(){var e=jle,t=1,n=1,r=!1;function i(o){var a,s=0;o.eachAfter(function(d){var h=d.children;h?(d.x=Lle(h),d.y=Ile(h)):(d.x=a?s+=e(d,a):0,d.y=0,a=d)});var u=zle(o),l=Ule(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(r?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(r=!1,t=+o[0],n=+o[1],i):r?null:[t,n]},i.nodeSize=function(o){return arguments.length?(r=!0,t=+o[0],n=+o[1],i):r?[t,n]:null},i}function Hle(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function Wle(){return this.eachAfter(Hle)}function Gle(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function Yle(e,t){for(var n=this,r=[n],i,o,a=-1;n=r.pop();)if(e.call(t,n,++a,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Vle(e,t){for(var n=this,r=[n],i=[],o,a,s,u=-1;n=r.pop();)if(i.push(n),o=n.children)for(a=0,s=o.length;a<s;++a)r.push(o[a]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function Xle(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Kle(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Jle(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Zle(e){for(var t=this,n=Qle(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Qle(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function ece(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function tce(){return Array.from(this)}function nce(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function rce(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*ice(){var e=this,t,n=[e],r,i,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function OE(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=sce)):t===void 0&&(t=ace);for(var n=new Ul(e),r,i=[n],o,a,s,u;r=i.pop();)if((a=t(r.data))&&(u=(a=Array.from(a)).length))for(r.children=a,s=u-1;s>=0;--s)i.push(o=a[s]=new Ul(a[s])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(rR)}function oce(){return OE(this).eachBefore(uce)}function ace(e){return e.children}function sce(e){return Array.isArray(e)?e[1]:null}function uce(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function rR(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Ul(e){this.data=e,this.depth=this.height=0,this.parent=null}Ul.prototype=OE.prototype={constructor:Ul,count:Wle,each:Gle,eachAfter:Vle,eachBefore:Yle,find:Xle,sum:Kle,sort:Jle,path:Zle,ancestors:ece,descendants:tce,leaves:nce,links:rce,copy:oce,[Symbol.iterator]:ice};function lce(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function cce(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function fce(e){for(var t=0,n=(e=cce(Array.from(e))).length,r=[],i,o;t<n;)i=e[t],o&&iR(o,i)?++t:(o=hce(r=dce(r,i)),t=0);return o}function dce(e,t){var n,r;if(FE(t,e))return[t];for(n=0;n<e.length;++n)if(Am(t,e[n])&&FE(qd(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(Am(qd(e[n],e[r]),t)&&Am(qd(e[n],t),e[r])&&Am(qd(e[r],t),e[n])&&FE(oR(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function Am(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function iR(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function FE(e,t){for(var n=0;n<t.length;++n)if(!iR(e,t[n]))return!1;return!0}function hce(e){switch(e.length){case 1:return gce(e[0]);case 2:return qd(e[0],e[1]);case 3:return oR(e[0],e[1],e[2])}}function gce(e){return{x:e.x,y:e.y,r:e.r}}function qd(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,a=t.y,s=t.r,u=o-n,l=a-r,c=s-i,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(r+a+l/f*c)/2,r:(f+i+s)/2}}function oR(e,t,n){var r=e.x,i=e.y,o=e.r,a=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-a,h=r-l,g=i-s,p=i-c,m=u-o,y=f-o,v=r*r+i*i-o*o,b=v-a*a-s*s+u*u,x=v-l*l-c*c+f*f,w=h*g-d*p,E=(g*x-p*b)/(w*2)-r,_=(p*m-g*y)/w,$=(h*b-d*x)/(w*2)-i,C=(d*y-h*m)/w,O=_*_+C*C-1,A=2*(o+E*_+$*C),D=E*E+$*$-o*o,F=-(O?(A+Math.sqrt(A*A-4*O*D))/(2*O):D/A);return{x:r+E+_*F,y:i+$+C*F,r:F}}function aR(e,t,n){var r=e.x-t.x,i,o,a=e.y-t.y,s,u,l=r*r+a*a;l?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(i=(l+u-o)/(2*l),s=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-s*a,n.y=e.y-i*a+s*r):(i=(l+o-u)/(2*l),s=Math.sqrt(Math.max(0,o/l-i*i)),n.x=t.x+i*r-s*a,n.y=t.y+i*a+s*r)):(n.x=t.x+n.r,n.y=t.y)}function sR(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function uR(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function $m(e){this._=e,this.next=null,this.previous=null}function pce(e){if(!(i=(e=lce(e)).length))return 0;var t,n,r,i,o,a,s,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;aR(n,t,r=e[2]),t=new $m(t),n=new $m(n),r=new $m(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(s=3;s<i;++s){aR(t._,n._,r=e[s]),r=new $m(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(sR(u._,r._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(sR(l._,r._)){t=l,t.next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,o=uR(t);(r=r.next)!==n;)(a=uR(r))<o&&(t=r,o=a);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=fce(t),s=0;s<i;++s)t=e[s],t.x-=r.x,t.y-=r.y;return r.r}function mce(e){return e==null?null:Sm(e)}function Sm(e){if(typeof e!="function")throw new Error;return e}function Xs(){return 0}function ql(e){return function(){return e}}function yce(e){return Math.sqrt(e.value)}function vce(){var e=null,t=1,n=1,r=Xs;function i(o){return o.x=t/2,o.y=n/2,e?o.eachBefore(lR(e)).eachAfter(kE(r,.5)).eachBefore(cR(1)):o.eachBefore(lR(yce)).eachAfter(kE(Xs,1)).eachAfter(kE(r,o.r/Math.min(t,n))).eachBefore(cR(Math.min(t,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(e=mce(o),i):e},i.size=function(o){return arguments.length?(t=+o[0],n=+o[1],i):[t,n]},i.padding=function(o){return arguments.length?(r=typeof o=="function"?o:ql(+o),i):r},i}function lR(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function kE(e,t){return function(n){if(r=n.children){var r,i,o=r.length,a=e(n)*t||0,s;if(a)for(i=0;i<o;++i)r[i].r+=a;if(s=pce(r),a)for(i=0;i<o;++i)r[i].r-=a;n.r=s+a}}}function cR(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function fR(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Hd(e,t,n,r,i){for(var o=e.children,a,s=-1,u=o.length,l=e.value&&(r-t)/e.value;++s<u;)a=o[s],a.y0=n,a.y1=i,a.x0=t,a.x1=t+=a.value*l}function bce(){var e=1,t=1,n=0,r=!1;function i(a){var s=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/s,a.eachBefore(o(t,s)),r&&a.eachBefore(fR),a}function o(a,s){return function(u){u.children&&Hd(u,u.x0,a*(u.depth+1)/s,u.x1,a*(u.depth+2)/s);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(a){return arguments.length?(r=!!a,i):r},i.size=function(a){return arguments.length?(e=+a[0],t=+a[1],i):[e,t]},i.padding=function(a){return arguments.length?(n=+a,i):n},i}var xce={depth:-1},dR={};function wce(e){return e.id}function _ce(e){return e.parentId}function hR(){var e=wce,t=_ce;function n(r){var i=Array.from(r),o=i.length,a,s,u,l,c,f,d,h=new Map;for(s=0;s<o;++s)a=i[s],c=i[s]=new Ul(a),(f=e(a,s,r))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?dR:c)),(f=t(a,s,r))!=null&&(f+="")&&(c.parent=f);for(s=0;s<o;++s)if(c=i[s],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===dR)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=xce,u.eachBefore(function(g){g.depth=g.parent.depth+1,--o}).eachBefore(rR),u.parent=null,o>0)throw new Error("cycle");return u}return n.id=function(r){return arguments.length?(e=Sm(r),n):e},n.parentId=function(r){return arguments.length?(t=Sm(r),n):t},n}function Ece(e,t){return e.parent===t.parent?1:2}function DE(e){var t=e.children;return t?t[0]:e.t}function ME(e){var t=e.children;return t?t[t.length-1]:e.t}function Ace(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function $ce(e){for(var t=0,n=0,r=e.children,i=r.length,o;--i>=0;)o=r[i],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function Sce(e,t,n){return e.a.parent===t.parent?e.a:n}function Cm(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Cm.prototype=Object.create(Ul.prototype);function Cce(e){for(var t=new Cm(e,0),n,r=[t],i,o,a,s;n=r.pop();)if(o=n._.children)for(n.children=new Array(s=o.length),a=s-1;a>=0;--a)r.push(i=n.children[a]=new Cm(o[a],a)),i.parent=n;return(t.parent=new Cm(null,0)).children=[t],t}function Oce(){var e=Ece,t=1,n=1,r=null;function i(l){var c=Cce(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var g=f===d?1:e(f,d)/2,p=g-f.x,m=t/(d.x+g+p),y=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+p)*m,v.y=v.depth*y})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){$ce(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=s(l,d,l.parent.A||f[0])}function a(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,c,f){if(c){for(var d=l,h=l,g=c,p=d.parent.children[0],m=d.m,y=h.m,v=g.m,b=p.m,x;g=ME(g),d=DE(d),g&&d;)p=DE(p),h=ME(h),h.a=l,x=g.z+v-d.z-m+e(g._,d._),x>0&&(Ace(Sce(g,l,f),l,x),m+=x,y+=x),v+=g.m,m+=d.m,b+=p.m,y+=h.m;g&&!ME(h)&&(h.t=g,h.m+=v-y),d&&!DE(p)&&(p.t=d,p.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function Om(e,t,n,r,i){for(var o=e.children,a,s=-1,u=o.length,l=e.value&&(i-n)/e.value;++s<u;)a=o[s],a.x0=t,a.x1=r,a.y0=n,a.y1=n+=a.value*l}var gR=(1+Math.sqrt(5))/2;function pR(e,t,n,r,i,o){for(var a=[],s=t.children,u,l,c=0,f=0,d=s.length,h,g,p=t.value,m,y,v,b,x,w,E;c<d;){h=i-n,g=o-r;do m=s[f++].value;while(!m&&f<d);for(y=v=m,w=Math.max(g/h,h/g)/(p*e),E=m*m*w,x=Math.max(v/E,E/y);f<d;++f){if(m+=l=s[f].value,l<y&&(y=l),l>v&&(v=l),E=m*m*w,b=Math.max(v/E,E/y),b>x){m-=l;break}x=b}a.push(u={value:m,dice:h<g,children:s.slice(c,f)}),u.dice?Hd(u,n,r,i,p?r+=g*m/p:o):Om(u,n,r,p?n+=h*m/p:i,o),p-=m,c=f}return a}var mR=function e(t){function n(r,i,o,a,s){pR(t,r,i,o,a,s)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(gR);function Fce(){var e=mR,t=!1,n=1,r=1,i=[0],o=Xs,a=Xs,s=Xs,u=Xs,l=Xs;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(fR),d}function f(d){var h=i[d.depth],g=d.x0+h,p=d.y0+h,m=d.x1-h,y=d.y1-h;m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),d.x0=g,d.y0=p,d.x1=m,d.y1=y,d.children&&(h=i[d.depth+1]=o(d)/2,g+=l(d)-h,p+=a(d)-h,m-=s(d)-h,y-=u(d)-h,m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),e(d,g,p,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=Sm(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:ql(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(a=typeof d=="function"?d:ql(+d),c):a},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:ql(+d),c):s},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:ql(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:ql(+d),c):l},c}function kce(e,t,n,r,i){var o=e.children,a,s=o.length,u,l=new Array(s+1);for(l[0]=u=a=0;a<s;++a)l[a+1]=u+=o[a].value;c(0,s,e.value,t,n,r,i);function c(f,d,h,g,p,m,y){if(f>=d-1){var v=o[f];v.x0=g,v.y0=p,v.x1=m,v.y1=y;return}for(var b=l[f],x=h/2+b,w=f+1,E=d-1;w<E;){var _=w+E>>>1;l[_]<x?w=_+1:E=_}x-l[w-1]<l[w]-x&&f+1<w&&--w;var $=l[w]-b,C=h-$;if(m-g>y-p){var O=h?(g*C+m*$)/h:m;c(f,w,$,g,p,O,y),c(w,d,C,O,p,m,y)}else{var A=h?(p*C+y*$)/h:y;c(f,w,$,g,p,m,A),c(w,d,C,g,A,m,y)}}}function Dce(e,t,n,r,i){(e.depth&1?Om:Hd)(e,t,n,r,i)}var Mce=function e(t){function n(r,i,o,a,s){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,g=u.length,p=r.value;++d<g;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?Hd(l,i,o,a,p?o+=(s-o)*l.value/p:s):Om(l,i,o,p?i+=(a-i)*l.value/p:a,s),p-=l.value}else r._squarify=u=pR(t,r,i,o,a,s),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(gR);function TE(e,t,n){const r={};return e.each(i=>{const o=i.data;n(o)&&(r[t(o)]=i)}),e.lookup=r,e}function NE(e){N.call(this,null,e)}NE.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Tce=e=>e.values;q(NE,N,{transform(e,t){t.source||I("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each(a=>{a.children&&dg(a.data)&&i.rem.push(a.data)}),this.value=o=OE({values:oe(e.keys).reduce((a,s)=>(a.key(s),a),Nce()).entries(i.source)},Tce),n&&o.each(a=>{a.children&&(a=Le(a.data),i.add.push(a),i.source.push(a))}),TE(o,ee,ee)),i.source.root=o,i}});function Nce(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,o){if(o>=e.length)return i;const a=i.length,s=e[o++],u={},l={};let c=-1,f,d,h;for(;++c<a;)f=s(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function r(i,o){if(++o>e.length)return i;const a=[];for(const s in i)a.push({key:s,values:r(i[s],o)});return a}return t}function No(e){N.call(this,null,e)}const Rce=(e,t)=>e.parent===t.parent?1:2;q(No,N,{transform(e,t){(!t.source||!t.source.root)&&I(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(Es(e.sort,a=>a.data)),jce(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Rce:Xu);try{this.value=n(i)}catch(a){I(a)}return i.each(a=>Lce(a,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function jce(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}function Lce(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}const RE=["x","y","r","depth","children"];function jE(e){No.call(this,e)}jE.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:RE.length,default:RE}]};q(jE,No,{layout:vce,params:["radius","size","padding"],fields:RE});const LE=["x0","y0","x1","y1","depth","children"];function PE(e){No.call(this,e)}PE.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:LE.length,default:LE}]};q(PE,No,{layout:bce,params:["size","round","padding"],fields:LE});function IE(e){N.call(this,null,e)}IE.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};q(IE,N,{transform(e,t){t.source||I("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?TE(hR().id(e.key).parentId(e.parentKey)(i.source),e.key,_r):TE(hR()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const yR={tidy:Oce,cluster:qle},BE=["x","y","depth","children"];function zE(e){No.call(this,e)}zE.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:BE.length,default:BE}]};q(zE,No,{layout(e){const t=e||"tidy";if(ae(yR,t))return yR[t]();I("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:BE});function UE(e){N.call(this,[],e)}UE.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};q(UE,N,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||I("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,a=>o[ee(a)]=1),r.each(a=>{const s=a.data,u=a.parent&&a.parent.data;u&&o[ee(s)]&&o[ee(u)]&&i.add.push(Le({source:u,target:s}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,a=>o[ee(a)]=1),n.forEach(a=>{(o[ee(a.source)]||o[ee(a.target)])&&i.mod.push(a)})),i}});const vR={binary:kce,dice:Hd,slice:Om,slicedice:Dce,squarify:mR,resquarify:Mce},qE=["x0","y0","x1","y1","depth","children"];function HE(e){No.call(this,e)}HE.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:qE.length,default:qE}]};q(HE,No,{layout(){const e=Fce();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ae(vR,t)?e.tile(vR[t]):I("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:qE});var Pce=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:NE,pack:jE,partition:PE,stratify:IE,tree:zE,treelinks:UE,treemap:HE});const Ice=4278190080,Bce=268435456,zce=.0625;function Uce(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function qce(e,t,n,r){const i=e.width,o=e.height,a=n||r,s=ll(i,o).getContext("2d");t.forEach(m=>bR(s,m,a));const u=new Uint32Array(s.getImageData(0,0,i,o).data.buffer),l=e.bitmap(),c=a&&e.bitmap();let f,d,h,g,p;for(d=0;d<o;++d)for(f=0;f<i;++f)p=u[d*i+f]&Ice,p&&(h=e(f),g=e(d),r||l.set(h,g),a&&p^Bce&&c.set(h,g));return[l,c]}function bR(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(o=>bR(e,o.items,n))}):ur[r].draw(e,{items:n?t.map(Hce):t})}function Hce(e){const t=hg(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=zce,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Ro=5,En=31,Wd=32,Ra=new Uint32Array(Wd+1),ri=new Uint32Array(Wd+1);ri[0]=0;Ra[0]=~ri[0];for(let e=1;e<=Wd;++e)ri[e]=ri[e-1]<<1|1,Ra[e]=~ri[e];function Wce(e,t){const n=new Uint32Array(~~((e*t+Wd)/Wd));function r(o,a){n[o]|=a}function i(o,a){n[o]&=a}return{array:n,get:(o,a)=>{const s=a*e+o;return n[s>>>Ro]&1<<(s&En)},set:(o,a)=>{const s=a*e+o;r(s>>>Ro,1<<(s&En))},clear:(o,a)=>{const s=a*e+o;i(s>>>Ro,~(1<<(s&En)))},getRange:(o,a,s,u)=>{let l=u,c,f,d,h;for(;l>=a;--l)if(c=l*e+o,f=l*e+s,d=c>>>Ro,h=f>>>Ro,d===h){if(n[d]&Ra[c&En]&ri[(f&En)+1])return!0}else{if(n[d]&Ra[c&En]||n[h]&ri[(f&En)+1])return!0;for(let g=d+1;g<h;++g)if(n[g])return!0}return!1},setRange:(o,a,s,u)=>{let l,c,f,d,h;for(;a<=u;++a)if(l=a*e+o,c=a*e+s,f=l>>>Ro,d=c>>>Ro,f===d)r(f,Ra[l&En]&ri[(c&En)+1]);else for(r(f,Ra[l&En]),r(d,ri[(c&En)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(o,a,s,u)=>{let l,c,f,d,h;for(;a<=u;++a)if(l=a*e+o,c=a*e+s,f=l>>>Ro,d=c>>>Ro,f===d)i(f,ri[l&En]|Ra[(c&En)+1]);else for(i(f,ri[l&En]),i(d,Ra[(c&En)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(o,a,s,u)=>o<0||a<0||u>=t||s>=e}}function Gce(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),a=s=>~~((s+n)/r);return a.invert=s=>s*r-n,a.bitmap=()=>Wce(i,o),a.ratio=r,a.padding=n,a.width=e,a.height=t,a}function Yce(e,t,n,r){const i=e.width,o=e.height;return function(a){const s=a.datum.datum.items[r].items,u=s.length,l=a.datum.fontSize,c=Ri.width(a.datum,a.datum.text);let f=0,d,h,g,p,m,y,v;for(let b=0;b<u;++b)d=s[b].x,g=s[b].y,h=s[b].x2===void 0?d:s[b].x2,p=s[b].y2===void 0?g:s[b].y2,m=(d+h)/2,y=(g+p)/2,v=Math.abs(h-d+p-g),v>=f&&(f=v,a.x=m,a.y=y);return m=c/2,y=l/2,d=a.x-m,h=a.x+m,g=a.y-y,p=a.y+y,a.align="center",d<0&&h<=i?a.align="left":0<=d&&i<h&&(a.align="right"),a.baseline="middle",g<0&&p<=o?a.baseline="top":0<=g&&o<p&&(a.baseline="bottom"),!0}}function Vce(e,t,n,r,i,o){let a=n/2;return e-a<0||e+a>i||t-(a=r/2)<0||t+a>o}function Xce(){return!1}function Kce(e,t,n,r,i,o,a,s){const u=i*o/(r*2),l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return a.outOfBounds(l,f,c,d)||a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function Jce(e,t,n,r,i,o,a,s){const u=i*o/(r*2);let l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return l=l>0?l:0,f=f>0?f:0,c=c<e.width?c:e.width-1,d=d<e.height?d:e.height-1,a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function xR(e){return e?[Jce,Xce]:[Kce,Vce]}function Zce(e,t,n,r,i){const o=e.width,a=e.height,[s,u]=xR(i),l=t[0],c=t[1];function f(d,h,g,p,m){const y=e.invert(d),v=e.invert(h);let b=g,x=a,w;if(!u(y,v,p,m,o,a)&&!s(e,y,v,m,p,b,l,c)&&!s(e,y,v,m,p,m,l,null)){for(;x-b>=1;)w=(b+x)/2,s(e,y,v,m,p,w,l,c)?x=w:b=w;if(b>g)return[y,v,b,!0]}}return function(d){const h=d.datum.datum.items[r].items,g=h.length,p=d.datum.fontSize,m=Ri.width(d.datum,d.datum.text);let y=n?p:0,v=!1,b=!1,x=0,w,E,_,$,C,O,A,D,F,T,S,M,P,B,H,ie,le;for(let he=0;he<g;++he){for(w=h[he].x,_=h[he].y,E=h[he].x2===void 0?w:h[he].x2,$=h[he].y2===void 0?_:h[he].y2,w>E&&(le=w,w=E,E=le),_>$&&(le=_,_=$,$=le),F=e(w),S=e(E),T=~~((F+S)/2),M=e(_),B=e($),P=~~((M+B)/2),A=T;A>=F;--A)for(D=P;D>=M;--D)ie=f(A,D,y,m,p),ie&&([d.x,d.y,y,v]=ie);for(A=T;A<=S;++A)for(D=P;D<=B;++D)ie=f(A,D,y,m,p),ie&&([d.x,d.y,y,v]=ie);!v&&!n&&(H=Math.abs(E-w+$-_),C=(w+E)/2,O=(_+$)/2,H>=x&&!u(C,O,m,p,o,a)&&!s(e,C,O,p,m,p,l,null)&&(x=H,d.x=C,d.y=O,b=!0))}return v||b?(C=m/2,O=p/2,l.setRange(e(d.x-C),e(d.y-O),e(d.x+C),e(d.y+O)),d.align="center",d.baseline="middle",!0):!1}}const Qce=[-1,-1,1,1],efe=[-1,1,-1,1];function tfe(e,t,n,r,i){const o=e.width,a=e.height,[s,u]=xR(i),l=t[0],c=t[1],f=e.bitmap();return function(d){const h=d.datum.datum.items[r].items,g=h.length,p=d.datum.fontSize,m=Ri.width(d.datum,d.datum.text),y=[];let v=n?p:0,b=!1,x=!1,w=0,E,_,$,C,O,A,D,F,T,S,M,P;for(let B=0;B<g;++B){for(E=h[B].x,$=h[B].y,_=h[B].x2===void 0?E:h[B].x2,C=h[B].y2===void 0?$:h[B].y2,y.push([e((E+_)/2),e(($+C)/2)]);y.length;)if([D,F]=y.pop(),!(l.get(D,F)||c.get(D,F)||f.get(D,F))){f.set(D,F);for(let H=0;H<4;++H)O=D+Qce[H],A=F+efe[H],f.outOfBounds(O,A,O,A)||y.push([O,A]);if(O=e.invert(D),A=e.invert(F),T=v,S=a,!u(O,A,m,p,o,a)&&!s(e,O,A,p,m,T,l,c)&&!s(e,O,A,p,m,p,l,null)){for(;S-T>=1;)M=(T+S)/2,s(e,O,A,p,m,M,l,c)?S=M:T=M;T>v&&(d.x=O,d.y=A,v=T,b=!0)}}!b&&!n&&(P=Math.abs(_-E+C-$),O=(E+_)/2,A=($+C)/2,P>=w&&!u(O,A,m,p,o,a)&&!s(e,O,A,p,m,p,l,null)&&(w=P,d.x=O,d.y=A,x=!0))}return b||x?(O=m/2,A=p/2,l.setRange(e(d.x-O),e(d.y-A),e(d.x+O),e(d.y+A)),d.align="center",d.baseline="middle",!0):!1}}const nfe=["right","center","left"],rfe=["bottom","middle","top"];function ife(e,t,n,r,i){const o=e.width,a=e.height,s=t[0],u=t[1],l=r.length;return function(c){const f=c.boundary,d=c.datum.fontSize;if(!i&&(f[2]<0||f[5]<0||f[0]>o||f[3]>a))return!1;let h=0,g,p,m,y,v,b,x,w,E,_,$,C,O,A,D;for(let F=0;F<l;++F){if(g=(n[F]&3)-1,p=(n[F]>>>2&3)-1,m=g===0&&p===0||r[F]<0,y=g&&p?Math.SQRT1_2:1,v=r[F]<0?-1:1,b=f[1+g]+r[F]*g*y,$=f[4+p]+v*d*p/2+r[F]*p*y,w=$-d/2,E=$+d/2,C=e(b),A=e(w),D=e(E),i&&(C=C<0?0:C,A=A<0?0:A,D=D>=e.height?e.height-1:D),!h)if(wR(C,C,A,D,s,u,b,b,w,E,f,m))h=Ri.width(c.datum,c.datum.text);else continue;if(_=b+v*h*g/2,b=_-h/2,x=_+h/2,C=e(b),O=e(x),i&&(C=C<0?0:C,O=O>=e.width?e.width-1:O),wR(C,O,A,D,s,u,b,x,w,E,f,m))return c.x=g?g*v<0?x:b:_,c.y=p?p*v<0?E:w:$,c.align=nfe[g*v+1],c.baseline=rfe[p*v+1],s.setRange(C,A,O,D),!0}return!1}}function wR(e,t,n,r,i,o,a,s,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o?o.getRange(e,n,t,r)||!ofe(a,u,s,l,c):i.getRange(e,n,t,r)))}function ofe(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}const WE=0,GE=4,YE=8,VE=0,XE=1,KE=2,afe={"top-left":WE+VE,top:WE+XE,"top-right":WE+KE,left:GE+VE,middle:GE+XE,right:GE+KE,"bottom-left":YE+VE,bottom:YE+XE,"bottom-right":YE+KE},sfe={naive:Yce,"reduced-search":Zce,floodfill:tfe};function ufe(e,t,n,r,i,o,a,s,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=lfe(r,f),h=cfe(i,f),g=ffe(e[0].datum),p=g==="group"&&e[0].datum.items[u].marktype,m=p==="area",y=dfe(g,p,s,u),v=l===null||l===1/0,b=Gce(t[0],t[1],v?0:l),x=m&&c==="naive",w=e.map($=>({datum:$,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y($)}));let E;if(!x){n&&w.sort((C,O)=>n(C.datum,O.datum));let $=!1;for(let C=0;C<h.length&&!$;++C)$=h[C]===5||d[C]<0;g&&(a||m)&&(o=[e.map(C=>C.datum)].concat(o)),E=o.length?qce(b,o,$,m):Uce(b,a&&w)}const _=m?sfe[c](b,E,a,u,v):ife(b,E,h,d,v);return w.forEach($=>$.opacity=+_($)),w}function lfe(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function cfe(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=afe[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function ffe(e){return e&&e.mark&&e.mark.marktype}function dfe(e,t,n,r){const i=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>i(o.datum):t==="line"?o=>{const a=o.datum.items[r].items;return i(a.length?a[n==="start"?0:a.length-1]:{x:NaN,y:NaN})}:o=>{const a=o.datum.bounds;return[a.x1,(a.x1+a.x2)/2,a.x2,a.y1,(a.y1+a.y2)/2,a.y2]}:i}const JE=["x","y","opacity","align","baseline"],_R=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function ZE(e){N.call(this,null,e)}ZE.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:_R},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:JE.length,default:JE}]};q(ZE,N,{transform(e,t){function n(o){const a=e[o];return me(a)&&t.modified(a.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&I("Size parameter should be specified as a [width, height] array.");const i=e.as||JE;return ufe(t.materialize(t.SOURCE).source||[],e.size,e.sort,oe(e.offset==null?1:e.offset),oe(e.anchor||_R),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const a=o.datum;a[i[0]]=o.x,a[i[1]]=o.y,a[i[2]]=o.opacity,a[i[3]]=o.align,a[i[4]]=o.baseline}),t.reflow(r).modifies(i)}});var hfe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:ZE});function ER(e,t){var n=[],r=function(c){return c(s)},i,o,a,s,u,l;if(t==null)n.push(e);else for(i={},o=0,a=e.length;o<a;++o)s=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function QE(e){N.call(this,null,e)}QE.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};q(QE,N,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=ER(r,e.groupby),o=(e.groupby||[]).map(ut),a=o.length,s=e.as||[ut(e.x),ut(e.y)],u=[];i.forEach(l=>{ED(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<a;++d)f[o[d]]=l.dims[d];f[s[0]]=c[0],f[s[1]]=c[1],u.push(Le(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const eA={linear:ix,log:yD,exp:vD,pow:bD,quad:ox,poly:xD},gfe=(e,t)=>e==="poly"?t:e==="quad"?2:1;function tA(e){N.call(this,null,e)}tA.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(eA)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};q(tA,N,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=ER(r,e.groupby),o=(e.groupby||[]).map(ut),a=e.method||"linear",s=e.order||3,u=gfe(a,s),l=e.as||[ut(e.x),ut(e.y)],c=eA[a],f=[];let d=e.extent;ae(eA,a)||I("Invalid regression method: "+a),d!=null&&a==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const p=c(h,e.x,e.y,s);if(e.params){f.push(Le({keys:h.dims,coef:p.coef,rSquared:p.rSquared}));return}const m=d||Ai(h,e.x),y=v=>{const b={};for(let x=0;x<o.length;++x)b[o[x]]=h.dims[x];b[l[0]]=v[0],b[l[1]]=v[1],f.push(Le(b))};a==="linear"?m.forEach(v=>y([v,p.predict(v)])):Eg(p.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var pfe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:QE,regression:tA});const AR=Math.pow(2,-52),Fm=new Uint32Array(512);class km{static from(t,n=xfe,r=wfe){const i=t.length,o=new Float64Array(i*2);for(let a=0;a<i;a++){const s=t[a];o[2*a]=n(s),o[2*a+1]=r(s)}return new km(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:o}=this,a=t.length>>1;let s=1/0,u=1/0,l=-1/0,c=-1/0;for(let O=0;O<a;O++){const A=t[2*O],D=t[2*O+1];A<s&&(s=A),D<u&&(u=D),A>l&&(l=A),D>c&&(c=D),this._ids[O]=O}const f=(s+l)/2,d=(u+c)/2;let h=1/0,g,p,m;for(let O=0;O<a;O++){const A=nA(f,d,t[2*O],t[2*O+1]);A<h&&(g=O,h=A)}const y=t[2*g],v=t[2*g+1];h=1/0;for(let O=0;O<a;O++){if(O===g)continue;const A=nA(y,v,t[2*O],t[2*O+1]);A<h&&A>0&&(p=O,h=A)}let b=t[2*p],x=t[2*p+1],w=1/0;for(let O=0;O<a;O++){if(O===g||O===p)continue;const A=vfe(y,v,b,x,t[2*O],t[2*O+1]);A<w&&(m=O,w=A)}let E=t[2*m],_=t[2*m+1];if(w===1/0){for(let D=0;D<a;D++)this._dists[D]=t[2*D]-t[0]||t[2*D+1]-t[1];Hl(this._ids,this._dists,0,a-1);const O=new Uint32Array(a);let A=0;for(let D=0,F=-1/0;D<a;D++){const T=this._ids[D];this._dists[T]>F&&(O[A++]=T,F=this._dists[T])}this.hull=O.subarray(0,A),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Dm(y,v,b,x,E,_)){const O=p,A=b,D=x;p=m,b=E,x=_,m=O,E=A,_=D}const $=bfe(y,v,b,x,E,_);this._cx=$.x,this._cy=$.y;for(let O=0;O<a;O++)this._dists[O]=nA(t[2*O],t[2*O+1],$.x,$.y);Hl(this._ids,this._dists,0,a-1),this._hullStart=g;let C=3;r[g]=n[m]=p,r[p]=n[g]=m,r[m]=n[p]=g,i[g]=0,i[p]=1,i[m]=2,o.fill(-1),o[this._hashKey(y,v)]=g,o[this._hashKey(b,x)]=p,o[this._hashKey(E,_)]=m,this.trianglesLen=0,this._addTriangle(g,p,m,-1,-1,-1);for(let O=0,A,D;O<this._ids.length;O++){const F=this._ids[O],T=t[2*F],S=t[2*F+1];if(O>0&&Math.abs(T-A)<=AR&&Math.abs(S-D)<=AR||(A=T,D=S,F===g||F===p||F===m))continue;let M=0;for(let le=0,he=this._hashKey(T,S);le<this._hashSize&&(M=o[(he+le)%this._hashSize],!(M!==-1&&M!==r[M]));le++);M=n[M];let P=M,B;for(;B=r[P],!Dm(T,S,t[2*P],t[2*P+1],t[2*B],t[2*B+1]);)if(P=B,P===M){P=-1;break}if(P===-1)continue;let H=this._addTriangle(P,F,r[P],-1,-1,i[P]);i[F]=this._legalize(H+2),i[P]=H,C++;let ie=r[P];for(;B=r[ie],Dm(T,S,t[2*ie],t[2*ie+1],t[2*B],t[2*B+1]);)H=this._addTriangle(ie,F,B,i[F],-1,i[ie]),i[F]=this._legalize(H+2),r[ie]=ie,C--,ie=B;if(P===M)for(;B=n[P],Dm(T,S,t[2*B],t[2*B+1],t[2*P],t[2*P+1]);)H=this._addTriangle(B,F,P,-1,i[P],i[B]),this._legalize(H+2),i[B]=H,r[P]=P,C--,P=B;this._hullStart=n[F]=P,r[P]=n[ie]=F,r[F]=ie,o[this._hashKey(T,S)]=F,o[this._hashKey(t[2*P],t[2*P+1])]=P}this.hull=new Uint32Array(C);for(let O=0,A=this._hullStart;O<C;O++)this.hull[O]=A,A=r[A];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(mfe(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let o=0,a=0;for(;;){const s=r[t],u=t-t%3;if(a=u+(t+2)%3,s===-1){if(o===0)break;t=Fm[--o];continue}const l=s-s%3,c=u+(t+1)%3,f=l+(s+2)%3,d=n[a],h=n[t],g=n[c],p=n[f];if(yfe(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*g],i[2*g+1],i[2*p],i[2*p+1])){n[t]=p,n[s]=d;const y=r[f];if(y===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,y),this._link(s,r[a]),this._link(a,f);const v=l+(s+1)%3;o<Fm.length&&(Fm[o++]=v)}else{if(o===0)break;t=Fm[--o]}}return a}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,o,a){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=n,this._triangles[s+2]=r,this._link(s,i),this._link(s+1,o),this._link(s+2,a),this.trianglesLen+=3,s}}function mfe(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function nA(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function rA(e,t,n,r,i,o){const a=(r-t)*(i-e),s=(n-e)*(o-t);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function Dm(e,t,n,r,i,o){return(rA(i,o,e,t,n,r)||rA(e,t,n,r,i,o)||rA(n,r,i,o,e,t))<0}function yfe(e,t,n,r,i,o,a,s){const u=e-a,l=t-s,c=n-a,f=r-s,d=i-a,h=o-s,g=u*u+l*l,p=c*c+f*f,m=d*d+h*h;return u*(f*m-p*h)-l*(c*m-p*d)+g*(c*h-f*d)<0}function vfe(e,t,n,r,i,o){const a=n-e,s=r-t,u=i-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=(l*c-s*f)*d,g=(a*f-u*c)*d;return h*h+g*g}function bfe(e,t,n,r,i,o){const a=n-e,s=r-t,u=i-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=e+(l*c-s*f)*d,g=t+(a*f-u*c)*d;return{x:h,y:g}}function Hl(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const o=e[i],a=t[o];let s=i-1;for(;s>=n&&t[e[s]]>a;)e[s+1]=e[s--];e[s+1]=o}else{const i=n+r>>1;let o=n+1,a=r;Gd(e,i,o),t[e[n]]>t[e[r]]&&Gd(e,n,r),t[e[o]]>t[e[r]]&&Gd(e,o,r),t[e[n]]>t[e[o]]&&Gd(e,n,o);const s=e[o],u=t[s];for(;;){do o++;while(t[e[o]]<u);do a--;while(t[e[a]]>u);if(a<o)break;Gd(e,o,a)}e[n+1]=e[a],e[a]=s,r-o+1>=a-n?(Hl(e,t,o,r),Hl(e,t,n,a-1)):(Hl(e,t,n,a-1),Hl(e,t,o,r))}}function Gd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function xfe(e){return e[0]}function wfe(e){return e[1]}const $R=1e-6;class Ks{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,o=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>$R||Math.abs(this._y1-o)>$R)&&(this._+="L"+i+","+o),!!r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class iA{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class _fe{constructor(t,[n,r,i,o]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,o=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,g=0,p=r.length,m,y;h<p;h+=3,g+=2){const v=r[h]*2,b=r[h+1]*2,x=r[h+2]*2,w=t[v],E=t[v+1],_=t[b],$=t[b+1],C=t[x],O=t[x+1],A=_-w,D=$-E,F=C-w,T=O-E,S=A*A+D*D,M=F*F+T*T,P=(A*T-D*F)*2;if(!P)m=(w+C)/2-1e8*T,y=(E+O)/2+1e8*F;else if(Math.abs(P)<1e-8)m=(w+C)/2,y=(E+O)/2;else{const B=1/P;m=w+(T*S-D*M)*B,y=E+(A*M-F*S)*B}o[g]=m,o[g+1]=y}let a=n[n.length-1],s,u=a*4,l,c=t[2*a],f,d=t[2*a+1];i.fill(0);for(let h=0;h<n.length;++h)a=n[h],s=u,l=c,f=d,u=a*4,c=t[2*a],d=t[2*a+1],i[s+2]=i[u]=f-d,i[s+3]=i[u+1]=c-l}render(t){const n=t==null?t=new Ks:void 0,{delaunay:{halfedges:r,inedges:i,hull:o},circumcenters:a,vectors:s}=this;if(o.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,g=Math.floor(d/3)*2,p=a[h],m=a[h+1],y=a[g],v=a[g+1];this._renderSegment(p,m,y,v,t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];const f=Math.floor(i[l]/3)*2,d=a[f],h=a[f+1],g=u*4,p=this._project(d,h,s[g+2],s[g+3]);p&&this._renderSegment(d,h,p[0],p[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Ks:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new Ks:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let a=2;a<o;a+=2)(i[a]!==i[a-2]||i[a+1]!==i[a-1])&&n.lineTo(i[a],i[a+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new iA;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,o){let a;const s=this._regioncode(t,n),u=this._regioncode(r,i);s===0&&u===0?(o.moveTo(t,n),o.lineTo(r,i)):(a=this._clipSegment(t,n,r,i,s,u))&&(o.moveTo(a[0],a[1]),o.lineTo(a[2],a[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i)e:for(let o=0,a=n.length;o<a;o+=2)for(let s=0,u=i.length;s<u;s+=2)if(n[o]==i[s]&&n[o+1]==i[s+1]&&n[(o+2)%a]==i[(s+u-2)%u]&&n[(o+3)%a]==i[(s+u-1)%u]){yield r;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:o}}=this,a=r[t];if(a===-1)return null;const s=[];let u=a;do{const l=Math.floor(u/3);if(s.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,o[u]!==t)break;u=i[u]}while(u!==a&&u!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let i=null,o,a,s=n[r-2],u=n[r-1],l,c=this._regioncode(s,u),f,d;for(let h=0;h<r;h+=2)if(o=s,a=u,s=n[h],u=n[h+1],l=c,c=this._regioncode(s,u),l===0&&c===0)f=d,d=0,i?i.push(s,u):i=[s,u];else{let g,p,m,y,v;if(l===0){if((g=this._clipSegment(o,a,s,u,l,c))===null)continue;[p,m,y,v]=g}else{if((g=this._clipSegment(s,u,o,a,c,l))===null)continue;[y,v,p,m]=g,f=d,d=this._edgecode(p,m),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(p,m):i=[p,m]}f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(y,v):i=[y,v]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,o,a){for(;;){if(o===0&&a===0)return[t,n,r,i];if(o&a)return null;let s,u,l=o||a;l&8?(s=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):l&4?(s=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):l&2?(u=n+(i-n)*(this.xmax-t)/(r-t),s=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),s=this.xmin),o?(t=s,n=u,o=this._regioncode(t,n)):(r=s,i=u,a=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,o,a){let s=Array.from(n),u;if((u=this._project(s[0],s[1],r,i))&&s.unshift(u[0],u[1]),(u=this._project(s[s.length-2],s[s.length-1],o,a))&&s.push(u[0],u[1]),s=this._clipFinite(t,s))for(let l=0,c=s.length,f,d=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)f=d,d=this._edgecode(s[l],s[l+1]),f&&d&&(l=this._edge(t,f,d,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,n,r,i,o){for(;n!==r;){let a,s;switch(n){case 5:n=4;continue;case 4:n=6,a=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,a=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,a=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,a=this.xmin,s=this.ymin;break}(i[o]!==a||i[o+1]!==s)&&this.contains(t,a,s)&&(i.splice(o,0,a,s),o+=2)}if(i.length>4)for(let a=0;a<i.length;a+=2){const s=(a+2)%i.length,u=(a+4)%i.length;(i[a]===i[s]&&i[s]===i[u]||i[a+1]===i[s+1]&&i[s+1]===i[u+1])&&(i.splice(s,2),a-=2)}return o}_project(t,n,r,i){let o=1/0,a,s,u;if(i<0){if(n<=this.ymin)return null;(a=(this.ymin-n)/i)<o&&(u=this.ymin,s=t+(o=a)*r)}else if(i>0){if(n>=this.ymax)return null;(a=(this.ymax-n)/i)<o&&(u=this.ymax,s=t+(o=a)*r)}if(r>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/r)<o&&(s=this.xmax,u=n+(o=a)*i)}else if(r<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/r)<o&&(s=this.xmin,u=n+(o=a)*i)}return[s,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const Efe=2*Math.PI,Wl=Math.pow;function Afe(e){return e[0]}function $fe(e){return e[1]}function Sfe(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],o=2*t[r+1],a=2*t[r+2];if((n[a]-n[i])*(n[o+1]-n[i+1])-(n[o]-n[i])*(n[a+1]-n[i+1])>1e-10)return!1}return!0}function Cfe(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class oA{static from(t,n=Afe,r=$fe,i){return new oA("length"in t?Ofe(t,n,r,i):Float64Array.from(Ffe(t,n,r,i)))}constructor(t){this._delaunator=new km(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&Sfe(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const g=Cfe(n[2*d],n[2*d+1],f);n[2*d]=g[0],n[2*d+1]=g[1]}this._delaunator=new km(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=o[u%3==2?u-2:u+1];(r[u]===-1||a[c]===-1)&&(a[c]=u)}for(let u=0,l=i.length;u<l;++u)s[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],a[i[0]]=1,i.length===2&&(a[i[1]]=0))}voronoi(t){return new _fe(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:o,triangles:a,collinear:s}=this;if(s){const f=s.indexOf(t);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=a[l],l=l%3==2?l-2:l+1,a[l]!==t)return;if(l=o[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let o;for(;(o=this._step(r,t,n))>=0&&o!==r&&o!==i;)r=o;return o}_step(t,n,r){const{inedges:i,hull:o,_hullIndex:a,halfedges:s,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=Wl(n-l[t*2],2)+Wl(r-l[t*2+1],2);const d=i[t];let h=d;do{let g=u[h];const p=Wl(n-l[g*2],2)+Wl(r-l[g*2+1],2);if(p<f&&(f=p,c=g),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=s[h],h===-1){if(h=o[(a[t]+1)%o.length],h!==g&&Wl(n-l[h*2],2)+Wl(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new Ks:void 0,{points:r,halfedges:i,triangles:o}=this;for(let a=0,s=i.length;a<s;++a){const u=i[a];if(u<a)continue;const l=o[a]*2,c=o[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new Ks:void 0,{points:i}=this;for(let o=0,a=i.length;o<a;o+=2){const s=i[o],u=i[o+1];t.moveTo(s+n,u),t.arc(s,u,n,0,Efe)}return r&&r.value()}renderHull(t){const n=t==null?t=new Ks:void 0,{hull:r,points:i}=this,o=r[0]*2,a=r.length;t.moveTo(i[o],i[o+1]);for(let s=1;s<a;++s){const u=2*r[s];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new iA;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new Ks:void 0,{points:i,triangles:o}=this,a=o[t*=3]*2,s=o[t+1]*2,u=o[t+2]*2;return n.moveTo(i[a],i[a+1]),n.lineTo(i[s],i[s+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new iA;return this.renderTriangle(t,n),n.value()}}function Ofe(e,t,n,r){const i=e.length,o=new Float64Array(i*2);for(let a=0;a<i;++a){const s=e[a];o[a*2]=t.call(r,s,a,e),o[a*2+1]=n.call(r,s,a,e)}return o}function*Ffe(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}function aA(e){N.call(this,null,e)}aA.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const kfe=[-1e5,-1e5,1e5,1e5];q(aA,N,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:kfe;const o=this.value=oA.from(r,e.x,e.y).voronoi(i);for(let a=0,s=r.length;a<s;++a){const u=o.cellPolygon(a);r[a][n]=u?Dfe(u):null}return t.reflow(e.modified()).modifies(n)}});function Dfe(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var Mfe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:aA}),sA=Math.PI/180,Yd=1<<11>>5,Mm=1<<11;function Tfe(){var e=[256,256],t,n,r,i,o,a,s,u=SR,l=[],c=Math.random,f={};f.layout=function(){for(var g=d(ll()),p=Ife((e[0]>>5)*e[1]),m=null,y=l.length,v=-1,b=[],x=l.map(E=>({text:t(E),font:n(E),style:i(E),weight:o(E),rotate:a(E),size:~~(r(E)+1e-14),padding:s(E),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:E})).sort((E,_)=>_.size-E.size);++v<y;){var w=x[v];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,Nfe(g,w,x,v),w.hasText&&h(p,w,m)&&(b.push(w),m?jfe(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function d(g){g.width=g.height=1;var p=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=(Yd<<5)/p,g.height=Mm/p;var m=g.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:p}}function h(g,p,m){for(var y=p.x,v=p.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=u(e),w=c()<.5?1:-1,E=-w,_,$,C;(_=x(E+=w))&&($=~~_[0],C=~~_[1],!(Math.min(Math.abs($),Math.abs(C))>=b));)if(p.x=y+$,p.y=v+C,!(p.x+p.x0<0||p.y+p.y0<0||p.x+p.x1>e[0]||p.y+p.y1>e[1])&&(!m||!Rfe(p,g,e[0]))&&(!m||Lfe(p,m))){for(var O=p.sprite,A=p.width>>5,D=e[0]>>5,F=p.x-(A<<4),T=F&127,S=32-T,M=p.y1-p.y0,P=(p.y+p.y0)*D+(F>>5),B,H=0;H<M;H++){B=0;for(var ie=0;ie<=A;ie++)g[P+ie]|=B<<S|(ie<A?(B=O[H*A+ie])>>>T:0);P+=D}return p.sprite=null,!0}return!1}return f.words=function(g){return arguments.length?(l=g,f):l},f.size=function(g){return arguments.length?(e=[+g[0],+g[1]],f):e},f.font=function(g){return arguments.length?(n=Js(g),f):n},f.fontStyle=function(g){return arguments.length?(i=Js(g),f):i},f.fontWeight=function(g){return arguments.length?(o=Js(g),f):o},f.rotate=function(g){return arguments.length?(a=Js(g),f):a},f.text=function(g){return arguments.length?(t=Js(g),f):t},f.spiral=function(g){return arguments.length?(u=Bfe[g]||g,f):u},f.fontSize=function(g){return arguments.length?(r=Js(g),f):r},f.padding=function(g){return arguments.length?(s=Js(g),f):s},f.random=function(g){return arguments.length?(c=g,f):c},f}function Nfe(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(Yd<<5)/o,Mm/o);var a=0,s=0,u=0,l=n.length,c,f,d,h,g;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=i.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var p=Math.sin(t.rotate*sA),m=Math.cos(t.rotate*sA),y=c*m,v=c*p,b=d*m,x=d*p;c=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,d=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else c=c+31>>5<<5;if(d>u&&(u=d),a+c>=Yd<<5&&(a=0,s+=u,u=0),s+d>=Mm)break;i.translate((a+(c>>1))/o,(s+(d>>1))/o),t.rotate&&i.rotate(t.rotate*sA),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=a,t.yoff=s,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,a+=c}for(var w=i.getImageData(0,0,(Yd<<5)/o,Mm/o).data,E=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)E[h]=0;if(a=t.xoff,a==null)return;s=t.yoff;var _=0,$=-1;for(g=0;g<d;g++){for(h=0;h<c;h++){var C=f*g+(h>>5),O=w[(s+g)*(Yd<<5)+(a+h)<<2]?1<<31-h%32:0;E[C]|=O,_|=O}_?$=g:(t.y0++,d--,g--,s++)}t.y1=t.y0+$,t.sprite=E.slice(0,(t.y1-t.y0)*f)}}}function Rfe(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,o=e.x-(i<<4),a=o&127,s=32-a,u=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<s|(d<i?(c=r[f*i+d])>>>a:0))&t[l+d])return!0;l+=n}return!1}function jfe(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Lfe(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function SR(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Pfe(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(o){var a=o<0?-1:1;switch(Math.sqrt(1+4*a*o)-a&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function Ife(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Js(e){return typeof e=="function"?e:function(){return e}}var Bfe={archimedean:SR,rectangular:Pfe};const CR=["x","y","font","fontSize","fontStyle","fontWeight","angle"],zfe=["text","font","rotate","fontSize","fontStyle","fontWeight"];function uA(e){N.call(this,Tfe(),e)}uA.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:CR}]};q(uA,N,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&I("Wordcloud size dimensions must be non-zero.");function n(g){const p=e[g];return me(p)&&t.modified(p.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||zfe.some(n)))return;const i=t.materialize(t.SOURCE).source,o=this.value,a=e.as||CR;let s=e.fontSize||14,u;if(me(s)?u=e.fontSizeRange:s=Jt(s),u){const g=s,p=Ne("sqrt")().domain(Ai(i,g)).range(u);s=m=>p(g(m))}i.forEach(g=>{g[a[0]]=NaN,g[a[1]]=NaN,g[a[3]]=0});const l=o.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(Ar).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let g=0,p,m;g<h;++g)p=l[g],m=p.datum,m[a[0]]=p.x+f,m[a[1]]=p.y+d,m[a[2]]=p.font,m[a[3]]=p.size,m[a[4]]=p.style,m[a[5]]=p.weight,m[a[6]]=p.rotate;return t.reflow(r).modifies(a)}});var Ufe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:uA});function OR(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function FR(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=qfe(e));function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=r(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:r,center:o,right:i}}function qfe(e){return(t,n)=>OR(e(t),n)}function Hfe(e){return e===null?NaN:+e}const kR=FR(OR),Wfe=kR.right,Gfe=kR.left;FR(Hfe).center;function Yfe(e,t){return Array.from(t,n=>e[n])}const Vfe=e=>new Uint8Array(e),Xfe=e=>new Uint16Array(e),Vd=e=>new Uint32Array(e);function Kfe(){let e=8,t=[],n=Vd(0),r=Tm(0,e),i=Tm(0,e);return{data:()=>t,seen:()=>n=Jfe(n,t.length),add(o){for(let a=0,s=t.length,u=o.length,l;a<u;++a)l=o[a],l._index=s++,t.push(l)},remove(o,a){const s=t.length,u=Array(s-o),l=t;let c,f,d;for(f=0;!a[f]&&f<s;++f)u[f]=t[f],l[f]=f;for(d=f;f<s;++f)c=t[f],a[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:o=>i[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,a){r[o]|=a},clear(o,a){r[o]&=~a},resize(o,a){const s=r.length;(o>s||a>e)&&(e=Math.max(a,e),r=Tm(o,e,r),i=Tm(o,e))}}}function Jfe(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function Tm(e,t,n){const r=(t<257?Vfe:t<65537?Xfe:Vd)(e);return n&&r.set(n),r}function DR(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,o){const a=this,s=a.bisect(a.range,i.value),u=i.index,l=s[0],c=s[1],f=u.length;let d;for(d=0;d<l;++d)o[u[d]]|=r;for(d=c;d<f;++d)o[u[d]]|=r;return a}}}function MR(){let e=Vd(0),t=[],n=0;function r(s,u,l){if(!u.length)return[];const c=n,f=u.length,d=Vd(f);let h=Array(f),g,p,m;for(m=0;m<f;++m)h[m]=s(u[m]),d[m]=m;if(h=Zfe(h,d),c)g=t,p=e,t=Array(c+f),e=Vd(c+f),Qfe(l,g,p,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(s,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-s}function o(s){for(let u=0,l=n;u<l;++u)e[u]=s[e[u]]}function a(s,u){let l;return u?l=u.length:(u=t,l=n),[Gfe(u,s[0],0,l),Wfe(u,s[1],0,l)]}return{insert:r,remove:i,bisect:a,reindex:o,index:()=>e,size:()=>n}}function Zfe(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],o=e[r];return i<o?-1:i>o?1:0}),Yfe(e,t)}function Qfe(e,t,n,r,i,o,a,s,u){let l=0,c=0,f;for(f=0;l<r&&c<a;++f)t[l]<i[c]?(s[f]=t[l],u[f]=n[l++]):(s[f]=i[c],u[f]=o[c++]+e);for(;l<r;++l,++f)s[f]=t[l],u[f]=n[l];for(;c<a;++c,++f)s[f]=i[c],u[f]=o[c]+e}function lA(e){N.call(this,Kfe(),e),this._indices=null,this._dims=null}lA.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};q(lA,N,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],a=r.length;let s=0,u,l;for(;s<a;++s)u=n[s].fname,l=i[u]||(i[u]=MR()),o.push(DR(l,s,r[s]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,a=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,g={};let p,m,y,v,b,x,w,E,_;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},v=t.mod,w=0,E=v.length;w<E;++w)x[v[w]._index]=1;for(w=0;w<h;++w)_=r[w],(!a[w]||e.modified("fields",w)||t.modified(_.fields))&&(y=_.fname,(p=g[y])||(o[y]=m=MR(),g[y]=p=m.insert(_,t.source,0)),a[w]=DR(m,w,i[w]).onAdd(p,u));for(w=0,E=s.data().length;w<E;++w)b[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,a=this._indices,s=e.fields,u={},l=n.add,c=i.size()+r.length,f=o.length;let d=i.size(),h,g,p;i.resize(c,f),i.add(r);const m=i.curr(),y=i.prev(),v=i.all();for(h=0;h<f;++h)g=s[h].fname,p=u[g]||(u[g]=a[g].insert(s[h],r,d)),o[h].onAdd(p,m);for(;d<c;++d)y[d]=v,m[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),a=e.mod;let s,u,l;for(s=0,u=a.length;s<u;++s)l=a[s]._index,i[l]!==o&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),a=i.prev(),s=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,g;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,a[h]=g=o[h],o[h]=s,g!==s&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const o=i.remove(t,n);for(const a in r)r[a].reindex(o)})},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,a=r.length;let s=0,u,l;for(n.filters=0,l=0;l<a;++l)e.modified("query",l)&&(u=l,++s);if(s===1)s=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,s=0;l<a;++l)!e.modified("query",l)||(s|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return s},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),a=i.curr(),s=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],g=l[1],p=e.one;let m,y,v;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=p;else if(f>h)for(m=h,y=Math.min(f,g);m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=p;if(d>g)for(m=Math.max(f,g),y=d;m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=p;else if(d<g)for(m=Math.max(h,d),y=g;m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=p;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,o=i.curr(),a=e.index(),s=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=s[0],d=s[1],h=e.one;let g,p,m;if(l<f)for(g=l,p=Math.min(f,c);g<p;++g)m=a[g],o[m]^=h,n.push(m);else if(l>f)for(g=f,p=Math.min(l,d);g<p;++g)m=a[g],o[m]^=h,r.push(m);if(c>d)for(g=Math.max(l,d),p=c;g<p;++g)m=a[g],o[m]^=h,n.push(m);else if(c<d)for(g=Math.max(f,c),p=d;g<p;++g)m=a[g],o[m]^=h,r.push(m);e.range=t.slice()}});function cA(e){N.call(this,null,e)}cA.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};q(cA,N,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)==0)return t.StopPropagation;const o=t.fork(t.ALL),a=r.data(),s=r.curr(),u=r.prev(),l=c=>s[c]&n?null:a[c];return o.filter(o.MOD,l),i&i-1?(o.filter(o.ADD,c=>{const f=s[c]&n;return!f&&f^u[c]&n?a[c]:null}),o.filter(o.REM,c=>{const f=s[c]&n;return f&&!(f^(f^u[c]&n))?a[c]:null})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(s[c]&n)===i?a[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});var ede=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:lA,resolvefilter:cA}),tde=Math.sqrt(50),nde=Math.sqrt(10),rde=Math.sqrt(2);function ide(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=tde?i*=10:o>=nde?i*=5:o>=rde&&(i*=2),t<e?-i:i}const ode="RawCode",Zs="Literal",ade="Property",sde="Identifier",ude="ArrayExpression",lde="BinaryExpression",TR="CallExpression",cde="ConditionalExpression",fde="LogicalExpression",dde="MemberExpression",hde="ObjectExpression",gde="UnaryExpression";function ii(e){this.type=e}ii.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=pde(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function pde(e){switch(e.type){case ude:return e.elements;case lde:case fde:return[e.left,e.right];case TR:return[e.callee].concat(e.arguments);case cde:return[e.test,e.consequent,e.alternate];case dde:return[e.object,e.property];case hde:return e.properties;case ade:return[e.key,e.value];case gde:return[e.argument];case sde:case Zs:case ode:default:return[]}}var Hi,K,j,an,Ue,Nm=1,Xd=2,Qs=3,ja=4,Rm=5,eu=6,Hn=7,Kd=8,mde=9;Hi={};Hi[Nm]="Boolean";Hi[Xd]="<end>";Hi[Qs]="Identifier";Hi[ja]="Keyword";Hi[Rm]="Null";Hi[eu]="Numeric";Hi[Hn]="Punctuator";Hi[Kd]="String";Hi[mde]="RegularExpression";var yde="ArrayExpression",vde="BinaryExpression",bde="CallExpression",xde="ConditionalExpression",NR="Identifier",wde="Literal",_de="LogicalExpression",Ede="MemberExpression",Ade="ObjectExpression",$de="Property",Sde="UnaryExpression",Nt="Unexpected token %0",Cde="Unexpected number",Ode="Unexpected string",Fde="Unexpected identifier",kde="Unexpected reserved word",Dde="Unexpected end of input",fA="Invalid regular expression",dA="Invalid regular expression: missing /",RR="Octal literals are not allowed in strict mode.",Mde="Duplicate data property in object literal not allowed in strict mode",Ht="ILLEGAL",Jd="Disabled.",Tde=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Nde=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function jm(e,t){if(!e)throw new Error("ASSERT: "+t)}function jo(e){return e>=48&&e<=57}function hA(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Zd(e){return"01234567".indexOf(e)>=0}function Rde(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Qd(e){return e===10||e===13||e===8232||e===8233}function eh(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Tde.test(String.fromCharCode(e))}function Lm(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Nde.test(String.fromCharCode(e))}const jde={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function jR(){for(;j<an;){const e=K.charCodeAt(j);if(Rde(e)||Qd(e))++j;else break}}function gA(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)j<an&&hA(K[j])?(r=K[j++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Re({},Nt,Ht);return String.fromCharCode(i)}function Lde(){var e,t,n,r;for(e=K[j],t=0,e==="}"&&Re({},Nt,Ht);j<an&&(e=K[j++],!!hA(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Re({},Nt,Ht),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function LR(){var e,t;for(e=K.charCodeAt(j++),t=String.fromCharCode(e),e===92&&(K.charCodeAt(j)!==117&&Re({},Nt,Ht),++j,e=gA("u"),(!e||e==="\\"||!eh(e.charCodeAt(0)))&&Re({},Nt,Ht),t=e);j<an&&(e=K.charCodeAt(j),!!Lm(e));)++j,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),K.charCodeAt(j)!==117&&Re({},Nt,Ht),++j,e=gA("u"),(!e||e==="\\"||!Lm(e.charCodeAt(0)))&&Re({},Nt,Ht),t+=e);return t}function Pde(){var e,t;for(e=j++;j<an;){if(t=K.charCodeAt(j),t===92)return j=e,LR();if(Lm(t))++j;else break}return K.slice(e,j)}function Ide(){var e,t,n;return e=j,t=K.charCodeAt(j)===92?LR():Pde(),t.length===1?n=Qs:jde.hasOwnProperty(t)?n=ja:t==="null"?n=Rm:t==="true"||t==="false"?n=Nm:n=Qs,{type:n,value:t,start:e,end:j}}function pA(){var e=j,t=K.charCodeAt(j),n,r=K[j],i,o,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++j,{type:Hn,value:String.fromCharCode(t),start:e,end:j};default:if(n=K.charCodeAt(j+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return j+=2,{type:Hn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:j};case 33:case 61:return j+=2,K.charCodeAt(j)===61&&++j,{type:Hn,value:K.slice(e,j),start:e,end:j}}}if(a=K.substr(j,4),a===">>>=")return j+=4,{type:Hn,value:a,start:e,end:j};if(o=a.substr(0,3),o===">>>"||o==="<<="||o===">>=")return j+=3,{type:Hn,value:o,start:e,end:j};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return j+=2,{type:Hn,value:i,start:e,end:j};if(i==="//"&&Re({},Nt,Ht),"<>=!+-*%&|^/".indexOf(r)>=0)return++j,{type:Hn,value:r,start:e,end:j};Re({},Nt,Ht)}function Bde(e){let t="";for(;j<an&&hA(K[j]);)t+=K[j++];return t.length===0&&Re({},Nt,Ht),eh(K.charCodeAt(j))&&Re({},Nt,Ht),{type:eu,value:parseInt("0x"+t,16),start:e,end:j}}function zde(e){let t="0"+K[j++];for(;j<an&&Zd(K[j]);)t+=K[j++];return(eh(K.charCodeAt(j))||jo(K.charCodeAt(j)))&&Re({},Nt,Ht),{type:eu,value:parseInt(t,8),octal:!0,start:e,end:j}}function PR(){var e,t,n;if(n=K[j],jm(jo(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=j,e="",n!=="."){if(e=K[j++],n=K[j],e==="0"){if(n==="x"||n==="X")return++j,Bde(t);if(Zd(n))return zde(t);n&&jo(n.charCodeAt(0))&&Re({},Nt,Ht)}for(;jo(K.charCodeAt(j));)e+=K[j++];n=K[j]}if(n==="."){for(e+=K[j++];jo(K.charCodeAt(j));)e+=K[j++];n=K[j]}if(n==="e"||n==="E")if(e+=K[j++],n=K[j],(n==="+"||n==="-")&&(e+=K[j++]),jo(K.charCodeAt(j)))for(;jo(K.charCodeAt(j));)e+=K[j++];else Re({},Nt,Ht);return eh(K.charCodeAt(j))&&Re({},Nt,Ht),{type:eu,value:parseFloat(e),start:t,end:j}}function Ude(){var e="",t,n,r,i,o=!1;for(t=K[j],jm(t==="'"||t==='"',"String literal must starts with a quote"),n=j,++j;j<an;)if(r=K[j++],r===t){t="";break}else if(r==="\\")if(r=K[j++],!r||!Qd(r.charCodeAt(0)))switch(r){case"u":case"x":K[j]==="{"?(++j,e+=Lde()):e+=gA(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Zd(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),j<an&&Zd(K[j])&&(o=!0,i=i*8+"01234567".indexOf(K[j++]),"0123".indexOf(r)>=0&&j<an&&Zd(K[j])&&(i=i*8+"01234567".indexOf(K[j++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&K[j]===`
`&&++j;else{if(Qd(r.charCodeAt(0)))break;e+=r}return t!==""&&Re({},Nt,Ht),{type:Kd,value:e,octal:o,start:n,end:j}}function qde(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Re({},fA)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Re({},fA)}try{return new RegExp(e,t)}catch(r){return null}}function Hde(){var e,t,n,r,i;for(e=K[j],jm(e==="/","Regular expression literal must start with a slash"),t=K[j++],n=!1,r=!1;j<an;)if(e=K[j++],t+=e,e==="\\")e=K[j++],Qd(e.charCodeAt(0))&&Re({},dA),t+=e;else if(Qd(e.charCodeAt(0)))Re({},dA);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Re({},dA),i=t.substr(1,t.length-2),{value:i,literal:t}}function Wde(){var e,t,n;for(t="",n="";j<an&&(e=K[j],!!Lm(e.charCodeAt(0)));)++j,e==="\\"&&j<an?Re({},Nt,Ht):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Re({},fA,n),{value:n,literal:t}}function Gde(){var e,t,n,r;return Ue=null,jR(),e=j,t=Hde(),n=Wde(),r=qde(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:j}}function Yde(e){return e.type===Qs||e.type===ja||e.type===Nm||e.type===Rm}function IR(){if(jR(),j>=an)return{type:Xd,start:j,end:j};const e=K.charCodeAt(j);return eh(e)?Ide():e===40||e===41||e===59?pA():e===39||e===34?Ude():e===46?jo(K.charCodeAt(j+1))?PR():pA():jo(e)?PR():pA()}function Wn(){const e=Ue;return j=e.end,Ue=IR(),j=e.end,e}function BR(){const e=j;Ue=IR(),j=e}function Vde(e){const t=new ii(yde);return t.elements=e,t}function zR(e,t,n){const r=new ii(e==="||"||e==="&&"?_de:vde);return r.operator=e,r.left=t,r.right=n,r}function Xde(e,t){const n=new ii(bde);return n.callee=e,n.arguments=t,n}function Kde(e,t,n){const r=new ii(xde);return r.test=e,r.consequent=t,r.alternate=n,r}function mA(e){const t=new ii(NR);return t.name=e,t}function th(e){const t=new ii(wde);return t.value=e.value,t.raw=K.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function UR(e,t,n){const r=new ii(Ede);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Jde(e){const t=new ii(Ade);return t.properties=e,t}function qR(e,t,n){const r=new ii($de);return r.key=t,r.value=n,r.kind=e,r}function Zde(e,t){const n=new ii(Sde);return n.operator=e,n.argument=t,n.prefix=!0,n}function Re(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,a)=>(jm(a<r.length,"Message reference must be in range"),r[a]));throw n=new Error(i),n.index=j,n.description=i,n}function Pm(e){e.type===Xd&&Re(e,Dde),e.type===eu&&Re(e,Cde),e.type===Kd&&Re(e,Ode),e.type===Qs&&Re(e,Fde),e.type===ja&&Re(e,kde),Re(e,Nt,e.value)}function sn(e){const t=Wn();(t.type!==Hn||t.value!==e)&&Pm(t)}function Qe(e){return Ue.type===Hn&&Ue.value===e}function yA(e){return Ue.type===ja&&Ue.value===e}function Qde(){const e=[];for(j=Ue.start,sn("[");!Qe("]");)Qe(",")?(Wn(),e.push(null)):(e.push(tu()),Qe("]")||sn(","));return Wn(),Vde(e)}function HR(){j=Ue.start;const e=Wn();return e.type===Kd||e.type===eu?(e.octal&&Re(e,RR),th(e)):mA(e.value)}function ehe(){var e,t,n,r;if(j=Ue.start,e=Ue,e.type===Qs)return n=HR(),sn(":"),r=tu(),qR("init",n,r);if(e.type===Xd||e.type===Hn)Pm(e);else return t=HR(),sn(":"),r=tu(),qR("init",t,r)}function the(){var e=[],t,n,r,i={},o=String;for(j=Ue.start,sn("{");!Qe("}");)t=ehe(),t.key.type===NR?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Re({},Mde):i[r]=!0,e.push(t),Qe("}")||sn(",");return sn("}"),Jde(e)}function nhe(){sn("(");const e=vA();return sn(")"),e}const rhe={if:1};function ihe(){var e,t,n;if(Qe("("))return nhe();if(Qe("["))return Qde();if(Qe("{"))return the();if(e=Ue.type,j=Ue.start,e===Qs||rhe[Ue.value])n=mA(Wn().value);else if(e===Kd||e===eu)Ue.octal&&Re(Ue,RR),n=th(Wn());else{if(e===ja)throw new Error(Jd);e===Nm?(t=Wn(),t.value=t.value==="true",n=th(t)):e===Rm?(t=Wn(),t.value=null,n=th(t)):Qe("/")||Qe("/=")?(n=th(Gde()),BR()):Pm(Wn())}return n}function ohe(){const e=[];if(sn("("),!Qe(")"))for(;j<an&&(e.push(tu()),!Qe(")"));)sn(",");return sn(")"),e}function ahe(){j=Ue.start;const e=Wn();return Yde(e)||Pm(e),mA(e.value)}function she(){return sn("."),ahe()}function uhe(){sn("[");const e=vA();return sn("]"),e}function lhe(){var e,t,n;for(e=ihe();;)if(Qe("."))n=she(),e=UR(".",e,n);else if(Qe("("))t=ohe(),e=Xde(e,t);else if(Qe("["))n=uhe(),e=UR("[",e,n);else break;return e}function WR(){const e=lhe();if(Ue.type===Hn&&(Qe("++")||Qe("--")))throw new Error(Jd);return e}function Im(){var e,t;if(Ue.type!==Hn&&Ue.type!==ja)t=WR();else{if(Qe("++")||Qe("--"))throw new Error(Jd);if(Qe("+")||Qe("-")||Qe("~")||Qe("!"))e=Wn(),t=Im(),t=Zde(e.value,t);else{if(yA("delete")||yA("void")||yA("typeof"))throw new Error(Jd);t=WR()}}return t}function GR(e){let t=0;if(e.type!==Hn&&e.type!==ja)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function che(){var e,t,n,r,i,o,a,s,u,l;if(e=Ue,u=Im(),r=Ue,i=GR(r),i===0)return u;for(r.prec=i,Wn(),t=[e,Ue],a=Im(),o=[u,r,a];(i=GR(Ue))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=zR(s,u,a),o.push(n);r=Wn(),r.prec=i,o.push(r),t.push(Ue),n=Im(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=zR(o[l-1].value,o[l-2],n),l-=2;return n}function tu(){var e,t,n;return e=che(),Qe("?")&&(Wn(),t=tu(),sn(":"),n=tu(),e=Kde(e,t,n)),e}function vA(){const e=tu();if(Qe(","))throw new Error(Jd);return e}function YR(e){K=e,j=0,an=K.length,Ue=null,BR();const t=vA();if(Ue.type!==Xd)throw new Error("Unexpect token after expression.");return t}var VR={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function XR(e){function t(a,s,u,l){let c=e(s[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(l<0?"":l===0?"()":"("+s.slice(1).map(e).join(",")+")")}function n(a,s,u){return l=>t(a,l,s,u)}const r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&I("Missing arguments to clamp function."),a.length>3&&I("Too many arguments to clamp function.");const s=a.map(e);return"Math.max("+s[1]+", Math.min("+s[2]+","+s[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:o,test:n("test",o),if:function(a){a.length<3&&I("Missing arguments to if function."),a.length>3&&I("Too many arguments to if function.");const s=a.map(e);return"("+s[0]+"?"+s[1]+":"+s[2]+")"}}}function fhe(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function KR(e){e=e||{};const t=e.allowed?Yr(e.allowed):{},n=e.forbidden?Yr(e.forbidden):{},r=e.constants||VR,i=(e.functions||XR)(f),o=e.globalvar,a=e.fieldvar,s=me(o)?o:g=>`${o}["${g}"]`;let u={},l={},c=0;function f(g){if(Fe(g))return g;const p=d[g.type];return p==null&&I("Unsupported type: "+g.type),p(g)}const d={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return c>0?p:ae(n,p)?I("Illegal identifier: "+p):ae(r,p)?r[p]:ae(t,p)?p:(u[p]=1,s(p))},MemberExpression:g=>{const p=!g.computed,m=f(g.object);p&&(c+=1);const y=f(g.property);return m===a&&(l[fhe(y)]=1),p&&(c-=1),m+(p?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&I("Illegal callee type: "+g.callee.type);const p=g.callee.name,m=g.arguments,y=ae(i,p)&&i[p];return y||I("Unrecognized function: "+p),me(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(f).join(",")+"]",BinaryExpression:g=>"("+f(g.left)+" "+g.operator+" "+f(g.right)+")",UnaryExpression:g=>"("+g.operator+f(g.argument)+")",ConditionalExpression:g=>"("+f(g.test)+"?"+f(g.consequent)+":"+f(g.alternate)+")",LogicalExpression:g=>"("+f(g.left)+g.operator+f(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(f).join(",")+"}",Property:g=>{c+=1;const p=f(g.key);return c-=1,p+":"+f(g.value)}};function h(g){const p={code:f(g),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},p}return h.functions=i,h.constants=r,h}class La{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[r++]=s),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}function dhe(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}var Bm=1e-6,JR=1e-12,nh=Math.PI,ZR=nh/2,QR=nh/4,e9=nh*2,rh=180/nh,un=nh/180,bA=Math.abs,zm=Math.atan2,An=Math.cos,xA=Math.hypot,$n=Math.sin,t9=Math.sqrt;function wA(e){return e>1?ZR:e<-1?-ZR:Math.asin(e)}function ih(){}function Um(e,t){e&&r9.hasOwnProperty(e.type)&&r9[e.type](e,t)}var n9={Feature:function(e,t){Um(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Um(n[r].geometry,t)}},r9={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){_A(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)_A(n[r],t,0)},Polygon:function(e,t){i9(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)i9(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Um(n[r],t)}};function _A(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function i9(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)_A(e[n],t,1);t.polygonEnd()}function EA(e,t){e&&n9.hasOwnProperty(e.type)?n9[e.type](e,t):Um(e,t)}var qm=new La,Hm=new La,o9,a9,AA,$A,SA,Wi={point:ih,lineStart:ih,lineEnd:ih,polygonStart:function(){qm=new La,Wi.lineStart=hhe,Wi.lineEnd=ghe},polygonEnd:function(){var e=+qm;Hm.add(e<0?e9+e:e),this.lineStart=this.lineEnd=this.point=ih},sphere:function(){Hm.add(e9)}};function hhe(){Wi.point=phe}function ghe(){s9(o9,a9)}function phe(e,t){Wi.point=s9,o9=e,a9=t,e*=un,t*=un,AA=e,$A=An(t=t/2+QR),SA=$n(t)}function s9(e,t){e*=un,t*=un,t=t/2+QR;var n=e-AA,r=n>=0?1:-1,i=r*n,o=An(t),a=$n(t),s=SA*a,u=$A*o+s*An(i),l=s*r*$n(i);qm.add(zm(l,u)),AA=e,$A=o,SA=a}function mhe(e){return Hm=new La,EA(e,Wi),Hm*2}function yhe(e){return[zm(e[1],e[0]),wA(e[2])]}function vhe(e){var t=e[0],n=e[1],r=An(n);return[r*An(t),r*$n(t),$n(n)]}function u9(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function bhe(e){var t=t9(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var ot,Gn,ct,hr,nu,l9,c9,Gl,oh,Pa,Lo,Po={point:CA,lineStart:d9,lineEnd:h9,polygonStart:function(){Po.point=g9,Po.lineStart=xhe,Po.lineEnd=whe,oh=new La,Wi.polygonStart()},polygonEnd:function(){Wi.polygonEnd(),Po.point=CA,Po.lineStart=d9,Po.lineEnd=h9,qm<0?(ot=-(ct=180),Gn=-(hr=90)):oh>Bm?hr=90:oh<-Bm&&(Gn=-90),Lo[0]=ot,Lo[1]=ct},sphere:function(){ot=-(ct=180),Gn=-(hr=90)}};function CA(e,t){Pa.push(Lo=[ot=e,ct=e]),t<Gn&&(Gn=t),t>hr&&(hr=t)}function f9(e,t){var n=vhe([e*un,t*un]);if(Gl){var r=u9(Gl,n),i=[r[1],-r[0],0],o=u9(i,r);bhe(o),o=yhe(o);var a=e-nu,s=a>0?1:-1,u=o[0]*rh*s,l,c=bA(a)>180;c^(s*nu<u&&u<s*e)?(l=o[1]*rh,l>hr&&(hr=l)):(u=(u+360)%360-180,c^(s*nu<u&&u<s*e)?(l=-o[1]*rh,l<Gn&&(Gn=l)):(t<Gn&&(Gn=t),t>hr&&(hr=t))),c?e<nu?gr(ot,e)>gr(ot,ct)&&(ct=e):gr(e,ct)>gr(ot,ct)&&(ot=e):ct>=ot?(e<ot&&(ot=e),e>ct&&(ct=e)):e>nu?gr(ot,e)>gr(ot,ct)&&(ct=e):gr(e,ct)>gr(ot,ct)&&(ot=e)}else Pa.push(Lo=[ot=e,ct=e]);t<Gn&&(Gn=t),t>hr&&(hr=t),Gl=n,nu=e}function d9(){Po.point=f9}function h9(){Lo[0]=ot,Lo[1]=ct,Po.point=CA,Gl=null}function g9(e,t){if(Gl){var n=e-nu;oh.add(bA(n)>180?n+(n>0?360:-360):n)}else l9=e,c9=t;Wi.point(e,t),f9(e,t)}function xhe(){Wi.lineStart()}function whe(){g9(l9,c9),Wi.lineEnd(),bA(oh)>Bm&&(ot=-(ct=180)),Lo[0]=ot,Lo[1]=ct,Gl=null}function gr(e,t){return(t-=e)<0?t+360:t}function _he(e,t){return e[0]-t[0]}function p9(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Ehe(e){var t,n,r,i,o,a,s;if(hr=ct=-(ot=Gn=1/0),Pa=[],EA(e,Po),n=Pa.length){for(Pa.sort(_he),t=1,r=Pa[0],o=[r];t<n;++t)i=Pa[t],p9(r,i[0])||p9(r,i[1])?(gr(r[0],i[1])>gr(r[0],r[1])&&(r[1]=i[1]),gr(i[0],r[1])>gr(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,n=o.length-1,t=0,r=o[n];t<=n;r=i,++t)i=o[t],(s=gr(r[1],i[0]))>a&&(a=s,ot=i[0],ct=r[1])}return Pa=Lo=null,ot===1/0||Gn===1/0?[[NaN,NaN],[NaN,NaN]]:[[ot,Gn],[ct,hr]]}var ah,Wm,Gm,Ym,Vm,Xm,Km,Jm,OA,FA,kA,m9,y9,Sn,Cn,On,oi={sphere:ih,point:DA,lineStart:v9,lineEnd:b9,polygonStart:function(){oi.lineStart=She,oi.lineEnd=Che},polygonEnd:function(){oi.lineStart=v9,oi.lineEnd=b9}};function DA(e,t){e*=un,t*=un;var n=An(t);sh(n*An(e),n*$n(e),$n(t))}function sh(e,t,n){++ah,Gm+=(e-Gm)/ah,Ym+=(t-Ym)/ah,Vm+=(n-Vm)/ah}function v9(){oi.point=Ahe}function Ahe(e,t){e*=un,t*=un;var n=An(t);Sn=n*An(e),Cn=n*$n(e),On=$n(t),oi.point=$he,sh(Sn,Cn,On)}function $he(e,t){e*=un,t*=un;var n=An(t),r=n*An(e),i=n*$n(e),o=$n(t),a=zm(t9((a=Cn*o-On*i)*a+(a=On*r-Sn*o)*a+(a=Sn*i-Cn*r)*a),Sn*r+Cn*i+On*o);Wm+=a,Xm+=a*(Sn+(Sn=r)),Km+=a*(Cn+(Cn=i)),Jm+=a*(On+(On=o)),sh(Sn,Cn,On)}function b9(){oi.point=DA}function She(){oi.point=Ohe}function Che(){x9(m9,y9),oi.point=DA}function Ohe(e,t){m9=e,y9=t,e*=un,t*=un,oi.point=x9;var n=An(t);Sn=n*An(e),Cn=n*$n(e),On=$n(t),sh(Sn,Cn,On)}function x9(e,t){e*=un,t*=un;var n=An(t),r=n*An(e),i=n*$n(e),o=$n(t),a=Cn*o-On*i,s=On*r-Sn*o,u=Sn*i-Cn*r,l=xA(a,s,u),c=wA(l),f=l&&-c/l;OA.add(f*a),FA.add(f*s),kA.add(f*u),Wm+=c,Xm+=c*(Sn+(Sn=r)),Km+=c*(Cn+(Cn=i)),Jm+=c*(On+(On=o)),sh(Sn,Cn,On)}function Fhe(e){ah=Wm=Gm=Ym=Vm=Xm=Km=Jm=0,OA=new La,FA=new La,kA=new La,EA(e,oi);var t=+OA,n=+FA,r=+kA,i=xA(t,n,r);return i<JR&&(t=Xm,n=Km,r=Jm,Wm<Bm&&(t=Gm,n=Ym,r=Vm),i=xA(t,n,r),i<JR)?[NaN,NaN]:[zm(n,t)*rh,wA(r/i)*rh]}function uh(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Zm(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ru(){}var lh=.7,Qm=1/lh,Yl="\\s*([+-]?\\d+)\\s*",ch="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Gi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",khe=/^#([0-9a-f]{3,8})$/,Dhe=new RegExp("^rgb\\("+[Yl,Yl,Yl]+"\\)$"),Mhe=new RegExp("^rgb\\("+[Gi,Gi,Gi]+"\\)$"),The=new RegExp("^rgba\\("+[Yl,Yl,Yl,ch]+"\\)$"),Nhe=new RegExp("^rgba\\("+[Gi,Gi,Gi,ch]+"\\)$"),Rhe=new RegExp("^hsl\\("+[ch,Gi,Gi]+"\\)$"),jhe=new RegExp("^hsla\\("+[ch,Gi,Gi,ch]+"\\)$"),w9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};uh(ru,MA,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:_9,formatHex:_9,formatHsl:Lhe,formatRgb:E9,toString:E9});function _9(){return this.rgb().formatHex()}function Lhe(){return F9(this).formatHsl()}function E9(){return this.rgb().formatRgb()}function MA(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=khe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?A9(t):n===3?new Fn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?e1(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?e1(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Dhe.exec(e))?new Fn(t[1],t[2],t[3],1):(t=Mhe.exec(e))?new Fn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=The.exec(e))?e1(t[1],t[2],t[3],t[4]):(t=Nhe.exec(e))?e1(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Rhe.exec(e))?O9(t[1],t[2]/100,t[3]/100,1):(t=jhe.exec(e))?O9(t[1],t[2]/100,t[3]/100,t[4]):w9.hasOwnProperty(e)?A9(w9[e]):e==="transparent"?new Fn(NaN,NaN,NaN,0):null}function A9(e){return new Fn(e>>16&255,e>>8&255,e&255,1)}function e1(e,t,n,r){return r<=0&&(e=t=n=NaN),new Fn(e,t,n,r)}function $9(e){return e instanceof ru||(e=MA(e)),e?(e=e.rgb(),new Fn(e.r,e.g,e.b,e.opacity)):new Fn}function TA(e,t,n,r){return arguments.length===1?$9(e):new Fn(e,t,n,r==null?1:r)}function Fn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}uh(Fn,TA,Zm(ru,{brighter:function(e){return e=e==null?Qm:Math.pow(Qm,e),new Fn(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?lh:Math.pow(lh,e),new Fn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:S9,formatHex:S9,formatRgb:C9,toString:C9}));function S9(){return"#"+NA(this.r)+NA(this.g)+NA(this.b)}function C9(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function NA(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function O9(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Yi(e,t,n,r)}function F9(e){if(e instanceof Yi)return new Yi(e.h,e.s,e.l,e.opacity);if(e instanceof ru||(e=MA(e)),!e)return new Yi;if(e instanceof Yi)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Yi(a,s,u,e.opacity)}function k9(e,t,n,r){return arguments.length===1?F9(e):new Yi(e,t,n,r==null?1:r)}function Yi(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}uh(Yi,k9,Zm(ru,{brighter:function(e){return e=e==null?Qm:Math.pow(Qm,e),new Yi(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?lh:Math.pow(lh,e),new Yi(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Fn(RA(e>=240?e-240:e+120,i,r),RA(e,i,r),RA(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function RA(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Phe=Math.PI/180,Ihe=180/Math.PI,t1=18,D9=.96422,M9=1,T9=.82521,N9=4/29,Vl=6/29,R9=3*Vl*Vl,Bhe=Vl*Vl*Vl;function j9(e){if(e instanceof Vi)return new Vi(e.l,e.a,e.b,e.opacity);if(e instanceof Io)return I9(e);e instanceof Fn||(e=$9(e));var t=IA(e.r),n=IA(e.g),r=IA(e.b),i=jA((.2225045*t+.7168786*n+.0606169*r)/M9),o,a;return t===n&&n===r?o=a=i:(o=jA((.4360747*t+.3850649*n+.1430804*r)/D9),a=jA((.0139322*t+.0971045*n+.7141733*r)/T9)),new Vi(116*i-16,500*(o-i),200*(i-a),e.opacity)}function L9(e,t,n,r){return arguments.length===1?j9(e):new Vi(e,t,n,r==null?1:r)}function Vi(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}uh(Vi,L9,Zm(ru,{brighter:function(e){return new Vi(this.l+t1*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Vi(this.l-t1*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=D9*LA(t),e=M9*LA(e),n=T9*LA(n),new Fn(PA(3.1338561*t-1.6168667*e-.4906146*n),PA(-.9787684*t+1.9161415*e+.033454*n),PA(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function jA(e){return e>Bhe?Math.pow(e,1/3):e/R9+N9}function LA(e){return e>Vl?e*e*e:R9*(e-N9)}function PA(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function IA(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function zhe(e){if(e instanceof Io)return new Io(e.h,e.c,e.l,e.opacity);if(e instanceof Vi||(e=j9(e)),e.a===0&&e.b===0)return new Io(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Ihe;return new Io(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function P9(e,t,n,r){return arguments.length===1?zhe(e):new Io(e,t,n,r==null?1:r)}function Io(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function I9(e){if(isNaN(e.h))return new Vi(e.l,0,0,e.opacity);var t=e.h*Phe;return new Vi(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}uh(Io,P9,Zm(ru,{brighter:function(e){return new Io(this.h,this.c,this.l+t1*(e==null?1:e),this.opacity)},darker:function(e){return new Io(this.h,this.c,this.l-t1*(e==null?1:e),this.opacity)},rgb:function(){return I9(this).rgb()}}));function Uhe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function qhe(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=Hhe(e));function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=r(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:r,center:o,right:i}}function Hhe(e){return(t,n)=>Uhe(e(t),n)}const BA="intersect",B9="union",Whe="vlMulti",Ghe="vlPoint",z9="or",Yhe="and",Vhe="_vgsid_",Xhe="E",Khe="R",Jhe="R-E",Zhe="R-LE",Qhe="R-RE",n1="index:unit";function U9(e,t){for(var n=t.fields,r=t.values,i=n.length,o=0,a,s;o<i;++o)if(s=n[o],s.getter=Ln.getter||Ln(s.field),a=s.getter(e),sa(a)&&(a=Kt(a)),sa(r[o])&&(r[o]=Kt(r[o])),sa(r[o][0])&&(r[o]=r[o].map(Kt)),s.type===Xhe){if(Q(r[o])?r[o].indexOf(a)<0:a!==r[o])return!1}else if(s.type===Khe){if(!Ju(a,r[o]))return!1}else if(s.type===Qhe){if(!Ju(a,r[o],!0,!1))return!1}else if(s.type===Jhe){if(!Ju(a,r[o],!1,!1))return!1}else if(s.type===Zhe&&!Ju(a,r[o],!1,!0))return!1;return!0}function e0e(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],o=r?r[n1]&&r[n1].value:void 0,a=n===BA,s=i.length,u=0,l,c,f,d,h;u<s;++u)if(l=i[u],o&&a){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=U9(t,l),c[d]=h?-1:++f,h&&o.size===1)return!0;if(!h&&f===o.get(d).count)return!1}else if(h=U9(t,l),a^h)return h;return s&&a}const zA=Ln(Vhe),q9=qhe(zA),t0e=q9.left,n0e=q9.right;function r0e(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[n1]&&r[n1].value:void 0,a=n===BA,s=zA(t),u=t0e(i,s);if(u===i.length||zA(i[u])!==s)return!1;if(o&&a){if(o.size===1)return!0;if(n0e(i,s)-u<o.size)return!1}return!0}function i0e(e,t){return e.map(n=>ge({values:t.fields.map(r=>(r.getter||(r.getter=Ln(r.field)))(n.datum))},t))}function o0e(e,t,n,r){for(var i=this.context.data[e],o=i?i.values.value:[],a={},s={},u={},l,c,f,d,h,g,p,m,y,v=o.length,b=0,x,w;b<v;++b){for(l=o[b],d=l.unit,c=l.fields,f=l.values,x=0,w=c.length;x<w;++x)h=c[x],g=a[h.field]||(a[h.field]={}),p=g[d]||(g[d]=[]),u[h.field]=m=h.type.charAt(0),y=H9[m+"_union"],g[d]=y(p,oe(f[x]));n&&(p=s[d]||(s[d]=[]),p.push(oe(f).reduce((E,_,$)=>(E[c[$].field]=_,E),{})))}if(t=t||B9,Object.keys(a).forEach(E=>{a[E]=Object.keys(a[E]).map(_=>a[E][_]).reduce((_,$)=>_===void 0?$:H9[u[E]+"_"+t](_,$))}),o=Object.keys(s),n&&o.length){const E=r?Ghe:Whe;a[E]=t===B9?{[z9]:o.reduce((_,$)=>(_.push(...s[$]),_),[])}:{[Yhe]:o.map(_=>({[z9]:s[_]}))}}return a}var H9={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Kt(t[0]),r=Kt(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Kt(t[0]),r=Kt(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const a0e=":",s0e="@";function UA(e,t,n,r){t[0].type!==Zs&&I("First argument to selection functions must be a string literal.");const i=t[0].value,o=t.length>=2&&_e(t).value,a="unit",s=s0e+a,u=a0e+i;o===BA&&!ae(r,s)&&(r[s]=n.getData(i).indataRef(n,a)),ae(r,u)||(r[u]=n.getData(i).tuplesRef())}function W9(e){const t=this.context.data[e];return t?t.values.value:[]}function u0e(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function l0e(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(_r).insert(t)),1}function c0e(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const fh=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},f0e=fh("format"),G9=fh("timeFormat"),d0e=fh("utcFormat"),h0e=fh("timeParse"),g0e=fh("utcParse"),r1=new Date(2e3,0,1);function i1(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(r1.setYear(2e3),r1.setMonth(e),r1.setDate(t),G9.call(this,r1,n))}function p0e(e){return i1.call(this,e,1,"%B")}function m0e(e){return i1.call(this,e,1,"%b")}function y0e(e){return i1.call(this,0,2+e,"%A")}function v0e(e){return i1.call(this,0,2+e,"%a")}const b0e=":",x0e="@",qA="%",Y9="$";function HA(e,t,n,r){t[0].type!==Zs&&I("First argument to data functions must be a string literal.");const i=t[0].value,o=b0e+i;if(!ae(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(a){}}function w0e(e,t,n,r){t[0].type!==Zs&&I("First argument to indata must be a string literal."),t[1].type!==Zs&&I("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,a=x0e+o;ae(a,r)||(r[a]=n.getData(i).indataRef(n,o))}function Yn(e,t,n,r){if(t[0].type===Zs)V9(n,r,t[0].value);else for(e in n.scales)V9(n,r,e)}function V9(e,t,n){const r=qA+n;if(!ae(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}function Bo(e,t){let n;return me(e)?e:Fe(e)?(n=t.scales[e])&&n.value:void 0}function _0e(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=Yn,n._range=Yn,n._scale=Yn;const r=i=>"_["+(i.type===Zs?ne(qA+i.value):ne(qA)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function WA(e,t){return function(n,r,i){if(n){const o=Bo(n,(i||this).context);return o&&o.path[e](r)}else return t(r)}}const E0e=WA("area",mhe),A0e=WA("bounds",Ehe),$0e=WA("centroid",Fhe);function S0e(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function GA(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function C0e(){return GA(this.context.dataflow,"warn",arguments)}function O0e(){return GA(this.context.dataflow,"info",arguments)}function F0e(){return GA(this.context.dataflow,"debug",arguments)}function YA(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function VA(e){const t=TA(e),n=YA(t.r),r=YA(t.g),i=YA(t.b);return .2126*n+.7152*r+.0722*i}function k0e(e,t){const n=VA(e),r=VA(t),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function D0e(){const e=[].slice.call(arguments);return e.unshift({}),ge(...e)}function X9(e,t){return e===t||e!==e&&t!==t?!0:Q(e)?Q(t)&&e.length===t.length?M0e(e,t):!1:se(e)&&se(t)?K9(e,t):!1}function M0e(e,t){for(let n=0,r=e.length;n<r;++n)if(!X9(e[n],t[n]))return!1;return!0}function K9(e,t){for(const n in e)if(!X9(e[n],t[n]))return!1;return!0}function J9(e){return t=>K9(e,t)}function T0e(e,t,n,r,i,o){const a=this.context.dataflow,s=this.context.data[e],u=s.input,l=a.stamp();let c=s.changes,f,d;if(a._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(s.changes=c=a.changeset(),c.stamp=l,a.runAfter(()=>{s.modified=!0,a.pulse(u,c).run()},!0,1)),n&&(f=n===!0?_r:Q(n)||dg(n)?n:J9(n),c.remove(f)),t&&c.insert(t),r&&(f=J9(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in o)c.modify(i,d,o[d]);return 1}function N0e(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function R0e(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const Z9={};function j0e(e,t){const n=Z9[t]||(Z9[t]=Ln(t));return Q(e)?e.map(n):n(e)}function XA(e){return Q(e)||ArrayBuffer.isView(e)?e:null}function KA(e){return XA(e)||(Fe(e)?e:null)}function L0e(e,...t){return XA(e).join(...t)}function P0e(e,...t){return KA(e).indexOf(...t)}function I0e(e,...t){return KA(e).lastIndexOf(...t)}function B0e(e,...t){return KA(e).slice(...t)}function z0e(e,t,n){return me(n)&&I("Function argument passed to replace."),String(e).replace(t,n)}function U0e(e){return XA(e).slice().reverse()}function q0e(e,t,n){return H2(e||0,t||0,n||0)}function H0e(e,t){const n=Bo(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function W0e(e,t){const n=Bo(e,(t||this).context);return n?n.copy():void 0}function G0e(e,t){const n=Bo(e,(t||this).context);return n?n.domain():[]}function Y0e(e,t,n){const r=Bo(e,(n||this).context);return r?Q(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function V0e(e,t){const n=Bo(e,(t||this).context);return n&&n.range?n.range():[]}function X0e(e,t,n){const r=Bo(e,(n||this).context);return r?r(t):void 0}function K0e(e,t,n,r,i){e=Bo(e,(i||this).context);const o=jT(t,n);let a=e.domain(),s=a[0],u=_e(a),l=yn;return u-s?l=wT(e,s,u):e=(e.interpolator?Ne("sequential")().interpolator(e.interpolator()):Ne("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(a=e.ticks(+r||15),s!==a[0]&&a.unshift(s),u!==_e(a)&&a.push(u)),a.forEach(c=>o.stop(l(c),e(c))),o}function J0e(e,t,n){const r=Bo(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function Z0e(e){let t=null;return function(n){return n?Kf(n,t=t||xl(e)):e}}const Q9=e=>e.data;function e7(e,t){const n=W9.call(t,e);return n.root&&n.root.lookup||{}}function Q0e(e,t,n){const r=e7(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(Q9):void 0}function ege(e,t){const n=e7(e,this)[t];return n?n.ancestors().map(Q9):void 0}const t7=()=>typeof window!="undefined"&&window||null;function tge(){const e=t7();return e?e.screen:{}}function nge(){const e=t7();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function rge(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function ige(e,t,n){if(!e)return[];const[r,i]=e,o=new _t().set(r[0],r[1],i[0],i[1]),a=n||this.context.dataflow.scenegraph().root;return K6(a,o,oge(t))}function oge(e){let t=null;if(e){const n=oe(e.marktype),r=oe(e.markname);t=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return t}const dh={random(){return Ar()},cumulativeNormal:xg,cumulativeLogNormal:Zb,cumulativeUniform:nx,densityNormal:Yb,densityLogNormal:Jb,densityUniform:tx,quantileNormal:wg,quantileLogNormal:Qb,quantileUniform:rx,sampleNormal:bg,sampleLogNormal:Kb,sampleUniform:ex,isArray:Q,isBoolean:eb,isDate:sa,isDefined(e){return e!==void 0},isNumber:ua,isObject:se,isRegExp:lF,isString:Fe,isTuple:dg,isValid(e){return e!=null&&e===e},toBoolean:nb,toDate:rb,toNumber:Kt,toString:ib,indexof:P0e,join:L0e,lastindexof:I0e,replace:z0e,reverse:U0e,slice:B0e,flush:sF,lerp:cF,merge:D0e,pad:hF,peek:_e,pluck:j0e,span:nf,inrange:Ju,truncate:gF,rgb:TA,lab:L9,hcl:P9,hsl:k9,luminance:VA,contrast:k0e,sequence:dhe,format:f0e,utcFormat:d0e,utcParse:g0e,utcOffset:JF,utcSequence:ek,timeFormat:G9,timeParse:h0e,timeOffset:KF,timeSequence:QF,timeUnitSpecifier:IF,monthFormat:p0e,monthAbbrevFormat:m0e,dayFormat:y0e,dayAbbrevFormat:v0e,quarter:rF,utcquarter:iF,week:zF,utcweek:HF,dayofyear:BF,utcdayofyear:qF,warn:C0e,info:O0e,debug:F0e,extent:Ai,inScope:S0e,intersect:ige,clampRange:oF,pinchDistance:N0e,pinchAngle:R0e,screen:tge,containerSize:rge,windowSize:nge,bandspace:q0e,setdata:l0e,pathShape:Z0e,panLinear:Q3,panLog:eF,panPow:tF,panSymlog:nF,zoomLinear:Xv,zoomLog:Kv,zoomPow:Z0,zoomSymlog:Jv,encode:c0e,modify:T0e},age=["view","item","group","xy","x","y"],sge="event.vega.",n7="this.",JA={},r7={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${ne(Y9+e)}]`,functions:uge,constants:VR,visitors:JA},ZA=KR(r7);function uge(e){const t=XR(e);age.forEach(n=>t[n]=sge+n);for(const n in dh)t[n]=n7+n;return ge(t,_0e(e,dh,JA)),t}function mt(e,t,n){return arguments.length===1?dh[e]:(dh[e]=t,n&&(JA[e]=n),ZA&&(ZA.functions[e]=n7+e),this)}mt("bandwidth",H0e,Yn);mt("copy",W0e,Yn);mt("domain",G0e,Yn);mt("range",V0e,Yn);mt("invert",Y0e,Yn);mt("scale",X0e,Yn);mt("gradient",K0e,Yn);mt("geoArea",E0e,Yn);mt("geoBounds",A0e,Yn);mt("geoCentroid",$0e,Yn);mt("geoShape",J0e,Yn);mt("indata",u0e,w0e);mt("data",W9,HA);mt("treePath",Q0e,HA);mt("treeAncestors",ege,HA);mt("vlSelectionTest",e0e,UA);mt("vlSelectionIdTest",r0e,UA);mt("vlSelectionResolve",o0e,UA);mt("vlSelectionTuples",i0e);function Xi(e,t){const n={};let r;try{e=Fe(e)?e:ne(e)+"",r=YR(e)}catch(o){I("Expression parse error: "+e)}r.visit(o=>{if(o.type!==TR)return;const a=o.callee.name,s=r7.visitors[a];s&&s(a,o.arguments,t,n)});const i=ZA(r);return i.globals.forEach(o=>{const a=Y9+o;!ae(n,a)&&t.getSignal(o)&&(n[a]=t.signalRef(o))}),{$expr:ge({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function lge(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const cge=Yr(["rule"]),i7=Yr(["group","image","rect"]);function fge(e,t){let n="";return cge[t]||(e.x2&&(e.x?(i7[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(i7[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function QA(e){return(e+"").toLowerCase()}function dge(e){return QA(e)==="operator"}function hge(e){return QA(e)==="collect"}function hh(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function gge(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(r,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(r," : ")}var pge={operator:(e,t)=>hh(e,["_"],t.code),parameter:(e,t)=>hh(e,["datum","_"],t.code),event:(e,t)=>hh(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return hh(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const a="o["+ne(o)+"]";i+="$=".concat(r[o].code,";if(").concat(a,"!==$)").concat(a,"=$,m=1;")}return i+=fge(r,n),i+="return m;",hh(e,["item","_"],i)},codegen:{get(e){const t="[".concat(e.map(ne).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const r=(o,a)=>{const s=t[a];let u,l;return o.path?(u="a".concat(o.path),l="b".concat(o.path)):((n=n||{})["f"+a]=o,u="this.f".concat(a,"(a)"),l="this.f".concat(a,"(b)")),gge(u,l,-s,s)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function mge(e){const t=this;dge(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function yge(e){const t=this;if(e.params){const n=t.get(e.id);n||I("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function vge(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=Q(i)?i.map(o=>o7(o,n,t)):o7(i,n,t)}return t}function o7(e,t,n){if(!e||!se(e))return e;for(let r=0,i=a7.length,o;r<i;++r)if(o=a7[r],ae(e,o.key))return o.parse(e,t,n);return e}var a7=[{key:"$ref",parse:bge},{key:"$key",parse:wge},{key:"$expr",parse:xge},{key:"$field",parse:_ge},{key:"$encode",parse:Age},{key:"$compare",parse:Ege},{key:"$context",parse:$ge},{key:"$subflow",parse:Sge},{key:"$tupleid",parse:Cge}];function bge(e,t){return t.get(e.$ref)||I("Operator not defined: "+e.$ref)}function xge(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=jn(t.parameterExpression(e.$expr),e.$fields,e.$name))}function wge(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=tb(e.$key,e.$flat,t.expr.codegen))}function _ge(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Ln(e.$field,e.$name,t.expr.codegen))}function Ege(e,t){const n="c:"+e.$compare+"_"+e.$order,r=oe(e.$compare).map(i=>i&&i.$tupleid?ee:i);return t.fn[n]||(t.fn[n]=Zv(r,e.$order,t.expr.codegen))}function Age(e,t){const n=e.$encode,r={};for(const i in n){const o=n[i];r[i]=jn(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}function $ge(e,t){return t}function Sge(e,t){const n=e.$subflow;return function(r,i,o){const a=t.fork().parse(n),s=a.get(n.operators[0].id),u=a.signals.parent;return u&&u.set(o),s.detachSubflow=()=>t.detach(a),s}}function Cge(){return ee}function Oge(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(o=>t.get(o)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(o=>t.get(o)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&I("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function Fge(e){var t=this,n=se(n=e.source)?n.$ref:n,r=t.get(n),i=null,o=e.update,a=void 0;r||I("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(a=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,r,i,o,a)}const kge={skip:!0};function Dge(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(o=>{const a=t.signals[o];e.signals(o,a)&&(r[o]=a.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(o=>{const a=t.data[o];e.data(o,a)&&(i[o]=a.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function Mge(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(o=>{n.update(t.signals[o],i[o],kge)}),Object.keys(r||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(_r).insert(r[o]))}),(e.subcontext||[]).forEach((o,a)=>{const s=t.subcontext[a];s&&s.setState(o)})}function s7(e,t,n,r){return new u7(e,t,n,r)}function u7(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||pge,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function l7(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}u7.prototype=l7.prototype={fork(){const e=new l7(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),hge(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(r.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),r.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const a=n.data[o]||(n.data[o]={});e.data[o].forEach(s=>a[s]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[QA(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:lge,parseOperator:mge,parseOperatorParameters:yge,parseParameters:vge,parseStream:Oge,parseUpdate:Fge,getState:Dge,setState:Mge};var Xl=0,gh=0,ph=0,c7=1e3,o1,mh,a1=0,iu=0,s1=0,yh=typeof performance=="object"&&performance.now?performance:Date,f7=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function e$(){return iu||(f7(Tge),iu=yh.now()+s1)}function Tge(){iu=0}function t$(){this._call=this._time=this._next=null}t$.prototype={constructor:t$,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?e$():+n)+(t==null?0:+t),!this._next&&mh!==this&&(mh?mh._next=this:o1=this,mh=this),this._call=e,this._time=n,n$()},stop:function(){this._call&&(this._call=null,this._time=1/0,n$())}};function Nge(){e$(),++Xl;for(var e=o1,t;e;)(t=iu-e._time)>=0&&e._call.call(null,t),e=e._next;--Xl}function d7(){iu=(a1=yh.now())+s1,Xl=gh=0;try{Nge()}finally{Xl=0,jge(),iu=0}}function Rge(){var e=yh.now(),t=e-a1;t>c7&&(s1-=t,a1=e)}function jge(){for(var e,t=o1,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:o1=n);mh=e,n$(r)}function n$(e){if(!Xl){gh&&(gh=clearTimeout(gh));var t=e-iu;t>24?(e<1/0&&(gh=setTimeout(d7,e-yh.now()-s1)),ph&&(ph=clearInterval(ph))):(ph||(a1=yh.now(),ph=setInterval(Rge,c7)),Xl=1,f7(d7))}}function Lge(e,t,n){var r=new t$,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(o,a,s){a=+a,s=s==null?e$():+s,r._restart(function u(l){l+=i,r._restart(u,i+=a,s),o(l)},a,s)},r.restart(e,t,n),r)}function Pge(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),h7(t,e.description()))}function h7(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Ige(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const r$="default";function Bge(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:r$,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,o=i?Fe(i)?i:i.user:r$,a=r.item&&r.item.cursor||null;return i&&o===i.user&&a==i.item?i:{user:o,item:a}}),e.add(null,function(n){let r=n.cursor,i=this.value;return Fe(r)||(i=r.item,r=r.user),i$(e,r&&r!==r$?r:i||r),i},{cursor:t})}function i$(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function u1(e,t){var n=e._runtime.data;return ae(n,t)||I("Unrecognized data set: "+t),n[t]}function zge(e,t){return arguments.length<2?u1(this,e).values.value:l1.call(this,e,As().remove(_r).insert(t))}function l1(e,t){Xk(t)||I("Second argument to changes must be a changeset.");const n=u1(this,e);return n.modified=!0,this.pulse(n.input,t)}function Uge(e,t){return l1.call(this,e,As().insert(t))}function qge(e,t){return l1.call(this,e,As().remove(t))}function g7(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function p7(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function c1(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Hge(e){var t=c1(e),n=g7(e),r=p7(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(o){e.error(o)}})}function Wge(e,t,n){var r=e._renderer,i=r&&r.canvas(),o,a,s;return i&&(s=c1(e),a=t.changedTouches?t.changedTouches[0]:t,o=xp(a,i),o[0]-=s[0],o[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=Gge(e,n,o),t}function Gge(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(a){var s=r,u;if(a){for(u=t;u;u=u.mark.group)if(u.mark.name===a){s=u;break}}return s&&s.mark&&s.mark.interactive?s:{}}function o(a){if(!a)return n;Fe(a)&&(a=i(a));const s=n.slice();for(;a;)s[0]-=a.x||0,s[1]-=a.y||0,a=a.mark&&a.mark.group;return s}return{view:Jt(e),item:Jt(t||{}),group:i,xy:o,x:a=>o(a)[0],y:a=>o(a)[1]}}const m7="view",Yge="timer",Vge="window",Xge={trap:!1};function Kge(e){const t=ge({defaults:{}},e),n=(r,i)=>{i.forEach(o=>{Q(r[o])&&(r[o]=Yr(r[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function y7(e,t,n,r){e._eventListeners.push({type:n,sources:oe(t),handler:r})}function Jge(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function f1(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||se(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Zge(e,t,n){var r=this,i=new mg(n),o=function(l,c){r.runAsync(null,()=>{e===m7&&Jge(r,t)&&l.preventDefault(),i.receive(Wge(r,l,c))})},a;if(e===Yge)f1(r,"timer",t)&&r.timer(o,t);else if(e===m7)f1(r,"view",t)&&r.addEventListener(t,o,Xge);else if(e===Vge?f1(r,"window",t)&&typeof window!="undefined"&&(a=[window]):typeof document!="undefined"&&f1(r,"selector",t)&&(a=document.querySelectorAll(e)),!a)r.warn("Can not resolve event source: "+e);else{for(var s=0,u=a.length;s<u;++s)a[s].addEventListener(t,o);y7(r,a,t,o)}return i}function v7(e){return e.item}function b7(e){return e.item.mark.source}function x7(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Qge(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",v7),b7,x7(e)),this.on(this.events("view","mouseout",v7),b7,x7(t)),this}function epe(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,o;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(o=n[r],i=o.sources.length;--i>=0;)o.sources[i].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this}function pr(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const tpe="vega-bind",npe="vega-bind-name",rpe="vega-bind-radio";function ipe(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:a=>{a!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,a)})}},r.debounce&&(i.update=Qv(r.debounce,i.update))),(r.input==null&&r.element?ope:spe)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function ope(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),y7(r,t,i,o),e.set=a=>{t.value=a,t.dispatchEvent(ape(i))}}function ape(e){return typeof Event!="undefined"?new Event(e):{type:e}}function spe(e,t,n,r){const i=r.signal(n.signal),o=pr("div",{class:tpe}),a=n.input==="radio"?o:o.appendChild(pr("label"));a.appendChild(pr("span",{class:npe},n.name||n.signal)),t.appendChild(o);let s=upe;switch(n.input){case"checkbox":s=lpe;break;case"select":s=cpe;break;case"radio":s=fpe;break;case"range":s=dpe;break}s(e,a,n,i)}function upe(e,t,n,r){const i=pr("input");for(const o in n)o!=="signal"&&o!=="element"&&i.setAttribute(o==="input"?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=o=>i.value=o}function lpe(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=pr("input",i);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=a=>o.checked=!!a||null}function cpe(e,t,n,r){const i=pr("select",{name:n.signal}),o=n.labels||[];n.options.forEach((a,s)=>{const u={value:a};d1(a,r)&&(u.selected=!0),i.appendChild(pr("option",u,(o[s]||a)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=a=>{for(let s=0,u=n.options.length;s<u;++s)if(d1(n.options[s],a)){i.selectedIndex=s;return}}}function fpe(e,t,n,r){const i=pr("span",{class:rpe}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map((a,s)=>{const u={type:"radio",name:n.signal,value:a};d1(a,r)&&(u.checked=!0);const l=pr("input",u);l.addEventListener("change",()=>e.update(a));const c=pr("label",{},(o[s]||a)+"");return c.prepend(l),i.appendChild(c),l}),e.set=a=>{const s=e.elements,u=s.length;for(let l=0;l<u;++l)d1(s[l].value,a)&&(s[l].checked=!0)}}function dpe(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||ide(o,i,100),s=pr("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const u=pr("span",{},+r);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=c=>{s.value=c,u.textContent=c}}function d1(e,t){return e===t||e+""==t+""}function w7(e,t,n,r,i,o){return t=t||new r(e.loader()),t.initialize(n,g7(e),p7(e),c1(e),i,o).background(e.background())}function o$(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function hpe(e,t,n,r){const i=new r(e.loader(),o$(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,c1(e),e);return t&&t.handlers().forEach(o=>{i.on(o.type,o.handler)}),i}function gpe(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=Fp(r);e=n._el=e?a$(n,e,!0):null,Pge(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||cd,s=e?o.renderer:o.headless;return n._renderer=s?w7(n,n._renderer,e,s):null,n._handler=hpe(n,n._handler,e,a),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=a$(n,t,!0):e.appendChild(pr("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=a$(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{ipe(n,u.element||t,u)})),n}function a$(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const vh=e=>+e||0,ppe=e=>({top:e,bottom:e,left:e,right:e});function _7(e){return se(e)?{top:vh(e.top),bottom:vh(e.bottom),left:vh(e.left),right:vh(e.right)}:ppe(vh(e))}async function s$(e,t,n,r){const i=Fp(t),o=i&&i.headless;return o||I("Unrecognized renderer type: "+t),await e.runAsync(),w7(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}async function mpe(e,t){e!==Oa.Canvas&&e!==Oa.SVG&&e!==Oa.PNG&&I("Unrecognized image type: "+e);const n=await s$(this,e,t);return e===Oa.SVG?ype(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function ype(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function vpe(e,t){return(await s$(this,Oa.Canvas,e,t)).canvas()}async function bpe(e){return(await s$(this,Oa.SVG,e)).svg()}function xpe(e,t,n){return s7(e,ol,dh,n).parse(t)}function wpe(e){var t=this._runtime.scales;return ae(t,e)||I("Unrecognized scale or projection: "+e),t[e].value}var E7="width",A7="height",u$="padding",$7={skip:!0};function S7(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===u$?r.left+r.right:0)}function C7(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===u$?r.top+r.bottom:0)}function _pe(e){var t=e._signals,n=t[E7],r=t[A7],i=t[u$];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,s=>{e._width=s.size,e._viewWidth=S7(e,s.size),o()},{size:n}),e._resizeHeight=e.add(null,s=>{e._height=s.size,e._viewHeight=C7(e,s.size),o()},{size:r});const a=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}function Epe(e,t,n,r,i,o){this.runAfter(a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(E7,n,$7),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal(A7,r,$7),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),(a._origin[0]!==i[0]||a._origin[1]!==i[1])&&(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter(u=>u.resize())},!1,1)}function Ape(e){return this._runtime.getState(e||{data:$pe,signals:Spe,recurse:!0})}function $pe(e,t){return t.modified&&Q(t.input.value)&&e.indexOf("_:vega:_")}function Spe(e,t){return!(e==="parent"||t instanceof ol.proxy)}function Cpe(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Ope(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(Lge(n,t))}function Fpe(e,t,n,r){const i=e.element();i&&i.setAttribute("title",kpe(r))}function kpe(e){return e==null?"":Q(e)?O7(e):se(e)&&!sa(e)?Dpe(e):e+""}function Dpe(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(Q(n)?O7(n):F7(n))}).join(`
`)}function O7(e){return"["+e.map(F7).join(", ")+"]"}function F7(e){return Q(e)?"[\u2026]":se(e)&&!sa(e)?"{\u2026}":e}function k7(e,t){const n=this;if(t=t||{},il.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=ge({},e.locale,t.locale);n.locale(Lk(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Oa.Canvas,n._scenegraph=new Nw;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Fpe,n._redraw=!0,n._handler=new cd().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Kge(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=xpe(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:ge({},o)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=S7(n,n._width),n._viewHeight=C7(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,_pe(n),Ige(n),Bge(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function h1(e,t){return ae(e._signals,t)?e._signals[t]:I("Unrecognized signal name: "+ne(t))}function D7(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function M7(e,t,n,r){let i=D7(n,r);return i||(i=o$(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function T7(e,t,n){const r=D7(t,n);return r&&t._targets.remove(r),e}q(k7,il,{async evaluate(e,t,n){if(await il.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Hge(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&fg(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&h7(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=h1(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",_7(e)):_7(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Fp(e)||I("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(il.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(h1(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Epe,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=o$(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,o;--r>=0;)if(o=n[r].type,i=n[r].handler,e===o&&(t===i||t===i.raw)){this._handler.off(o,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return M7(this,e,h1(this,e),t)},removeSignalListener(e,t){return T7(this,h1(this,e),t)},addDataListener(e,t){return M7(this,e,u1(this,e).values,t)},removeDataListener(e,t){return T7(this,u1(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=i$(this,null);this._globalCursor=!!e,t&&i$(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Ope,events:Zge,finalize:epe,hover:Qge,data:zge,change:l1,insert:Uge,remove:qge,scale:wpe,initialize:gpe,toImageURL:mpe,toCanvas:vpe,toSVG:bpe,getState:Ape,setState:Cpe});const Mpe="view",g1="[",p1="]",N7="{",R7="}",Tpe=":",j7=",",Npe="@",Rpe=">",jpe=/[[\]{}]/,Lpe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let L7,P7;function I7(e,t,n){return L7=t||Mpe,P7=n||Lpe,B7(e.trim()).map(l$)}function Ppe(e){return P7[e]}function bh(e,t,n,r,i){const o=e.length;let a=0,s;for(;t<o;++t){if(s=e[t],!a&&s===n)return t;i&&i.indexOf(s)>=0?--a:r&&r.indexOf(s)>=0&&++a}return t}function B7(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=bh(e,i,j7,g1+N7,p1+R7),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function l$(e){return e[0]==="["?Ipe(e):Bpe(e)}function Ipe(e){const t=e.length;let n=1,r;if(n=bh(e,n,p1,g1,p1),n===t)throw"Empty between selector: "+e;if(r=B7(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Rpe)throw"Expected '>' after between selector: "+e;r=r.map(l$);const i=l$(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function Bpe(e){const t={source:L7},n=[];let r=[0,0],i=0,o=0,a=e.length,s=0,u,l;if(e[a-1]===R7){if(s=e.lastIndexOf(N7),s>=0){try{r=zpe(e.substring(s+1,a-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),a=e.length}else throw"Unmatched right brace: "+e;s=0}if(!a)throw e;if(e[0]===Npe&&(i=++s),u=bh(e,s,Tpe),u<a&&(n.push(e.substring(o,u).trim()),o=s=++u),s=bh(e,s,g1),s===a)n.push(e.substring(o,a).trim());else if(n.push(e.substring(o,s).trim()),l=[],o=++s,o===a)throw"Unmatched left bracket: "+e;for(;s<a;){if(s=bh(e,s,p1),s===a)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,s).trim()),s<a-1&&e[++s]!==g1)throw"Expected left bracket: "+e;o=++s}if(!(a=n.length)||jpe.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],i?t.markname=n[0].slice(1):Ppe(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function zpe(e){const t=e.split(j7);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function Upe(e){return se(e)?e:{type:e||"pad"}}const xh=e=>+e||0,qpe=e=>({top:e,bottom:e,left:e,right:e});function Hpe(e){return se(e)?e.signal?e:{top:xh(e.top),bottom:xh(e.bottom),left:xh(e.left),right:xh(e.right)}:qpe(xh(e))}const Rt=e=>se(e)&&!Q(e)?ge({},e):{value:e};function z7(e,t,n,r){return n!=null?(se(n)&&!Q(n)||Q(n)&&n.length&&se(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Wt(e,t,n){for(const r in t)z7(e,r,t[r]);for(const r in n)z7(e,r,n[r],"update")}function Kl(e,t,n){for(const r in t)n&&ae(n,r)||(e[r]=ge(e[r]||{},t[r]));return e}function Jl(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const c$="mark",f$="frame",d$="scope",Wpe="axis",Gpe="axis-domain",Ype="axis-grid",Vpe="axis-label",Xpe="axis-tick",Kpe="axis-title",Jpe="legend",Zpe="legend-band",Qpe="legend-entry",eme="legend-gradient",U7="legend-label",tme="legend-symbol",nme="legend-title",rme="title",ime="title-text",ome="title-subtitle";function ame(e,t,n,r,i){const o={},a={};let s,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!Jl(u,e)&&h$(o,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===f$?i.group:n===c$?ge({},i.mark,i[t]):null;for(u in c)l=Jl(u,e)||(u==="fill"||u==="stroke")&&(Jl("fill",e)||Jl("stroke",e)),l||h$(o,u,c[u]);oe(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)Jl(h,e)||h$(o,h,d[h])}),e=ge({},e);for(u in o)c=o[u],c.signal?(s=s||{})[u]=c:a[u]=c;return e.enter=ge(a,e.enter),s&&(e.update=ge(s,e.update)),e}function h$(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const q7=e=>Fe(e)?ne(e):e.signal?`(${e.signal})`:H7(e);function m1(e){if(e.gradient!=null)return ume(e);let t=e.signal?`(${e.signal})`:e.color?sme(e.color):e.field!=null?H7(e.field):e.value!==void 0?ne(e.value):void 0;return e.scale!=null&&(t=lme(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${v1(e.exponent)})`),e.mult!=null&&(t+=`*${v1(e.mult)}`),e.offset!=null&&(t+=`+${v1(e.offset)}`),e.round&&(t=`round(${t})`),t}const y1=(e,t,n,r)=>`(${e}(${[t,n,r].map(m1).join(",")})+'')`;function sme(e){return e.c?y1("hcl",e.h,e.c,e.l):e.h||e.s?y1("hsl",e.h,e.s,e.l):e.l||e.a?y1("lab",e.l,e.a,e.b):e.r||e.g||e.b?y1("rgb",e.r,e.g,e.b):null}function ume(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:ne(n));for(;t.length&&_e(t)==null;)t.pop();return t.unshift(q7(e.gradient)),`gradient(${t.join(",")})`}function v1(e){return se(e)?"("+m1(e)+")":e}function H7(e){return W7(se(e)?e:{datum:e})}function W7(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):I("Invalid field reference: "+ne(e));return e.signal||(r=Fe(r)?Y0(r).map(ne).join("]["):W7(r)),t+"["+r+"]"}function lme(e,t){const n=q7(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+v1(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function cme(e){let t="";return e.forEach(n=>{const r=m1(n);t+=n.test?`(${n.test})?${r}:`:r}),_e(t)===":"&&(t+="null"),t}function G7(e,t,n,r,i,o){const a={};o=o||{},o.encoders={$encode:a},e=ame(e,t,n,r,i.config);for(const s in e)a[s]=fme(e[s],t,o,i);return o}function fme(e,t,n,r){const i={},o={};for(const a in e)e[a]!=null&&(i[a]=hme(dme(e[a]),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function dme(e){return Q(e)?cme(e):m1(e)}function hme(e,t,n,r){const i=Xi(e,t);return i.$fields.forEach(o=>r[o]=1),ge(n,i.$params),i.$expr}const gme="outer",pme=["value","update","init","react","bind"];function Y7(e,t){I(e+' for "outer" push: '+ne(t))}function V7(e,t){const n=e.name;if(e.push===gme)t.signals[n]||Y7("No prior signal definition",n),pme.forEach(r=>{e[r]!==void 0&&Y7("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function g$(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function b1(e,t,n,r){return new g$(e,t,n,r)}function x1(e,t){return b1("operator",e,t)}function te(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function wh(e,t){return t?{$field:e,$name:t}:{$field:e}}const p$=wh("key");function X7(e,t){return{$compare:e,$order:t}}function mme(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const yme="ascending",vme="descending";function bme(e){return se(e)?(e.order===vme?"-":"+")+w1(e.op,e.field):""}function w1(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const m$="scope",y$="view";function At(e){return e&&e.signal}function xme(e){return e&&e.expr}function _1(e){if(At(e))return!0;if(se(e)){for(const t in e)if(_1(e[t]))return!0}return!1}function ai(e,t){return e!=null?e:t}function ou(e){return e&&e.signal||e}const K7="timer";function _h(e,t){return(e.merge?_me:e.stream?Eme:e.type?Ame:I("Invalid stream specification: "+ne(e)))(e,t)}function wme(e){return e===m$?y$:e||y$}function _me(e,t){const n=e.merge.map(i=>_h(i,t)),r=v$({merge:n},e,t);return t.addStream(r).id}function Eme(e,t){const n=_h(e.stream,t),r=v$({stream:n},e,t);return t.addStream(r).id}function Ame(e,t){let n;e.type===K7?(n=t.event(K7,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(wme(e.source),e.type);const r=v$({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function v$(e,t,n){let r=t.between;return r&&(r.length!==2&&I('Stream "between" parameter must have 2 entries: '+ne(t)),e.between=[_h(r[0],n),_h(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push($me(t.marktype,t.markname,t.markrole)),t.source===m$&&r.push("inScope(event.item)"),r.length&&(e.filter=Xi("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function $me(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const Sme={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Cme(e,t,n){const r=e.encode,i={target:n};let o=e.events,a=e.update,s=[];o||I("Signal update missing events specification."),Fe(o)&&(o=I7(o,t.isSubscope()?m$:y$)),o=oe(o).filter(u=>u.signal||u.scale?(s.push(u),0):1),s.length>1&&(s=[Fme(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),r!=null&&(a&&I("Signal encode and update are mutually exclusive."),a="encode(item(),"+ne(r)+")"),i.update=Fe(a)?Xi(a,t):a.expr!=null?Xi(a.expr,t):a.value!=null?a.value:a.signal!=null?{$expr:Sme,$params:{$value:t.signalRef(a.signal)}}:I("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach(u=>t.addUpdate(ge(Ome(u,t),i)))}function Ome(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):_h(e,t)}}function Fme(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function kme(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?I("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=Xi(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>Cme(i,t,n.id))}const He=e=>(t,n,r)=>b1(e,n,t||void 0,r),J7=He("aggregate"),Dme=He("axisticks"),Z7=He("bound"),si=He("collect"),Q7=He("compare"),Mme=He("datajoin"),ej=He("encode"),Tme=He("expression"),Nme=He("facet"),Rme=He("field"),jme=He("key"),Lme=He("legendentries"),Pme=He("load"),Ime=He("mark"),Bme=He("multiextent"),zme=He("multivalues"),Ume=He("overlap"),qme=He("params"),tj=He("prefacet"),Hme=He("projection"),Wme=He("proxy"),Gme=He("relay"),nj=He("render"),Yme=He("scale"),au=He("sieve"),Vme=He("sortitems"),rj=He("viewlayout"),Xme=He("values");let Kme=0;const ij={min:"min",max:"max",count:"sum"};function Jme(e,t){const n=e.type||"linear";pT(n)||I("Unrecognized scale type: "+ne(n)),t.addScale(e.name,{type:n,domain:void 0})}function Zme(e,t){const n=t.getScale(e.name).params;let r;n.domain=oj(e.domain,e,t),e.range!=null&&(n.range=sj(e,t,n)),e.interpolate!=null&&u1e(e.interpolate,n),e.nice!=null&&(n.nice=s1e(e.nice)),e.bins!=null&&(n.bins=a1e(e.bins,t));for(r in e)ae(n,r)||r==="name"||(n[r]=Mr(e[r],t))}function Mr(e,t){return se(e)?e.signal?t.signalRef(e.signal):I("Unsupported object: "+ne(e)):e}function E1(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Mr(n,t))}function A1(e){I("Can not find data set: "+ne(e))}function oj(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&I("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(Q(e)?Qme:e.fields?t1e:e1e)(e,t,n)}function Qme(e,t,n){return e.map(r=>Mr(r,n))}function e1e(e,t,n){const r=n.getData(e.data);return r||A1(e.data),bl(t.type)?r.valuesRef(n,e.field,aj(e.sort,!1)):vT(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function t1e(e,t,n){const r=e.data,i=e.fields.reduce((o,a)=>(a=Fe(a)?{data:r,field:a}:Q(a)||a.signal?n1e(a,n):a,o.push(a),o),[]);return(bl(t.type)?r1e:vT(t.type)?i1e:o1e)(e,n,i)}function n1e(e,t){const n="_:vega:_"+Kme++,r=si({});if(Q(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+ne(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,au({})]),{data:n,field:"data"}}function r1e(e,t,n){const r=aj(e.sort,!0);let i,o;const a=n.map(l=>{const c=t.getData(l.data);return c||A1(l.data),c.countsRef(t,l.field,r)}),s={groupby:p$,pulse:a};r&&(i=r.op||"count",o=r.field?w1(i,r.field):"count",s.ops=[ij[i]],s.fields=[t.fieldRef(o)],s.as=[o]),i=t.add(J7(s));const u=t.add(si({pulse:te(i)}));return o=t.add(Xme({field:p$,sort:t.sortRef(r),pulse:te(u)})),te(o)}function aj(e,t){return e&&(!e.field&&!e.op?se(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?I("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!ij[e.op]&&I("Multiple domain scales can not be sorted using "+e.op)),e}function i1e(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||A1(i.data),o.domainRef(t,i.field)});return te(t.add(zme({values:r})))}function o1e(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||A1(i.data),o.extentRef(t,i.field)});return te(t.add(Bme({extents:r})))}function a1e(e,t){return e.signal||Q(e)?E1(e,t):t.objectProperty(e)}function s1e(e){return se(e)?{interval:Mr(e.interval),step:Mr(e.step)}:Mr(e)}function u1e(e,t){t.interpolate=Mr(e.type||e),e.gamma!=null&&(t.interpolateGamma=Mr(e.gamma))}function sj(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Fe(i)){if(r&&ae(r,i))return e=ge({},e,{range:r[i]}),sj(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=bl(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:I("Unrecognized scale range value: "+ne(i))}else if(i.scheme){n.scheme=Q(i.scheme)?E1(i.scheme,t):Mr(i.scheme,t),i.extent&&(n.schemeExtent=E1(i.extent,t)),i.count&&(n.schemeCount=Mr(i.count,t));return}else if(i.step){n.rangeStep=Mr(i.step,t);return}else{if(bl(e.type)&&!Q(i))return oj(i,e,t);Q(i)||I("Unsupported range type: "+ne(i))}return i.map(o=>(Q(o)?E1:Mr)(o,t))}function l1e(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=b$(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=b$(n[i],i,t));t.addProjection(e.name,r)}function b$(e,t,n){return Q(e)?e.map(r=>b$(r,t,n)):se(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:I("Unsupported parameter object: "+ne(e)):e}const ui="top",Zl="left",Ql="right",Ia="bottom",uj="center",c1e="vertical",f1e="start",d1e="middle",h1e="end",x$="index",w$="label",g1e="offset",ec="perc",p1e="perc2",Tr="value",Eh="guide-label",_$="guide-title",m1e="group-title",y1e="group-subtitle",lj="symbol",$1="gradient",E$="discrete",A$="size",v1e="shape",b1e="fill",x1e="stroke",w1e="strokeWidth",_1e="strokeDash",E1e="opacity",$$=[A$,v1e,b1e,x1e,w1e,_1e,E1e],Ah={name:1,style:1,interactive:1},Ce={value:0},Nr={value:1},S1="group",cj="rect",S$="rule",A1e="symbol",su="text";function $h(e){return e.type=S1,e.interactive=e.interactive||!1,e}function Vn(e,t){const n=(r,i)=>ai(e[r],ai(t[r],i));return n.isVertical=r=>c1e===ai(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>ai(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>ai(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>ai(e.columns,ai(t.columns,+n.isVertical(!0))),n}function fj(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function $1e(e,t,n){const r=t.config.style[n];return r&&r[e]}function C1(e,t,n){return`item.anchor === '${f1e}' ? ${e} : item.anchor === '${h1e}' ? ${t} : ${n}`}const C$=C1(ne(Zl),ne(Ql),ne(uj));function S1e(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},se(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function dj(e,t){return t?e?se(e)?Object.assign({},e,{offset:dj(e.offset,t)}):{value:e,offset:t}:t:e}function mr(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Kl(e.encode,t,Ah)):e.interactive=!1,e}function C1e(e,t,n,r){const i=Vn(e,n),o=i.isVertical(),a=i.gradientThickness(),s=i.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=a,d=s):(l=[0,0],c=[1,0],f=s,d=a);const h={enter:u={opacity:Ce,x:Ce,y:Ce,width:Rt(f),height:Rt(d)},update:ge({},u,{opacity:Nr,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Ce}};return Wt(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),mr({type:cj,role:eme,encode:h},r)}function O1e(e,t,n,r,i){const o=Vn(e,n),a=o.isVertical(),s=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";a?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const g={opacity:Ce,fill:{scale:t,field:Tr}};g[l]={signal:h+"datum."+ec,mult:u},g[c]=Ce,g[f]={signal:h+"datum."+p1e,mult:u},g[d]=Rt(s);const p={enter:g,update:ge({},g,{opacity:Nr}),exit:{opacity:Ce}};return Wt(p,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),mr({type:cj,role:Zpe,key:Tr,from:i,encode:p},r)}const F1e=`datum.${ec}<=0?"${Zl}":datum.${ec}>=1?"${Ql}":"${uj}"`,k1e=`datum.${ec}<=0?"${Ia}":datum.${ec}>=1?"${ui}":"${d1e}"`;function hj(e,t,n,r){const i=Vn(e,t),o=i.isVertical(),a=Rt(i.gradientThickness()),s=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const g={enter:l={opacity:Ce},update:c={opacity:Nr,text:{field:w$}},exit:{opacity:Ce}};return Wt(g,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:ai(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:k1e},f="y",d="x",h="1-"):(l.align=c.align={signal:F1e},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+ec,mult:s},l[d]=c[d]=a,a.offset=ai(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+x$}:void 0,mr({type:su,role:U7,style:Eh,key:Tr,from:r,encode:g,overlap:u},n)}function D1e(e,t,n,r,i){const o=Vn(e,t),a=n.entries,s=!!(a&&a.interactive),u=a?a.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${g1e} : datum.${A$}`,h=l?Rt(l):{field:A$},g=`datum.${x$}`,p=`max(1, ${i})`;let m,y,v,b,x;h.mult=.5,m={enter:y={opacity:Ce,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Nr,x:y.x,y:y.y},exit:{opacity:Ce}};let w=null,E=null;e.fill||(w=t.symbolBaseFillColor,E=t.symbolBaseStrokeColor),Wt(m,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",E),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),$$.forEach(O=>{e[O]&&(v[O]=y[O]={scale:e[O],field:Tr})});const _=mr({type:A1e,role:tme,key:Tr,from:f,clip:l?!0:void 0,encode:m},n.symbols),$=Rt(c);$.offset=o("labelOffset"),m={enter:y={opacity:Ce,x:{signal:d,offset:$},y:h},update:v={opacity:Nr,text:{field:w$},x:y.x,y:y.y},exit:{opacity:Ce}},Wt(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const C=mr({type:su,role:U7,style:Eh,key:Tr,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:Ce,height:l?Rt(l):Ce,opacity:Ce},exit:{opacity:Ce},update:v={opacity:Nr,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b=`ceil(item.mark.items.length / ${p})`,v.row.signal=`${g}%${b}`,v.column.signal=`floor(${g} / ${b})`,x={field:["row",g]}):(v.row.signal=`floor(${g} / ${p})`,v.column.signal=`${g} % ${p}`,x={field:g}),v.column.signal=`(${i})?${v.column.signal}:${g}`,r={facet:{data:r,name:"value",groupby:x$}},$h({role:d$,from:r,encode:Kl(m,a,Ah),marks:[_,C],name:u,interactive:s,sort:x})}function M1e(e,t){const n=Vn(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const O$='item.orient === "left"',F$='item.orient === "right"',O1=`(${O$} || ${F$})`,T1e=`datum.vgrad && ${O1}`,N1e=C1('"top"','"bottom"','"middle"'),R1e=C1('"right"','"left"','"center"'),j1e=`datum.vgrad && ${F$} ? (${R1e}) : (${O1} && !(datum.vgrad && ${O$})) ? "left" : ${C$}`,L1e=`item._anchor || (${O1} ? "middle" : "start")`,P1e=`${T1e} ? (${O$} ? -90 : 90) : 0`,I1e=`${O1} ? (datum.vgrad ? (${F$} ? "bottom" : "top") : ${N1e}) : "top"`;function B1e(e,t,n,r){const i=Vn(e,t),o={enter:{opacity:Ce},update:{opacity:Nr,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Ce}};return Wt(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:L1e},angle:{signal:P1e},align:{signal:j1e},baseline:{signal:I1e},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),mr({type:su,role:nme,style:_$,from:r,encode:o},n)}function z1e(e,t){let n;return se(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+gj(e.path)+")":e.sphere&&(n="geoShape("+gj(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function gj(e){return se(e)&&e.signal?e.signal:ne(e)}function pj(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===S1?d$:t||c$}function U1e(e){return{marktype:e.type,name:e.name||void 0,role:e.role||pj(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function q1e(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function k$(e,t){const n=iD(e.type);n||I("Unrecognized transform type: "+ne(e.type));const r=b1(n.type.toLowerCase(),null,mj(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function mj(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const a=e.params[o];r[a.name]=H1e(a,t,n)}return r}function H1e(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return W1e(e,t,n);if(i===void 0){e.required&&I("Missing required "+ne(t.type)+" parameter: "+ne(e.name));return}else{if(r==="param")return G1e(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!At(i)?i.map(o=>yj(e,o,n)):yj(e,i,n)}function yj(e,t,n){const r=e.type;if(At(t))return bj(r)?I("Expression references can not be signals."):D$(r)?n.fieldRef(t):xj(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||D$(r);return i&&Y1e(t)?n.exprRef(t.expr,t.as):i&&V1e(t)?wh(t.field,t.as):bj(r)?Xi(t,n):X1e(r)?te(n.getData(t).values):D$(r)?wh(t):xj(r)?n.compareRef(t):t}}function W1e(e,t,n){return Fe(t.from)||I('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function G1e(e,t,n){const r=t[e.name];return e.array?(Q(r)||I("Expected an array of sub-parameters. Instead: "+ne(r)),r.map(i=>vj(e,i,n))):vj(e,r,n)}function vj(e,t,n){const r=e.params.length;let i;for(let a=0;a<r;++a){i=e.params[a];for(const s in i.key)if(i.key[s]!==t[s]){i=null;break}if(i)break}i||I("Unsupported parameter: "+ne(t));const o=ge(mj(i,t,n),i.key);return te(n.add(qme(o)))}const Y1e=e=>e&&e.expr,V1e=e=>e&&e.field,X1e=e=>e==="data",bj=e=>e==="expr",D$=e=>e==="field",xj=e=>e==="compare";function K1e(e,t,n){let r,i,o,a,s;return e?(r=e.facet)&&(t||I("Only group marks can be faceted."),r.field!=null?a=s=F1(r,n):(e.data?s=te(n.getData(e.data).aggregate):(o=k$(ge({type:"aggregate",groupby:oe(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=F1(r,n),a=s=te(n.add(o))),i=n.keyRef(r.groupby,!0))):a=te(n.add(si(null,[{}]))),a||(a=F1(e,n)),{key:i,pulse:a,parent:s}}function F1(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:te(t.getData(e.data).output)}function uu(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}uu.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],a=null,s=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=te(t[s-1]),e.add(t[s]),t[s].type==="aggregate"&&(a=t[s]);return new uu(e,o,i,r,a)};function wj(e){return Fe(e)?e:null}function _j(e,t,n){const r=w1(n.op,n.field);let i;if(t.ops){for(let o=0,a=t.as.length;o<a;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function Sh(e,t,n,r,i,o,a){const s=t[n]||(t[n]={}),u=bme(o);let l=wj(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=s[l]),!c){const d=o?{field:p$,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:te(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(b1(r,void 0,d)),a&&(t.index[i]=f),c=te(f),l!=null&&(s[l]=c)}return c}uu.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=wj(t);let a,s,u;return o!=null&&(e=r.scope,a=i[o]),a?n&&n.field&&_j(e,a.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:te(r.output)},n&&n.field&&_j(e,u,n),s=e.add(J7(u)),a=e.add(si({pulse:te(s)})),a={agg:s,ref:te(a)},o!=null&&(i[o]=a)),a.ref},tuplesRef(){return te(this.values)},extentRef(e,t){return Sh(e,this,"extent","extent",t,!1)},domainRef(e,t){return Sh(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return Sh(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return Sh(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return Sh(e,this,"indata","tupleindex",t,!0,!0)}};function J1e(e,t,n){const r=e.from.facet,i=r.name,o=F1(r,t);let a;r.name||I("Facet must have a name: "+ne(r)),r.data||I("Facet must reference a data set: "+ne(r)),r.field?a=t.add(tj({field:t.fieldRef(r.field),pulse:o})):r.groupby?a=t.add(Nme({key:t.keyRef(r.groupby),group:te(t.proxy(n.parent)),pulse:o})):I("Facet must specify groupby or field: "+ne(r));const s=t.fork(),u=s.add(si()),l=s.add(au({pulse:te(u)}));s.addData(i,new uu(s,u,u,l)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(e).toRuntime()}}function Z1e(e,t,n){const r=t.add(tj({pulse:n.pulse})),i=t.fork();i.add(au()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function Ej(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,a=e.modify,s=e.values,u=t.add(x1()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,o,a,s].map(f=>f==null?"null":f).join(",")+"),0)",c=Xi(l,t);u.update=c.$expr,u.params=c.$params}function k1(e,t){const n=pj(e),r=e.type===S1,i=e.from&&e.from.facet,o=e.overlap;let a=e.layout||n===d$||n===f$,s,u,l,c,f,d,h;const g=n===c$||a||i,p=K1e(e.from,r,t);u=t.add(Mme({key:p.key||(e.key?wh(e.key):void 0),pulse:p.pulse,clean:!r}));const m=te(u);u=l=t.add(si({pulse:m})),u=t.add(Ime({markdef:U1e(e),interactive:q1e(e.interactive,t),clip:z1e(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:te(u)}));const y=te(u);u=c=t.add(ej(G7(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(E=>{const _=k$(E,t),$=_.metadata;($.generates||$.changes)&&I("Mark transforms should not generate new data."),$.nomod||(c.params.mod=!0),_.params.pulse=te(u),t.add(u=_)}),e.sort&&(u=t.add(Vme({sort:t.compareRef(e.sort),pulse:te(u)})));const v=te(u);(i||a)&&(a=t.add(rj({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),d=te(a));const b=t.add(Z7({mark:y,pulse:d||v}));h=te(b),r&&(g&&(s=t.operators,s.pop(),a&&s.pop()),t.pushState(v,d||h,m),i?J1e(e,t,p):g?Z1e(e,t,p):t.parse(e),t.popState(),g&&(a&&s.push(a),s.push(b))),o&&(h=Q1e(o,h,t));const x=t.add(nj({pulse:h})),w=t.add(au({pulse:te(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new uu(t,l,x,w)),e.on&&e.on.forEach(E=>{(E.insert||E.remove||E.toggle)&&I("Marks only support modify triggers."),Ej(E,t,f)}))}function Q1e(e,t,n){const r=e.method,i=e.bound,o=e.separation,a={separation:At(o)?n.signalRef(o.signal):o,method:At(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(a.sort=n.compareRef({field:e.order})),i){const s=i.tolerance;a.boundTolerance=At(s)?n.signalRef(s.signal):+s,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return te(n.add(Ume(a)))}function eye(e,t){const n=t.config.legend,r=e.encode||{},i=Vn(e,n),o=r.legend||{},a=o.name||void 0,s=o.interactive,u=o.style,l={};let c=0,f,d,h;$$.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||I("Missing valid scale for legend.");const g=tye(e,t.scaleType(c)),p={title:e.title!=null,scales:l,type:g,vgrad:g!=="symbol"&&i.isVertical()},m=te(t.add(si(null,[p]))),y={enter:{x:{value:0},y:{value:0}}},v=te(t.add(Lme(d={type:g,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return g===$1?(h=[C1e(e,c,n,r.gradient),hj(e,n,r.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${ou(i.gradientLength())})/100))`)):g===E$?h=[O1e(e,c,n,r.gradient,v),hj(e,n,r.labels,v)]:(f=M1e(e,n),h=[D1e(e,n,r,v,ou(f.columns))],d.size=iye(e,t,h[0].marks)),h=[$h({role:Qpe,from:m,encode:y,marks:h,layout:f,interactive:s})],p.title&&h.push(B1e(e,n,r.title,m)),k1($h({role:Jpe,from:m,encode:Kl(rye(i,e,n),o,Ah),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:s,style:u}),t)}function tye(e,t){let n=e.type||lj;return!e.type&&nye(e)===1&&(e.fill||e.stroke)&&(n=K2(t)?$1:J2(t)?E$:lj),n!==$1?n:J2(t)?E$:$1}function nye(e){return $$.reduce((t,n)=>t+(e[n]?1:0),0)}function rye(e,t,n){const r={enter:{},update:{}};return Wt(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function iye(e,t,n){const r=ou(Aj("size",e,n)),i=ou(Aj("strokeWidth",e,n)),o=ou(oye(n[1].encode,t,Eh));return Xi(`max(ceil(sqrt(${r})+${i}),${o})`,t)}function Aj(e,t,n){return t[e]?`scale("${t[e]}",datum)`:fj(e,n[0].encode)}function oye(e,t,n){return fj("fontSize",e)||$1e("fontSize",t,n)}const aye=`item.orient==="${Zl}"?-90:item.orient==="${Ql}"?90:0`;function sye(e,t){e=Fe(e)?{text:e}:e;const n=Vn(e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,a=i.interactive,s=i.style,u=[],l={},c=te(t.add(si(null,[l])));return u.push(cye(e,n,uye(e),c)),e.subtitle&&u.push(fye(e,n,r.subtitle,c)),k1($h({role:rme,from:c,encode:lye(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),t)}function uye(e){const t=e.encode;return t&&t.title||ge({name:e.name,interactive:e.interactive,style:e.style},t)}function lye(e,t){const n={enter:{},update:{}};return Wt(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:C$},angle:{signal:aye},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Kl(n,t,Ah)}function cye(e,t,n,r){const i={value:0},o=e.text,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Wt(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),mr({type:su,role:ime,style:m1e,from:r,encode:a},n)}function fye(e,t,n,r){const i={value:0},o=e.subtitle,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Wt(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),mr({type:su,role:ome,style:y1e,from:r,encode:a},n)}function dye(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(k$(r,t))}),e.on&&e.on.forEach(r=>{Ej(r,t,e.name)}),t.addDataPipeline(e.name,hye(e,t,n))}function hye(e,t,n){const r=[];let i=null,o=!1,a=!1,s,u,l,c,f;for(e.values?At(e.values)||_1(e.format)?(r.push($j(t,e)),r.push(i=lu())):r.push(i=lu({$ingest:e.values,$format:e.format})):e.url?_1(e.url)||_1(e.format)?(r.push($j(t,e)),r.push(i=lu())):r.push(i=lu({$request:e.url,$format:e.format})):e.source&&(i=s=oe(e.source).map(d=>te(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=lu()),r.push(c),f.generates&&(a=!0),f.modifies&&!a&&(o=!0),f.source?i=c:f.changes&&(i=null);return s&&(l=s.length-1,r[0]=Gme({derive:o,pulse:l?s:s[0]}),(o||l)&&r.splice(1,0,lu())),i||r.push(lu()),r.push(au({})),r}function lu(e){const t=si({},e);return t.metadata={source:!0},t}function $j(e,t){return Pme({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const Sj=e=>e===Ia||e===ui,D1=(e,t,n)=>At(e)?yye(e.signal,t,n):e===Zl||e===ui?t:n,jt=(e,t,n)=>At(e)?pye(e.signal,t,n):Sj(e)?t:n,li=(e,t,n)=>At(e)?mye(e.signal,t,n):Sj(e)?n:t,Cj=(e,t,n)=>At(e)?vye(e.signal,t,n):e===ui?{value:t}:{value:n},gye=(e,t,n)=>At(e)?bye(e.signal,t,n):e===Ql?{value:t}:{value:n},pye=(e,t,n)=>Oj(`${e} === '${ui}' || ${e} === '${Ia}'`,t,n),mye=(e,t,n)=>Oj(`${e} !== '${ui}' && ${e} !== '${Ia}'`,t,n),yye=(e,t,n)=>M$(`${e} === '${Zl}' || ${e} === '${ui}'`,t,n),vye=(e,t,n)=>M$(`${e} === '${ui}'`,t,n),bye=(e,t,n)=>M$(`${e} === '${Ql}'`,t,n),Oj=(e,t,n)=>(t=t!=null?Rt(t):t,n=n!=null?Rt(n):n,Fj(t)&&Fj(n)?(t=t?t.signal||ne(t.value):null,n=n?n.signal||ne(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[ge({test:e},t)].concat(n||[])),Fj=e=>e==null||Object.keys(e).length===1,M$=(e,t,n)=>({signal:`${e} ? (${tc(t)}) : (${tc(n)})`}),xye=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${Zl}' ? (${tc(r)}) : `:"")+(n!=null?`${e} === '${Ia}' ? (${tc(n)}) : `:"")+(i!=null?`${e} === '${Ql}' ? (${tc(i)}) : `:"")+(t!=null?`${e} === '${ui}' ? (${tc(t)}) : `:"")+"(null)"}),tc=e=>At(e)?e.signal:e==null?null:ne(e),wye=(e,t)=>t===0?0:At(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},nc=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function rc(e,t,n,r){let i;if(t&&ae(t,e))return t[e];if(ae(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[_$][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[Eh][i]}return null}function kj(e){const t={};for(const n of e)if(!!n)for(const r in n)t[r]=1;return Object.keys(t)}function _ye(e,t){var n=t.config,r=n.style,i=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,a=e.orient,s,u,l;if(At(a)){const f=kj([n.axisX,n.axisY]),d=kj([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);s={};for(l of f)s[l]=jt(a,rc(l,n.axisX,i,r),rc(l,n.axisY,i,r));u={};for(l of d)u[l]=xye(a.signal,rc(l,n.axisTop,i,r),rc(l,n.axisBottom,i,r),rc(l,n.axisLeft,i,r),rc(l,n.axisRight,i,r))}else s=a===ui||a===Ia?n.axisX:n.axisY,u=n["axis"+a[0].toUpperCase()+a.slice(1)];return s||u||o?ge({},i,s,u,o):i}function Eye(e,t,n,r){const i=Vn(e,t),o=e.orient;let a,s;const u={enter:a={opacity:Ce},update:s={opacity:Nr},exit:{opacity:Ce}};Wt(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=Dj(e,0),c=Dj(e,1);return a.x=s.x=jt(o,l,Ce),a.x2=s.x2=jt(o,c),a.y=s.y=li(o,l,Ce),a.y2=s.y2=li(o,c),mr({type:S$,role:Gpe,from:r,encode:u},n)}function Dj(e,t){return{scale:e.scale,range:t}}function Aye(e,t,n,r,i){const o=Vn(e,t),a=e.orient,s=e.gridScale,u=D1(a,1,-1),l=$ye(e.offset,u);let c,f,d;const h={enter:c={opacity:Ce},update:d={opacity:Nr},exit:f={opacity:Ce}};Wt(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const g={scale:e.scale,field:Tr,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},p=jt(a,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},y=s?{scale:s,range:1,mult:u,offset:l}:ge(p,{mult:u,offset:l});return c.x=d.x=jt(a,g,m),c.y=d.y=li(a,g,m),c.x2=d.x2=li(a,y),c.y2=d.y2=jt(a,y),f.x=jt(a,g),f.y=li(a,g),mr({type:S$,role:Ype,key:Tr,from:r,encode:h},n)}function $ye(e,t){if(t!==1)if(!se(e))e=At(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=ge({},e);for(;n.mult!=null;)if(se(n.mult))n=n.mult=ge({},n.mult);else return n.mult=At(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Sye(e,t,n,r,i,o){const a=Vn(e,t),s=e.orient,u=D1(s,-1,1);let l,c,f;const d={enter:l={opacity:Ce},update:f={opacity:Nr},exit:c={opacity:Ce}};Wt(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=Rt(i);h.mult=u;const g={scale:e.scale,field:Tr,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=l.y=jt(s,Ce,g),f.y2=l.y2=jt(s,h),c.x=jt(s,g),f.x=l.x=li(s,Ce,g),f.x2=l.x2=li(s,h),c.y=li(s,g),mr({type:S$,role:Xpe,key:Tr,from:r,encode:d},n)}function T$(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function Cye(e,t,n,r,i,o){const a=Vn(e,t),s=e.orient,u=e.scale,l=D1(s,-1,1),c=ou(a("labelFlush")),f=ou(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let g=c===0||!!c,p;const m=Rt(i);m.mult=l,m.offset=Rt(a("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:Tr,band:.5,offset:dj(o.offset,a("labelOffset"))},v=jt(s,g?T$(u,c,'"left"','"right"','"center"'):{value:"center"},gye(s,"left","right")),b=jt(s,Cj(s,"bottom","top"),g?T$(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=T$(u,c,`-(${f})`,f,0);g=g&&f;const w={opacity:Ce,x:jt(s,y,m),y:li(s,y,m)},E={enter:w,update:p={opacity:Nr,text:{field:w$},x:w.x,y:w.y,align:v,baseline:b},exit:{opacity:Ce,x:w.x,y:w.y}};Wt(E,{dx:!d&&g?jt(s,x):null,dy:!h&&g?li(s,x):null}),Wt(E,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const _=a("labelBound");let $=a("labelOverlap");return $=$||_?{separation:a("labelSeparation"),method:$,order:"datum.index",bound:_?{scale:u,orient:s,tolerance:_}:null}:void 0,p.align!==v&&(p.align=nc(p.align,v)),p.baseline!==b&&(p.baseline=nc(p.baseline,b)),mr({type:su,role:Vpe,style:Eh,key:Tr,from:r,encode:E,overlap:$},n)}function Oye(e,t,n,r){const i=Vn(e,t),o=e.orient,a=D1(o,-1,1);let s,u;const l={enter:s={opacity:Ce,anchor:Rt(i("titleAnchor",null)),align:{signal:C$}},update:u=ge({},s,{opacity:Nr,text:Rt(e.title)}),exit:{opacity:Ce}},c={signal:`lerp(range("${e.scale}"), ${C1(0,1,.5)})`};return u.x=jt(o,c),u.y=li(o,c),s.angle=jt(o,Ce,wye(a,90)),s.baseline=jt(o,Cj(o,Ia,ui),{value:Ia}),u.angle=s.angle,u.baseline=s.baseline,Wt(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),Fye(i,o,l,n),l.update.align=nc(l.update.align,s.align),l.update.angle=nc(l.update.angle,s.angle),l.update.baseline=nc(l.update.baseline,s.baseline),mr({type:su,role:Kpe,style:_$,from:r,encode:l},n)}function Fye(e,t,n,r){const i=(s,u)=>s!=null?(n.update[u]=nc(Rt(s),n.update[u]),!1):!Jl(u,r),o=i(e("titleX"),"x"),a=i(e("titleY"),"y");n.enter.auto=a===o?Rt(a):jt(t,Rt(a),Rt(o))}function kye(e,t){const n=_ye(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,a=i.interactive,s=i.style,u=Vn(e,n),l=S1e(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=te(t.add(si({},[c]))),d=te(t.add(Dme({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let g;return c.grid&&h.push(Aye(e,n,r.grid,d,l)),c.ticks&&(g=u("tickSize"),h.push(Sye(e,n,r.ticks,d,g,l))),c.labels&&(g=c.ticks?g:0,h.push(Cye(e,n,r.labels,d,g,l))),c.domain&&h.push(Eye(e,n,r.domain,f)),c.title&&h.push(Oye(e,n,r.title,f)),k1($h({role:Wpe,from:f,encode:Kl(Dye(u,e),i,Ah),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:a,style:s}),t)}function Dye(e,t){const n={enter:{},update:{}};return Wt(n,{orient:e("orient"),offset:e("offset")||0,position:ai(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function Mj(e,t,n){const r=oe(e.signals),i=oe(e.scales);return n||r.forEach(o=>V7(o,t)),oe(e.projections).forEach(o=>l1e(o,t)),i.forEach(o=>Jme(o,t)),oe(e.data).forEach(o=>dye(o,t)),i.forEach(o=>Zme(o,t)),(n||r).forEach(o=>kme(o,t)),oe(e.axes).forEach(o=>kye(o,t)),oe(e.marks).forEach(o=>k1(o,t)),oe(e.legends).forEach(o=>eye(o,t)),e.title&&sye(e.title,t),t.parseLambdas(),t}const Mye=e=>Kl({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function Tye(e,t){const n=t.config,r=te(t.root=t.add(x1())),i=Nye(e,n);i.forEach(l=>V7(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(si()),a=t.add(ej(G7(Mye(e.encode),S1,f$,e.style,t,{pulse:te(o)}))),s=t.add(rj({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:te(a)}));t.operators.pop(),t.pushState(te(a),te(s),null),Mj(e,t,i),t.operators.push(s);let u=t.add(Z7({mark:r,pulse:te(s)}));return u=t.add(nj({pulse:te(u)})),u=t.add(au({pulse:te(u)})),t.addData("root",new uu(t,o,o,u)),t}function Ch(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Nye(e,t){const n=a=>ai(e[a],t[a]),r=[Ch("background",n("background")),Ch("autosize",Upe(n("autosize"))),Ch("padding",Hpe(n("padding"))),Ch("width",n("width")||0),Ch("height",n("height")||0)],i=r.reduce((a,s)=>(a[s.name]=s,a),{}),o={};return oe(e.signals).forEach(a=>{ae(i,a.name)?a=ge(i[a.name],a):r.push(a),o[a.name]=a}),oe(t.signals).forEach(a=>{!ae(o,a.name)&&!ae(i,a.name)&&r.push(a)}),r}function Tj(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Nj(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}Tj.prototype=Nj.prototype={parse(e){return Mj(e,this)},fork(){return new Nj(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof g$?te(e):e;return this.add(Wme({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,o){let a,s;r&&(a=r.data||(r.data={}),s=a[i]||(a[i]=[]),s.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(te(this.add(au({pulse:e})))),this._parent.push(t),this._lookup.push(n?te(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return _e(this._parent)},encode(){return _e(this._encode)},lookup(){return _e(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Fe(e))return wh(e,t);e.signal||I("Unsupported field reference: "+ne(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=te(this.add(Rme(i)))}return r},compareRef(e){let t=!1;const n=o=>At(o)?(t=!0,this.signalRef(o.signal)):xme(o)?(t=!0,this.exprRef(o.expr)):o,r=oe(e.field).map(n),i=oe(e.order).map(n);return t?te(this.add(Q7({fields:r,orders:i}))):X7(r,i)},keyRef(e,t){let n=!1;const r=o=>At(o)?(n=!0,te(i[o.signal])):o,i=this.signals;return e=oe(e).map(r),n?te(this.add(jme({fields:e,flat:t}))):mme(e,t)},sortRef(e){if(!e)return e;const t=w1(e.op,e.field),n=e.order||yme;return n.signal?te(this.add(Q7({fields:t,orders:this.signalRef(n.signal)}))):X7(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return ae(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&I("Duplicate signal name: "+ne(e));const n=t instanceof g$?t:this.add(x1(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||I("Unrecognized signal name: "+ne(e)),this.signals[e]},signalRef(e){return this.signals[e]?te(this.signals[e]):(ae(this.lambdas,e)||(this.lambdas[e]=this.add(x1(null))),te(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=Xi(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!se(e)?e:this.signalRef(e.signal||N$(e))},exprRef(e,t){const n={expr:Xi(e,this)};return t&&(n.expr.$name=t),te(this.add(Tme(n)))},addBinding(e,t){this.bindings||I("Nested signals do not support binding: "+ne(e)),this.bindings.push(ge({signal:e},t))},addScaleProj(e,t){ae(this.scales,e)&&I("Duplicate scale or projection name: "+ne(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Yme(t))},addProjection(e,t){this.addScaleProj(e,Hme(t))},getScale(e){return this.scales[e]||I("Unrecognized scale name: "+ne(e)),this.scales[e]},scaleRef(e){return te(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ae(this.data,e)&&I("Duplicate data set name: "+ne(e)),this.data[e]=t},getData(e){return this.data[e]||I("Undefined data set name: "+ne(e)),this.data[e]},addDataPipeline(e,t){return ae(this.data,e)&&I("Duplicate data set name: "+ne(e)),this.addData(e,uu.fromEntries(this,t))}};function N$(e){return(Q(e)?Rye:jye)(e)}function Rye(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(se(i)?i.signal||N$(i):ne(i))}return n+"]"}function jye(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+ne(r)+":"+(se(i)?i.signal||N$(i):ne(i));return t+"}"}function Lye(){const e="sans-serif",t=30,n=2,r="#4c78a8",i="#000",o="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:n},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:n},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Pye(e,t,n){return se(e)||I("Input Vega specification must be an object."),t=V0(Lye(),t,e.config),Tye(e,new Tj(t,n)).toRuntime()}var Iye="vega",Bye="5.21.0",zye="The Vega visualization grammar.",Uye=["vega","visualization","interaction","dataflow","library","data","d3"],qye="BSD-3-Clause",Hye="UW Interactive Data Lab (http://idl.cs.washington.edu)",Wye="build/vega-node.js",Gye="build/vega.module.js",Yye="build/vega.min.js",Vye="build/vega.min.js",Xye="index.d.ts",Kye="vega/vega",Jye={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},Zye={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.1","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.1.0","vega-loader":"~4.4.1","vega-parser":"~6.1.4","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.10","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.22.0","vega-util":"~1.17.0","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},Qye={"vega-schema":"*"},eve="774165e29850b66ec8b79ba52a7955f1ab936ea6",tve={name:Iye,version:Bye,description:zye,keywords:Uye,license:qye,author:Hye,main:Wye,module:Gye,unpkg:Yye,jsdelivr:Vye,types:Xye,repository:Kye,scripts:Jye,dependencies:Zye,devDependencies:Qye,gitHead:eve};ge(ol,NZ,Eoe,Aae,Uue,Rle,hfe,Pce,pfe,Mfe,Ufe,ede);const nve=tve.version;var rve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:nve,Dataflow:il,EventStream:mg,MultiPulse:Bb,Operator:Ye,Parameters:pg,Pulse:ha,Transform:N,changeset:As,definition:iD,ingest:Le,isTuple:dg,transform:oD,transforms:ol,tupleid:ee,interpolate:Z2,interpolateColors:ep,interpolateRange:bT,quantizeInterpolator:xT,scale:Ne,scheme:Q2,projection:iE,View:k7,defaultLocale:Tb,formatLocale:ag,locale:Lk,resetDefaultLocale:_K,timeFormatLocale:Ef,expressionFunction:mt,parse:Pye,runtimeContext:s7,codegenExpression:KR,parseExpression:YR,parseSelector:I7,Debug:G3,Error:Vv,Info:W3,None:q3,Warn:H3,accessor:jn,accessorFields:Xt,accessorName:ut,array:oe,ascending:Q0,clampRange:oF,compare:Zv,constant:Jt,debounce:Qv,error:I,extend:ge,extent:Ai,extentIndex:aF,falsy:aa,fastmap:Ku,field:Ln,flush:sF,hasOwnProperty:ae,id:Qc,identity:yn,inherits:q,inrange:Ju,isArray:Q,isBoolean:eb,isDate:sa,isFunction:me,isIterable:uF,isNumber:ua,isObject:se,isRegExp:lF,isString:Fe,key:tb,lerp:cF,logger:Y3,lruCache:fF,merge:dF,mergeConfig:V0,one:Xu,pad:hF,panLinear:Q3,panLog:eF,panPow:tF,panSymlog:nF,peek:_e,quarter:rF,repeat:tf,span:nf,splitAccessPath:Y0,stringValue:ne,toBoolean:nb,toDate:rb,toNumber:Kt,toSet:Yr,toString:ib,truncate:gF,truthy:_r,utcquarter:iF,visitArray:la,writeConfig:ef,zero:oa,zoomLinear:Xv,zoomLog:Kv,zoomPow:Z0,zoomSymlog:Jv,bandwidthNRD:Gb,bin:cD,bootstrapCI:fD,cumulativeLogNormal:Zb,cumulativeNormal:xg,cumulativeUniform:nx,densityLogNormal:Jb,densityNormal:Yb,densityUniform:tx,dotbin:dD,quantileLogNormal:Qb,quantileNormal:wg,quantileUniform:rx,quantiles:Hb,quartiles:Wb,get random(){return Ar},randomInteger:MJ,randomKDE:Xb,randomLCG:DJ,randomLogNormal:gD,randomMixture:pD,randomNormal:Vb,randomUniform:mD,regressionExp:vD,regressionLinear:ix,regressionLoess:ED,regressionLog:yD,regressionPoly:xD,regressionPow:bD,regressionQuad:ox,sampleCurve:Eg,sampleLogNormal:Kb,sampleNormal:bg,sampleUniform:ex,setRandom:FJ,DATE:Bn,DAY:Qt,DAYOFYEAR:$i,HOURS:ar,MILLISECONDS:Vr,MINUTES:sr,MONTH:Zt,QUARTER:In,SECONDS:Er,TIME_UNITS:hb,WEEK:xt,YEAR:zt,dayofyear:BF,timeBin:ok,timeFloor:YF,timeInterval:el,timeOffset:KF,timeSequence:QF,timeUnitSpecifier:IF,timeUnits:pb,utcFloor:VF,utcInterval:tl,utcOffset:JF,utcSequence:ek,utcdayofyear:qF,utcweek:HF,week:zF,format:ug,formats:Lb,inferType:Bk,inferTypes:zk,loader:lg,read:Wk,responseType:Hk,typeParsers:Nb,Bounds:_t,CanvasHandler:cd,CanvasRenderer:Cp,Gradient:jT,GroupItem:ap,Handler:Sa,Item:op,Marks:ur,RenderType:Oa,Renderer:Li,ResourceLoader:cw,SVGHandler:Iw,SVGRenderer:Gw,SVGStringRenderer:Xw,Scenegraph:Nw,boundClip:e8,boundContext:td,boundItem:Tw,boundMark:p6,boundStroke:Oo,domChild:Un,domClear:Zr,domCreate:$a,domFind:Rw,font:vp,fontFamily:ad,fontSize:ji,intersect:K6,intersectBoxLine:El,intersectPath:yw,intersectPoint:vw,intersectRule:e6,lineHeight:Ea,markup:Ww,multiLineOffset:kw,pathCurves:iw,pathEqual:t8,pathParse:xl,pathRectangle:qT,pathRender:Kf,pathSymbols:UT,pathTrail:HT,point:xp,renderModule:Fp,resetSVGClipId:GT,resetSVGDefIds:Iie,sceneEqual:Jw,sceneFromJSON:y6,scenePickVisit:hp,sceneToJSON:m6,sceneVisit:Jr,sceneZOrder:bw,serializeXML:I6,textMetrics:Ri});function ive(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var ove={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},ave={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},sve={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const uve=Array.prototype.slice,cu=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,uve.call(t,1))},lve=(e,t,n,r,i,o,a)=>new Date(e,t||0,n!=null?n:1,r||0,i||0,o||0,a||0);var cve={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:lve,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return cu("join",arguments)},indexof:function(){return cu("indexOf",arguments)},lastindexof:function(){return cu("lastIndexOf",arguments)},slice:function(){return cu("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return cu("substring",arguments,String)},split:function(){return cu("split",arguments,String)},replace:function(){return cu("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const fve=["view","item","group","xy","x","y"],dve={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:ove[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);return n&&(e.memberDepth-=1),r[i]},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),r==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||cve[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>ave[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>sve[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,r)=>{e.memberDepth+=1;const i=e(r.key);return e.memberDepth-=1,n[i]=e(r.value),n},{})};function Oh(e,t,n,r,i,o){const a=s=>dve[s.type](a,s);return a.memberDepth=0,a.fn=Object.create(t),a.params=n,a.datum=r,a.event=i,a.item=o,fve.forEach(s=>a.fn[s]=(...u)=>i.vega[s](...u)),a(e)}var hve={operator(e,t){const n=t.ast,r=e.functions;return i=>Oh(n,r,i)},parameter(e,t){const n=t.ast,r=e.functions;return(i,o)=>Oh(n,r,o,i)},event(e,t){const n=t.ast,r=e.functions;return i=>Oh(n,r,void 0,void 0,i)},handler(e,t){const n=t.ast,r=e.functions;return(i,o)=>{const a=o.item&&o.item.datum;return Oh(n,r,i,a,o)}},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,o=n==="group"||n==="image"||n==="rect";return(a,s)=>{const u=a.datum;let l=0,c;for(const f in r)c=Oh(r[f].ast,i,s,u,void 0,a),a[f]!==c&&(a[f]=c,l=1);return n!=="rule"&&ive(a,r,o),l}}};const gve="vega-lite",pve='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',mve="5.1.1",yve=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],vve="https://vega.github.io/vega-lite/",bve="Vega-Lite is a concise high-level language for interactive visualization.",xve="build/vega-lite.js",wve="build/vega-lite.min.js",_ve="build/vega-lite.min.js",Eve="build/src/index",Ave="build/src/index.d.ts",$ve={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},Sve={test:"test"},Cve=["bin","build","src","vega-lite*","tsconfig.json"],Ove={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/"},Fve={type:"git",url:"https://github.com/vega/vega-lite.git"},kve="BSD-3-Clause",Dve={url:"https://github.com/vega/vega-lite/issues"},Mve={"@babel/core":"^7.15.0","@babel/preset-env":"^7.15.0","@babel/preset-typescript":"^7.15.0","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^20.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.0.4","@types/chai":"^4.2.21","@types/d3":"^7.0.0","@types/jest":"^27.0.1","@types/mkdirp":"^1.0.2","@types/pako":"^1.0.2","@typescript-eslint/eslint-plugin":"^4.29.2","@typescript-eslint/parser":"^4.29.2",ajv:"^8.6.2","ajv-formats":"^2.1.1",chai:"^4.3.4",cheerio:"^1.0.0-rc.10","conventional-changelog-cli":"^2.1.1",d3:"^7.0.1","del-cli":"^4.0.1",eslint:"^7.32.0","eslint-config-prettier":"^8.3.0","eslint-plugin-jest":"^24.4.0","eslint-plugin-prettier":"^4.0.0","gh-pages":"^3.2.3","highlight.js":"^11.2.0",jest:"^27.0.6","jest-dev-server":"^5.0.3",mkdirp:"^1.0.4",pako:"^2.0.4",prettier:"^2.3.2",puppeteer:"^10.2.0",rollup:"^2.56.3","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2",serve:"^12.0.0",terser:"^5.7.1","ts-jest":"^27.0.5","ts-json-schema-generator":"^0.95.0",typescript:"~4.4.2","vega-cli":"^5.20.2","vega-datasets":"~2.2.0","vega-embed":"^6.18.2","vega-tooltip":"^0.27.0","yaml-front-matter":"^4.1.1"},Tve={"@types/clone":"~2.1.1","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.3.1","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-util":"~1.16.1",yargs:"~17.1.1"},Nve={vega:"^5.20.2"},Rve={node:">=12"};var jve={name:gve,author:pve,version:mve,collaborators:yve,homepage:vve,description:bve,main:xve,unpkg:wve,jsdelivr:_ve,module:Eve,types:Ave,bin:$ve,directories:Sve,files:Cve,scripts:Ove,repository:Fve,license:kve,bugs:Dve,devDependencies:Mve,dependencies:Tve,peerDependencies:Nve,engines:Rve};function ic(e,t,n){return e.fields=t||[],e.fname=n,e}function Lve(e){return e.length===1?Pve(e[0]):Ive(e)}const Pve=e=>function(t){return t[e]},Ive=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function R$(e){throw Error(e)}function fu(e){const t=[],n=e.length;let r=null,i=0,o="",a,s,u;e=e+"";function l(){t.push(o+e.substring(a,s)),o="",a=s+1}for(a=s=0;s<n;++s)if(u=e[s],u==="\\")o+=e.substring(a,s),o+=e.substring(++s,++s),a=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;a===i&&u==='"'||a===i&&u==="'"?(a=s+1,r=u):u==="."&&!i?s>a?l():a=s+1:u==="["?(s>a&&l(),i=a=s+1):u==="]"&&(i||R$("Access path missing open bracket: "+e),i>0&&l(),i=0,a=s+1)}return i&&R$("Access path missing closing bracket: "+e),r&&R$("Access path missing closing quote: "+e),s>a&&(s++,l()),t}function Bve(e,t,n){const r=fu(e);return e=r.length===1?r[0]:e,ic((n&&n.get||Lve)(r),[e],t||e)}Bve("id");const zve=ic(e=>e,[],"identity");ic(()=>0,[],"zero");ic(()=>1,[],"one");ic(()=>!0,[],"true");ic(()=>!1,[],"false");function M1(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const Uve=0,qve=1,Rj=2,Hve=3,Wve=4;function Gve(e,t){let n=e||Uve;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=qve&&M1(t||"error","ERROR",arguments),this},warn(){return n>=Rj&&M1(t||"warn","WARN",arguments),this},info(){return n>=Hve&&M1(t||"log","INFO",arguments),this},debug(){return n>=Wve&&M1(t||"log","DEBUG",arguments),this}}}var J=Array.isArray;function Ve(e){return e===Object(e)}const jj=e=>e!=="__proto__";function Lj(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=Yve(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;j$(t,r,n[r],i)}return t},{})}function j$(e,t,n,r){if(!jj(t))return;let i,o;if(Ve(n)&&!J(n)){o=Ve(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?j$(o,i,n[i]):jj(i)&&(o[i]=n[i])}else e[t]=n}function Yve(e,t){if(e==null)return t;const n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function ft(e){return e!=null?J(e)?e:[e]:[]}function Vve(e){return typeof e=="function"}const Xve=Object.prototype.hasOwnProperty;function oc(e,t){return Xve.call(e,t)}function Fh(e){return typeof e=="boolean"}function yt(e){return typeof e=="number"}function fe(e){return typeof e=="string"}function ke(e){return J(e)?"["+e.map(ke)+"]":Ve(e)||fe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function du(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var Pj={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch(d){r=function(){}}var i;try{i=Set}catch(d){i=function(){}}var o;try{o=Promise}catch(d){o=function(){}}function a(d,h,g,p,m){typeof h=="object"&&(g=h.depth,p=h.prototype,m=h.includeNonEnumerable,h=h.circular);var y=[],v=[],b=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof g=="undefined"&&(g=1/0);function x(w,E){if(w===null)return null;if(E===0)return w;var _,$;if(typeof w!="object")return w;if(n(w,r))_=new r;else if(n(w,i))_=new i;else if(n(w,o))_=new o(function(P,B){w.then(function(H){P(x(H,E-1))},function(H){B(x(H,E-1))})});else if(a.__isArray(w))_=[];else if(a.__isRegExp(w))_=new RegExp(w.source,f(w)),w.lastIndex&&(_.lastIndex=w.lastIndex);else if(a.__isDate(w))_=new Date(w.getTime());else{if(b&&Buffer.isBuffer(w))return Buffer.allocUnsafe?_=Buffer.allocUnsafe(w.length):_=new Buffer(w.length),w.copy(_),_;n(w,Error)?_=Object.create(w):typeof p=="undefined"?($=Object.getPrototypeOf(w),_=Object.create($)):(_=Object.create(p),$=p)}if(h){var C=y.indexOf(w);if(C!=-1)return v[C];y.push(w),v.push(_)}n(w,r)&&w.forEach(function(P,B){var H=x(B,E-1),ie=x(P,E-1);_.set(H,ie)}),n(w,i)&&w.forEach(function(P){var B=x(P,E-1);_.add(B)});for(var O in w){var A;$&&(A=Object.getOwnPropertyDescriptor($,O)),!(A&&A.set==null)&&(_[O]=x(w[O],E-1))}if(Object.getOwnPropertySymbols)for(var D=Object.getOwnPropertySymbols(w),O=0;O<D.length;O++){var F=D[O],T=Object.getOwnPropertyDescriptor(w,F);T&&!T.enumerable&&!m||(_[F]=x(w[F],E-1),T.enumerable||Object.defineProperty(_,F,{enumerable:!1}))}if(m)for(var S=Object.getOwnPropertyNames(w),O=0;O<S.length;O++){var M=S[O],T=Object.getOwnPropertyDescriptor(w,M);T&&T.enumerable||(_[M]=x(w[M],E-1),Object.defineProperty(_,M,{enumerable:!1}))}return _}return x(d,g)}a.clonePrototype=function(h){if(h===null)return null;var g=function(){};return g.prototype=h,new g};function s(d){return Object.prototype.toString.call(d)}a.__objToStr=s;function u(d){return typeof d=="object"&&s(d)==="[object Date]"}a.__isDate=u;function l(d){return typeof d=="object"&&s(d)==="[object Array]"}a.__isArray=l;function c(d){return typeof d=="object"&&s(d)==="[object RegExp]"}a.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return a.__getRegExpFlags=f,a}();e.exports&&(e.exports=t)})(Pj);var Kve=Pj.exports,Jve=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!=0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!=0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!=0;){var a=o[i];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n},L$=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(o){return function(a){return function(s,u){var l={key:s,value:a[s]},c={key:u,value:a[u]};return o(l,c)}}}(t.cmp),i=[];return function o(a){if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a!==void 0){if(typeof a=="number")return isFinite(a)?""+a:"null";if(typeof a!="object")return JSON.stringify(a);var s,u;if(Array.isArray(a)){for(u="[",s=0;s<a.length;s++)s&&(u+=","),u+=o(a[s])||"null";return u+"]"}if(a===null)return"null";if(i.indexOf(a)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=i.push(a)-1,c=Object.keys(a).sort(r&&r(a));for(u="",s=0;s<c.length;s++){var f=c[s],d=o(a[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return i.splice(l,1),"{"+u+"}"}}(e)};function P$(e){return!!e.or}function I$(e){return!!e.and}function B$(e){return!!e.not}function T1(e,t){if(B$(e))T1(e.not,t);else if(I$(e))for(const n of e.and)T1(n,t);else if(P$(e))for(const n of e.or)T1(n,t);else t(e)}function ac(e,t){return B$(e)?{not:ac(e.not,t)}:I$(e)?{and:e.and.map(n=>ac(n,t))}:P$(e)?{or:e.or.map(n=>ac(n,t))}:t(e)}const Ki=Jve,de=Kve;function sc(e,t){const n={};for(const r of t)oc(e,r)&&(n[r]=e[r]);return n}function yr(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>L$(e)).join(",")})`};const Ke=L$;function Ee(e){if(yt(e))return e;const t=fe(e)?e:L$(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function z$(e){return e===!1||e===null}function ye(e,t){return e.includes(t)}function uc(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function U$(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function Ij(e,...t){for(const n of t)Zve(e,n!=null?n:{});return e}function Zve(e,t){for(const n of z(t))j$(e,n,t[n],!0)}function Ji(e,t){const n=[],r={};let i;for(const o of e)i=t(o),!(i in r)&&(r[i]=1,n.push(o));return n}function Qve(e,t){const n=z(e),r=z(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}function Bj(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function q$(e,t){for(const n of e)if(t.has(n))return!0;return!1}function H$(e){const t=new Set;for(const n of e){const i=fu(n).map((a,s)=>s===0?a:`[${a}]`),o=i.map((a,s)=>i.slice(0,s+1).join(""));for(const a of o)t.add(a)}return t}function W$(e,t){return e===void 0||t===void 0?!0:q$(H$(e),H$(t))}function We(e){return z(e).length===0}const z=Object.keys,ln=Object.values,Ba=Object.entries;function kh(e){return e===!0||e===!1}function nt(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function Dh(e,t){return B$(e)?`!(${Dh(e.not,t)})`:I$(e)?`(${e.and.map(n=>Dh(n,t)).join(") && (")})`:P$(e)?`(${e.or.map(n=>Dh(n,t)).join(") || (")})`:t(e)}function N1(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&N1(e[n],t)&&delete e[n],We(e)}function Mh(e){return e.charAt(0).toUpperCase()+e.substr(1)}function G$(e,t="datum"){const n=fu(e),r=[];for(let i=1;i<=n.length;i++){const o=`[${n.slice(0,i).map(ke).join("][")}]`;r.push(`${t}${o}`)}return r.join(" && ")}function zj(e,t="datum"){return`${t}[${ke(fu(e).join("."))}]`}function ebe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Rr(e){return`${fu(e).map(ebe).join("\\.")}`}function hu(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function Y$(e){return`${fu(e).join(".")}`}function lc(e){return e?fu(e).length:0}function vt(...e){for(const t of e)if(t!==void 0)return t}let Uj=42;function qj(e){const t=++Uj;return e?String(e)+t:t}function tbe(){Uj=42}function Hj(e){return Wj(e)?e:`__${e}`}function Wj(e){return e.startsWith("__")}function Th(e){if(e!==void 0)return(e%360+360)%360}function R1(e){return yt(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}var Nh=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const zo="row",Uo="column",j1="facet",at="x",$t="y",ci="x2",Zi="y2",Qi="radius",qo="radius2",fi="theta",Ho="theta2",eo="latitude",to="longitude",di="latitude2",jr="longitude2",Xn="color",no="fill",ro="stroke",Kn="shape",Wo="size",gu="angle",Go="opacity",za="fillOpacity",Ua="strokeOpacity",qa="strokeWidth",Ha="strokeDash",Rh="text",jh="order",Lh="detail",L1="key",pu="tooltip",P1="href",I1="url",B1="description",nbe={x:1,y:1,x2:1,y2:1},Gj={theta:1,theta2:1,radius:1,radius2:1};function Yj(e){return e in Gj}const V$={longitude:1,longitude2:1,latitude:1,latitude2:1};function rbe(e){switch(e){case eo:return"y";case di:return"y2";case to:return"x";case jr:return"x2"}}function ibe(e){return e in V$}const obe=z(V$),Vj=Object.assign(Object.assign(Object.assign(Object.assign({},nbe),Gj),V$),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function cc(e){return e===Xn||e===no||e===ro}const Xj={row:1,column:1,facet:1},Lr=z(Xj),X$=Object.assign(Object.assign({},Vj),Xj),abe=z(X$),sbe=Nh(X$,["order","detail","tooltip"]),ube=Nh(sbe,["row","column","facet"]);function lbe(e){return!!ube[e]}function Kj(e){return!!X$[e]}const cbe=[ci,Zi,di,jr,Ho,qo];function Jj(e){return mu(e)!==e}function mu(e){switch(e){case ci:return at;case Zi:return $t;case di:return eo;case jr:return to;case Ho:return fi;case qo:return Qi}return e}function Wa(e){if(Yj(e))switch(e){case fi:return"startAngle";case Ho:return"endAngle";case Qi:return"outerRadius";case qo:return"innerRadius"}return e}function Yo(e){switch(e){case at:return ci;case $t:return Zi;case eo:return di;case to:return jr;case fi:return Ho;case Qi:return qo}}function Pr(e){switch(e){case at:case ci:return"width";case $t:case Zi:return"height"}}function fbe(e){switch(e){case at:return"xOffset";case $t:return"yOffset";case ci:return"x2Offset";case Zi:return"y2Offset";case fi:return"thetaOffset";case Qi:return"radiusOffset";case Ho:return"theta2Offset";case qo:return"radius2Offset"}}const K$=Nh(Vj,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),dbe=z(K$),Ga={x:1,y:1},io=z(Ga);function oo(e){return e in Ga}const J$={theta:1,radius:1},hbe=z(J$);function z1(e){return e==="width"?at:$t}const Zj=Nh(K$,["text","tooltip","href","url","description","detail","key","order"]),gbe=z(Zj);function pbe(e){return!!K$[e]}function mbe(e){switch(e){case Xn:case no:case ro:case Wo:case Kn:case Go:case qa:case Ha:return!0;case za:case Ua:case gu:return!1}}const Qj=Object.assign(Object.assign(Object.assign({},Ga),J$),Zj),U1=z(Qj);function Ya(e){return!!Qj[e]}function ybe(e,t){return bbe(e)[t]}const eL={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},vbe=Nh(eL,["geoshape"]);function bbe(e){switch(e){case Xn:case no:case ro:case B1:case Lh:case L1:case pu:case P1:case jh:case Go:case za:case Ua:case qa:case j1:case zo:case Uo:return eL;case at:case $t:case eo:case to:return vbe;case ci:case Zi:case di:case jr:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Wo:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Ha:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Kn:return{point:"always",geoshape:"always"};case Rh:return{text:"always"};case gu:return{point:"always",square:"always",text:"always"};case I1:return{image:"always"};case fi:return{text:"always",arc:"always"};case Qi:return{text:"always",arc:"always"};case Ho:case qo:return{arc:"always"}}}function Z$(e){switch(e){case at:case $t:case fi:case Qi:case Wo:case gu:case qa:case Go:case za:case Ua:case ci:case Zi:case Ho:case qo:return;case j1:case zo:case Uo:case Kn:case Ha:case Rh:case pu:case P1:case I1:case B1:return"discrete";case Xn:case no:case ro:return"flexible";case eo:case to:case di:case jr:case Lh:case L1:case jh:return}}const xbe={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},wbe={count:1,min:1,max:1};function Vo(e){return!!e&&!!e.argmin}function Va(e){return!!e&&!!e.argmax}function Q$(e){return fe(e)&&!!xbe[e]}const _be=["count","valid","missing","distinct"];function tL(e){return fe(e)&&ye(_be,e)}function Ebe(e){return fe(e)&&ye(["min","max"],e)}const Abe=["count","sum","distinct","valid","missing"],$be=["mean","average","median","q1","q3","min","max"],Sbe=du($be);function nL(e){return Fh(e)&&(e=uy(e,void 0)),"bin"+z(e).map(t=>q1(e[t])?nt(`_${t}_${Ba(e[t])}`):nt(`_${t}_${e[t]}`)).join("")}function Je(e){return e===!0||yu(e)&&!e.binned}function kn(e){return e==="binned"||yu(e)&&e.binned===!0}function yu(e){return Ve(e)}function q1(e){return e==null?void 0:e.param}function rL(e){switch(e){case zo:case Uo:case Wo:case Xn:case no:case ro:case qa:case Go:case za:case Ua:case Kn:return 6;case Ha:return 4;default:return 10}}function Ph(e){return e&&!!e.expr}function Jn(e){const t=z(e||{}),n={};for(const r of t)n[r]=vr(e[r]);return n}var Cbe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function iL(e){const{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:a,color:s,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:g}=e,p=Cbe(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},p),s?{fill:s}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),o!==void 0?{angle:o}:{}),a!==void 0?{limit:a}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{subtitleColor:u}:{}),l?{subtitleFont:l}:{}),c?{subtitleFontSize:c}:{}),f?{subtitleFontStyle:f}:{}),d?{subtitleFontWeight:d}:{}),h?{subtitleLineHeight:h}:{}),g?{subtitlePadding:g}:{}),b=sc(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:b,nonMarkTitleProperties:y,subtitle:v}}function Xa(e){return fe(e)||J(e)&&fe(e[0])}function re(e){return e&&!!e.signal}function Ka(e){return!!e.step}function Obe(e){return J(e)?!1:"fields"in e&&!("data"in e)}function Fbe(e){return J(e)?!1:"fields"in e&&"data"in e}function Xo(e){return J(e)?!1:"field"in e&&"data"in e}const kbe={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},Dbe=z(kbe),Mbe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},eS=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var tS=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function oL(e){const t=J(e.condition)?e.condition.map(aL):aL(e.condition);return Object.assign(Object.assign({},vr(e)),{condition:t})}function vr(e){if(Ph(e)){const{expr:t}=e,n=tS(e,["expr"]);return Object.assign({signal:t},n)}return e}function aL(e){if(Ph(e)){const{expr:t}=e,n=tS(e,["expr"]);return Object.assign({signal:t},n)}return e}function rt(e){if(Ph(e)){const{expr:t}=e,n=tS(e,["expr"]);return Object.assign({signal:t},n)}return re(e)?e:e!==void 0?{value:e}:void 0}function sL(e){return re(e)?e.signal:ke(e.value)}function Ko(e){return re(e)?e.signal:e==null?null:ke(e)}function Tbe(e,t,n){for(const r of n){const i=vu(r,t.markDef,t.config);i!==void 0&&(e[r]=rt(i))}return e}function uL(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Be(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:o&&(!i||i===e)?void 0:vu(e,t,n,r)}function vu(e,t,n,{vgChannel:r}={}){return vt(r?H1(e,t,n.style):void 0,H1(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function H1(e,t,n){return lL(e,uL(t),n)}function lL(e,t,n){t=ft(t);let r;for(const i of t){const o=n[i];o&&o[e]!==void 0&&(r=o[e])}return r}function cL(e,t){return ft(e).reduce((n,r)=>{var i;return n.field.push(G(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function fL(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(Ki(i,r))return;n.push(r)}),n}function dL(e,t){return Ki(e,t)||!t?e:e?[...ft(e),...ft(t)].join(", "):t}function hL(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Xa(n)||re(n))&&(Xa(r)||re(r)))return{explicit:e.explicit,value:dL(n,r)};if(Xa(n)||re(n))return{explicit:e.explicit,value:n};if(Xa(r)||re(r))return{explicit:e.explicit,value:r};if(!Xa(n)&&!re(n)&&!Xa(r)&&!re(r))return{explicit:e.explicit,value:fL(n,r)};throw new Error("It should never reach here")}function nS(e){return`Invalid specification ${Ke(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Nbe='Autosize "fit" only works for single views and layered views.';function gL(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function pL(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function mL(e){return e?`Dropping "fit-${e}" because spec has discrete ${Pr(e)}.`:'Dropping "fit" because spec has discrete size.'}function rS(e){return`Unknown field for ${e}. Cannot calculate view size.`}function yL(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Rbe(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function jbe(e){return`The "nearest" transform is not supported for ${e} marks.`}function vL(e){return`Selection not supported for ${e} yet.`}function Lbe(e){return`Cannot find a selection named "${e}".`}const Pbe="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Ibe="Legend bindings are only supported for selections over an individual field or encoding channel.";function Bbe(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function zbe(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const Ube="The same selection must be used to override scale domains in a layered view.",qbe='Interval selections should be initialized using "x" and/or "y" keys.';function Hbe(e){return`Unknown repeated value "${e}".`}function bL(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const Wbe="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Gbe(e){return`Unrecognized parse "${e}".`}function xL(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const Ybe="Attempt to add the same child twice.";function Vbe(e){return`Ignoring an invalid transform: ${Ke(e)}.`}const Xbe='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function wL(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Kbe(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Ke(t)} is overridden by a child projection ${Ke(n)}.`}const Jbe="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Zbe(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Ke(n)}}.`}function _L(e){return`Invalid field type "${e}".`}function Qbe(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function exe(e){return`Invalid aggregation operator "${e}".`}function EL(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function txe(e){return`Position range does not support relative band size for ${e}.`}function iS(e,t){return`Dropping ${Ke(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const nxe="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function W1(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function rxe(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function ixe(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function oxe(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function axe(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function oS(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function sxe(e){return`The ${e} for range marks cannot be an expression`}function uxe(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function lxe(e,t){return`Specified orient "${e}" overridden with "${t}".`}function cxe(e){return`Cannot use the scale property "${e}" with non-color channel.`}function fxe(e){return`Cannot use the relative band size with ${e} scale.`}function dxe(e){return`Using unaggregated domain with raw field has no effect (${Ke(e)}).`}function hxe(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function gxe(e){return`Unaggregated domain is currently unsupported for log scale (${Ke(e)}).`}function pxe(e){return`Cannot apply size to non-oriented mark "${e}".`}function mxe(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function yxe(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function AL(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function $L(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function vxe(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ke(n)} and ${Ke(r)}). Using ${Ke(n)}.`}function bxe(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ke(n)} and ${Ke(r)}). Using the union of the two domains.`}function xxe(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function wxe(e){return`Dropping sort property ${Ke(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const SL="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",_xe="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Exe="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",Axe="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function $xe(e){return`Cannot stack "${e}" if there is already "${e}2".`}function Sxe(e){return`Cannot stack non-linear scale (${e}).`}function Cxe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function G1(e,t){return`Invalid ${e}: ${Ke(t)}.`}function Oxe(e){return`Dropping day from datetime ${Ke(e)} as day cannot be combined with other units.`}function Fxe(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function kxe(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Dxe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function CL(e){return`1D error band does not support ${e}.`}function OL(e){return`Channel ${e} is required for "binned" bin.`}function Mxe(e){return`Channel ${e} should not be used with "binned" bin.`}function Txe(e){return`Domain for ${e} is required for threshold scale.`}const FL=Gve(Rj);let fc=FL;function Nxe(e){return fc=e,fc}function Rxe(){return fc=FL,fc}function U(...e){fc.warn(...e)}function jxe(...e){fc.debug(...e)}function bu(e){if(e&&Ve(e)){for(const t of sS)if(t in e)return!0}return!1}const kL=["january","february","march","april","may","june","july","august","september","october","november","december"],Lxe=kL.map(e=>e.substr(0,3)),DL=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Pxe=DL.map(e=>e.substr(0,3));function Ixe(e){if(R1(e)&&(e=+e),yt(e))return e>4&&U(G1("quarter",e)),e-1;throw new Error(G1("quarter",e))}function Bxe(e){if(R1(e)&&(e=+e),yt(e))return e-1;{const t=e.toLowerCase(),n=kL.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=Lxe.indexOf(r);if(i!==-1)return i;throw new Error(G1("month",e))}}function zxe(e){if(R1(e)&&(e=+e),yt(e))return e%7;{const t=e.toLowerCase(),n=DL.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=Pxe.indexOf(r);if(i!==-1)return i;throw new Error(G1("day",e))}}function aS(e,t){const n=[];if(t&&e.day!==void 0&&z(e).length>1&&(U(Oxe(e)),e=de(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?Bxe(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?Ixe(e.quarter):e.quarter;n.push(yt(r)?r*3:`${r}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?zxe(e.day):e.day;n.push(yt(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i=="undefined"?0:i)}return n}function Ih(e){const n=aS(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Uxe(e){const n=aS(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function qxe(e){const t=aS(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}var Hxe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const ML={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},sS=z(ML);function Wxe(e){return!!ML[e]}function uS(e){return e.startsWith("utc")}function Gxe(e){return e.substr(3)}const Yxe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function lS(e){return sS.filter(t=>TL(e,t))}function TL(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Vxe(e,t,{end:n}={end:!1}){const r=G$(t),i=uS(e)?"utc":"";function o(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let a;const s={};for(const u of sS)TL(e,u)&&(s[u]=o(u),a=u);return n&&(s[a]+="+1"),Uxe(s)}function NL(e){if(!e)return;const t=lS(e);return`timeUnitSpecifier(${Ke(t)}, ${Ke(Yxe)})`}function Xxe(e,t,n){if(!e)return;const r=NL(e);return`${n||uS(e)?"utc":"time"}Format(${t}, ${r})`}function Dn(e){if(!e)return;let t;return fe(e)?t={unit:e}:Ve(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),uS(t.unit)&&(t.utc=!0,t.unit=Gxe(t.unit)),t}function Kxe(e){const t=Dn(e),{utc:n}=t,r=Hxe(t,["utc"]);return r.unit?(n?"utc":"")+z(r).map(i=>nt(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+z(r).map(i=>nt(`_${i}_${r[i]}`)).join("")}function Jxe(e){return e==null?void 0:e.param}function cS(e){return e&&!!e.field&&e.equal!==void 0}function fS(e){return e&&!!e.field&&e.lt!==void 0}function dS(e){return e&&!!e.field&&e.lte!==void 0}function hS(e){return e&&!!e.field&&e.gt!==void 0}function gS(e){return e&&!!e.field&&e.gte!==void 0}function pS(e){if(e==null?void 0:e.field){if(J(e.range)&&e.range.length===2)return!0;if(re(e.range))return!0}return!1}function mS(e){return e&&!!e.field&&(J(e.oneOf)||J(e.in))}function Zxe(e){return e&&!!e.field&&e.valid!==void 0}function RL(e){return mS(e)||cS(e)||pS(e)||fS(e)||hS(e)||dS(e)||gS(e)}function ao(e,t){return ly(e,{timeUnit:t,wrapTime:!0})}function Qxe(e,t){return e.map(n=>ao(n,t))}function jL(e,t=!0){var n;const{field:r}=e,i=(n=Dn(e.timeUnit))===null||n===void 0?void 0:n.unit,o=i?`time(${Vxe(i,r)})`:G(e,{expr:"datum"});if(cS(e))return`${o}===${ao(e.equal,i)}`;if(fS(e)){const a=e.lt;return`${o}<${ao(a,i)}`}else if(hS(e)){const a=e.gt;return`${o}>${ao(a,i)}`}else if(dS(e)){const a=e.lte;return`${o}<=${ao(a,i)}`}else if(gS(e)){const a=e.gte;return`${o}>=${ao(a,i)}`}else{if(mS(e))return`indexof([${Qxe(e.oneOf,i).join(",")}], ${o}) !== -1`;if(Zxe(e))return yS(o,e.valid);if(pS(e)){const{range:a}=e,s=re(a)?{signal:`${a.signal}[0]`}:a[0],u=re(a)?{signal:`${a.signal}[1]`}:a[1];if(s!==null&&u!==null&&t)return"inrange("+o+", ["+ao(s,i)+", "+ao(u,i)+"])";const l=[];return s!==null&&l.push(`${o} >= ${ao(s,i)}`),u!==null&&l.push(`${o} <= ${ao(u,i)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${Ke(e)}`)}function yS(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function e2e(e){var t;return RL(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Dn(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const Bh={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},xu=Bh.quantitative,vS=Bh.ordinal,dc=Bh.temporal,bS=Bh.nominal,hc=Bh.geojson;function t2e(e){if(e)switch(e=e.toLowerCase(),e){case"q":case xu:return"quantitative";case"t":case dc:return"temporal";case"o":case vS:return"ordinal";case"n":case bS:return"nominal";case hc:return"geojson"}}var n2e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const St={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},xS={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function r2e(e,t){const n=xS[e],r=xS[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const i2e={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function LL(e){return i2e[e]}const PL=["linear","log","pow","sqrt","symlog","time","utc"],o2e=du(PL),a2e=["linear","log","pow","sqrt","symlog"],s2e=du(a2e);function u2e(e){return e in s2e}const l2e=["quantile","quantize","threshold"],c2e=du(l2e),f2e=PL.concat(["quantile","quantize","threshold","sequential","identity"]),d2e=du(f2e),h2e=["ordinal","bin-ordinal","point","band"],g2e=du(h2e);function cn(e){return e in g2e}function br(e){return e in d2e}function hi(e){return e in o2e}function zh(e){return e in c2e}const p2e={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function m2e(e){return!fe(e)&&!!e.name}function IL(e){return e==null?void 0:e.param}function y2e(e){return e&&e.unionWith}function v2e(e){return se(e)&&"field"in e}const b2e={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},x2e=n2e(b2e,["type","domain","range","rangeMax","rangeMin","scheme"]),w2e=z(x2e);function wS(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return hi(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return hi(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return hi(e);case"nice":return hi(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return br(e)&&!ye(["log","time","utc","threshold","quantile"],e)}}function BL(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return cc(e)?void 0:cxe(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function _2e(e,t){return ye([vS,bS],t)?e===void 0||cn(e):t===dc?ye([St.TIME,St.UTC,void 0],e):t===xu?ye([St.LOG,St.POW,St.SQRT,St.SYMLOG,St.QUANTILE,St.QUANTIZE,St.THRESHOLD,St.LINEAR,void 0],e):!0}function E2e(e,t){if(!Ya(e))return!1;switch(e){case at:case $t:case fi:case Qi:return hi(t)||ye(["band","point"],t);case Wo:case qa:case Go:case za:case Ua:case gu:return hi(t)||zh(t)||ye(["band","point","ordinal"],t);case Xn:case no:case ro:return t!=="band";case Ha:case Kn:return t==="ordinal"||zh(t)}}const Mn={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},zL=Mn.arc,Y1=Mn.area,V1=Mn.bar,A2e=Mn.image,X1=Mn.line,K1=Mn.point,$2e=Mn.rect,J1=Mn.rule,UL=Mn.text,_S=Mn.tick,S2e=Mn.trail,ES=Mn.circle,AS=Mn.square,qL=Mn.geoshape;function Ja(e){return["line","area","trail"].includes(e)}function HL(e){return["rect","bar","image","arc"].includes(e)}const WL=z(Mn);function so(e){return e.type}du(WL);const C2e=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],O2e=["fill","fillOpacity"],F2e=[...C2e,...O2e],k2e={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},GL=z(k2e),D2e={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},M2e={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},T2e={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},YL=z(T2e);function gc(e){return e&&e.band!=null}const N2e={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},VL=5,R2e={binSpacing:1,continuousBandSize:VL,timeUnitBandPosition:.5},j2e={binSpacing:0,continuousBandSize:VL,timeUnitBandPosition:.5},L2e={thickness:1};function P2e(e){return so(e)?e.type:e}function $S(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:o}=e,a=KL(e);return Y(n)&&!tL(n.aggregate)&&i&&hi(i.get("type"))&&i.get("zero")===!1?XL({fieldDef:n,channel:t,markDef:r,ref:a,config:o}):a}function XL({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return Ja(n.type)||Be("invalid",n,i)===null?r:[I2e(e,t),r]}function I2e(e,t){const n=SS(e,!0),i=mu(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function SS(e,t=!0){return yS(fe(e)?e:G(e,{expr:"datum"}),!t)}function B2e(e){const{datum:t}=e;return bu(t)?Ih(t):`${Ke(t)}`}function wu(e,t,n,r){const i={};if(t&&(i.scale=t),Za(e)){const{datum:o}=e;bu(o)?i.signal=Ih(o):re(o)?i.signal=o.signal:Ph(o)?i.signal=o.expr:i.value=o}else i.field=G(e,n);if(r){const{offset:o,band:a}=r;o&&(i.offset=o),a&&(i.band=a)}return i}function Z1({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,bandPosition:o=.5}){const a=0<o&&o<1?"datum":void 0,s=G(t,{expr:a,suffix:i}),u=n!==void 0?G(n,{expr:a}):G(t,{suffix:"end",expr:a}),l={};if(o===0||o===1){l.scale=e;const c=o===0?s:u;l.field=c}else{const c=re(o)?`${o.signal} * ${s} + (1-${o.signal}) * ${u}`:`${o} * ${s} + ${1-o} * ${u}`;l.signal=`scale("${e}", ${c})`}return r&&(l.offset=r),l}function KL({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l,bandPosition:c}){var f;if(t){if(ue(t)){if(Ir(t)){c!=null||(c=uP({fieldDef:t,fieldDef2:n,markDef:r,config:i}));const{bin:h,timeUnit:g,type:p}=t;if(Je(h)||c&&g&&p===dc)return(s==null?void 0:s.impute)?wu(t,o,{binSuffix:"mid"},{offset:u}):c?Z1({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):wu(t,o,Hh(t,e)?{binSuffix:"range"}:{},{offset:u});if(kn(h)){if(Y(n))return Z1({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});U(OL(e===at?ci:Zi))}}const d=a==null?void 0:a.get("type");return wu(t,o,cn(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c!=null?c:t.bandPosition)!==null&&f!==void 0?f:.5:void 0})}else if(gi(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},Uh(e,d)),h)}}return Vve(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function Uh(e,t){return ye(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:ye(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:rt(t)}function _u(e){return e&&e!=="number"&&e!=="time"}function JL(e,t,n){return`${e}(${t}${n?`, ${Ke(n)}`:""})`}const z2e=" \u2013 ";function CS({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){var a,s;if(_u(n))return OS({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});const u=ZL(e,r,i);if(yc(e)){const l=q2e(u,Y(e)?(a=Dn(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0,t,o.timeFormat,Eu(e)&&((s=e.scale)===null||s===void 0?void 0:s.type)===St.UTC);return l?{signal:l}:void 0}if(t=tP(MS(e),t,o),Y(e)&&Je(e.bin)){const l=G(e,{expr:r,binSuffix:"end"});return{signal:Q1(u,l,t,n,o)}}else return t||MS(e)==="quantitative"?{signal:`${nP(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function ZL(e,t,n){return Y(e)?n?`${G(e,{expr:t,suffix:"end"})}-${G(e,{expr:t,suffix:"start"})}`:G(e,{expr:t}):B2e(e)}function OS({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:a}){if(a!=null||(a=ZL(e,r,i)),Y(e)&&Je(e.bin)){const s=G(e,{expr:r,binSuffix:"end"});return{signal:Q1(a,s,t,n,o)}}return{signal:JL(n,a,t)}}function QL(e,t,n,r,i,o){var a;if(!_u(r)){if(yc(e)){const s=Y(e)?(a=Dn(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0;return U2e(n,s,i,o)}return tP(t,n,i)}}function eP(e,t,n){if(e&&(re(e)||e==="number"||e==="time"))return e;if(yc(t)&&n!=="time"&&n!=="utc")return"time"}function tP(e,t,n){if(fe(t))return t;if(e===xu)return n.numberFormat}function U2e(e,t,n,r){return e||(t?{signal:NL(t)}:r?void 0:n.timeFormat)}function nP(e,t){return`format(${e}, "${t||""}")`}function rP(e,t,n,r){var i;return _u(n)?JL(n,e,t):nP(e,(i=fe(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function Q1(e,t,n,r,i){const o=rP(e,n,r,i),a=rP(t,n,r,i);return`${yS(e,!1)} ? "null" : ${o} + "${z2e}" + ${a}`}function q2e(e,t,n,r,i){return!t||n?(n=fe(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):Xxe(t,e,i)}const ey="min",H2e={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function iP(e){return e in H2e}function oP(e){return!!e&&!!e.encoding}function uo(e){return!!e&&(e.op==="count"||!!e.field)}function aP(e){return!!e&&J(e)}function qh(e){return"row"in e||"column"in e}function FS(e){return!!e&&"header"in e}function ty(e){return"facet"in e}var kS=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function W2e(e){return e.param}function G2e(e){return e&&!fe(e)&&"repeat"in e}function sP(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function DS(e){return"sort"in e}function uP({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(ue(e)&&e.bandPosition!==void 0)return e.bandPosition;if(Y(e)){const{timeUnit:i,bin:o}=e;if(i&&!t)return HL(n.type)?0:vu("timeUnitBandPosition",n,r);if(Je(o))return .5}}function lP({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:a}){var s,u,l;const c=Pr(e),f=Be(a?"size":c,r,i,{vgChannel:c});if(f!==void 0)return f;if(Y(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:vu("timeUnitBandSize",r,i)};if(Je(h)&&!cn(o))return{band:1}}if(HL(r.type))return o?cn(o)?((s=i[r.type])===null||s===void 0?void 0:s.discreteBandSize)||{band:1}:(u=i[r.type])===null||u===void 0?void 0:u.continuousBandSize:(l=i[r.type])===null||l===void 0?void 0:l.discreteBandSize}function cP(e,t,n,r){return Je(e.bin)||e.timeUnit&&Ir(e)&&e.type==="temporal"?uP({fieldDef:e,fieldDef2:t,markDef:n,config:r})!==void 0:!1}function ny(e){return e&&"condition"in e}function ry(e){const t=e&&e.condition;return!!t&&!J(t)&&Y(t)}function iy(e){const t=e&&e.condition;return!!t&&!J(t)&&ue(t)}function Y2e(e){const t=e&&e.condition;return!!t&&(J(t)||gi(t))}function Y(e){return e&&(!!e.field||e.aggregate==="count")}function MS(e){return e&&e.type}function Za(e){return e&&"datum"in e}function lo(e){return Ir(e)&&!oy(e)||TS(e)}function TS(e){return Za(e)&&yt(e.datum)}function ue(e){return Y(e)||Za(e)}function Ir(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function gi(e){return e&&"value"in e&&"value"in e}function Eu(e){return e&&("scale"in e||"sort"in e)}function NS(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function fP(e){return e&&"legend"in e}function dP(e){return e&&("format"in e||"formatType"in e)}function V2e(e){return yr(e,["legend","axis","header","scale"])}function X2e(e){return"op"in e}function G(e,t={}){var n,r,i;let o=e.field;const a=t.prefix;let s=t.suffix,u="";if(J2e(e))o=Hj("count");else{let l;if(!t.nofn)if(X2e(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Je(c)?(l=nL(c),s=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?Va(f)?(u=`["${o}"]`,o=`argmax_${f.argmax}`):Vo(f)?(u=`["${o}"]`,o=`argmin_${f.argmin}`):l=String(f):d&&(l=Kxe(d),s=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}l&&(o=o?`${l}_${o}`:l)}return s&&(o=`${o}_${s}`),a&&(o=`${a}_${o}`),t.forAs?Y$(o):t.expr?zj(o,t.expr)+u:Rr(o)+u}function oy(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Y(e)&&!!e.bin;case"temporal":return!1}throw new Error(_L(e.type))}function K2e(e){var t;return Eu(e)&&zh((t=e.scale)===null||t===void 0?void 0:t.type)}function J2e(e){return e.aggregate==="count"}function Z2e(e,t){var n;const{field:r,bin:i,timeUnit:o,aggregate:a}=e;if(a==="count")return t.countTitle;if(Je(i))return`${r} (binned)`;if(o){const s=(n=Dn(o))===null||n===void 0?void 0:n.unit;if(s)return`${r} (${lS(s).join("-")})`}else if(a)return Va(a)?`${r} for max ${a.argmax}`:Vo(a)?`${r} for min ${a.argmin}`:`${Mh(a)} of ${r}`;return r}function Q2e(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Va(t))return`${i} for argmax(${t.argmax})`;if(Vo(t))return`${i} for argmin(${t.argmin})`;const o=Dn(r),a=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||Je(n)&&"bin";return a?`${a.toUpperCase()}(${i})`:i}const hP=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Q2e(e);default:return Z2e(e,t)}};let gP=hP;function pP(e){gP=e}function ewe(){pP(hP)}function pc(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,o;const a=(i=RS(e))===null||i===void 0?void 0:i.title;if(!Y(e))return a;const s=e,u=r?jS(s,t):void 0;return n?vt(a,s.title,u):(o=a!=null?a:s.title)!==null&&o!==void 0?o:u}function RS(e){if(NS(e)&&e.axis)return e.axis;if(fP(e)&&e.legend)return e.legend;if(FS(e)&&e.header)return e.header}function jS(e,t){return gP(e,t)}function ay(e){var t;if(dP(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}else{const n=(t=RS(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function twe(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(DS(e)&&J(e.sort))return"ordinal";const{aggregate:r,bin:i,timeUnit:o}=e;if(o)return"temporal";if(i||r&&!Va(r)&&!Vo(r))return"quantitative";if(Eu(e)&&((n=e.scale)===null||n===void 0?void 0:n.type))switch(xS[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function co(e){if(Y(e))return e;if(ry(e))return e.condition}function Ct(e){if(ue(e))return e;if(iy(e))return e.condition}function mP(e,t,n,r={}){if(fe(e)||yt(e)||Fh(e)){const i=fe(e)?"string":yt(e)?"number":"boolean";return U(Zbe(t,i,e)),{value:e}}return ue(e)?sy(e,t,n,r):iy(e)?Object.assign(Object.assign({},e),{condition:sy(e.condition,t,n,r)}):e}function sy(e,t,n,r){if(dP(e)){const{format:i,formatType:o}=e,a=kS(e,["format","formatType"]);if(_u(o)&&!n.customFormatTypes)return U(wL(t)),sy(a,t,n,r)}else{const i=NS(e)?"axis":fP(e)?"legend":FS(e)?"header":null;if(i&&e[i]){const o=e[i],{format:a,formatType:s}=o,u=kS(o,["format","formatType"]);if(_u(s)&&!n.customFormatTypes)return U(wL(t)),sy(Object.assign(Object.assign({},e),{[i]:u}),t,n,r)}}return Y(e)?LS(e,t,r):nwe(e)}function nwe(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=yt(n)?"quantitative":fe(n)?"nominal":bu(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function LS(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:a}=e,s=Object.assign({},e);if(!n&&r&&!Q$(r)&&!Va(r)&&!Vo(r)&&(U(exe(r)),delete s.aggregate),i&&(s.timeUnit=Dn(i)),a&&(s.field=`${a}`),Je(o)&&(s.bin=uy(o,t)),kn(o)&&!oo(t)&&U(Mxe(t)),Ir(s)){const{type:u}=s,l=t2e(u);u!==l&&(s.type=l),u!=="quantitative"&&tL(r)&&(U(Qbe(u,r)),s.type="quantitative")}else if(!Jj(t)){const u=twe(s,t);s.type=u}if(Ir(s)){const{compatible:u,warning:l}=rwe(s,t)||{};u===!1&&U(l)}if(DS(s)&&fe(s.sort)){const{sort:u}=s;if(iP(u))return Object.assign(Object.assign({},s),{sort:{encoding:u}});const l=u.substr(1);if(u.charAt(0)==="-"&&iP(l))return Object.assign(Object.assign({},s),{sort:{encoding:l,order:"descending"}})}if(FS(s)){const{header:u}=s;if(u){const{orient:l}=u,c=kS(u,["orient"]);if(l)return Object.assign(Object.assign({},s),{header:Object.assign(Object.assign({},c),{labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l})})}}return s}function uy(e,t){return Fh(e)?{maxbins:rL(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:rL(t)}):e}const mc={compatible:!0};function rwe(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case zo:case Uo:case j1:return oy(e)?mc:{compatible:!1,warning:ixe(t)};case at:case $t:case Xn:case no:case ro:case Rh:case Lh:case L1:case pu:case P1:case I1:case gu:case fi:case Qi:case B1:return mc;case to:case jr:case eo:case di:return n!==xu?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:mc;case Go:case za:case Ua:case qa:case Wo:case Ho:case qo:case ci:case Zi:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:mc;case Kn:case Ha:return!oy(e)&&!K2e(e)?{compatible:!1,warning:oxe(t)}:mc;case jh:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:mc}}function yc(e){const{formatType:t}=ay(e);return t==="time"||!t&&iwe(e)}function iwe(e){return e&&(e.type==="temporal"||Y(e)&&!!e.timeUnit)}function ly(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var o;const a=t&&((o=Dn(t))===null||o===void 0?void 0:o.unit);let s=a||n==="temporal",u;return Ph(e)?u=e.expr:re(e)?u=e.signal:bu(e)?(s=!0,u=Ih(e)):(fe(e)||yt(e))&&s&&(u=`datetime(${Ke(e)})`,Wxe(a)&&(yt(e)&&e<1e4||fe(e)&&isNaN(Date.parse(e)))&&(u=Ih({[a]:e}))),u?r&&s?`time(${u})`:u:i?void 0:Ke(e)}function yP(e,t){const{type:n}=e;return t.map(r=>{const i=ly(r,{timeUnit:Y(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function Hh(e,t){return Je(e.bin)?Ya(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const vP={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Wh(e){return e&&e.condition}const bP=["domain","grid","labels","ticks","title"],owe={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},xP={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},awe=Object.assign(Object.assign({},xP),{style:1,labelExpr:1,encoding:1});function wP(e){return!!awe[e]}const swe={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},_P=z(swe);function Jo(e){return"mark"in e}class cy{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Jo(t)?P2e(t.mark)===this.name:!1}}var uwe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Au(e,t){const n=e&&e[t];return n?J(n)?uc(n,r=>!!r.field):Y(n)||ry(n):!1}function PS(e){return uc(abe,t=>{if(Au(e,t)){const n=e[t];if(J(n))return uc(n,r=>!!r.aggregate);{const r=co(n);return r&&!!r.aggregate}}return!1})}function EP(e,t){const n=[],r=[],i=[],o=[],a={};return IS(e,(s,u)=>{if(Y(s)){const{field:l,aggregate:c,bin:f,timeUnit:d}=s,h=uwe(s,["field","aggregate","bin","timeUnit"]);if(c||d||f){const g=RS(s),p=g==null?void 0:g.title;let m=G(s,{forAs:!0});const y=Object.assign(Object.assign(Object.assign({},p?[]:{title:pc(s,t,{allowDisabling:!0})}),h),{field:m});if(c){let v;if(Va(c)?(v="argmax",m=G({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${l}`):Vo(c)?(v="argmin",m=G({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const b={op:v,as:m};l&&(b.field=l),o.push(b)}}else if(n.push(m),Ir(s)&&Je(f)){if(r.push({bin:f,field:l,as:m}),n.push(G(s,{binSuffix:"end"})),Hh(s,u)&&n.push(G(s,{binSuffix:"range"})),oo(u)){const v={field:`${m}_end`};a[`${u}2`]=v}y.bin="binned",Jj(u)||(y.type=xu)}else if(d){i.push({timeUnit:d,field:l,as:m});const v=Ir(s)&&s.type!==dc&&"time";v&&(u===Rh||u===pu?y.formatType=v:pbe(u)?y.legend=Object.assign({formatType:v},y.legend):oo(u)&&(y.axis=Object.assign({formatType:v},y.axis)))}a[u]=y}else n.push(l),a[u]=e[u]}else a[u]=e[u]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function lwe(e,t,n){const r=ybe(t,n);if(r){if(r==="binned"){const i=e[t===ci?at:$t];return!!(Y(i)&&Y(e[t])&&kn(i.bin))}}else return!1;return!0}function cwe(e,t,n,r){return z(e).reduce((i,o)=>{if(!Kj(o))return U(rxe(o)),i;const a=e[o];if(o==="angle"&&t==="arc"&&!e.theta&&(U(Jbe),o=fi),!lwe(e,o,t))return U(W1(o,t)),i;if(o===Wo&&t==="line"){const s=co(e[o]);if(s==null?void 0:s.aggregate)return U(nxe),i}if(o===Xn&&(n?"fill"in e:"stroke"in e))return U(EL("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(o===Lh||o===jh&&!J(a)&&!gi(a)||o===pu&&J(a))a&&(i[o]=ft(a).reduce((s,u)=>(Y(u)?s.push(LS(u,o)):U(iS(u,o)),s),[]));else{if(o===pu&&a===null)i[o]=null;else if(!Y(a)&&!Za(a)&&!gi(a)&&!ny(a)&&!re(a))return U(iS(a,o)),i;i[o]=mP(a,o,r)}return i},{})}function fy(e,t){const n={};for(const r of z(e)){const i=mP(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function fwe(e){const t=[];for(const n of z(e))if(Au(e,n)){const r=e[n],i=ft(r);for(const o of i)Y(o)?t.push(o):ry(o)&&t.push(o.condition)}return t}function IS(e,t,n){if(!!e)for(const r of z(e)){const i=e[r];if(J(i))for(const o of i)t.call(n,o,r);else t.call(n,i,r)}}function dwe(e,t,n,r){return e?z(e).reduce((i,o)=>{const a=e[o];return J(a)?a.reduce((s,u)=>t.call(r,s,u,o),i):t.call(r,i,a,o)},n):n}function AP(e,t){return z(t).reduce((n,r)=>{switch(r){case at:case $t:case P1:case B1:case I1:case ci:case Zi:case fi:case Ho:case Qi:case qo:case eo:case to:case di:case jr:case Rh:case Kn:case gu:case pu:return n;case jh:if(e==="line"||e==="trail")return n;case Lh:case L1:{const i=t[r];if(J(i)||Y(i))for(const o of ft(i))o.aggregate||n.push(G(o,{}));return n}case Wo:if(e==="trail")return n;case Xn:case no:case ro:case Go:case za:case Ua:case Ha:case qa:{const i=co(t[r]);return i&&!i.aggregate&&n.push(G(i,{})),n}}},[])}var $P=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function hwe(e){const{tooltip:t}=e,n=$P(e,["tooltip"]);if(!t)return{filteredEncoding:n};let r,i;if(J(t)){for(const o of t)o.aggregate?(r||(r=[]),r.push(o)):(i||(i=[]),i.push(o));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return J(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function BS(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};const i=e.map(({fieldPrefix:a,titlePrefix:s})=>{const u=r?` of ${zS(t)}`:"";return{field:a+t.field,type:t.type,title:re(s)?{signal:`${s}"${escape(u)}"`}:s+u}}),o=fwe(n).map(V2e);return{tooltip:[...i,...Ji(o,Ee)]}}function zS(e){const{title:t,field:n}=e;return vt(t,n)}function US(e,t,n,r,i){const{scale:o,axis:a}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=zS(n);return SP(e,s,i,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${l}_${n.field}`,type:n.type},d!==void 0?{title:d}:{}),o!==void 0?{scale:o}:{}),a!==void 0?{axis:a}:{})},fe(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),r),f)})}}function SP(e,t,n,r){const{clip:i,color:o,opacity:a}=e,s=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),o?{color:o}:{}),a?{opacity:a}:{}),so(r.mark)?r.mark:{type:r.mark}),{style:`${s}-${t}`}),Fh(e[t])?{}:e[t])})]:[]}function CP(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",o=r[i],a=r[`${i}2`],s=r[`${i}Error`],u=r[`${i}Error2`];return{continuousAxisChannelDef:dy(o,n),continuousAxisChannelDef2:dy(a,n),continuousAxisChannelDefError:dy(s,n),continuousAxisChannelDefError2:dy(u,n),continuousAxis:i}}function dy(e,t){if(e==null?void 0:e.aggregate){const{aggregate:n}=e,r=$P(e,["aggregate"]);return n!==t&&U(Dxe(n,t)),r}else return e}function OP(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(so(n)&&n.orient)return n.orient;if(lo(i)){if(lo(o)){const a=Y(i)&&i.aggregate,s=Y(o)&&o.aggregate;if(!a&&s===t)return"vertical";if(!s&&a===t)return"horizontal";if(a===t&&s===t)throw new Error("Both x and y cannot have aggregate");return yc(o)&&!yc(i)?"horizontal":"vertical"}return"horizontal"}else{if(lo(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}var hy=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const gy="boxplot",gwe=["box","median","outliers","rule","ticks"],pwe=new cy(gy,kP);function FP(e){return yt(e)?"tukey":e}function kP(e,{config:t}){var n,r;e=Object.assign(Object.assign({},e),{encoding:fy(e.encoding,t)});const{mark:i,encoding:o,params:a,projection:s}=e,u=hy(e,["mark","encoding","params","projection"]),l=so(i)?i:{type:i};a&&U(vL("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Be("size",l,t),d=FP(c),{bins:h,timeUnits:g,transform:p,continuousAxisChannelDef:m,continuousAxis:y,groupby:v,aggregate:b,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:E,customTooltipWithoutAggregatedField:_}=mwe(e,c,t),{color:$,size:C}=x,O=hy(x,["color","size"]),A=we=>US(l,y,m,we,t.boxplot),D=A(O),F=A(x),T=A(Object.assign(Object.assign({},O),C?{size:C}:{})),S=BS([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],m,x),M={type:"tick",color:"black",opacity:1,orient:w,invalid:null,aria:!1},P=d==="min-max"?S:BS([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,x),B=[...D({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:P}),...D({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:P}),...D({partName:"ticks",mark:M,positionPrefix:"lower_whisker",extraEncoding:P}),...D({partName:"ticks",mark:M,positionPrefix:"upper_whisker",extraEncoding:P})],H=[...d!=="tukey"?B:[],...F({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:E,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:S}),...T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Ve(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:w,aria:!1}),positionPrefix:"mid_box",extraEncoding:S})];if(d==="min-max")return Object.assign(Object.assign({},u),{transform:((r=u.transform)!==null&&r!==void 0?r:[]).concat(p),layer:H});const ie=`datum["lower_box_${m.field}"]`,le=`datum["upper_box_${m.field}"]`,he=`(${le} - ${ie})`,Ae=`${ie} - ${c} * ${he}`,$e=`${le} + ${c} * ${he}`,Pe=`datum["${m.field}"]`,It={joinaggregate:DP(m.field),groupby:v},tr={transform:[{filter:`(${Ae} <= ${Pe}) && (${Pe} <= ${$e})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...b],groupby:v}],layer:B},Nn=hy(O,["tooltip"]),{scale:R,axis:W}=m,V=zS(m),k=yr(W,["title"]),xe=SP(l,"outliers",t.boxplot,{transform:[{filter:`(${Pe} < ${Ae}) || (${Pe} > ${$e})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[y]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},V!==void 0?{title:V}:{}),R!==void 0?{scale:R}:{}),We(k)?{}:{axis:k})},Nn),$?{color:$}:{}),_?{tooltip:_}:{})})[0];let X;const Oe=[...h,...g,It];return xe?X={transform:Oe,layer:[xe,tr]}:(X=tr,X.transform.unshift(...Oe)),Object.assign(Object.assign({},u),{layer:[X,{transform:p,layer:H}]})}function DP(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function mwe(e,t,n){const r=OP(e,gy),{continuousAxisChannelDef:i,continuousAxis:o}=CP(e,r,gy),a=i.field,s=FP(t),u=[...DP(a),{op:"median",field:a,as:`mid_box_${a}`},{op:"min",field:a,as:(s==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:a,as:(s==="min-max"?"upper_whisker_":"max_")+a}],l=s==="min-max"||s==="tukey"?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],c=e.encoding,f=o;c[f];const d=hy(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:g}=hwe(d),{bins:p,timeUnits:m,aggregate:y,groupby:v,encoding:b}=EP(g,n),x=r==="vertical"?"horizontal":"vertical",w=r,E=[...p,...m,{aggregate:[...y,...u],groupby:v},...l];return{bins:p,timeUnits:m,transform:E,groupby:v,aggregate:y,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:h}}var MP=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const qS="errorbar",ywe=["ticks","rule"],vwe=new cy(qS,TP);function TP(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:fy(e.encoding,t)});const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:a,markDef:s,outerSpec:u,tooltipEncoding:l}=NP(e,qS,t);delete o.size;const c=US(s,i,r,o,t.errorbar),f=s.thickness,d=s.size,h=Object.assign(Object.assign({type:"tick",orient:a,aria:!1},f!==void 0?{thickness:f}:{}),d!==void 0?{size:d}:{}),g=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},f!==void 0?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),g.length>1?{layer:g}:Object.assign({},g[0]))}function bwe(e,t){const{encoding:n}=e;if(xwe(n))return{orient:OP(e,t),inputType:"raw"};const r=wwe(n),i=_we(n),o=n.x,a=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=n.x2,u=n.y2;if(ue(s)&&ue(u))throw new Error(`${t} cannot have both x2 and y2`);if(ue(s)){if(lo(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(ue(u)){if(lo(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const s=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(ue(u)&&!ue(s))throw new Error(`${t} cannot have xError2 without xError`);if(ue(c)&&!ue(l))throw new Error(`${t} cannot have yError2 without yError`);if(ue(s)&&ue(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(ue(s)){if(lo(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(ue(l)){if(lo(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function xwe(e){return(ue(e.x)||ue(e.y))&&!ue(e.x2)&&!ue(e.y2)&&!ue(e.xError)&&!ue(e.xError2)&&!ue(e.yError)&&!ue(e.yError2)}function wwe(e){return ue(e.x2)||ue(e.y2)}function _we(e){return ue(e.xError)||ue(e.xError2)||ue(e.yError)||ue(e.yError2)}function NP(e,t,n){var r;const{mark:i,encoding:o,params:a,projection:s}=e,u=MP(e,["mark","encoding","params","projection"]),l=so(i)?i:{type:i};a&&U(vL(t));const{orient:c,inputType:f}=bwe(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:g,continuousAxisChannelDefError2:p,continuousAxis:m}=CP(e,c,t),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:b,tooltipTitleWithFieldName:x}=Ewe(l,d,h,g,p,f,t,n),w=o,E=m;w[E];const _=m==="x"?"x2":"y2";w[_];const $=m==="x"?"xError":"yError";w[$];const C=m==="x"?"xError2":"yError2";w[C];const O=MP(w,[typeof E=="symbol"?E:E+"",typeof _=="symbol"?_:_+"",typeof $=="symbol"?$:$+"",typeof C=="symbol"?C:C+""]),{bins:A,timeUnits:D,aggregate:F,groupby:T,encoding:S}=EP(O,n),M=[...F,...y],P=f!=="raw"?[]:T,B=BS(b,d,S,x);return{transform:[...(r=u.transform)!==null&&r!==void 0?r:[],...A,...D,...M.length===0?[]:[{aggregate:M,groupby:P}],...v],groupby:P,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:S,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:B}}function Ewe(e,t,n,r,i,o,a,s){let u=[],l=[];const c=t.field;let f,d=!1;if(o==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center,g=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(g==="iqr")&&U(kxe(h,g,a)),g==="stderr"||g==="stdev")u=[{op:g,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:Mh(h)},{fieldPrefix:"upper_",titlePrefix:RP(h,g,"+")},{fieldPrefix:"lower_",titlePrefix:RP(h,g,"-")}],d=!0;else{let p,m,y;g==="ci"?(p="mean",m="ci0",y="ci1"):(p="median",m="q1",y="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:p,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:pc({field:c,aggregate:y,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:pc({field:c,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:pc({field:c,aggregate:p,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&U(Fxe(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:hu(hu(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function RP(e,t,n){return`${Mh(e)} ${n} ${t}`}const HS="errorband",Awe=["band","borders"],$we=new cy(HS,jP);function jP(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:fy(e.encoding,t)});const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:a,outerSpec:s,tooltipEncoding:u}=NP(e,HS,t),l=a,c=US(l,i,r,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const g=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),g),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign(Object.assign({},h),g),{aria:!1})):l.interpolate?U(CL("interpolate")):l.tension&&U(CL("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]})}const LP={};function WS(e,t,n){const r=new cy(e,t);LP[e]={normalizer:r,parts:n}}function Swe(){return z(LP)}WS(gy,kP,gwe);WS(qS,TP,ywe);WS(HS,jP,Awe);const Cwe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],PP={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},IP={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Owe=z(PP),Fwe=z(IP),kwe={header:1,headerRow:1,headerColumn:1,headerFacet:1},BP=z(kwe),zP=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Dwe={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},Mwe={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Gh="_vgsid_",Twe={point:{on:"click",fields:[Gh],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function GS(e){return!!e&&(e==="legend"||!!e.legend)}function YS(e){return GS(e)&&Ve(e)}function VS(e){return!!e.select}var Nwe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function UP(e){const t=[];for(const n of e||[]){if(VS(n))continue;const{expr:r,bind:i}=n,o=Nwe(n,["expr","bind"]);if(i&&r){const a=Object.assign(Object.assign({},o),{bind:i,init:r});t.push(a)}else{const a=Object.assign(Object.assign(Object.assign({},o),r?{update:r}:{}),i?{bind:i}:{});t.push(a)}}return t}function Rwe(e){return py(e)||KS(e)||XS(e)}function XS(e){return"concat"in e}function py(e){return"vconcat"in e}function KS(e){return"hconcat"in e}function fo(e){return Ve(e)&&e.step!==void 0}function qP(e){return e.view||e.width||e.height}const HP=20,jwe={align:1,bounds:1,center:1,columns:1,spacing:1},Lwe=z(jwe);function Pwe(e,t,n){var r,i;const o=n[t],a={},{spacing:s,columns:u}=o;s!==void 0&&(a.spacing=s),u!==void 0&&(ty(e)&&!qh(e.facet)||XS(e))&&(a.columns=u),py(e)&&(a.columns=1);for(const l of Lwe)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];a[l]=yt(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:s,column:(i=c.column)!==null&&i!==void 0?i:s}}else a[l]=e[l];return a}var Iwe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function JS(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function my(e,t){const n=Yh(e,t);return fo(n)?n.step:WP}function Yh(e,t){var n;const r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return vt(r,{step:e.step})}const WP=20,Bwe={continuousWidth:200,continuousHeight:200,step:WP},zwe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Bwe,mark:M2e,arc:{},area:{},bar:R2e,circle:{},geoshape:{},image:{},line:{},point:{},rect:j2e,rule:{color:"black"},square:{},text:{color:"black"},tick:L2e,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:p2e,projection:{},legend:Dwe,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Twe,style:{},title:{},facet:{spacing:HP},concat:{spacing:HP}},Zo=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],GP={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},YP={blue:Zo[0],orange:Zo[1],red:Zo[2],teal:Zo[3],green:Zo[4],yellow:Zo[5],purple:Zo[6],pink:Zo[7],brown:Zo[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Uwe(e={}){return{signals:[{name:"color",value:Ve(e)?Object.assign(Object.assign({},YP),e):YP}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function qwe(e){return{signals:[{name:"fontSize",value:Ve(e)?Object.assign(Object.assign({},GP),e):GP}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Hwe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function VP(e){const t=z(e||{}),n={};for(const r of t){const i=e[r];n[r]=Wh(i)?oL(i):vr(i)}return n}function Wwe(e){const t=z(e),n={};for(const r of t)n[r]=VP(e[r]);return n}const Gwe=[...YL,..._P,...BP,"background","padding","legend","lineBreak","scale","style","title","view"];function XP(e={}){const{color:t,font:n,fontSize:r,selection:i}=e,o=Iwe(e,["color","font","fontSize","selection"]),a=Lj({},de(zwe),n?Hwe(n):{},t?Uwe(t):{},r?qwe(r):{},o||{});i&&ef(a,"selection",i,!0);const s=yr(a,Gwe);for(const u of["background","lineBreak","padding"])a[u]&&(s[u]=vr(a[u]));for(const u of YL)a[u]&&(s[u]=Jn(a[u]));for(const u of _P)a[u]&&(s[u]=VP(a[u]));for(const u of BP)a[u]&&(s[u]=Jn(a[u]));return a.legend&&(s.legend=Jn(a.legend)),a.scale&&(s.scale=Jn(a.scale)),a.style&&(s.style=Wwe(a.style)),a.title&&(s.title=Jn(a.title)),a.view&&(s.view=Jn(a.view)),s}const Ywe=["view",...WL],Vwe=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Xwe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},D2e);function Kwe(e){e=de(e);for(const t of Vwe)delete e[t];if(e.axis)for(const t in e.axis)Wh(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of Cwe)delete e.legend[t];if(e.mark){for(const t of GL)delete e.mark[t];e.mark.tooltip&&Ve(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(UP(e.params)),delete e.params);for(const t of Ywe){for(const r of GL)delete e[t][r];const n=Xwe[t];if(n)for(const r of n)delete e[t][r];Zwe(e,t)}for(const t of Swe())delete e[t];Jwe(e);for(const t in e)Ve(e[t])&&We(e[t])&&delete e[t];return We(e)?void 0:e}function Jwe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=iL(e.title);We(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),We(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),We(r)?delete e.title:e.title=r}function Zwe(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const o=Object.assign(Object.assign({},i),e.style[n!=null?n:t]);We(o)||(e.style[n!=null?n:t]=o),r||delete e[t]}function yy(e){return"layer"in e}function Qwe(e){return"repeat"in e}function e_e(e){return!J(e.repeat)&&e.repeat.layer}var t_e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class ZS{map(t,n){return ty(t)?this.mapFacet(t,n):Qwe(t)?this.mapRepeat(t,n):KS(t)?this.mapHConcat(t,n):py(t)?this.mapVConcat(t,n):XS(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(yy(t))return this.mapLayer(t,n);if(Jo(t))return this.mapUnit(t,n);throw new Error(nS(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=t_e(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(o=>this.map(o,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const n_e={zero:1,center:1,normalize:1};function r_e(e){return e in n_e}const i_e=new Set([zL,V1,Y1,J1,K1,ES,AS,X1,UL,_S]),o_e=new Set([V1,Y1,zL]);function vc(e){return Y(e)&&MS(e)==="quantitative"&&!e.bin}function KP(e,t){var n,r;const i=t==="x"?"y":"radius",o=e[t],a=e[i];if(Y(o)&&Y(a))if(vc(o)&&vc(a)){if(o.stack)return t;if(a.stack)return i;const s=Y(o)&&!!o.aggregate,u=Y(a)&&!!a.aggregate;if(s!==u)return s?t:i;{const l=(n=o.scale)===null||n===void 0?void 0:n.type,c=(r=a.scale)===null||r===void 0?void 0:r.type;if(l&&l!=="linear")return i;if(c&&c!=="linear")return t}}else{if(vc(o))return t;if(vc(a))return i}else{if(vc(o))return t;if(vc(a))return i}}function a_e(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function JP(e,t,n={}){var r,i;const o=so(e)?e.type:e;if(!i_e.has(o))return null;const a=KP(t,"x")||KP(t,"theta");if(!a)return null;const s=t[a],u=Y(s)?G(s,{}):void 0;let l=a_e(a),c=t[l],f=Y(c)?G(c,{}):void 0;f===u&&(f=void 0,c=void 0,l=void 0);const d=dbe.reduce((g,p)=>{if(p!=="tooltip"&&Au(t,p)){const m=t[p];for(const y of ft(m)){const v=co(y);if(v.aggregate)continue;const b=G(v,{});(!b||b!==f)&&g.push({channel:p,fieldDef:v})}}return g},[]);let h;if(s.stack!==void 0?Fh(s.stack)?h=s.stack?"zero":null:h=s.stack:o_e.has(o)&&(h="zero"),!h||!r_e(h)||PS(t)&&d.length===0)return null;if(((r=s==null?void 0:s.scale)===null||r===void 0?void 0:r.type)&&((i=s==null?void 0:s.scale)===null||i===void 0?void 0:i.type)!==St.LINEAR){if(n.disallowNonLinearStack)return null;U(Sxe(s.scale.type))}return ue(t[Yo(a)])?(s.stack!==void 0&&U($xe(a)),null):(Y(s)&&s.aggregate&&!ye(Abe,s.aggregate)&&U(Cxe(s.aggregate)),{groupbyChannel:c?l:void 0,groupbyField:f,fieldChannel:a,impute:s.impute===null?!1:Ja(o),stackBy:d,offset:h})}var ZP=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function s_e(e){const t=ZP(e,["point","line"]);return z(t).length>1?t:t.type}function u_e(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:yr(e[t],["point","line"])}));return e}function QS(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Ve(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Ve(t.point)?t.point:{}:void 0}function QP(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class l_e{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Jo(t)){const{mark:r,encoding:i}=t,o=so(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!QS(o,n[o.type],i);case"area":return!!QS(o,n[o.type],i)||!!QP(o,n[o.type])}}return!1}run(t,n,r){const{config:i}=n,{params:o,projection:a,mark:s,encoding:u}=t,l=ZP(t,["params","projection","mark","encoding"]),c=fy(u,i),f=so(s)?s:{type:s},d=QS(f,i[f.type],c),h=f.type==="area"&&QP(f,i[f.type]),g=[Object.assign(Object.assign({},o?{params:o}:{}),{mark:s_e(Object.assign(Object.assign({},f.type==="area"&&f.opacity===void 0&&f.fillOpacity===void 0?{opacity:.7}:{}),f)),encoding:yr(c,["shape"])})],p=JP(f,c);let m=c;if(p){const{fieldChannel:y,offset:v}=p;m=Object.assign(Object.assign({},c),{[y]:Object.assign(Object.assign({},c[y]),v?{stack:v}:{})})}return h&&g.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},sc(f,["clip","interpolate","tension","tooltip"])),h),encoding:m})),d&&g.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},sc(f,["clip","tooltip"])),d),encoding:m})),r(Object.assign(Object.assign({},l),{layer:g}),Object.assign(Object.assign({},n),{config:u_e(i)}))}}var c_e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function f_e(e,t){return t?qh(e)?rI(e,t):eI(e,t):e}function eC(e,t){return t?rI(e,t):e}function tC(e,t,n){const r=t[e];if(G2e(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});U(Hbe(r.repeat));return}return t}function eI(e,t){if(e=tC("field",e,t),e!==void 0){if(e===null)return null;if(DS(e)&&uo(e.sort)){const n=tC("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function tI(e,t){if(Y(e))return eI(e,t);{const n=tC("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function nI(e,t){if(ue(e)){const n=tI(e,t);if(n)return n;if(ny(e))return{condition:e.condition}}else{if(iy(e)){const n=tI(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):c_e(e,["condition"])}return e}}function rI(e,t){const n={};for(const r in e)if(oc(e,r)){const i=e[r];if(J(i))n[r]=i.map(o=>nI(o,t)).filter(o=>o);else{const o=nI(i,t);o!==void 0&&(n[r]=o)}}return n}class d_e{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Jo(t)){const{encoding:n,mark:r}=t;if(r==="line"||so(r)&&r.type==="line")for(const i of cbe){const o=mu(i),a=n[o];if(n[i]&&(Y(a)&&!kn(a.bin)||Za(a)))return!0}}return!1}run(t,n,r){const{encoding:i,mark:o}=t;return U(uxe(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:Ve(o)?Object.assign(Object.assign({},o),{type:"rule"}):"rule"}),n)}}var Qa=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class h_e extends ZS{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[pwe,vwe,$we,new l_e,new d_e]}map(t,n){if(Jo(t)){const r=Au(t.encoding,zo),i=Au(t.encoding,Uo),o=Au(t.encoding,j1);if(r||i||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,o=eC(t.encoding,n.repeater),a=Object.assign(Object.assign({},t),o?{encoding:o}:{});if(r||i)return this.mapUnitWithParentEncodingOrProjection(a,n);const s=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(a,n.config))return u.run(a,n,s);return a}mapRepeat(t,n){return e_e(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,o=Qa(t,["repeat","spec"]),{row:a,column:s,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return a||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},a?{row:a}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:i}}),n):Object.assign(Object.assign({},o),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=`${(i.name||"")+c}child__layer_${nt(f)}`,g=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return g.name=h,g})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:o,data:a}=t,s=Qa(t,["repeat","spec","data"]);!J(i)&&t.columns&&(t=yr(t,["columns"]),U(bL("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!J(i)&&i.row||[l?l.row:null],d=!J(i)&&i.column||[l?l.column:null],h=J(i)&&i||[l?l.repeat:null];for(const p of h)for(const m of f)for(const y of d){const v={repeat:p,row:m,column:y,layer:l.layer},b=(o.name||"")+c+"child__"+(J(i)?`${nt(p)}`:(i.row?`row_${nt(m)}`:"")+(i.column?`column_${nt(y)}`:"")),x=this.map(o,Object.assign(Object.assign({},n),{repeater:v,repeaterPrefix:b}));x.name=b,u.push(yr(x,["data"]))}const g=J(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=o.data)!==null&&r!==void 0?r:a,align:"all"},s),{columns:g,concat:u})}mapFacet(t,n){const{facet:r}=t;return qh(r)&&t.columns&&(t=yr(t,["columns"]),U(bL("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:o,parentProjection:a,config:s}=n,u=oI({parentProjection:a,projection:i}),l=iI({parentEncoding:o,encoding:eC(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:o,facet:a}=r,s=Qa(r,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,params:h,encoding:g}=t,p=Qa(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:m,layout:y}=this.getFacetMappingAndLayout({row:i,column:o,facet:a},n),v=eC(s,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),y),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:v}),h?{params:h}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:o,facet:a}=t;if(i||o){a&&U(axe([...i?[zo]:[],...o?[Uo]:[]]));const s={},u={};for(const l of[zo,Uo]){const c=t[l];if(c){const f=Qa(c,["align","center","spacing","columns"]);s[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&((r=u[d])!==null&&r!==void 0||(u[d]={}),u[d][l]=c[d])}}return{facetMapping:s,layout:u}}else{const{align:s,center:u,spacing:l,columns:c}=a,f=Qa(a,["align","center","spacing","columns"]);return{facetMapping:f_e(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},s?{align:s}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,o=Qa(n,["parentEncoding","parentProjection"]);const{encoding:a,projection:s}=t,u=Qa(t,["encoding","projection"]),l=Object.assign(Object.assign({},o),{parentEncoding:iI({parentEncoding:r,encoding:a,layer:!0}),parentProjection:oI({parentProjection:i,projection:s})});return super.mapLayer(u,l)}}function iI({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){const i=new Set([...z(e),...z(t)]);for(const o of i){const a=t[o],s=e[o];if(ue(a)){const u=Object.assign(Object.assign({},s),a);r[o]=u}else iy(a)?r[o]=Object.assign(Object.assign({},a),{condition:Object.assign(Object.assign({},s),a.condition)}):a||a===null?r[o]=a:(n||gi(s)||re(s)||ue(s)||J(s))&&(r[o]=s)}}else r=t;return!r||We(r)?void 0:r}function oI(e){const{parentProjection:t,projection:n}=e;return t&&n&&U(Kbe({parentProjection:t,projection:n})),n!=null?n:t}function nC(e){return"filter"in e}function g_e(e){return(e==null?void 0:e.stop)!==void 0}function aI(e){return"lookup"in e}function p_e(e){return"data"in e}function m_e(e){return"param"in e}function y_e(e){return"pivot"in e}function v_e(e){return"density"in e}function b_e(e){return"quantile"in e}function x_e(e){return"regression"in e}function w_e(e){return"loess"in e}function __e(e){return"sample"in e}function E_e(e){return"window"in e}function A_e(e){return"joinaggregate"in e}function $_e(e){return"flatten"in e}function S_e(e){return"calculate"in e}function sI(e){return"bin"in e}function C_e(e){return"impute"in e}function O_e(e){return"timeUnit"in e}function F_e(e){return"aggregate"in e}function k_e(e){return"stack"in e}function D_e(e){return"fold"in e}function M_e(e){return e.map(t=>nC(t)?{filter:ac(t.filter,e2e)}:t)}var es=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class T_e extends ZS{map(t,n){var r,i;return(r=n.emptySelections)!==null&&r!==void 0||(n.emptySelections={}),(i=n.selectionPredicates)!==null&&i!==void 0||(n.selectionPredicates={}),t=uI(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=uI(t,n),t.encoding){const r={};for(const[i,o]of Ba(t.encoding))r[i]=lI(o,n);t=Object.assign(Object.assign({},t),{encoding:r})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const r=t,{selection:i}=r,o=es(r,["selection"]);return i?Object.assign(Object.assign({},o),{params:Ba(i).map(([a,s])=>{var u;const l=s,{init:c,bind:f,empty:d}=l,h=es(l,["init","bind","empty"]);h.type==="single"?(h.type="point",h.toggle=!1):h.type==="multi"&&(h.type="point"),n.emptySelections[a]=d!=="none";for(const g of ln((u=n.selectionPredicates[a])!==null&&u!==void 0?u:{}))g.empty=d!=="none";return{name:a,value:c,select:h,bind:f}})}):t}}function uI(e,t){const{transform:n}=e,r=es(e,["transform"]);if(n){const i=n.map(o=>{if(nC(o))return{filter:rC(o,t)};if(sI(o)&&yu(o.bin))return Object.assign(Object.assign({},o),{bin:cI(o.bin)});if(aI(o)){const a=o.from,{selection:s}=a,u=es(a,["selection"]);return s?Object.assign(Object.assign({},o),{from:Object.assign({param:s},u)}):o}return o});return Object.assign(Object.assign({},r),{transform:i})}return e}function lI(e,t){var n,r;const i=de(e);if(Y(i)&&yu(i.bin)&&(i.bin=cI(i.bin)),Eu(i)&&((r=(n=i.scale)===null||n===void 0?void 0:n.domain)===null||r===void 0?void 0:r.selection)){const o=i.scale.domain,{selection:a}=o,s=es(o,["selection"]);i.scale.domain=Object.assign(Object.assign({},s),a?{param:a}:{})}if(ny(i))if(Q(i.condition))i.condition=i.condition.map(o=>{const{selection:a,param:s,test:u}=o,l=es(o,["selection","param","test"]);return s?o:Object.assign(Object.assign({},l),{test:rC(o,t)})});else{const o=lI(i.condition,t),{selection:a,param:s,test:u}=o,l=es(o,["selection","param","test"]);i.condition=s?i.condition:Object.assign(Object.assign({},l),{test:rC(i.condition,t)})}return i}function cI(e){const t=e.extent;if(t==null?void 0:t.selection){const{selection:n}=t,r=es(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},r),{param:n})})}return e}function rC(e,t){const n=r=>ac(r,i=>{var o,a,s;const u=(o=t.emptySelections[i])!==null&&o!==void 0?o:!0,l={param:i,empty:u};return(a=(s=t.selectionPredicates)[i])!==null&&a!==void 0||(s[i]=[]),t.selectionPredicates[i].push(l),l});return e.selection?n(e.selection):ac(e.test||e.filter,r=>r.selection?n(r.selection):r)}class iC extends ZS{map(t,n){var r;const i=(r=n.selections)!==null&&r!==void 0?r:[];if(t.params&&!Jo(t)){const o=[];for(const a of t.params)VS(a)?i.push(a):o.push(a);t.params=o}return n.selections=i,super.map(t,fI(t,n))}mapUnit(t,n){var r;const i=n.selections;if(!i||!i.length)return t;const o=((r=n.path)!==null&&r!==void 0?r:[]).concat(t.name),a=[];for(const s of i)if(!s.views||!s.views.length)a.push(s);else for(const u of s.views)(Fe(u)&&(u===t.name||o.indexOf(u)>=0)||Q(u)&&u.map(l=>o.indexOf(l)).every((l,c,f)=>l!==-1&&(c===0||l>f[c-1])))&&a.push(s);return a.length&&(t.params=a),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=iC.prototype[e];iC.prototype[e]=function(n,r){return t.call(this,n,fI(n,r))}}function fI(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:((n=t.path)!==null&&n!==void 0?n:[]).concat(e.name)}):t}function dI(e,t){t===void 0&&(t=XP(e.config));const n=L_e(e,t),{width:r,height:i}=e,o=P_e(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}const N_e=new h_e,R_e=new T_e,j_e=new iC;function L_e(e,t={}){const n={config:t};return j_e.map(N_e.map(R_e.map(e,n),n),n)}function hI(e){return fe(e)?{type:e}:e!=null?e:{}}function P_e(e,t,n){let{width:r,height:i}=t;const o=Jo(e)||yy(e),a={};o?r=="container"&&i=="container"?(a.type="fit",a.contains="padding"):r=="container"?(a.type="fit-x",a.contains="padding"):i=="container"&&(a.type="fit-y",a.contains="padding"):(r=="container"&&(U(gL("width")),r=void 0),i=="container"&&(U(gL("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},a),n?hI(n.autosize):{}),hI(e.autosize));if(s.type==="fit"&&!o&&(U(Nbe),s.type="pad"),r=="container"&&!(s.type=="fit"||s.type=="fit-x")&&U(pL("width")),i=="container"&&!(s.type=="fit"||s.type=="fit-y")&&U(pL("height")),!Ki(s,{type:"pad"}))return s}function I_e(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function B_e(e){return e?`fit-${z1(e)}`:"fit"}const z_e=["background","padding"];function gI(e,t){const n={};for(const r of z_e)e&&e[r]!==void 0&&(n[r]=vr(e[r]));return t&&(n.params=e.params),n}class Qo{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Qo(de(this.explicit),de(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return vt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:r}){n!==void 0&&this.set(t,n,r)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:r}){n[t]!==void 0?this.set(t,n[t],!0):r[t]!==void 0&&this.set(t,r[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of z(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function ea(e){return{explicit:!0,value:e}}function xr(e){return{explicit:!1,value:e}}function pI(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:vy(t,n,r,i)}}function vy(e,t,n,r){return e.explicit&&t.explicit&&U(vxe(n,r,e.value,t.value)),e}function ts(e,t,n,r,i=vy){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Ki(e.value,t.value)?e:i(e,t,n,r)}class U_e extends Qo{constructor(t={},n={},r=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function bc(e){return"url"in e}function Vh(e){return"values"in e}function mI(e){return"name"in e&&!bc(e)&&!Vh(e)&&!ns(e)}function ns(e){return e&&(yI(e)||vI(e)||oC(e))}function yI(e){return"sequence"in e}function vI(e){return"sphere"in e}function oC(e){return"graticule"in e}var Ze;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(Ze||(Ze={}));const q_e="view",by="[",xy="]",bI="{",xI="}",H_e=":",wI=",",W_e="@",G_e=">",Y_e=/[[\]{}]/,V_e={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let _I,EI;function xc(e,t,n){return _I=t||q_e,EI=n||V_e,AI(e.trim()).map(aC)}function X_e(e){return EI[e]}function Xh(e,t,n,r,i){const o=e.length;let a=0,s;for(;t<o;++t){if(s=e[t],!a&&s===n)return t;i&&i.indexOf(s)>=0?--a:r&&r.indexOf(s)>=0&&++a}return t}function AI(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=Xh(e,i,wI,by+bI,xy+xI),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function aC(e){return e[0]==="["?K_e(e):J_e(e)}function K_e(e){const t=e.length;let n=1,r;if(n=Xh(e,n,xy,by,xy),n===t)throw"Empty between selector: "+e;if(r=AI(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==G_e)throw"Expected '>' after between selector: "+e;r=r.map(aC);const i=aC(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function J_e(e){const t={source:_I},n=[];let r=[0,0],i=0,o=0,a=e.length,s=0,u,l;if(e[a-1]===xI){if(s=e.lastIndexOf(bI),s>=0){try{r=Z_e(e.substring(s+1,a-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),a=e.length}else throw"Unmatched right brace: "+e;s=0}if(!a)throw e;if(e[0]===W_e&&(i=++s),u=Xh(e,s,H_e),u<a&&(n.push(e.substring(o,u).trim()),o=s=++u),s=Xh(e,s,by),s===a)n.push(e.substring(o,a).trim());else if(n.push(e.substring(o,s).trim()),l=[],o=++s,o===a)throw"Unmatched left bracket: "+e;for(;s<a;){if(s=Xh(e,s,xy),s===a)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,s).trim()),s<a-1&&e[++s]!==by)throw"Expected left bracket: "+e;o=++s}if(!(a=n.length)||Y_e.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],i?t.markname=n[0].slice(1):X_e(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function Z_e(e){const t=e.split(wI);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}var Q_e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function wc(e,t=!0,n=zve){if(J(e)){const r=e.map(i=>wc(i,t,n));return t?`[${r.join(", ")}]`:r}else if(bu(e))return n(t?Ih(e):qxe(e));return t?n(Ke(e)):e}function eEe(e,t){var n;for(const r of ln((n=e.component.selection)!==null&&n!==void 0?n:{})){const i=r.name;let o=`${i}${os}, ${r.resolve==="global"?"true":`{unit: ${Ac(e)}}`}`;for(const a of $y)!a.defined(r)||(a.signals&&(t=a.signals(e,r,t)),a.modifyExpr&&(o=a.modifyExpr(e,r,o)));t.push({name:i+TEe,on:[{events:{signal:r.name+os},update:`modify(${ke(r.name+$u)}, ${o})`}]})}return sC(t)}function tEe(e,t){if(e.component.selection&&z(e.component.selection).length){const n=ke(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:xc("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return sC(t)}function nEe(e,t){var n;let r=!1;for(const i of ln((n=e.component.selection)!==null&&n!==void 0?n:{})){const o=i.name,a=ke(o+$u);if(t.filter(u=>u.name===o).length===0){const u=i.resolve==="global"?"union":i.resolve,l=i.type==="point"?", true, true)":")";t.push({name:i.name,update:`${YI}(${a}, ${ke(u)}${l}`})}r=!0;for(const u of $y)u.defined(i)&&u.topLevelSignals&&(t=u.topLevelSignals(e,i,t))}return r&&t.filter(o=>o.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),sC(t)}function rEe(e,t){var n;const r=[...t];for(const i of ln((n=e.component.selection)!==null&&n!==void 0?n:{})){const o={name:i.name+$u};if(i.init){const s=i.project.items.map(u=>Q_e(u,["signals"]));o.values=i.init.map(u=>({unit:Ac(e,{escape:!1}),fields:s,values:wc(u,!1)}))}r.filter(s=>s.name===i.name+$u).length||r.push(o)}return r}function $I(e,t){var n;for(const r of ln((n=e.component.selection)!==null&&n!==void 0?n:{}))for(const i of $y)i.defined(r)&&i.marks&&(t=i.marks(e,r,t));return t}function iEe(e,t){for(const n of e.children)bt(n)&&(t=$I(n,t));return t}function oEe(e,t,n,r){const i=fB(e,t.param,t);return{signal:br(n.get("type"))&&J(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}function sC(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class Ge{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){U(Ybe);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class Tn extends Ge{constructor(t,n,r,i){super(t,n);this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${qj()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var SI=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class ho extends Ge{constructor(t,n){super(t);this.formula=n}clone(){return new ho(null,de(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o)=>{const{field:a,timeUnit:s}=o;if(s){const u=G(o,{forAs:!0});i[Ee({as:u,field:a,timeUnit:s})]={as:u,field:a,timeUnit:s}}return i},{});return We(r)?null:new ho(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,o=SI(r,["timeUnit"]),a=Dn(i),s=Object.assign(Object.assign({},o),{timeUnit:a});return new ho(t,{[Ee(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[r,i]of Ba(this.formula))t.has(i.as)||(n[r]=i);this.formula=n}producedFields(){return new Set(ln(this.formula).map(t=>t.as))}dependentFields(){return new Set(ln(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${Ee(this.formula)}`}assemble(){const t=[];for(const n of ln(this.formula)){const{field:r,as:i,timeUnit:o}=n,a=Dn(o),{unit:s,utc:u}=a,l=SI(a,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Rr(r),type:"timeunit"},s?{units:lS(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[i,`${i}_end`]}))}return t}}var aEe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const Kh="_tuple_fields";class sEe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const uEe={defined:()=>!0,parse:(e,t,n)=>{var r;const i=t.name,o=(r=t.project)!==null&&r!==void 0?r:t.project=new sEe,a={},s={},u=new Set,l=(p,m)=>{const y=m==="visual"?p.channel:p.field;let v=nt(`${i}_${y}`);for(let b=1;u.has(v);b++)v=nt(`${i}_${y}_${b}`);return u.add(v),{[m]:v}},c=t.type,f=e.config.selection[c],d=n.value!==void 0?ft(n.value):null;let{fields:h,encodings:g}=Ve(n.select)?n.select:{};if(!h&&!g&&d){for(const p of d)if(!!Ve(p))for(const m of z(p))lbe(m)?(g||(g=[])).push(m):c==="interval"?(U(qbe),g=f.encodings):(h||(h=[])).push(m)}!h&&!g&&(g=f.encodings,"fields"in f&&(h=f.fields));for(const p of g!=null?g:[]){const m=e.fieldDef(p);if(m){let y=m.field;if(m.aggregate){U(Rbe(p,m.aggregate));continue}else if(!y){U(yL(p));continue}if(m.timeUnit){y=e.vgField(p);const v={timeUnit:m.timeUnit,as:y,field:m.field};s[Ee(v)]=v}if(!a[y]){let v="E";if(c==="interval"){const x=e.getScaleComponent(p).get("type");br(x)&&(v="R")}else m.bin&&(v="R-RE");const b={field:y,channel:p,type:v};b.signals=Object.assign(Object.assign({},l(b,"data")),l(b,"visual")),o.items.push(a[y]=b),o.hasField[y]=o.hasChannel[p]=a[y]}}else U(yL(p))}for(const p of h!=null?h:[]){if(o.hasField[p])continue;const m={type:"E",field:p};m.signals=Object.assign({},l(m,"data")),o.items.push(m),o.hasField[p]=m}d&&(t.init=d.map(p=>o.items.map(m=>Ve(p)?p[m.channel]!==void 0?p[m.channel]:p[m.field]:p))),We(s)||(o.timeUnit=new ho(null,s))},signals:(e,t,n)=>{const r=t.name+Kh;return n.filter(o=>o.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(o=>{const a=aEe(o,["signals","hasLegend"]);return a.field=Rr(a.field),a})})}},rs={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!Ya(i))continue;const o=e.getScaleComponent(i),a=o?o.get("type"):void 0;if(!o||!br(a)){U(Pbe);continue}o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(a=>n.filter(s=>s.name===a.signals.data).length===0);if(!e.parent||lC(e)||r.length===0)return n;const i=n.filter(a=>a.name===t.name)[0];let o=i.update;if(o.indexOf(YI)>=0)i.update=`{${r.map(a=>`${ke(Rr(a.field))}: ${a.signals.data}`).join(", ")}}`;else{for(const a of r){const s=`${ke(Rr(a.field))}: ${a.signals.data}`;o.includes(s)||(o=`${o.substring(0,o.length-1)}, ${s}}`)}i.update=o}return n.concat(r.map(a=>({name:a.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!lC(e))for(const r of t.scales){const i=n.filter(o=>o.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function uC(e,t){return`domain(${ke(e.scaleName(t))})`}function lC(e){var t;return e.parent&&Dc(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:lC(e.parent.parent))}var lEe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const _c="_brush",cC="_scale_trigger",cEe={defined:e=>e.type==="interval",signals:(e,t,n)=>{const r=t.name,i=r+Kh,o=rs.defined(t),a=t.init?t.init[0]:null,s=[],u=[];if(t.translate&&!o){const c=`!event.item || event.item.mark.name !== ${ke(r+_c)}`;CI(t,(f,d)=>{var h,g;const p=ft((h=(g=d.between[0]).filter)!==null&&h!==void 0?h:g.filter=[]);return p.includes(c)||p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==at&&d!==$t){U("Interval selections only support x and y encoding channels.");return}const h=a?a[f]:null,g=fEe(e,t,c,h),p=c.signals.data,m=c.signals.visual,y=ke(e.scaleName(d)),v=e.getScaleComponent(d).get("type"),b=br(v)?"+":"";n.push(...g),s.push(p),u.push({scaleName:e.scaleName(d),expr:`(!isArray(${p}) || (${b}invert(${y}, ${m})[0] === ${b}${p}[0] && ${b}invert(${y}, ${m})[1] === ${b}${p}[1]))`})}),!o&&u.length&&n.push({name:r+cC,value:{},on:[{events:u.map(c=>({scale:c.scaleName})),update:`${u.map(c=>c.expr).join(" && ")} ? ${r+cC} : {}`}]});const l=`unit: ${Ac(e)}, fields: ${i}, values`;return n.concat(Object.assign(Object.assign({name:r+os},a?{init:`{${l}: ${wc(a)}}`}:{}),s.length?{on:[{events:[{signal:s.join(" || ")}],update:`${s.join(" && ")} ? {${l}: [${s}]} : null`}]}:{}))},marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,a=i&&i.signals.visual,s=o&&o.signals.visual,u=`data(${ke(t.name+$u)})`;if(rs.defined(t)||!i&&!o)return n;const l={x:i!==void 0?{signal:`${a}[0]`}:{value:0},y:o!==void 0?{signal:`${s}[0]`}:{value:0},x2:i!==void 0?{signal:`${a}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of z(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Ac(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,g=lEe(c,["fill","fillOpacity","cursor"]),p=z(g).reduce((m,y)=>(m[y]=[{test:[i!==void 0&&`${a}[0] !== ${a}[1]`,o!==void 0&&`${s}[0] !== ${s}[1]`].filter(v=>v).join(" && "),value:g[y]},{value:null}],m),{});return[{name:`${r+_c}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:r+_c,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),p)}}]}};function fEe(e,t,n,r){const i=n.channel,o=n.signals.visual,a=n.signals.data,s=rs.defined(t),u=ke(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=p=>`scale(${u}, ${p})`,d=e.getSizeSignalRef(i===at?"width":"height").signal,h=`${i}(unit)`,g=CI(t,(p,m)=>[...p,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${o}[0], clamp(${h}, 0, ${d})]`}]);return g.push({events:{signal:t.name+cC},update:br(c)?`[${f(`${a}[0]`)}, ${f(`${a}[1]`)}]`:"[0, 0]"}),s?[{name:a,on:[]}]:[Object.assign(Object.assign({name:o},r?{init:wc(r,!0,f)}:{value:[]}),{on:g}),Object.assign(Object.assign({name:a},r?{init:wc(r)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]})]}function CI(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(U(`${r} is not an ordered event stream for interval selections.`),n),[])}const dEe={defined:e=>e.type==="point",signals:(e,t,n)=>{var r;const i=t.name,o=i+Kh,a=t.project,s="(item().isVoronoi ? datum.datum : datum)",u=a.items.map(h=>{const g=e.fieldDef(h.channel);return(g==null?void 0:g.bin)?`[${s}[${ke(e.vgField(h.channel,{}))}], ${s}[${ke(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${s}[${ke(h.field)}]`}).join(", "),l=`unit: ${Ac(e)}, fields: ${o}, values`,c=t.events,f=ln((r=e.component.selection)!==null&&r!==void 0?r:{}).reduce((h,g)=>g.type==="interval"?h.concat(g.name+_c):h,[]).map(h=>`indexof(item().mark.name, '${h}') < 0`).join(" && "),d="datum && item().mark.marktype !== 'group'"+(f?` && ${f}`:"");return n.concat([{name:i+os,on:c?[{events:c,update:`${d} ? {${l}: [${u}]} : null`,force:!0}]:[]}])}};function Ec(e,t,n,r){const i=ny(t)&&t.condition,o=r(t);if(i){const s=ft(i).map(u=>{const l=r(u);if(W2e(u)){const{param:c,empty:f}=u,d=cB(e,{param:c,empty:f});return Object.assign({test:d},l)}else{const c=My(e,u.test);return Object.assign({test:c},l)}});return{[n]:[...s,...o!==void 0?[o]:[]]}}else return o!==void 0?{[n]:o}:{}}function fC(e,t="text"){const n=e.encoding[t];return Ec(e,n,t,r=>wy(r,e.config))}function wy(e,t,n="datum"){if(e){if(gi(e))return rt(e.value);if(ue(e)){const{format:r,formatType:i}=ay(e);return CS({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function OI(e,t={}){const{encoding:n,markDef:r,config:i,stack:o}=e,a=n.tooltip;if(J(a))return{tooltip:kI({tooltip:a},o,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return Ec(e,a,"tooltip",u=>{const l=wy(u,i,s);if(l)return l;if(u===null)return;let c=Be("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),fe(c))return{value:c};if(Ve(c))return re(c)?c:c.content==="encoding"?kI(n,o,i,t):{signal:s}})}}function FI(e,t,n,{reactiveGeom:r}={}){const i={},o=r?"datum.datum":"datum",a=[];function s(l,c){const f=mu(c),d=Ir(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=d.title||jS(d,n),g=ft(h).join(", ");let p;if(oo(c)){const m=c==="x"?"x2":"y2",y=co(e[m]);if(kn(d.bin)&&y){const v=G(d,{expr:o}),b=G(y,{expr:o}),{format:x,formatType:w}=ay(d);p=Q1(v,b,x,w,n),i[m]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:b}=ay(d);p=CS({fieldOrDatumDef:d,format:v,formatType:b,expr:o,config:n,normalizeStack:!0}).signal}}p!=null||(p=wy(d,n,o).signal),a.push({channel:c,key:g,value:p})}IS(e,(l,c)=>{Y(l)?s(l,c):ry(l)&&s(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of a)!i[l]&&!u[c]&&(u[c]=f);return u}function kI(e,t,n,{reactiveGeom:r}={}){const i=FI(e,t,n,{reactiveGeom:r}),o=Ba(i).map(([a,s])=>`"${a}": ${s}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function hEe(e){const{markDef:t,config:n}=e,r=Be("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),gEe(e)),pEe(e))}function gEe(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=Be("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in Mbe?{}:{ariaRoleDescription:{value:t}}}function pEe(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return Ec(e,o,"description",u=>wy(u,e.config));const a=Be("description",n,r);if(a!=null)return{description:rt(a)};if(r.aria===!1)return{};const s=FI(t,i,r);if(!We(s))return{description:{signal:Ba(s).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Lt(e,t,n={}){const{markDef:r,encoding:i,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:u}=n;s===void 0&&(u!=null||(u=Be(e,r,o,{vgChannel:a,ignoreVgConfig:!0})),u!==void 0&&(s=rt(u)));const l=i[e];return Ec(t,l,a!=null?a:e,c=>KL({channel:e,channelDef:c,markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function DI(e,t={filled:void 0}){var n,r,i,o;const{markDef:a,encoding:s,config:u}=e,{type:l}=a,c=(n=t.filled)!==null&&n!==void 0?n:Be("filled",a,u),f=ye(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(i=(r=Be(c===!0?"color":void 0,a,u,{vgChannel:"fill"}))!==null&&r!==void 0?r:u.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,h=(o=Be(c===!1?"color":void 0,a,u,{vgChannel:"stroke"}))!==null&&o!==void 0?o:u.mark[c===!1&&"color"],g=c?"fill":"stroke",p=Object.assign(Object.assign({},d?{fill:rt(d)}:{}),h?{stroke:rt(h)}:{});return a.color&&(c?a.fill:a.stroke)&&U(EL("property",{fill:"fill"in a,stroke:"stroke"in a})),Object.assign(Object.assign(Object.assign(Object.assign({},p),Lt("color",e,{vgChannel:g,defaultValue:c?d:h})),Lt("fill",e,{defaultValue:s.fill?d:void 0})),Lt("stroke",e,{defaultValue:s.stroke?h:void 0}))}function mEe(e){const{encoding:t,mark:n}=e,r=t.order;return!Ja(n)&&gi(r)?Ec(e,r,"zindex",i=>rt(i.value)):{}}function Jh(e,t){const n=fbe(e),r=t[n];if(r)return r}function fn(e,t,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:a,stack:s}=t,u=i[e],l=i[Yo(e)],c=t.scaleName(e),f=t.getScaleComponent(e),d=Jh(e,o),h=dC({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!u&&oo(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:yEe({channel:e,channelDef:u,channel2Def:l,markDef:o,config:a,scaleName:c,scale:f,stack:s,offset:d,defaultRef:h});return g?{[r||e]:g}:void 0}function yEe(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:a}=e;if(ue(n)&&i&&t===i.fieldChannel){if(Y(n)){let s=n.bandPosition;if(s===void 0&&a.type==="text"&&(t==="radius"||t==="theta")&&(s=.5),s!==void 0)return Z1({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:s,offset:o})}return wu(n,r,{suffix:"end"},{offset:o})}return $S(e)}function dC({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:o,config:a}=e;return()=>{const s=mu(n),u=Wa(n),l=Be(n,o,a,{vgChannel:u});if(l!==void 0)return Uh(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!ye([St.LOG,St.TIME,St.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return s==="y"?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Pr(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const vEe={left:"x",center:"xc",right:"x2"},bEe={top:"y",middle:"yc",bottom:"y2"};function MI(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Wa(e);const i=e==="x"?"align":"baseline",o=Be(i,t,n);let a;return re(o)?(U(sxe(i)),a=void 0):a=o,e==="x"?vEe[a||(r==="top"?"left":"center")]:bEe[a||r]}function _y(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?TI(e,t,{defaultPos:n,defaultPos2:r}):fn(e,t,{defaultPos:n})}function TI(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=t,a=Yo(e),s=Pr(e),u=xEe(t,r,a),l=u[s]?MI(e,i,o):Wa(e);return Object.assign(Object.assign({},fn(e,t,{defaultPos:n,vgChannel:l})),u)}function xEe(e,t,n){const{encoding:r,mark:i,markDef:o,stack:a,config:s}=e,u=mu(n),l=Pr(n),c=Wa(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),g=n in r||n in o?Jh(n,e.markDef):Jh(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude)){const m=Pr(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const p=wEe({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:g,defaultRef:void 0});return p!==void 0?{[c]:p}:Ey(n,o)||Ey(n,{[n]:H1(n,o,s.style),[l]:H1(l,o,s.style)})||Ey(n,s[i])||Ey(n,s.mark)||{[c]:dC({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function wEe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l}){return ue(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?wu(t,o,{suffix:"start"},{offset:u}):$S({channel:e,channelDef:n,scaleName:o,scale:a,stack:s,markDef:r,config:i,offset:u,defaultRef:l})}function Ey(e,t){const n=Pr(e),r=Wa(e);if(t[r]!==void 0)return{[r]:Uh(e,t[r])};if(t[e]!==void 0)return{[r]:Uh(e,t[e])};if(t[n]){const i=t[n];if(gc(i))U(txe(n));else return{[n]:Uh(e,i)}}}function is(e,t,n){var r,i,o,a;const{config:s,encoding:u,markDef:l}=e,c=Yo(t),f=Pr(t),d=u[t],h=u[c],g=e.getScaleComponent(t),p=g?g.get("type"):void 0,m=e.scaleName(t),y=l.orient,v=(i=(r=u[f])!==null&&r!==void 0?r:u.size)!==null&&i!==void 0?i:Be("size",l,s,{vgChannel:f}),b=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(Y(d)&&(Je(d.bin)||kn(d.bin)||d.timeUnit&&!h)&&!(v&&!gc(v))&&!cn(p)){const x=lP({channel:t,fieldDef:d,markDef:l,config:s,scaleType:p}),w=(o=e.component.axes[t])===null||o===void 0?void 0:o[0],E=(a=w==null?void 0:w.get("translate"))!==null&&a!==void 0?a:.5;return AEe({fieldDef:d,fieldDef2:h,channel:t,markDef:l,scaleName:m,bandSize:x,axisTranslate:E,spacing:oo(t)?Be("binSpacing",l,s):void 0,reverse:g.get("reverse"),config:s})}else return(ue(d)&&cn(p)||b)&&!h?EEe(d,t,e):TI(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function _Ee(e,t,n,r,i){if(gc(i))if(n){const a=n.get("type");if(a==="band")return{scale:t,band:i.band};i.band!==1&&(U(fxe(a)),i=void 0)}else return{mult:i.band,field:{group:e}};else{if(re(i))return i;if(i)return{value:i}}if(n){const a=n.get("range");if(Ka(a)&&yt(a.step))return{value:a.step-2}}return{value:my(r.view,e)-2}}function EEe(e,t,n){const{markDef:r,encoding:i,config:o,stack:a}=n,s=r.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=Pr(t),f=Yo(t),d=s==="horizontal"&&t==="y"||s==="vertical"&&t==="x";let h;(i.size||r.size)&&(d?h=Lt("size",n,{vgChannel:c,defaultRef:rt(r.size)}):U(pxe(r.type)));const g=lP({channel:t,fieldDef:e,markDef:r,config:o,scaleType:l==null?void 0:l.get("type"),useVlSizeChannel:d});h=h||{[c]:_Ee(c,u,l,o,g)};const p=(l==null?void 0:l.get("type"))!=="band"||!("band"in h[c])?"middle":"top",m=MI(t,r,o,p),y=m==="xc"||m==="yc",v=Jh(t,r),b=$S({channel:t,channelDef:e,markDef:r,config:o,scaleName:u,scale:l,stack:a,offset:v,defaultRef:dC({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:y?.5:re(g)?{signal:`(1-${g})/2`}:gc(g)?(1-g.band)/2:0});if(c)return Object.assign({[m]:b},h);{const x=Wa(f),w=h[c],E=v?Object.assign(Object.assign({},w),{offset:v}):w;return{[m]:b,[x]:J(b)?[b[0],Object.assign(Object.assign({},b[1]),{offset:E})]:Object.assign(Object.assign({},b),{offset:E})}}}function Zh(e,t,n,r,i){if(Yj(e))return 0;const o=e==="x"||e==="y2"?-t/2:t/2;if(re(n)||re(i)||re(r)){const a=Ko(n),s=Ko(i),u=Ko(r),l=u?`${u} + `:"",c=a?`(${a} ? -1 : 1) * `:"",f=s?`(${s} + ${o})`:o;return{signal:l+c+f}}else return i=i||0,r+(n?-i-o:+i+o)}function AEe({fieldDef:e,fieldDef2:t,channel:n,bandSize:r,scaleName:i,markDef:o,spacing:a=0,axisTranslate:s,reverse:u,config:l}){const c=Yo(n),f=Wa(n),d=Wa(c),h=Jh(n,o),g=re(r)?{signal:`(1-${r.signal})/2`}:gc(r)?(1-r.band)/2:.5;if(Je(e.bin)||e.timeUnit)return{[d]:NI({channel:n,fieldDef:e,scaleName:i,markDef:o,bandPosition:g,offset:Zh(c,a,u,s,h),config:l}),[f]:NI({channel:n,fieldDef:e,scaleName:i,markDef:o,bandPosition:re(g)?{signal:`1-${g.signal}`}:1-g,offset:Zh(n,a,u,s,h),config:l})};if(kn(e.bin)){const p=wu(e,i,{},{offset:Zh(c,a,u,s,h)});if(Y(t))return{[d]:p,[f]:wu(t,i,{},{offset:Zh(n,a,u,s,h)})};if(yu(e.bin)&&e.bin.step)return{[d]:p,[f]:{signal:`scale("${i}", ${G(e,{expr:"datum"})} + ${e.bin.step})`,offset:Zh(n,a,u,s,h)}}}U(OL(c))}function NI({channel:e,fieldDef:t,scaleName:n,markDef:r,bandPosition:i,offset:o,config:a}){const s=Z1({scaleName:n,fieldOrDatumDef:t,bandPosition:i,offset:o});return XL({fieldDef:t,channel:e,markDef:r,ref:s,config:a})}const $Ee=new Set(["aria","width","height"]);function Br(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?DI(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},SEe(e.markDef,t)),RI(e,"fill",n)),RI(e,"stroke",r)),Lt("opacity",e)),Lt("fillOpacity",e)),Lt("strokeOpacity",e)),Lt("strokeWidth",e)),Lt("strokeDash",e)),mEe(e)),OI(e)),fC(e,"href")),hEe(e))}function RI(e,t,n){const{config:r,mark:i,markDef:o}=e;if(Be("invalid",o,r)==="hide"&&n&&!Ja(i)){const s=CEe(e,{invalid:!0,channels:U1});if(s)return{[t]:[{test:s,value:null},...ft(n)]}}return n?{[t]:n}:{}}function SEe(e,t){return Dbe.reduce((n,r)=>(!$Ee.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=rt(e[r])),n),{})}function CEe(e,{invalid:t=!1,channels:n}){const r=n.reduce((o,a)=>{const s=e.getScaleComponent(a);if(s){const u=s.get("type"),l=e.vgField(a,{expr:"datum"});l&&br(u)&&(o[l]=!0)}return o},{}),i=z(r);if(i.length>0){const o=t?"||":"&&";return i.map(a=>SS(a,t)).join(` ${o} `)}}function hC(e){const{config:t,markDef:n}=e;if(Be("invalid",n,t)){const i=OEe(e,{channels:io});if(i)return{defined:{signal:i}}}return{}}function OEe(e,{invalid:t=!1,channels:n}){const r=n.reduce((o,a)=>{const s=e.getScaleComponent(a);if(s){const u=s.get("type"),l=e.vgField(a,{expr:"datum"});l&&br(u)&&(o[l]=!0)}return o},{}),i=z(r);if(i.length>0){const o=t?"||":"&&";return i.map(a=>SS(a,t)).join(` ${o} `)}}function jI(e,t){if(t!==void 0)return{[e]:rt(t)}}const gC="voronoi",LI={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(gC)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(Ja(o))return U(jbe(o)),n;const a={name:e.getName(gC),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},OI(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?s=c:d.indexOf(gC)>=0&&(u=!0)}),u||n.splice(s+1,0,a),n}},PI={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!GS(e.bind),parse:(e,t,n)=>VI(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,a=t.init&&t.init[0],s=LI.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{var c,f;const d=nt(`${r}_${u.field}`);n.filter(g=>g.name===d).length||n.unshift(Object.assign(Object.assign({name:d},a?{init:wc(a[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${ke(u.field)}] : null`}]:[],bind:(f=(c=o[u.field])!==null&&c!==void 0?c:o[u.channel])!==null&&f!==void 0?f:o}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.filter(l=>l.name===r+os)[0],a=r+Kh,s=i.items.map(l=>nt(`${r}_${l.field}`)),u=s.map(l=>`${l} !== null`).join(" && ");return s.length&&(o.update=`${u} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}},Ay="_toggle",II={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+Ay,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+os,r=t.name+Ay;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Ac(e)}}, `)+`${r} ? ${n} : null`}},FEe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=fe(t.clear)?xc(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(PI.defined(t))for(const r of t.project.items){const i=n.findIndex(o=>o.name===nt(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,o){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const i of t.project.items){const o=n.findIndex(a=>a.name===i.signals.visual);if(r(o,"[0, 0]"),o===-1){const a=n.findIndex(s=>s.name===i.signals.data);r(a,"null")}}else{let i=n.findIndex(o=>o.name===t.name+os);r(i,"null"),II.defined(t)&&(i=n.findIndex(o=>o.name===t.name+Ay),r(i,"false"))}return n}},BI={defined:e=>{const t=e.resolve==="global"&&e.bind&&GS(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Gh;return t&&!n&&U(Ibe),t&&n},parse:(e,t,n)=>{var r;const i=de(n);if(i.select=fe(i.select)?{type:i.select,toggle:t.toggle}:Object.assign(Object.assign({},i.select),{toggle:t.toggle}),VI(t,i),se(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=ft((r=u.filter)!==null&&r!==void 0?r:[]),u.filter.includes(s)||u.filter.push(s)}const o=YS(t.bind)?t.bind.legend:"click",a=fe(o)?xc(o,"view"):ft(o);t.bind={legend:{merge:a}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=YS(t.bind)&&t.bind.legend,o=a=>s=>{const u=de(s);return u.markname=a,u};for(const a of t.project.items){if(!a.hasLegend)continue;const s=`${nt(a.field)}_legend`,u=`${r}_${s}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(o(`${s}_symbols`)).concat(i.merge.map(o(`${s}_labels`))).concat(i.merge.map(o(`${s}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(d=>d.name===r+os),a=r+Kh,s=i.items.filter(d=>d.hasLegend).map(d=>nt(`${r}_${nt(d.field)}_legend`)),l=`${s.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map(d=>({signal:d})),update:l}):s.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(d=>d.name===r+Ay),f=YS(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function kEe(e,t,n){var r,i,o,a;const s=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;for(const u of ln((i=e.component.selection)!==null&&i!==void 0?i:{})){const l=(o=u.project.hasField[s])!==null&&o!==void 0?o:u.project.hasChannel[t];if(l&&BI.defined(u)){const c=(a=n.get("selections"))!==null&&a!==void 0?a:[];c.push(u.name),n.set("selections",c,!1),l.hasLegend=!0}}}const zI="_translate_anchor",UI="_translate_delta",DEe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=rs.defined(t),o=r+zI,{x:a,y:s}=t.project.hasChannel;let u=xc(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+_c,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(a!==void 0?`, extent_x: ${i?uC(e,at):`slice(${a.signals.visual})`}`:"")+(s!==void 0?`, extent_y: ${i?uC(e,$t):`slice(${s.signals.visual})`}`:"")+"}"}]},{name:r+UI,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),a!==void 0&&qI(e,t,a,"width",n),s!==void 0&&qI(e,t,s,"height",n),n}};function qI(e,t,n,r,i){var o,a;const s=t.name,u=s+zI,l=s+UI,c=n.channel,f=rs.defined(t),d=i.filter(_=>_.name===n.signals[f?"data":"visual"])[0],h=e.getSizeSignalRef(r).signal,g=e.getScaleComponent(c),p=g.get("type"),m=g.get("reverse"),y=f?c===at?m?"":"-":m?"-":"":"",v=`${u}.extent_${c}`,b=`${y}${l}.${c} / ${f?`${h}`:`span(${v})`}`,x=f?p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear":"panLinear",w=f?p==="pow"?`, ${(o=g.get("exponent"))!==null&&o!==void 0?o:1}`:p==="symlog"?`, ${(a=g.get("constant"))!==null&&a!==void 0?a:1}`:"":"",E=`${x}(${v}, ${b}${w})`;d.on.push({events:{signal:l},update:f?E:`clampRange(${E}, 0, ${h})`})}const HI="_zoom_anchor",WI="_zoom_delta",MEe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=rs.defined(t),o=r+WI,{x:a,y:s}=t.project.hasChannel,u=ke(e.scaleName(at)),l=ke(e.scaleName($t));let c=xc(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+_c,f))),n.push({name:r+HI,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),a!==void 0&&GI(e,t,a,"width",n),s!==void 0&&GI(e,t,s,"height",n),n}};function GI(e,t,n,r,i){var o,a;const s=t.name,u=n.channel,l=rs.defined(t),c=i.filter(x=>x.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(u),h=d.get("type"),g=l?uC(e,u):c.name,p=s+WI,m=`${s}${HI}.${u}`,y=l?h==="log"?"zoomLog":h==="symlog"?"zoomSymlog":h==="pow"?"zoomPow":"zoomLinear":"zoomLinear",v=l?h==="pow"?`, ${(o=d.get("exponent"))!==null&&o!==void 0?o:1}`:h==="symlog"?`, ${(a=d.get("constant"))!==null&&a!==void 0?a:1}`:"":"",b=`${y}(${g}, ${m}, ${p}${v})`;c.on.push({events:{signal:p},update:l?b:`clampRange(${b}, 0, ${f})`})}const $u="_store",os="_tuple",TEe="_modify",YI="vlSelectionResolve",$y=[dEe,cEe,uEe,II,PI,rs,BI,FEe,DEe,MEe,LI];function NEe(e){let t=e.parent;for(;t&&!vi(t);)t=t.parent;return t}function Ac(e,{escape:t}={escape:!0}){let n=t?ke(e.name):e.name;const r=NEe(e);if(r){const{facet:i}=r;for(const o of Lr)i[o]&&(n+=` + '__facet_${o}_' + (facet[${ke(r.vgField(o))}])`)}return n}function pC(e){var t;return ln((t=e.component.selection)!==null&&t!==void 0?t:{}).reduce((n,r)=>n||r.project.items.some(i=>i.field===Gh),!1)}function VI(e,t){(Fe(t.select)||!t.select.on)&&delete e.events,(Fe(t.select)||!t.select.clear)&&delete e.clear,(Fe(t.select)||!t.select.toggle)&&delete e.toggle}const REe="RawCode",jEe="Literal",LEe="Property",PEe="Identifier",IEe="ArrayExpression",BEe="BinaryExpression",zEe="CallExpression",UEe="ConditionalExpression",qEe="LogicalExpression",HEe="MemberExpression",WEe="ObjectExpression",GEe="UnaryExpression";function pi(e){this.type=e}pi.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=YEe(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function YEe(e){switch(e.type){case IEe:return e.elements;case BEe:case qEe:return[e.left,e.right];case zEe:return[e.callee].concat(e.arguments);case UEe:return[e.test,e.consequent,e.alternate];case HEe:return[e.object,e.property];case WEe:return e.properties;case LEe:return[e.key,e.value];case GEe:return[e.argument];case PEe:case jEe:case REe:default:return[]}}var go,Z,L,dn,qe,Sy=1,Qh=2,Su=3,as=4,Cy=5,Cu=6,Zn=7,e0=8,VEe=9;go={};go[Sy]="Boolean";go[Qh]="<end>";go[Su]="Identifier";go[as]="Keyword";go[Cy]="Null";go[Cu]="Numeric";go[Zn]="Punctuator";go[e0]="String";go[VEe]="RegularExpression";var XEe="ArrayExpression",KEe="BinaryExpression",JEe="CallExpression",ZEe="ConditionalExpression",XI="Identifier",QEe="Literal",eAe="LogicalExpression",tAe="MemberExpression",nAe="ObjectExpression",rAe="Property",iAe="UnaryExpression",Pt="Unexpected token %0",oAe="Unexpected number",aAe="Unexpected string",sAe="Unexpected identifier",uAe="Unexpected reserved word",lAe="Unexpected end of input",mC="Invalid regular expression",yC="Invalid regular expression: missing /",KI="Octal literals are not allowed in strict mode.",cAe="Duplicate data property in object literal not allowed in strict mode",Gt="ILLEGAL",t0="Disabled.",fAe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),dAe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Oy(e,t){if(!e)throw new Error("ASSERT: "+t)}function ta(e){return e>=48&&e<=57}function vC(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function n0(e){return"01234567".indexOf(e)>=0}function hAe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function r0(e){return e===10||e===13||e===8232||e===8233}function i0(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&fAe.test(String.fromCharCode(e))}function Fy(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&dAe.test(String.fromCharCode(e))}const gAe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function JI(){for(;L<dn;){const e=Z.charCodeAt(L);if(hAe(e)||r0(e))++L;else break}}function bC(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)L<dn&&vC(Z[L])?(r=Z[L++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):je({},Pt,Gt);return String.fromCharCode(i)}function pAe(){var e,t,n,r;for(e=Z[L],t=0,e==="}"&&je({},Pt,Gt);L<dn&&(e=Z[L++],!!vC(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&je({},Pt,Gt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function ZI(){var e,t;for(e=Z.charCodeAt(L++),t=String.fromCharCode(e),e===92&&(Z.charCodeAt(L)!==117&&je({},Pt,Gt),++L,e=bC("u"),(!e||e==="\\"||!i0(e.charCodeAt(0)))&&je({},Pt,Gt),t=e);L<dn&&(e=Z.charCodeAt(L),!!Fy(e));)++L,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Z.charCodeAt(L)!==117&&je({},Pt,Gt),++L,e=bC("u"),(!e||e==="\\"||!Fy(e.charCodeAt(0)))&&je({},Pt,Gt),t+=e);return t}function mAe(){var e,t;for(e=L++;L<dn;){if(t=Z.charCodeAt(L),t===92)return L=e,ZI();if(Fy(t))++L;else break}return Z.slice(e,L)}function yAe(){var e,t,n;return e=L,t=Z.charCodeAt(L)===92?ZI():mAe(),t.length===1?n=Su:gAe.hasOwnProperty(t)?n=as:t==="null"?n=Cy:t==="true"||t==="false"?n=Sy:n=Su,{type:n,value:t,start:e,end:L}}function xC(){var e=L,t=Z.charCodeAt(L),n,r=Z[L],i,o,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++L,{type:Zn,value:String.fromCharCode(t),start:e,end:L};default:if(n=Z.charCodeAt(L+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return L+=2,{type:Zn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:L};case 33:case 61:return L+=2,Z.charCodeAt(L)===61&&++L,{type:Zn,value:Z.slice(e,L),start:e,end:L}}}if(a=Z.substr(L,4),a===">>>=")return L+=4,{type:Zn,value:a,start:e,end:L};if(o=a.substr(0,3),o===">>>"||o==="<<="||o===">>=")return L+=3,{type:Zn,value:o,start:e,end:L};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return L+=2,{type:Zn,value:i,start:e,end:L};if(i==="//"&&je({},Pt,Gt),"<>=!+-*%&|^/".indexOf(r)>=0)return++L,{type:Zn,value:r,start:e,end:L};je({},Pt,Gt)}function vAe(e){let t="";for(;L<dn&&vC(Z[L]);)t+=Z[L++];return t.length===0&&je({},Pt,Gt),i0(Z.charCodeAt(L))&&je({},Pt,Gt),{type:Cu,value:parseInt("0x"+t,16),start:e,end:L}}function bAe(e){let t="0"+Z[L++];for(;L<dn&&n0(Z[L]);)t+=Z[L++];return(i0(Z.charCodeAt(L))||ta(Z.charCodeAt(L)))&&je({},Pt,Gt),{type:Cu,value:parseInt(t,8),octal:!0,start:e,end:L}}function QI(){var e,t,n;if(n=Z[L],Oy(ta(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=L,e="",n!=="."){if(e=Z[L++],n=Z[L],e==="0"){if(n==="x"||n==="X")return++L,vAe(t);if(n0(n))return bAe(t);n&&ta(n.charCodeAt(0))&&je({},Pt,Gt)}for(;ta(Z.charCodeAt(L));)e+=Z[L++];n=Z[L]}if(n==="."){for(e+=Z[L++];ta(Z.charCodeAt(L));)e+=Z[L++];n=Z[L]}if(n==="e"||n==="E")if(e+=Z[L++],n=Z[L],(n==="+"||n==="-")&&(e+=Z[L++]),ta(Z.charCodeAt(L)))for(;ta(Z.charCodeAt(L));)e+=Z[L++];else je({},Pt,Gt);return i0(Z.charCodeAt(L))&&je({},Pt,Gt),{type:Cu,value:parseFloat(e),start:t,end:L}}function xAe(){var e="",t,n,r,i,o=!1;for(t=Z[L],Oy(t==="'"||t==='"',"String literal must starts with a quote"),n=L,++L;L<dn;)if(r=Z[L++],r===t){t="";break}else if(r==="\\")if(r=Z[L++],!r||!r0(r.charCodeAt(0)))switch(r){case"u":case"x":Z[L]==="{"?(++L,e+=pAe()):e+=bC(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:n0(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),L<dn&&n0(Z[L])&&(o=!0,i=i*8+"01234567".indexOf(Z[L++]),"0123".indexOf(r)>=0&&L<dn&&n0(Z[L])&&(i=i*8+"01234567".indexOf(Z[L++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&Z[L]===`
`&&++L;else{if(r0(r.charCodeAt(0)))break;e+=r}return t!==""&&je({},Pt,Gt),{type:e0,value:e,octal:o,start:n,end:L}}function wAe(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";je({},mC)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){je({},mC)}try{return new RegExp(e,t)}catch(r){return null}}function _Ae(){var e,t,n,r,i;for(e=Z[L],Oy(e==="/","Regular expression literal must start with a slash"),t=Z[L++],n=!1,r=!1;L<dn;)if(e=Z[L++],t+=e,e==="\\")e=Z[L++],r0(e.charCodeAt(0))&&je({},yC),t+=e;else if(r0(e.charCodeAt(0)))je({},yC);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||je({},yC),i=t.substr(1,t.length-2),{value:i,literal:t}}function EAe(){var e,t,n;for(t="",n="";L<dn&&(e=Z[L],!!Fy(e.charCodeAt(0)));)++L,e==="\\"&&L<dn?je({},Pt,Gt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&je({},mC,n),{value:n,literal:t}}function AAe(){var e,t,n,r;return qe=null,JI(),e=L,t=_Ae(),n=EAe(),r=wAe(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:L}}function $Ae(e){return e.type===Su||e.type===as||e.type===Sy||e.type===Cy}function eB(){if(JI(),L>=dn)return{type:Qh,start:L,end:L};const e=Z.charCodeAt(L);return i0(e)?yAe():e===40||e===41||e===59?xC():e===39||e===34?xAe():e===46?ta(Z.charCodeAt(L+1))?QI():xC():ta(e)?QI():xC()}function Qn(){const e=qe;return L=e.end,qe=eB(),L=e.end,e}function tB(){const e=L;qe=eB(),L=e}function SAe(e){const t=new pi(XEe);return t.elements=e,t}function nB(e,t,n){const r=new pi(e==="||"||e==="&&"?eAe:KEe);return r.operator=e,r.left=t,r.right=n,r}function CAe(e,t){const n=new pi(JEe);return n.callee=e,n.arguments=t,n}function OAe(e,t,n){const r=new pi(ZEe);return r.test=e,r.consequent=t,r.alternate=n,r}function wC(e){const t=new pi(XI);return t.name=e,t}function o0(e){const t=new pi(QEe);return t.value=e.value,t.raw=Z.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function rB(e,t,n){const r=new pi(tAe);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function FAe(e){const t=new pi(nAe);return t.properties=e,t}function iB(e,t,n){const r=new pi(rAe);return r.key=t,r.value=n,r.kind=e,r}function kAe(e,t){const n=new pi(iAe);return n.operator=e,n.argument=t,n.prefix=!0,n}function je(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,a)=>(Oy(a<r.length,"Message reference must be in range"),r[a]));throw n=new Error(i),n.index=L,n.description=i,n}function ky(e){e.type===Qh&&je(e,lAe),e.type===Cu&&je(e,oAe),e.type===e0&&je(e,aAe),e.type===Su&&je(e,sAe),e.type===as&&je(e,uAe),je(e,Pt,e.value)}function hn(e){const t=Qn();(t.type!==Zn||t.value!==e)&&ky(t)}function et(e){return qe.type===Zn&&qe.value===e}function _C(e){return qe.type===as&&qe.value===e}function DAe(){const e=[];for(L=qe.start,hn("[");!et("]");)et(",")?(Qn(),e.push(null)):(e.push(Ou()),et("]")||hn(","));return Qn(),SAe(e)}function oB(){L=qe.start;const e=Qn();return e.type===e0||e.type===Cu?(e.octal&&je(e,KI),o0(e)):wC(e.value)}function MAe(){var e,t,n,r;if(L=qe.start,e=qe,e.type===Su)return n=oB(),hn(":"),r=Ou(),iB("init",n,r);if(e.type===Qh||e.type===Zn)ky(e);else return t=oB(),hn(":"),r=Ou(),iB("init",t,r)}function TAe(){var e=[],t,n,r,i={},o=String;for(L=qe.start,hn("{");!et("}");)t=MAe(),t.key.type===XI?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?je({},cAe):i[r]=!0,e.push(t),et("}")||hn(",");return hn("}"),FAe(e)}function NAe(){hn("(");const e=EC();return hn(")"),e}const RAe={if:1};function jAe(){var e,t,n;if(et("("))return NAe();if(et("["))return DAe();if(et("{"))return TAe();if(e=qe.type,L=qe.start,e===Su||RAe[qe.value])n=wC(Qn().value);else if(e===e0||e===Cu)qe.octal&&je(qe,KI),n=o0(Qn());else{if(e===as)throw new Error(t0);e===Sy?(t=Qn(),t.value=t.value==="true",n=o0(t)):e===Cy?(t=Qn(),t.value=null,n=o0(t)):et("/")||et("/=")?(n=o0(AAe()),tB()):ky(Qn())}return n}function LAe(){const e=[];if(hn("("),!et(")"))for(;L<dn&&(e.push(Ou()),!et(")"));)hn(",");return hn(")"),e}function PAe(){L=qe.start;const e=Qn();return $Ae(e)||ky(e),wC(e.value)}function IAe(){return hn("."),PAe()}function BAe(){hn("[");const e=EC();return hn("]"),e}function zAe(){var e,t,n;for(e=jAe();;)if(et("."))n=IAe(),e=rB(".",e,n);else if(et("("))t=LAe(),e=CAe(e,t);else if(et("["))n=BAe(),e=rB("[",e,n);else break;return e}function aB(){const e=zAe();if(qe.type===Zn&&(et("++")||et("--")))throw new Error(t0);return e}function Dy(){var e,t;if(qe.type!==Zn&&qe.type!==as)t=aB();else{if(et("++")||et("--"))throw new Error(t0);if(et("+")||et("-")||et("~")||et("!"))e=Qn(),t=Dy(),t=kAe(e.value,t);else{if(_C("delete")||_C("void")||_C("typeof"))throw new Error(t0);t=aB()}}return t}function sB(e){let t=0;if(e.type!==Zn&&e.type!==as)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function UAe(){var e,t,n,r,i,o,a,s,u,l;if(e=qe,u=Dy(),r=qe,i=sB(r),i===0)return u;for(r.prec=i,Qn(),t=[e,qe],a=Dy(),o=[u,r,a];(i=sB(qe))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=nB(s,u,a),o.push(n);r=Qn(),r.prec=i,o.push(r),t.push(qe),n=Dy(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=nB(o[l-1].value,o[l-2],n),l-=2;return n}function Ou(){var e,t,n;return e=UAe(),et("?")&&(Qn(),t=Ou(),hn(":"),n=Ou(),e=OAe(e,t,n)),e}function EC(){const e=Ou();if(et(","))throw new Error(t0);return e}function qAe(e){Z=e,L=0,dn=Z.length,qe=null,tB();const t=EC();if(qe.type!==Qh)throw new Error("Unexpect token after expression.");return t}function AC(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...AC(e.object)),t.push(...AC(e.property))),t)}function uB(e){return e.object.type==="MemberExpression"?uB(e.object):e.object.name==="datum"}function lB(e){const t=qAe(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&uB(r)&&n.add(AC(r).slice(1).join("."))}),n}class $c extends Ge{constructor(t,n,r){super(t);this.model=n,this.filter=r,this.expr=My(this.model,this.filter,this),this._dependentFields=lB(this.expr)}clone(){return new $c(null,this.model,de(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function HAe(e,t){var n;const r={},i=e.config.selection;if(!t||!t.length)return r;for(const o of t){const a=nt(o.name),s=o.select,u=fe(s)?s:s.type,l=Ve(s)?de(s):{type:u},c=i[u];for(const d in c)d==="fields"||d==="encodings"||(d==="mark"&&(l[d]=Object.assign(Object.assign({},c[d]),l[d])),(l[d]===void 0||l[d]===!0)&&(l[d]=(n=c[d])!==null&&n!==void 0?n:l[d]));const f=r[a]=Object.assign(Object.assign({},l),{name:a,type:u,init:o.value,bind:o.bind,events:fe(l.on)?xc(l.on,"scope"):ft(de(l.on))});for(const d of $y)d.defined(f)&&d.parse&&d.parse(e,f,o)}return r}function cB(e,t,n,r="datum"){const i=fe(t)?t:t.param,o=nt(i),a=ke(o+$u);let s;try{s=e.getSelectionComponent(o,i)}catch(c){return`!!${o}`}if(s.project.timeUnit){const c=n!=null?n:e.component.data.raw,f=s.project.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}const u=`vlSelectionTest(${a}, ${r}${s.resolve==="global"?")":`, ${ke(s.resolve)})`}`,l=`length(data(${a}))`;return t.empty===!1?`${l} && ${u}`:`!${l} || ${u}`}function fB(e,t,n){const r=nt(t),i=n.encoding;let o=n.field,a;try{a=e.getSelectionComponent(r,t)}catch(s){return r}if(!i&&!o)o=a.project.items[0].field,a.project.items.length>1&&U(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${ke(o)}.`);else if(i&&!o){const s=a.project.items.filter(u=>u.channel===i);!s.length||s.length>1?(o=a.project.items[0].field,U((s.length?"Multiple ":"No ")+`matching ${ke(i)} encoding found for selection ${ke(n.param)}. Using "field": ${ke(o)}.`)):o=s[0].field}return`${a.name}[${ke(Rr(o))}]`}function WAe(e,t){var n;for(const[r,i]of Ba((n=e.component.selection)!==null&&n!==void 0?n:{})){const o=e.getName(`lookup_${r}`);e.component.data.outputNodes[o]=i.materialized=new Tn(new $c(t,e,{param:r}),o,Ze.Lookup,e.component.data.outputNodeRefCounts)}}function My(e,t,n){return Dh(t,r=>fe(r)?r:Jxe(r)?cB(e,r,n):jL(r))}var Ty=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function GAe(e,t){if(!!e)return J(e)&&!Xa(e)?e.map(n=>jS(n,t)).join(", "):e}function $C(e,t,n,r){var i,o,a,s,u;(i=e.encode)!==null&&i!==void 0||(e.encode={}),(o=(s=e.encode)[t])!==null&&o!==void 0||(s[t]={}),(a=(u=e.encode[t]).update)!==null&&a!==void 0||(u.update={}),e.encode[t].update[n]=r}function a0(e,t,n,r={header:!1}){var i,o;const a=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=a,h=Ty(a,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const g in h){const p=owe[g],m=h[g];if(p&&p!==t&&p!=="both")delete h[g];else if(Wh(m)){const{condition:y}=m,v=Ty(m,["condition"]),b=ft(y),x=vP[g];if(x){const{vgProp:w,part:E}=x,_=[...b.map($=>{const{test:C}=$,O=Ty($,["test"]);return Object.assign({test:My(null,C)},O)}),v];$C(h,E,w,_),delete h[g]}else if(x===null){const w={signal:b.map(E=>{const{test:_}=E,$=Ty(E,["test"]);return`${My(null,_)} ? ${sL($)} : `}).join("")+sL(v)};h[g]=w}}else if(re(m)){const y=vP[g];if(y){const{vgProp:v,part:b}=y;$C(h,b,v,m),delete h[g]}}ye(["labelAlign","labelBaseline"],g)&&h[g]===null&&delete h[g]}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:g}=h.encode;h.encode=Object.assign({},g?{grid:g}:{}),We(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:vt(d,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let p=c;((o=(i=h.encode)===null||i===void 0?void 0:i.labels)===null||o===void 0?void 0:o.update)&&re(h.encode.labels.update.text)&&(p=hu(c,"datum.label",h.encode.labels.update.text.signal)),$C(h,"labels","text",{signal:p})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const p of bP)e.hasAxisPart(p)||delete h.encode[p];We(h.encode)&&delete h.encode}const g=GAe(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},g?{title:g}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:vt(d,0)})}}}function dB(e){const{axes:t}=e.component,n=[];for(const r of io)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const o=r==="x"?"height":"width",a=e.getSizeSignalRef(o).signal;o!==a&&n.push({name:o,update:a})}}return n}function YAe(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>a0(i,"grid",t)),...r.map(i=>a0(i,"grid",t)),...n.map(i=>a0(i,"main",t)),...r.map(i=>a0(i,"main",t))].filter(i=>i)}function hB(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const o=n==="x"?"bottom":"left",a=t[n==="x"?"axisBottom":"axisLeft"]||{},s=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...z(a),...z(s)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${o}" ? ${Ko(a[c])} : ${Ko(s[c])}`};return l}return t[i]})])}function VAe(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:u2e(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",a=re(n)?"axisOrient":`axis${Mh(n)}`,s=[...i,...i.map(l=>o+l.substr(4))],u=["axis",a,o];return{vlOnlyAxisConfig:hB(s,r,e,n),vgAxisConfig:hB(u,r,e,n),axisConfigStyle:XAe([...u,...s],r)}}function XAe(e,t){var n;const r=[{}];for(const i of e){let o=(n=t[i])===null||n===void 0?void 0:n.style;if(o){o=ft(o);for(const a of o)r.push(t.style[a])}}return Object.assign.apply(null,r)}function SC(e,t,n,r={}){var i;const o=lL(e,n,t);if(o!==void 0)return{configFrom:"style",configValue:o};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[a])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:a,configValue:r[a][e]};return{}}const gB={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return QL(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return eP(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return(r=t.grid)!==null&&r!==void 0?r:KAe(n,e)},gridScale:({model:e,channel:t})=>JAe(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||mB(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||pB(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:QAe(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:e$e(t.type,n,Y(t)&&!!t.timeUnit,Y(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var o;const a=e==="x"?"width":e==="y"?"height":void 0,s=a?t.getSizeSignalRef(a):void 0;return(o=n.tickCount)!==null&&o!==void 0?o:n$e({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=yB(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),o=n==="x"?"x2":"y2",a=t.fieldDef(o);return fL(i?[sP(i)]:[],Y(a)?[sP(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>r$e(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:i$e(n,t)}};function KAe(e,t){return!cn(e)&&Y(t)&&!Je(t==null?void 0:t.bin)&&!kn(t==null?void 0:t.bin)}function JAe(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function ZAe(e,t,n,r,i){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return re(o)?o:Th(o);{const{configValue:a}=SC("labelAngle",r,t==null?void 0:t.style,i);return a!==void 0?Th(a):n===at&&ye([bS,vS],e.type)&&!(Y(e)&&e.timeUnit)?270:void 0}}function CC(e){return`(((${e.signal} % 360) + 360) % 360)`}function pB(e,t,n,r){if(e!==void 0)if(n==="x"){if(re(e)){const i=CC(e),o=re(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(re(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(re(e)){const i=CC(e),o=re(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(re(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function mB(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,o=r?"bottom":"left";if(re(e)){const a=CC(e),s=re(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${i?`(${a} + 90)`:a} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${a} && ${a} < ${180+i}) === ${s} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(re(t)){const a=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${a} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function QAe(e,t){if(t==="x"&&ye(["quantitative","temporal"],e))return!0}function e$e(e,t,n,r){if(n&&!Ve(r)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function t$e(e){return e==="x"?"bottom":"left"}function n$e({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!cn(t)&&t!=="log"){if(Y(e)){if(Je(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&ye(["month","hours","day","quarter"],(i=Dn(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function yB(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,a=i?i.title:void 0;if(o&&a)return dL(o,a);if(o)return o;if(a)return a;if(o!==void 0)return o;if(a!==void 0)return a}function r$e(e,t){const n=e.values;if(J(n))return yP(t,n);if(re(n))return n}function i$e(e,t){return e==="rect"&&oy(t)?1:0}class Sc extends Ge{constructor(t,n){super(t);this.transform=n,this._dependentFields=lB(this.transform.calculate)}clone(){return new Sc(null,de(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(!!Eu(r)&&aP(r.sort)){const{field:o,timeUnit:a}=r,s=r.sort,u=s.map((l,c)=>`${jL({field:o,timeUnit:a,equal:l})} ? ${c} : `).join("")+s.length;t=new Sc(t,{calculate:u,as:Cc(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Ee(this.transform)}`}}function Cc(e,t,n){return G(e,Object.assign({prefix:t,suffix:"sort_index"},n!=null?n:{}))}function Ny(e,t){return ye(["top","bottom"],t)?"column":ye(["left","right"],t)||e==="row"?"row":"column"}function Oc(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return vt((t||{})[e],i[e],n.header[e])}function Ry(e,t,n,r){const i={};for(const o of e){const a=Oc(o,t||{},n,r);a!==void 0&&(i[o]=a)}return i}const OC=["row","column"],FC=["header","footer"];function o$e(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=Ry(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),u=Ny(t,s),l=Th(a);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),bB(l,u)),vB(u,l,o)),xB(r,i,t,Owe,PP))}}function vB(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=mB(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function bB(e,t){const n=pB(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function a$e(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of FC)if(n[i])for(const o of n[i]){const a=u$e(e,t,i,n,o);a!=null&&r.push(a)}return r}function s$e(e,t){var n;const{sort:r}=e;return uo(r)?{field:G(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:J(r)?{field:Cc(e,t,{expr:"datum"}),order:"ascending"}:{field:G(e,{expr:"datum"}),order:r!=null?r:"ascending"}}function kC(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:u}=Ry(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=CS({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=Ny(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?hu(hu(u,"datum.label",l),"datum.value",G(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),bB(o,c)),vB(c,o,a)),xB(n,e,t,Fwe,IP))}function u$e(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:a}=r,s=e.config?e.config:void 0;if(a&&i.labels){const{labelOrient:f}=Ry(["labelOrient"],a.header,s,t);(t==="row"&&!ye(["top","bottom"],f)||t==="column"&&!ye(["left","right"],f))&&(o=kC(a,t,s))}const u=vi(e)&&!qh(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(o||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:s$e(a,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),o?{title:o}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const l$e={column:{start:0,end:1},row:{start:1,end:0}};function c$e(e,t){return l$e[t][e]}function f$e(e,t){const n={};for(const r of Lr){const i=e[r];if(i==null?void 0:i.facetFieldDef){const{titleAnchor:o,titleOrient:a}=Ry(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),s=Ny(r,a),u=c$e(o,s);u!==void 0&&(n[s]=u)}}return We(n)?void 0:n}function xB(e,t,n,r,i){const o={};for(const a of r){if(!i[a])continue;const s=Oc(a,t==null?void 0:t.header,e,n);s!==void 0&&(o[i[a]]=s)}return o}function DC(e){return[...jy(e,"width"),...jy(e,"height"),...jy(e,"childWidth"),...jy(e,"childHeight")]}function jy(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const o=e.getScaleComponent(n);if(o){const a=o.get("type"),s=o.get("range");if(cn(a)&&Ka(s)){const u=e.scaleName(n);return vi(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[wB(u,s)]:[wB(u,s),{name:i,update:_B(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const o=i.endsWith("width"),a=o?"containerSize()[0]":"containerSize()[1]",s=JS(e.config.view,o?"width":"height"),u=`isFinite(${a}) ? ${a} : ${s}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function wB(e,t){return{name:`${e}_step`,value:t.step}}function _B(e,t,n){const r=t.get("type"),i=t.get("padding"),o=vt(t.get("paddingOuter"),i);let a=t.get("paddingInner");return a=r==="band"?a!==void 0?a:i:1,`bandspace(${n}, ${Ko(a)}, ${Ko(o)}) * ${e}_step`}function EB(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function AB(e,t){return z(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),Ec(t,i,r,o=>rt(o.value)))},{})}function $B(e,t){if(vi(t))return e==="theta"?"independent":"shared";if(Dc(t))return"shared";if(YC(t))return oo(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function MC(e,t){const n=e.scale[t],r=oo(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&U(xxe(t)),"independent"):e[r][t]||"shared"}const d$e=Object.assign(Object.assign({},Mwe),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),SB=z(d$e);class h$e extends Qo{}const CB={symbols:g$e,gradient:p$e,labels:m$e,entries:y$e};function g$e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){var a,s,u,l,c,f,d,h;if(o!=="symbol")return;const{markDef:g,encoding:p,config:m,mark:y}=n,v=g.filled&&y!=="trail";let b=Object.assign(Object.assign({},Tbe({},n,F2e)),DI(n,{filled:v}));const x=(a=i.get("symbolOpacity"))!==null&&a!==void 0?a:m.legend.symbolOpacity,w=(s=i.get("symbolFillColor"))!==null&&s!==void 0?s:m.legend.symbolFillColor,E=(u=i.get("symbolStrokeColor"))!==null&&u!==void 0?u:m.legend.symbolStrokeColor,_=x===void 0?(l=OB(p.opacity))!==null&&l!==void 0?l:g.opacity:void 0;if(b.fill){if(r==="fill"||v&&r===Xn)delete b.fill;else if(b.fill.field)w?delete b.fill:(b.fill=rt((c=m.legend.symbolBaseFillColor)!==null&&c!==void 0?c:"black"),b.fillOpacity=rt(_!=null?_:1));else if(J(b.fill)){const $=(h=(d=TC((f=p.fill)!==null&&f!==void 0?f:p.color))!==null&&d!==void 0?d:g.fill)!==null&&h!==void 0?h:v&&g.color;$&&(b.fill=rt($))}}if(b.stroke){if(r==="stroke"||!v&&r===Xn)delete b.stroke;else if(b.stroke.field||E)delete b.stroke;else if(J(b.stroke)){const $=vt(TC(p.stroke||p.color),g.stroke,v?g.color:void 0);$&&(b.stroke={value:$})}}if(r!==Go){const $=Y(t)&&kB(n,i,t);$?b.opacity=[Object.assign({test:$},rt(_!=null?_:1)),rt(m.legend.unselectedOpacity)]:_&&(b.opacity=rt(_))}return b=Object.assign(Object.assign({},b),e),We(b)?void 0:b}function p$e(e,{model:t,legendType:n,legendCmpt:r}){var i;if(n!=="gradient")return;const{config:o,markDef:a,encoding:s}=t;let u={};const c=((i=r.get("gradientOpacity"))!==null&&i!==void 0?i:o.legend.gradientOpacity)===void 0?OB(s.opacity)||a.opacity:void 0;return c&&(u.opacity=rt(c)),u=Object.assign(Object.assign({},u),e),We(u)?void 0:u}function m$e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},a=n.config,s=Y(t)?kB(n,i,t):void 0,u=s?[{test:s,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,f=_u(c)?OS({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:a}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return We(d)?void 0:d}function y$e(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function OB(e){return FB(e,(t,n)=>Math.max(t,n.value))}function TC(e){return FB(e,(t,n)=>vt(t,n.value))}function FB(e,t){if(Y2e(e))return ft(e.condition).reduce(t,e.value);if(gi(e))return e.value}function kB(e,t,n){const r=t.get("selections");if(!(r==null?void 0:r.length))return;const i=ke(n.field);return r.map(o=>`(!length(data(${ke(nt(o)+$u)})) || (${o}[${i}] && indexof(${o}[${i}], datum.value) >= 0))`).join(" || ")}const DB={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return QL(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return eP(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:A$e(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:$$e(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:b$e(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>pc(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(cc(n)&&hi(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>v$e(t,e)};function v$e(e,t){const n=e.values;if(J(n))return yP(t,n);if(re(n))return n}function b$e(e,t,n,r){var i;if(t!=="shape"){const o=(i=TC(n))!==null&&i!==void 0?i:r;if(o)return o}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function x$e(e){const{legend:t}=e;return vt(t.type,w$e(e))}function w$e({channel:e,timeUnit:t,scaleType:n}){if(cc(e)){if(ye(["quarter","month","day"],t))return"symbol";if(hi(n))return"gradient"}return"symbol"}function _$e({legendConfig:e,legendType:t,orient:n,legend:r}){var i,o;return(o=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&o!==void 0?o:E$e(n,t)}function E$e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function A$e({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:a,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(hi(i))return n==="horizontal"?r==="top"||r==="bottom"?MB(t,"width",a,o):a:MB(t,"height",u,s)}function MB(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function $$e(e){if(ye(["quantile","threshold","log","symlog"],e))return"greedy"}function TB(e){const t=bt(e)?S$e(e):k$e(e);return e.component.legends=t,t}function S$e(e){const{encoding:t}=e,n={};for(const r of[Xn,...zP]){const i=Ct(t[r]);!i||!e.getScaleComponent(r)||r===Kn&&Y(i)&&i.type===hc||(n[r]=F$e(e,r))}return n}function C$e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function O$e(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function F$e(e,t){var n,r,i;let o=e.legend(t);const{markDef:a,encoding:s,config:u}=e,l=u.legend,c=new h$e({},C$e(e,t));kEe(e,t,c);const f=o!==void 0?!o:l.disable;if(c.set("disable",f,o!==void 0),f)return c;o=o||{};const d=e.getScaleComponent(t).get("type"),h=Ct(s[t]),g=Y(h)?(n=Dn(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,p=o.orient||u.legend.orient||"right",m=x$e({legend:o,channel:t,timeUnit:g,scaleType:d}),y=_$e({legend:o,legendType:m,orient:p,legendConfig:l}),v={legend:o,channel:t,model:e,markDef:a,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:p,legendType:m,direction:y};for(const _ of SB){if(m==="gradient"&&_.startsWith("symbol")||m==="symbol"&&_.startsWith("gradient"))continue;const $=_ in DB?DB[_](v):o[_];if($!==void 0){const C=O$e($,_,o,e.fieldDef(t));(C||u.legend[_]===void 0)&&c.set(_,$,C)}}const b=(r=o==null?void 0:o.encoding)!==null&&r!==void 0?r:{},x=c.get("selections"),w={},E={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const _ of["labels","legend","title","symbols","gradient","entries"]){const $=AB((i=b[_])!==null&&i!==void 0?i:{},e),C=_ in CB?CB[_]($,E):$;C!==void 0&&!We(C)&&(w[_]=Object.assign(Object.assign(Object.assign({},(x==null?void 0:x.length)&&Y(h)?{name:`${nt(h.field)}_legend_${_}`}:{}),(x==null?void 0:x.length)?{interactive:!!x}:{}),{update:C}))}return We(w)||c.set("encode",w,!!(o==null?void 0:o.encoding)),c}function k$e(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){TB(r);for(const i of z(r.component.legends))n.legend[i]=MC(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=NB(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of z(t))for(const i of e.children)!i.component.legends[r]||n.legend[r]==="shared"&&delete i.component.legends[r];return t}function NB(e,t){var n,r,i,o;if(!e)return t.clone();const a=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;let u=!1;for(const l of SB){const c=ts(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return D$e(f,d);case"title":return hL(f,d);case"type":return u=!0,xr("symbol")}return vy(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0?void 0:r.gradient)&&N1(e.implicit,["encode","gradient"]),((o=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||o===void 0?void 0:o.gradient)&&N1(e.explicit,["encode","gradient"])),e}function D$e(e,t){return t.value==="circle"?t:e}var M$e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function T$e(e,t,n,r){var i,o,a,s,u;(i=e.encode)!==null&&i!==void 0||(e.encode={}),(o=(s=e.encode)[t])!==null&&o!==void 0||(s[t]={}),(a=(u=e.encode[t]).update)!==null&&a!==void 0||(u.update={}),e.encode[t].update[n]=r}function RB(e){const t=e.component.legends,n={};for(const i of z(t)){const o=e.getScaleComponent(i),a=Ke(o.get("domains"));if(n[a])for(const s of n[a])NB(s,t[i])||n[a].push(t[i]);else n[a]=[t[i].clone()]}return ln(n).flat().map(i=>N$e(i,e.config)).filter(i=>i!==void 0)}function N$e(e,t){var n,r,i;const o=e.combine(),{disable:a,labelExpr:s,selections:u}=o,l=M$e(o,["disable","labelExpr","selections"]);if(!a){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of zP)l[f]&&delete c[f]}if(l.title||delete l.title,s!==void 0){let c=s;((i=(r=l.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0?void 0:i.update)&&re(l.encode.labels.update.text)&&(c=hu(s,"datum.label",l.encode.labels.update.text.signal)),T$e(l,"labels","text",{signal:c})}return l}}function R$e(e){return Dc(e)||YC(e)?j$e(e):jB(e)}function j$e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),jB(e))}function jB(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(a=>a.signal).join(", ")}]`},o=t.data.reduce((a,s)=>{const u=re(s)?s.signal:`data('${e.lookupDataSource(s)}')`;return ye(a,u)||a.push(u),a},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const L$e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class LB extends Qo{constructor(t,n,r,i){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function PB(e){e.component.projection=bt(e)?P$e(e):z$e(e)}function P$e(e){var t;if(e.hasProjection){const n=Jn(e.specifiedProjection),r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=r?I$e(e):void 0,a=new LB(e.projectionName(!0),Object.assign(Object.assign({},(t=Jn(e.config.projection))!==null&&t!==void 0?t:{}),n!=null?n:{}),i,o);return a.get("type")||a.set("type","equalEarth",!1),a}}function I$e(e){const t=[],{encoding:n}=e;for(const r of[[to,eo],[jr,di]])(Ct(n[r[0]])||Ct(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Kn)&&e.typedFieldDef(Kn).type===hc&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Ze.Main)),t}function B$e(e,t){const n=U$(L$e,i=>!!(!oc(e.explicit,i)&&!oc(t.explicit,i)||oc(e.explicit,i)&&oc(t.explicit,i)&&Ki(e.get(i),t.get(i))));if(Ki(e.size,t.size)){if(n)return e;if(Ki(e.explicit,{}))return t;if(Ki(t.explicit,{}))return e}return null}function z$e(e){if(e.children.length===0)return;let t;for(const r of e.children)PB(r);const n=U$(e.children,r=>{const i=r.component.projection;if(i)if(t){const o=B$e(t,i);return o&&(t=o),!!o}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new LB(r,t.specifiedProjection,t.size,de(t.data));for(const o of e.children){const a=o.component.projection;a&&(a.isFit&&i.data.push(...o.component.projection.data),o.renameProjection(a.get("name"),r),a.merged=!0)}return i}}var U$e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function q$e(e,t,n,r){var i,o;if(Hh(t,n)){const a=bt(e)?(o=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&o!==void 0?o:{}:{},s=G(t,{expr:"datum"}),u=G(t,{expr:"datum",binSuffix:"end"});return{formulaAs:G(t,{binSuffix:"range",forAs:!0}),formula:Q1(s,u,a.format,a.formatType,r)}}return{}}function IB(e,t){return`${nL(e)}_${t}`}function H$e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function NC(e,t,n){var r;const i=(r=uy(n,void 0))!==null&&r!==void 0?r:{},o=IB(i,t);return e.getName(`${o}_bins`)}function W$e(e){return"as"in e}function BB(e,t,n){let r,i;W$e(e)?r=fe(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[G(e,{forAs:!0}),G(e,{binSuffix:"end",forAs:!0})];const o=Object.assign({},uy(t,void 0)),a=IB(o,e.field),{signal:s,extentSignal:u}=H$e(n,a);if(q1(o.extent)){const c=o.extent;i=fB(n,c.param,c),delete o.extent}const l=Object.assign(Object.assign(Object.assign({bin:o,field:e.field,as:[r]},s?{signal:s}:{}),u?{extentSignal:u}:{}),i?{span:i}:{});return{key:a,binComponent:l}}class po extends Ge{constructor(t,n){super(t);this.bins=n}clone(){return new po(null,de(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,a)=>{if(Ir(o)&&Je(o.bin)){const{key:s,binComponent:u}=BB(o,o.bin,n);i[s]=Object.assign(Object.assign(Object.assign({},u),i[s]),q$e(n,o,a,n.config))}return i},{});return We(r)?null:new po(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:o}=BB(n,n.bin,r);return new po(t,{[i]:o})}merge(t,n){for(const r of z(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=Ji([...this.bins[r].as,...t.bins[r].as],Ee)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(ln(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(ln(this.bins).map(t=>t.field))}hash(){return`Bin ${Ee(this.bins)}`}assemble(){return ln(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,o=t.bin,{extent:a}=o,s=U$e(o,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:Rr(t.field),as:r,signal:t.signal},q1(a)?{extent:null}:{extent:a}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!a&&t.extentSignal&&(n.push({type:"extent",field:Rr(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:G({field:r[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function G$e(e,t,n,r){var i;const o=bt(r)?r.encoding[Yo(t)]:void 0;if(Ir(n)&&bt(r)&&cP(n,o,r.markDef,r.config))e.add(G(n,{})),e.add(G(n,{suffix:"end"})),n.bin&&Hh(n,t)&&e.add(G(n,{binSuffix:"range"}));else if(ibe(t)){const a=rbe(t);e.add(r.getName(a))}else e.add(G(n));return Eu(n)&&v2e((i=n.scale)===null||i===void 0?void 0:i.range)&&e.add(n.scale.range.field),e}function Y$e(e,t){var n;for(const r of z(t)){const i=t[r];for(const o of z(i))r in e?e[r][o]=new Set([...(n=e[r][o])!==null&&n!==void 0?n:[],...i[o]]):e[r]={[o]:i[o]}}}class mi extends Ge{constructor(t,n,r){super(t);this.dimensions=n,this.measures=r}clone(){return new mi(null,new Set(this.dimensions),de(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(a=>{a.aggregate&&(r=!0)});const i={},o=new Set;return!r||(n.forEachFieldDef((a,s)=>{var u,l,c,f;const{aggregate:d,field:h}=a;if(d)if(d==="count")(u=i["*"])!==null&&u!==void 0||(i["*"]={}),i["*"].count=new Set([G(a,{forAs:!0})]);else{if(Vo(d)||Va(d)){const g=Vo(d)?"argmin":"argmax",p=d[g];(l=i[p])!==null&&l!==void 0||(i[p]={}),i[p][g]=new Set([G({op:g,field:p},{forAs:!0})])}else(c=i[h])!==null&&c!==void 0||(i[h]={}),i[h][d]=new Set([G(a,{forAs:!0})]);Ya(s)&&n.scaleDomain(s)==="unaggregated"&&((f=i[h])!==null&&f!==void 0||(i[h]={}),i[h].min=new Set([G({field:h,aggregate:"min"},{forAs:!0})]),i[h].max=new Set([G({field:h,aggregate:"max"},{forAs:!0})]))}else G$e(o,s,a,n)}),o.size+z(i).length===0)?null:new mi(t,o,i)}static makeFromTransform(t,n){var r,i,o;const a=new Set,s={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?((r=s["*"])!==null&&r!==void 0||(s["*"]={}),s["*"].count=new Set([f||G(u,{forAs:!0})])):((i=s[c])!==null&&i!==void 0||(s[c]={}),s[c][l]=new Set([f||G(u,{forAs:!0})])))}for(const u of(o=n.groupby)!==null&&o!==void 0?o:[])a.add(u);return a.size+z(s).length===0?null:new mi(t,a,s)}merge(t){return Bj(this.dimensions,t.dimensions)?(Y$e(this.measures,t.measures),!0):(jxe("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...z(this.measures)])}producedFields(){const t=new Set;for(const n of z(this.measures))for(const r of z(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${Ee({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const o of z(this.measures))for(const a of z(this.measures[o]))for(const s of this.measures[o][a])r.push(s),t.push(a),n.push(o==="*"?null:Rr(o));return{type:"aggregate",groupby:[...this.dimensions].map(Rr),ops:t,fields:n,as:r}}}class Fc extends Ge{constructor(t,n,r,i){super(t);this.model=n,this.name=r,this.data=i;for(const o of Lr){const a=n.facet[o];if(a){const{bin:s,sort:u}=a;this[o]=Object.assign({name:n.getName(`${o}_domain`),fields:[G(a),...Je(s)?[G(a,{binSuffix:"end"})]:[]]},uo(u)?{sortField:u}:J(u)?{sortIndexField:Cc(a,o)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Lr)this[n]&&(t+=` ${n.charAt(0)}:${Ee(this[n])}`);return t}get fields(){var t;const n=[];for(const r of Lr)((t=this[r])===null||t===void 0?void 0:t.fields)&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Lr)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of io){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),o=r.get("range");if(cn(i)&&Ka(o)){const a=Py(this.childModel,n),s=HC(a);s?t[n]=s:U(rS(n))}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x",facet:void 0}[t],o=[],a=[],s=[];i&&r&&r[i]&&(n?(o.push(`distinct_${r[i]}`),a.push("max")):(o.push(r[i]),a.push("distinct")),s.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=ey,field:f}=u;o.push(f),a.push(c),s.push(G(u,{forAs:!0}))}else l&&(o.push(l),a.push("max"),s.push(l));return{name:this[t].name,source:n!=null?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},o.length?{fields:o,ops:a,as:s}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:o}=this.model.component,a=[],s={};for(const c of OC){for(const f of FC){const d=(n=o[c]&&o[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((r=h.axes)===null||r===void 0?void 0:r.length)>0){s[c]=!0;break}}if(s[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};a.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=s;return(u||l)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}assemble(){var t,n;const r=[];let i=null;const o=this.getChildIndependentFieldsWithStep(),{column:a,row:s,facet:u}=this;if(a&&s&&(o.x||o.y)){i=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=o.x)!==null&&t!==void 0?t:[],(n=o.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[Uo,zo])this[l]&&r.push(this.assembleRowColumnHeaderData(l,i,o));if(u){const l=this.assembleFacetHeaderData(o);l&&r.push(...l)}return r}}function zB(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function V$e(e,t){const n=G$(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const r=zB(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.startsWith("utc:")){const r=zB(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return U(Gbe(t)),null}function X$e(e){const t={};return T1(e.filter,n=>{var r;if(RL(n)){let i=null;cS(n)?i=vr(n.equal):dS(n)?i=vr(n.lte):fS(n)?i=vr(n.lt):hS(n)?i=vr(n.gt):gS(n)?i=vr(n.gte):pS(n)?i=n.range[0]:mS(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(bu(i)?t[n.field]="date":yt(i)?t[n.field]="number":fe(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function K$e(e){const t={};function n(r){yc(r)?t[r.field]="date":r.type==="quantitative"&&Ebe(r.aggregate)?t[r.field]="number":lc(r.field)>1?r.field in t||(t[r.field]="flatten"):Eu(r)&&uo(r.sort)&&lc(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((bt(e)||vi(e))&&e.forEachFieldDef((r,i)=>{if(Ir(r))n(r);else{const o=mu(i),a=e.fieldDef(o);n(Object.assign(Object.assign({},r),{type:a.type}))}}),bt(e)){const{mark:r,markDef:i,encoding:o}=e;if(Ja(r)&&!e.encoding.order){const a=i.orient==="horizontal"?"y":"x",s=o[a];Y(s)&&s.type==="quantitative"&&!(s.field in t)&&(t[s.field]="number")}}return t}function J$e(e){const t={};if(bt(e)&&e.component.selection)for(const n of z(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&lc(i.field)>1&&(t[i.field]="flatten")}return t}class gn extends Ge{constructor(t,n){super(t);this._parse=n}clone(){return new gn(null,de(this._parse))}hash(){return`Parse ${Ee(this._parse)}`}static makeExplicit(t,n,r){var i;let o={};const a=n.data;return!ns(a)&&((i=a==null?void 0:a.format)===null||i===void 0?void 0:i.parse)&&(o=a.format.parse),this.makeWithAncestors(t,o,{},r)}static makeWithAncestors(t,n,r,i){for(const s of z(r)){const u=i.getWithExplicit(s);u.value!==void 0&&(u.explicit||u.value===r[s]||u.value==="derived"||r[s]==="flatten"?delete r[s]:U(xL(s,r[s],u.value)))}for(const s of z(n)){const u=i.get(s);u!==void 0&&(u===n[s]?delete n[s]:U(xL(s,n[s],u)))}const o=new Qo(n,r);i.copyAll(o);const a={};for(const s of z(o.combine())){const u=o.get(s);u!==null&&(a[s]=u)}return z(a).length===0||i.parseNothing?null:new gn(t,a)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of z(this._parse)){const r=this._parse[n];lc(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(z(this._parse))}dependentFields(){return new Set(z(this._parse))}assembleTransforms(t=!1){return z(this._parse).filter(n=>t?lc(n)>1:!0).map(n=>{const r=V$e(n,this._parse[n]);return r?{type:"formula",expr:r,as:Y$(n)}:null}).filter(n=>n!==null)}}class ss extends Ge{clone(){return new ss(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Gh])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Gh}}}class s0 extends Ge{constructor(t,n){super(t);this.params=n}clone(){return new s0(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Ee(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class u0 extends Ge{constructor(t,n){super(t);this.params=n}clone(){return new u0(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${Ee(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class Fu extends Ge{constructor(t){super(null);t!=null||(t={name:"source"});let n;if(ns(t)||(n=t.format?Object.assign({},yr(t.format,["parse"])):{}),Vh(t))this._data={values:t.values};else if(bc(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];ye(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else vI(t)?this._data={values:[{type:"Sphere"}]}:(mI(t)||ns(t))&&(this._data={});this._generator=ns(t),t.name&&(this._name=t.name),n&&!We(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var UB=function(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},Z$e=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},l0;function RC(e){return e instanceof Fu||e instanceof s0||e instanceof u0}class jC{constructor(){l0.set(this,void 0),UB(this,l0,!1,"f")}setModified(){UB(this,l0,!0,"f")}get modifiedFlag(){return Z$e(this,l0,"f")}}l0=new WeakMap;class ku extends jC{getNodeDepths(t,n,r){r.set(t,n);for(const i of t.children)this.getNodeDepths(i,n+1,r);return r}optimize(t){const r=[...this.getNodeDepths(t,0,new Map).entries()].sort((i,o)=>o[1]-i[1]);for(const i of r)this.run(i[0]);return this.modifiedFlag}}class LC extends jC{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class Q$e extends LC{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of z(r))r[i].length>1&&(this.setModified(),this.mergeNodes(t,r[i]))}}class eSe extends LC{constructor(t){super();this.requiresSelectionId=t&&pC(t)}run(t){t instanceof ss&&(this.requiresSelectionId&&(RC(t.parent)||t.parent instanceof mi||t.parent instanceof gn)||(this.setModified(),t.remove()))}}class tSe extends jC{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let r=new Set;t instanceof ho&&(r=t.producedFields(),q$(r,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const i of t.children)this.run(i,new Set([...n,...r]))}}class nSe extends LC{constructor(){super()}run(t){t instanceof Tn&&!t.isRequired()&&(this.setModified(),t.remove())}}class rSe extends ku{run(t){if(!RC(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof gn)if(t instanceof gn)this.setModified(),t.merge(n);else{if(W$(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class iSe extends ku{run(t){const n=[...t.children],r=t.children.filter(i=>i instanceof gn);if(t.numChildren()>1&&r.length>=1){const i={},o=new Set;for(const a of r){const s=a.parse;for(const u of z(s))u in i?i[u]!==s[u]&&o.add(u):i[u]=s[u]}for(const a of o)delete i[a];if(!We(i)){this.setModified();const a=new gn(t,i);for(const s of n){if(s instanceof gn)for(const u of z(i))delete s.parse[u];t.removeChild(s),s.parent=a,s instanceof gn&&z(s.parse).length===0&&s.remove()}}}}}class oSe extends ku{run(t){t instanceof Tn||t.numChildren()>0||t instanceof Fc||t instanceof Fu||(this.setModified(),t.remove())}}class aSe extends ku{run(t){const n=t.children.filter(i=>i instanceof ho),r=n.pop();for(const i of n)this.setModified(),r.merge(i)}}class sSe extends ku{run(t){const n=t.children.filter(i=>i instanceof mi),r={};for(const i of n){const o=Ee(i.groupBy);o in r||(r[o]=[]),r[o].push(i)}for(const i of z(r)){const o=r[i];if(o.length>1){const a=o.pop();for(const s of o)a.merge(s)&&(t.removeChild(s),s.parent=a,s.remove(),this.setModified())}}}}class uSe extends ku{constructor(t){super();this.model=t}run(t){const n=!(RC(t)||t instanceof $c||t instanceof gn||t instanceof ss),r=[],i=[];for(const o of t.children)o instanceof po&&(n&&!W$(t.producedFields(),o.dependentFields())?r.push(o):i.push(o));if(r.length>0){const o=r.pop();for(const a of r)o.merge(a,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof po?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(i.length>1){const o=i.pop();for(const a of i)o.merge(a,this.model.renameSignal.bind(this.model));this.setModified()}}}class lSe extends ku{run(t){const n=[...t.children];if(!uc(n,a=>a instanceof Tn)||t.numChildren()<=1)return;const i=[];let o;for(const a of n)if(a instanceof Tn){let s=a;for(;s.numChildren()===1;){const[u]=s.children;if(u instanceof Tn)s=u;else break}i.push(...s.children),o?(t.removeChild(a),a.parent=o.parent,o.parent.removeChild(o),o.parent=s,this.setModified()):o=s}else i.push(a);if(i.length){this.setModified();for(const a of i)a.parent.removeChild(a),a.parent=o}}}class Du extends Ge{constructor(t,n){super(t);this.transform=n}clone(){return new Du(null,de(this.transform))}addDimensions(t){this.transform.groupby=Ji(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:G(t)}hash(){return`JoinAggregateTransform ${Ee(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const o of this.transform.joinaggregate)n.push(o.op),r.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}function cSe(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=G(r);return i&&t.push(i),t},[])}function fSe(e){return J(e)&&e.every(t=>fe(t))&&e.length>1}class na extends Ge{constructor(t,n){super(t);this._stack=n}clone(){return new na(null,de(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:o,offset:a="zero"}=n,s=[],u=[];if(n.sort!==void 0)for(const f of n.sort)s.push(f.field),u.push(vt(f.order,"ascending"));const l={field:s,order:u};let c;return fSe(o)?c=o:fe(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new na(t,{stackField:r,groupby:i,offset:a,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannel:o,fieldChannel:a,offset:s,impute:u}=r;let l;if(o){const h=i[o];l=co(h)}const c=cSe(n),f=n.encoding.order;let d;return J(f)||Y(f)?d=cL(f):d=c.reduce((h,g)=>(h.field.push(g),h.order.push(a==="y"?"descending":"ascending"),h),{field:[],order:[]}),new na(t,{dimensionFieldDef:l,stackField:n.vgField(a),facetby:[],stackby:c,sort:d,offset:s,impute:u,as:[n.vgField(a,{suffix:"start",forAs:!0}),n.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Ee(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[G(t,{binSuffix:"mid"})]:[G(t,{}),G(t,{binSuffix:"end"})]:[G(t)]:r!=null?r:[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:o,sort:a,offset:s,impute:u,as:l}=this._stack;if(u&&r){const{bandPosition:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+G(r,{expr:"datum"})+`+${1-c}*`+G(r,{expr:"datum",binSuffix:"end"}),as:G(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...o,...n],key:G(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:a,as:l,offset:s}),t}}class kc extends Ge{constructor(t,n){super(t);this.transform=n}clone(){return new kc(null,de(this.transform))}addDimensions(t){this.transform.groupby=Ji(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:G(t)}hash(){return`WindowTransform ${Ee(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],o=[];for(const d of this.transform.window)r.push(d.op),i.push(this.getDefaultName(d)),o.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const a=this.transform.frame,s=this.transform.groupby;if(a&&a[0]===null&&a[1]===null&&r.every(d=>Q$(d)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},s!==void 0?{groupby:s}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:o,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),s!==void 0?{groupby:s}:{}),a!==void 0?{frame:a}:{})}}function dSe(e){function t(n){if(!(n instanceof Fc)){const r=n.clone();if(r instanceof Tn){const i=IC+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof mi||r instanceof na||r instanceof kc||r instanceof Du)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function PC(e){if(e instanceof Fc)if(e.numChildren()===1&&!(e.children[0]instanceof Tn)){const t=e.children[0];(t instanceof mi||t instanceof na||t instanceof kc||t instanceof Du)&&t.addDimensions(e.fields),t.swapWithParent(),PC(e)}else{const t=e.model.component.data.main;qB(t);const n=dSe(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(PC)}function qB(e){if(e instanceof Tn&&e.type===Ze.Main&&e.numChildren()===1){const t=e.children[0];t instanceof Fc||(t.swapWithParent(),qB(e))}}const IC="scale_",Ly=5;function BC(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!BC(t.children))return!1}return!0}function yi(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function HB(e,t,n){let r=e.sources,i=!1;return i=yi(new nSe,r)||i,i=yi(new eSe(t),r)||i,r=r.filter(o=>o.numChildren()>0),i=yi(new oSe,r)||i,r=r.filter(o=>o.numChildren()>0),n||(i=yi(new rSe,r)||i,i=yi(new uSe(t),r)||i,i=yi(new tSe,r)||i,i=yi(new iSe,r)||i,i=yi(new sSe,r)||i,i=yi(new aSe,r)||i,i=yi(new Q$e,r)||i,i=yi(new lSe,r)||i),e.sources=r,i}function hSe(e,t){BC(e.sources);let n=0,r=0;for(let i=0;i<Ly&&HB(e,t,!0);i++)n++;e.sources.map(PC);for(let i=0;i<Ly&&HB(e,t,!1);i++)r++;BC(e.sources),Math.max(n,r)===Ly&&U(`Maximum optimization runs(${Ly}) reached.`)}class er{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new er(()=>t(n))}}var gSe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function WB(e){bt(e)?pSe(e):mSe(e)}function pSe(e){const t=e.component.scales;for(const n of z(t)){const r=vSe(e,n);if(t[n].setWithExplicit("domains",r),xSe(e,n),e.component.data.isFaceted){let o=e;for(;!vi(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const s of r.value)Xo(s)&&(s.data=IC+s.data.replace(IC,""))}}}function mSe(e){for(const n of e.children)WB(n);const t=e.component.scales;for(const n of z(t)){let r,i=null;for(const o of e.children){const a=o.component.scales[n];if(a){r===void 0?r=a.getWithExplicit("domains"):r=ts(r,a.getWithExplicit("domains"),"domains","scale",qC);const s=a.get("selectionExtent");i&&s&&i.param!==s.param&&U(Ube),i=s}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function ySe(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:o}=GB(t,n);if(!i){U(o);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=GB(t,n);if(i)return"unaggregated"}return e}function vSe(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=ySe(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&Ct(r.x2)?Ct(r.x)?ts(us(n,i,e,"x"),us(n,i,e,"x2"),"domain","scale",qC):us(n,i,e,"x2"):t==="y"&&Ct(r.y2)?Ct(r.y)?ts(us(n,i,e,"y"),us(n,i,e,"y2"),"domain","scale",qC):us(n,i,e,"y2"):us(n,i,e,t)}function bSe(e,t,n){return e.map(r=>({signal:`{data: ${ly(r,{timeUnit:n,type:t})}}`}))}function zC(e,t,n){var r;const i=(r=Dn(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?bSe(e,t,i):[e]}function us(e,t,n,r){const{encoding:i}=n,o=Ct(i[r]),{type:a}=o,s=o.timeUnit;if(y2e(t)){const f=us(e,void 0,n,r),d=zC(t.unionWith,a,s);return ea([...f.value,...d])}else{if(re(t))return ea([t]);if(t&&t!=="unaggregated"&&!IL(t))return ea(zC(t,a,s))}const u=n.stack;if(u&&r===u.fieldChannel){if(u.offset==="normalize")return xr([[0,1]]);const f=n.requestDataName(Ze.Main);return xr([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const l=Ya(r)&&Y(o)?wSe(n,r,e):void 0;if(Za(o)){const f=zC([o.datum],a,s);return xr(f)}const c=o;if(t==="unaggregated"){const f=n.requestDataName(Ze.Main),{field:d}=o;return xr([{data:f,field:G({field:d,aggregate:"min"})},{data:f,field:G({field:d,aggregate:"max"})}])}else if(Je(c.bin)){if(cn(e))return xr(e==="bin-ordinal"?[]:[{data:kh(l)?n.requestDataName(Ze.Main):n.requestDataName(Ze.Raw),field:n.vgField(r,Hh(c,r)?{binSuffix:"range"}:{}),sort:l===!0||!Ve(l)?{field:n.vgField(r,{}),op:"min"}:l}]);{const{bin:f}=c;if(Je(f)){const d=NC(n,c.field,f);return xr([new er(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return xr([{data:n.requestDataName(Ze.Main),field:n.vgField(r,{})}])}}else if(c.timeUnit&&ye(["time","utc"],e)&&cP(c,bt(n)?n.encoding[Yo(r)]:void 0,n.markDef,n.config)){const f=n.requestDataName(Ze.Main);return xr([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return xr(l?[{data:kh(l)?n.requestDataName(Ze.Main):n.requestDataName(Ze.Raw),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(Ze.Main),field:n.vgField(r)}])}function UC(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n!=null?n:t?"sum":ey},r?{field:Rr(r)}:{}),i?{order:i}:{})}function xSe(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,o=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,a=IL(i)&&i,s=yu(o)&&q1(o.extent)&&o.extent;(a||s)&&r.set("selectionExtent",a!=null?a:s,!0)}function wSe(e,t,n){if(!cn(n))return;const r=e.fieldDef(t),i=r.sort;if(aP(i))return{op:"min",field:Cc(r,t),order:"ascending"};const{stack:o}=e,a=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map(s=>s.fieldDef.field)]:void 0;if(uo(i)){const s=o&&!ye(a,i.field);return UC(i,s)}else if(oP(i)){const{encoding:s,order:u}=i,l=e.fieldDef(s),{aggregate:c,field:f}=l,d=o&&!ye(a,f);if(Vo(c)||Va(c))return UC({field:G(l),order:u},d);if(Q$(c)||!c)return UC({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(ye(["ascending",void 0],i))return!0}}function GB(e,t){const{aggregate:n,type:r}=e;return n?fe(n)&&!Sbe[n]?{valid:!1,reason:hxe(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:gxe(e)}:{valid:!0}:{valid:!1,reason:dxe(e)}}function qC(e,t,n,r){return e.explicit&&t.explicit&&U(bxe(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function _Se(e){const t=Ji(e.map(a=>Xo(a)?gSe(a,["sort"]):a),Ee),n=Ji(e.map(a=>{if(Xo(a)){const s=a.sort;return s!==void 0&&!kh(s)&&("op"in s&&s.op==="count"&&delete s.field,s.order==="ascending"&&delete s.order),s}}).filter(a=>a!==void 0),Ee);if(t.length===0)return;if(t.length===1){const a=e[0];if(Xo(a)&&n.length>0){let s=n[0];if(n.length>1)U(SL),s=!0;else if(Ve(s)&&"field"in s){const u=s.field;a.field===u&&(s=s.order?{order:s.order}:!0)}return Object.assign(Object.assign({},a),{sort:s})}return a}const r=Ji(n.map(a=>kh(a)||!("op"in a)||fe(a.op)&&a.op in wbe?a:(U(wxe(a)),!0)),Ee);let i;r.length===1?i=r[0]:r.length>1&&(U(SL),i=!0);const o=Ji(e.map(a=>Xo(a)?a.data:null),a=>a);return o.length===1&&o[0]!==null?Object.assign({data:o[0],fields:t.map(s=>s.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function HC(e){if(Xo(e)&&fe(e.field))return e.field;if(Obe(e)){let t;for(const n of e.fields)if(Xo(n)&&fe(n.field)){if(!t)t=n.field;else if(t!==n.field)return U(_xe),t}return U(Exe),t}else if(Fbe(e)){U(Axe);const t=e.fields[0];return fe(t)?t:void 0}}function Py(e,t){const r=e.component.scales[t].get("domains").map(i=>(Xo(i)&&(i.data=e.lookupDataSource(i.data)),i));return _Se(r)}var ESe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function YB(e){return Dc(e)||YC(e)?e.children.reduce((t,n)=>t.concat(YB(n)),VB(e)):VB(e)}function VB(e){return z(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:a,selectionExtent:s,domains:u,range:l,reverse:c}=i,f=ESe(i,["name","type","selectionExtent","domains","range","reverse"]),d=ASe(i.range,o,n,e),h=Py(e,n),g=s?oEe(e,s,r,h):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:a},h?{domain:h}:{}),g?{domainRaw:g}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function ASe(e,t,n,r){if(oo(n)){if(Ka(e))return{step:{signal:`${t}_step`}}}else if(Ve(e)&&Xo(e))return Object.assign(Object.assign({},e),{data:r.lookupDataSource(e.data)});return e}class XB extends Qo{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:uc(this.get("domains"),t=>J(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const $Se=["range","scheme"];function KB(e){return e==="x"?"width":e==="y"?"height":void 0}function SSe(e){const t=e.component.scales;for(const n of U1){const r=t[n];if(!r)continue;const i=CSe(n,e);r.setWithExplicit("range",i)}}function JB(e,t){const n=e.fieldDef(t);if(n==null?void 0:n.bin){const{bin:r,field:i}=n,o=KB(t),a=e.getName(o);if(Ve(r)&&r.binned&&r.step!==void 0)return new er(()=>{const s=e.scaleName(t),u=`(domain("${s}")[1] - domain("${s}")[0]) / ${r.step}`;return`${e.getSignalName(a)} / (${u})`});if(Je(r)){const s=NC(e,i,r);return new er(()=>{const u=e.getSignalName(s),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(a)} / (${l})`})}}}function CSe(e,t){const n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(const l of $Se)if(n[l]!==void 0){const c=wS(o,l),f=BL(e,l);if(!c)U(AL(o,l,e));else if(f)U(f);else switch(l){case"range":{const d=n.range;if(J(d)){if(oo(e))return ea(d.map(h=>{if(h==="width"||h==="height"){const g=t.getName(h),p=t.getSignalName.bind(t);return er.fromName(p,g)}return h}))}else if(Ve(d))return ea({data:t.requestDataName(Ze.Main),field:d.field,sort:{op:"min",field:t.vgField(e)}});return ea(d)}case"scheme":return ea(OSe(n[l]))}}if(e===at||e===$t){const l=e===at?"width":"height",c=r[l];if(fo(c)){if(cn(o))return ea({step:c.step});U($L(l))}}const{rangeMin:a,rangeMax:s}=n,u=FSe(e,t);return(a!==void 0||s!==void 0)&&wS(o,"rangeMin")&&J(u)&&u.length===2?ea([a!=null?a:u[0],s!=null?s:u[1]]):xr(u)}function OSe(e){return m2e(e)?Object.assign({scheme:e.name},yr(e,["name"])):{scheme:e}}function FSe(e,t){const{size:n,config:r,mark:i,encoding:o}=t,a=t.getSignalName.bind(t),{type:s}=Ct(o[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case at:case $t:{if(ye(["point","band"],l)){if(e===at&&!n.width){const g=Yh(r.view,"width");if(fo(g))return g}else if(e===$t&&!n.height){const g=Yh(r.view,"height");if(fo(g))return g}}const d=KB(e),h=t.getName(d);return e===$t&&br(l)?[er.fromName(a,h),0]:[0,er.fromName(a,h)]}case Wo:{const d=t.component.scales[e].get("zero"),h=ZB(i,d,r),g=MSe(i,n,t,r);return zh(l)?DSe(h,g,kSe(l,r,c,e)):[h,g]}case fi:return[0,Math.PI*2];case gu:return[0,360];case Qi:return[0,new er(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case qa:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Ha:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Kn:return"symbol";case Xn:case no:case ro:return l==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case Go:case za:case Ua:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function kSe(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&J(n)?n.length+1:(U(Txe(r)),3)}}function DSe(e,t,n){const r=()=>{const i=Ko(t),o=Ko(e),a=`(${i} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${i} + ${a}, ${a})`};return re(t)?new er(r):{signal:r()}}function ZB(e,t,n){if(t)return re(t)?{signal:`${t.signal} ? 0 : ${ZB(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(W1("size",e))}const QB=.95;function MSe(e,t,n,r){const i={x:JB(n,"x"),y:JB(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const o=ez(t,i,r.view);return yt(o)?o-1:new er(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const o=ez(t,i,r.view);return yt(o)?Math.pow(QB*o,2):new er(()=>`pow(${QB} * ${o.signal}, 2)`)}}throw new Error(W1("size",e))}function ez(e,t,n){const r=fo(e.width)?e.width.step:my(n,"width"),i=fo(e.height)?e.height.step:my(n,"height");return t.x||t.y?new er(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function tz(e,t){bt(e)?TSe(e,t):iz(e,t)}function TSe(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:a}=e;for(const s of z(n)){const u=a[s],l=n[s],c=e.getScaleComponent(s),f=Ct(i[s]),d=u[t],h=c.get("type"),g=c.get("padding"),p=c.get("paddingInner"),m=wS(h,t),y=BL(s,t);if(d!==void 0&&(m?y&&U(y):U(AL(h,t,s))),m&&y===void 0)if(d!==void 0){const v=f.timeUnit,b=f.type;switch(t){case"domainMax":case"domainMin":bu(u[t])||b==="temporal"||v?l.set(t,{signal:ly(u[t],{type:b,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=t in nz?nz[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:g,scalePaddingInner:p,domain:u.domain,markDef:o,config:r}):r.scale[t];v!==void 0&&l.set(t,v,!1)}}}const nz={bins:({model:e,fieldOrDatumDef:t})=>Y(t)?NSe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>RSe(e,t.type),nice:({scaleType:e,channel:t,domain:n,fieldOrDatumDef:r})=>jSe(e,t,n,r),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>LSe(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>PSe(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:o})=>ISe(e,t,n,r.type,i,o.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=Y(e)?e.sort:void 0;return BSe(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>zSe(e,t,n,r,i)};function rz(e){bt(e)?SSe(e):iz(e,"range")}function iz(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?rz(r):tz(r,t);for(const r of z(n)){let i;for(const o of e.children){const a=o.component.scales[r];if(a){const s=a.getWithExplicit(t);i=ts(i,s,t,"scale",pI((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function NSe(e,t){const n=t.bin;if(Je(n)){const r=NC(e,t.field,n);return new er(()=>e.getSignalName(r))}else if(kn(n)&&yu(n)&&n.step!==void 0)return{step:n.step}}function RSe(e,t){if(ye([Xn,no,ro],e)&&t!=="nominal")return"hcl"}function jSe(e,t,n,r){var i;if(!(((i=co(r))===null||i===void 0?void 0:i.bin)||J(n)||ye([St.TIME,St.UTC],e)))return t in Ga?!0:void 0}function LSe(e,t,n,r,i,o){if(e in Ga){if(hi(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:a,orient:s}=i;if(a==="bar"&&!(Y(r)&&(r.bin||r.timeUnit))&&(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===St.POINT)return n.pointPadding}}function PSe(e,t,n,r){if(e===void 0&&t in Ga){const{bandPaddingInner:i,barBandPaddingInner:o,rectBandPaddingInner:a}=r;return vt(i,n==="bar"?o:a)}}function ISe(e,t,n,r,i,o){if(e===void 0&&t in Ga&&n===St.BAND){const{bandPaddingOuter:a}=o;return vt(a,re(i)?{signal:`${i.signal}/2`}:i/2)}}function BSe(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return br(e)&&t==="descending"?re(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(br(e)&&t==="descending")return!0}function zSe(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&br(i)){if(J(n)){const a=n[0],s=n[n.length-1];if(a<=0&&s>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!zh(i))return!0;if(!(Y(t)&&t.bin)&&ye([...io,...hbe],e)){const{orient:a,type:s}=r;return!(ye(["bar","area","line","trail"],s)&&(a==="horizontal"&&e==="y"||a==="vertical"&&e==="x"))}return!1}function USe(e,t,n,r){const i=qSe(t,n,r),{type:o}=e;return Ya(t)?o!==void 0?E2e(t,o)?Y(n)&&!_2e(o,n.type)?(U(yxe(o,i)),i):o:(U(mxe(t,o,i)),i):i:null}function qSe(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":{if(cc(e)||Z$(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&U(oS(e,"ordinal")),"ordinal";if(e in Ga){if(ye(["rect","bar","image","rule"],n.type))return"band"}else if(n.type==="arc"&&e in J$)return"band";const i=n[Pr(e)];return gc(i)||NS(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point"}case"temporal":return cc(e)?"time":Z$(e)==="discrete"?(U(oS(e,"temporal")),"ordinal"):Y(t)&&t.timeUnit&&Dn(t.timeUnit).utc?"utc":"time";case"quantitative":return cc(e)?Y(t)&&Je(t.bin)?"bin-ordinal":"linear":Z$(e)==="discrete"?(U(oS(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(_L(t.type))}function HSe(e,{ignoreRange:t}={}){oz(e),WB(e);for(const n of w2e)tz(e,n);t||rz(e)}function oz(e){bt(e)?e.component.scales=WSe(e):e.component.scales=YSe(e)}function WSe(e){const{encoding:t,mark:n,markDef:r}=e;return U1.reduce((i,o)=>{const a=Ct(t[o]);if(a&&n===qL&&o===Kn&&a.type===hc)return i;let s=a&&a.scale;if(a&&s!==null&&s!==!1){s!=null||(s={});const u=USe(s,o,a,r);i[o]=new XB(e.scaleName(`${o}`,!0),{value:u,explicit:s.type===u})}return i},{})}const GSe=pI((e,t)=>LL(e)-LL(t));function YSe(e){var t,n;const r=e.component.scales={},i={},o=e.component.resolve;for(const a of e.children){oz(a);for(const s of z(a.component.scales))if((t=(n=o.scale)[s])!==null&&t!==void 0||(n[s]=$B(s,e)),o.scale[s]==="shared"){const u=i[s],l=a.component.scales[s].getWithExplicit("type");u?r2e(u.value,l.value)?i[s]=ts(u,l,"type","scale",GSe):(o.scale[s]="independent",delete i[s]):i[s]=l}}for(const a of z(i)){const s=e.scaleName(a,!0),u=i[a];r[a]=new XB(s,u);for(const l of e.children){const c=l.component.scales[a];c&&(l.renameScale(c.get("name"),s),c.merged=!0)}}return r}var WC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class GC{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function bt(e){return(e==null?void 0:e.type)==="unit"}function vi(e){return(e==null?void 0:e.type)==="facet"}function YC(e){return(e==null?void 0:e.type)==="concat"}function Dc(e){return(e==null?void 0:e.type)==="layer"}class VC{constructor(t,n,r,i,o,a,s){var u,l;this.type=n,this.parent=r,this.config=o,this.correctDataNames=c=>{var f,d,h;return((f=c.from)===null||f===void 0?void 0:f.data)&&(c.from.data=this.lookupDataSource(c.from.data)),((h=(d=c.from)===null||d===void 0?void 0:d.facet)===null||h===void 0?void 0:h.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=r,this.config=o,this.view=Jn(s),this.name=(u=t.name)!==null&&u!==void 0?u:i,this.title=Xa(t.title)?{text:t.title}:t.title?Jn(t.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new GC,this.projectionNameMap=r?r.projectionNameMap:new GC,this.signalNameMap=r?r.signalNameMap:new GC,this.data=t.data,this.description=t.description,this.transforms=M_e((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:Pwe(t,n,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:ty(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new Qo,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?de(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){HSe(this)}parseProjection(){PB(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){TB(this)}assembleEncodeFromView(t){const n=WC(t,["style"]),r={};for(const i of z(n)){const o=n[i];o!==void 0&&(r[i]=rt(o))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=rt(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n!=null?n:{}):We(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=WC(t,["spacing"]),{component:i,config:o}=this,a=f$e(i.layoutHeaders,o);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),a?{titleBand:a}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of Lr)t[r].title&&n.push(o$e(this,r));for(const r of OC)n=n.concat(a$e(this,r));return n}assembleAxes(){return YAe(this.component.axes,this.config)}assembleLegends(){return RB(this)}assembleProjections(){return R$e(this)}assembleTitle(){var t,n,r;const i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:o}=i,a=WC(i,["encoding"]),s=Object.assign(Object.assign(Object.assign({},iL(this.config.title).nonMarkTitleProperties),a),o?{encode:{update:o}}:{});if(s.text)return ye(["unit","layer"],this.type)?ye(["middle",void 0],s.anchor)&&((n=s.frame)!==null&&n!==void 0||(s.frame="group")):(r=s.anchor)!==null&&r!==void 0||(s.anchor="start"),We(s)?void 0:s}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||vi(this.parent)?YB(this):[];i.length>0&&(n.scales=i);const o=this.assembleAxes();o.length>0&&(n.axes=o);const a=this.assembleLegends();return a.length>0&&(n.legends=a),n}getName(t){return nt((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Ze[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(vi(this.parent)){const n=EB(t),r=z1(n),i=this.component.scales[r];if(i&&!i.merged){const o=i.get("type"),a=i.get("range");if(cn(o)&&Ka(a)){const s=i.get("name"),u=Py(this,r),l=HC(u);if(l){const c=G({aggregate:"distinct",field:l},{expr:"datum"});return{signal:_B(s,i,c)}}else return U(rS(r)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(Kj(t)&&Ya(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(Lbe(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class az extends VC{vgField(t,n={}){const r=this.fieldDef(t);if(!!r)return G(r,n)}reduceFieldDef(t,n){return dwe(this.getMapping(),(r,i,o)=>{const a=co(i);return a?t(r,a,o):r},n)}forEachFieldDef(t,n){IS(this.getMapping(),(r,i)=>{const o=co(r);o&&t(o,i)},n)}}var VSe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class Iy extends Ge{constructor(t,n){var r,i,o;super(t);this.transform=n,this.transform=de(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"value",(o=a[1])!==null&&o!==void 0?o:"density"]}clone(){return new Iy(null,de(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Ee(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=VSe(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class c0 extends Ge{constructor(t,n){super(t);this.filter=n}clone(){return new c0(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:o}=n;if(Be("invalid",o,r)!=="filter")return null;const s=n.reduceFieldDef((u,l,c)=>{const f=Ya(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");br(d)&&l.aggregate!=="count"&&!Ja(i)&&(u[l.field]=l)}return u},{});return z(s).length?new c0(t,s):null}dependentFields(){return new Set(z(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Ee(this.filter)}`}assemble(){const t=z(this.filter).reduce((n,r)=>{const i=this.filter[r],o=G(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):i.type==="quantitative"&&(n.push(`isValid(${o})`),n.push(`isFinite(+${o})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class By extends Ge{constructor(t,n){super(t);this.transform=n,this.transform=de(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((o,a)=>{var s;return(s=i[a])!==null&&s!==void 0?s:o})}clone(){return new By(this.parent,de(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Ee(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class zy extends Ge{constructor(t,n){var r,i,o;super(t);this.transform=n,this.transform=de(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"key",(o=a[1])!==null&&o!==void 0?o:"value"]}clone(){return new zy(null,de(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Ee(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Mc extends Ge{constructor(t,n,r,i){super(t);this.fields=n,this.geojson=r,this.signal=i}clone(){return new Mc(null,de(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[to,eo],[jr,di]]){const o=i.map(a=>{const s=Ct(n.encoding[a]);return Y(s)?s.field:Za(s)?{expr:`${s.datum}`}:gi(s)?{expr:`${s.value}`}:void 0});(o[0]||o[1])&&(t=new Mc(t,o,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(Kn)){const i=n.typedFieldDef(Kn);i.type===hc&&(t=new Mc(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(fe);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Ee(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class f0 extends Ge{constructor(t,n,r,i){super(t);this.projection=n,this.fields=r,this.as=i}clone(){return new f0(null,this.projection,de(this.fields),de(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[to,eo],[jr,di]]){const i=r.map(a=>{const s=Ct(n.encoding[a]);return Y(s)?s.field:Za(s)?{expr:`${s.datum}`}:gi(s)?{expr:`${s.value}`}:void 0}),o=r[0]===jr?"2":"";(i[0]||i[1])&&(t=new f0(t,n.projectionName(),i,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(fe))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Ee(this.fields)} ${Ee(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Mu extends Ge{constructor(t,n){super(t);this.transform=n}clone(){return new Mu(null,de(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new Mu(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,o=r.y;if(Y(i)&&Y(o)){const a=i.impute?i:o.impute?o:void 0;if(a===void 0)return;const s=i.impute?o:o.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=a.impute,d=AP(n.mark,r);return new Mu(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:a.field,key:s.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${Ee(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:o,value:a,frame:s=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:g_e(r)?this.processSequence(r):r}:{}),{method:"value"}),o?{groupby:o}:{}),{value:!i||i==="value"?a:null});if(i&&i!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:s,ignorePeers:!1},o?{groupby:o}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}var XSe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class Uy extends Ge{constructor(t,n){var r,i,o;super(t);this.transform=n,this.transform=de(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:n.on,(o=a[1])!==null&&o!==void 0?o:n.loess]}clone(){return new Uy(null,de(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Ee(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=XSe(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class d0 extends Ge{constructor(t,n,r){super(t);this.transform=n,this.secondary=r}clone(){return new d0(null,de(this.transform),this.secondary)}static make(t,n,r,i){const o=n.component.data.sources,{from:a}=r;let s=null;if(p_e(a)){let u=cz(a.data,o);u||(u=new Fu(a.data),o.push(u));const l=n.getName(`lookup_${i}`);s=new Tn(u,l,Ze.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=s}else if(m_e(a)){const u=a.param;r=Object.assign({as:u},r);let l;try{l=n.getSelectionComponent(nt(u),u)}catch(c){throw new Error(Bbe(u))}if(s=l.materialized,!s)throw new Error(zbe(u))}return new d0(t,r,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?ft(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Ee({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:ft(this.transform.as)}:{});else{let n=this.transform.as;fe(n)||(U(Xbe),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}var KSe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class qy extends Ge{constructor(t,n){var r,i,o;super(t);this.transform=n,this.transform=de(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:"prob",(o=a[1])!==null&&o!==void 0?o:"value"]}clone(){return new qy(null,de(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Ee(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=KSe(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}var JSe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class Hy extends Ge{constructor(t,n){var r,i,o;super(t);this.transform=n,this.transform=de(n);const a=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=a[0])!==null&&i!==void 0?i:n.on,(o=a[1])!==null&&o!==void 0?o:n.regression]}clone(){return new Hy(null,de(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Ee(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=JSe(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class Wy extends Ge{constructor(t,n){super(t);this.transform=n}clone(){return new Wy(null,de(this.transform))}addDimensions(t){var n;this.transform.groupby=Ji(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${Ee(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:o}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),o!==void 0?{op:o}:{}),r!==void 0?{groupby:r}:{})}}class Gy extends Ge{constructor(t,n){super(t);this.transform=n}clone(){return new Gy(null,de(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Ee(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function sz(e){let t=0;function n(r,i){var o;if(r instanceof Fu&&!r.isGenerator&&!bc(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof gn&&(r.parent instanceof Fu&&!i.source?(i.format=Object.assign(Object.assign({},(o=i.format)!==null&&o!==void 0?o:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof Fc){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,e.push(...r.assemble());return}switch((r instanceof s0||r instanceof u0||r instanceof c0||r instanceof $c||r instanceof Sc||r instanceof f0||r instanceof mi||r instanceof d0||r instanceof kc||r instanceof Du||r instanceof zy||r instanceof By||r instanceof Iy||r instanceof Uy||r instanceof qy||r instanceof Hy||r instanceof ss||r instanceof Gy||r instanceof Wy)&&i.transform.push(r.assemble()),(r instanceof po||r instanceof ho||r instanceof Mu||r instanceof na||r instanceof Mc)&&i.transform.push(...r.assemble()),r instanceof Tn&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof Tn?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof Tn&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let a=i.name;!i.source||i.transform.length>0?e.push(i):a=i.source;for(const s of r.children)n(s,{name:null,source:a,transform:[]});break}}}return n}function ZSe(e){const t=[],n=sz(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function QSe(e,t){var n,r;const i=[],o=sz(i);let a=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${a++}`);const l=u.assemble();o(u,l)}for(const u of i)u.transform.length===0&&delete u.transform;let s=0;for(const[u,l]of i.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&i.splice(s++,0,i.splice(u,1)[0]);for(const u of i)for(const l of(r=u.transform)!==null&&r!==void 0?r:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of i)u.name in t&&(u.values=t[u.name]);return i}function eCe(e){return e==="top"||e==="left"||re(e)?"header":"footer"}function tCe(e){for(const t of Lr)nCe(e,t);lz(e,"x"),lz(e,"y")}function nCe(e,t){var n;const{facet:r,config:i,child:o,component:a}=e;if(e.channelHasField(t)){const s=r[t],u=Oc("title",null,i,t);let l=pc(s,i,{allowDisabling:!0,includeDefault:u===void 0||!!u});o.component.layoutHeaders[t].title&&(l=J(l)?l.join(", "):l,l+=` / ${o.component.layoutHeaders[t].title}`,o.component.layoutHeaders[t].title=null);const c=Oc("labelOrient",s.header,i,t),f=s.header!==null?vt((n=s.header)===null||n===void 0?void 0:n.labels,i.header.labels,!0):!1,d=ye(["bottom","right"],c)?"footer":"header";a.layoutHeaders[t]={title:s.header!==null?l:null,facetFieldDef:s,[d]:t==="facet"?[]:[uz(e,t,f)]}}}function uz(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function lz(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:o}=e.component;if(o.axis[t]=MC(o,t),o.axis[t]==="shared"){const a=t==="x"?"column":"row",s=i[a];for(const u of r.component.axes[t]){const l=eCe(u.get("orient"));(n=s[l])!==null&&n!==void 0||(s[l]=[uz(e,a,!1)]);const c=a0(u,"main",e.config,{header:!0});c&&s[l][0].axes.push(c),u.mainExtracted=!0}}}}function rCe(e){XC(e),Yy(e,"width"),Yy(e,"height")}function iCe(e){XC(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";Yy(e,t),Yy(e,n)}function XC(e){for(const t of e.children)t.parseLayoutSize()}function Yy(e,t){var n;const r=EB(t),i=z1(r),o=e.component.resolve,a=e.component.layoutSize;let s;for(const u of e.children){const l=u.component.layoutSize.getWithExplicit(r),c=(n=o.scale[i])!==null&&n!==void 0?n:$B(i,e);if(c==="independent"&&l.value==="step"){s=void 0;break}if(s){if(c==="independent"&&s.value!==l.value){s=void 0;break}s=ts(s,l,r,"")}else s=l}if(s){for(const u of e.children)e.renameSignal(u.getName(r),e.getName(t)),u.component.layoutSize.set(r,"merged",!1);a.setWithExplicit(t,s)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function oCe(e){const{size:t,component:n}=e;for(const r of io){const i=Pr(r);if(t[i]){const o=t[i];n.layoutSize.set(i,fo(o)?"step":o,!0)}else{const o=aCe(e,i);n.layoutSize.set(i,o,!1)}}}function aCe(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const o=i.get("type"),a=i.get("range");if(cn(o)){const s=Yh(r.view,t);return Ka(a)||fo(s)?"step":s}else return JS(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return JS(r.view,t);{const o=Yh(r.view,t);return fo(o)?o.step:o}}}function KC(e,t,n){return G(t,Object.assign({suffix:`by_${G(e)}`},n!=null?n:{}))}class h0 extends az{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve);this.child=tO(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!qh(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=z(t),r={};for(const i of n){if(![zo,Uo].includes(i)){U(W1(i,"facet"));break}const o=t[i];if(o.field===void 0){U(iS(o,i));break}r[i]=this.initFacetFieldDef(o,i)}return r}initFacetFieldDef(t,n){const r=LS(t,n);return r.header?r.header=Jn(r.header):r.header===null&&(r.header=null),r}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Vy(this),this.child.parseData()}parseLayoutSize(){XC(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),tCe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const o of Lr)for(const a of FC){const s=this.component.layoutHeaders[o],u=s[a],{facetFieldDef:l}=s;if(l){const c=Oc("titleOrient",l.header,this.config,o);if(["right","bottom"].includes(c)){const f=Ny(o,c);(t=i.titleAnchor)!==null&&t!==void 0||(i.titleAnchor={}),i.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=o==="row"?"height":"width",f=a==="header"?"headerBand":"footerBand";o!=="facet"&&!this.child.component.layoutSize.get(c)&&((n=i[f])!==null&&n!==void 0||(i[f]={}),i[f][o]=.5),s.title&&((r=i.offset)!==null&&r!==void 0||(i.offset={}),i.offset[o==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof h0))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof h0?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:G(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof h0){if(this.child.channelHasField("column")){const i=G(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of io){const o=this.child.component.scales[i];if(o&&!o.merged){const a=o.get("type"),s=o.get("range");if(cn(a)&&Ka(s)){const u=Py(this.child,i),l=HC(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):U(rS(i))}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:o,ops:a,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const c of Lr){const f=this.facet[c];if(f){u.push(G(f));const{bin:d,sort:h}=f;if(Je(d)&&u.push(G(f,{binSuffix:"end"})),uo(h)){const{field:g,op:p=ey}=h,m=KC(f,h);r&&i?(o.push(m),a.push("max"),s.push(m)):(o.push(g),a.push(p),s.push(m))}else if(J(h)){const g=Cc(f,c);o.push(g),a.push("max"),s.push(g)}}}const l=!!r&&!!i;return Object.assign({name:t,data:n,groupby:u},l||o.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),o.length?{fields:o,ops:a,as:s}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?uo(r.sort)?[KC(r,r.sort,{expr:"datum"})]:J(r.sort)?[Cc(r,t,{expr:"datum"})]:[G(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(uo(i)?i.order:!J(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:r}=this;if(n.facet)return kC(n.facet,"facet",r);const i={row:["top","bottom"],column:["left","right"]};for(const o of OC)if(n[o]){const a=Oc("labelOrient",(t=n[o])===null||t===void 0?void 0:t.header,r,o);if(i[o].includes(a))return kC(n[o],o,r)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=ZSe(n),i=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),a=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},o?{title:o}:{}),a?{style:a}:{}),{from:{facet:this.assembleFacet()},sort:{field:Lr.map(u=>this.facetSortFields(u)).flat(),order:Lr.map(u=>this.facetSortOrder(u)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(tEe(this,[])))]}getMapping(){return this.facet}}function sCe(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const o of[n,r])if(uo(o.sort)){const{field:a,op:s=ey}=o.sort;e=i=new Du(e,{joinaggregate:[{op:s,field:a,as:KC(o,o.sort,{forAs:!0})}],groupby:[G(o)]})}return i}return null}function cz(e,t){var n,r,i,o;for(const a of t){const s=a.data;if(e.name&&a.hasName()&&e.name!==a.dataName)continue;const u=(n=e.format)===null||n===void 0?void 0:n.mesh,l=(r=s.format)===null||r===void 0?void 0:r.feature;if(u&&l)continue;const c=(i=e.format)===null||i===void 0?void 0:i.feature;if((c||l)&&c!==l)continue;const f=(o=s.format)===null||o===void 0?void 0:o.mesh;if(!((u||f)&&u!==f)){if(Vh(e)&&Vh(s)){if(Ki(e.values,s.values))return a}else if(bc(e)&&bc(s)){if(e.url===s.url)return a}else if(mI(e)&&e.name===a.dataName)return a}}return null}function uCe(e,t){if(e.data||!e.parent){if(e.data===null){const r=new Fu({values:[]});return t.push(r),r}const n=cz(e.data,t);if(n)return ns(e.data)||(n.data.format=Ij({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new Fu(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function lCe(e,t,n){var r,i;let o=0;for(const a of t.transforms){let s,u;if(S_e(a))u=e=new Sc(e,a),s="derived";else if(nC(a)){const l=X$e(a);u=e=(r=gn.makeWithAncestors(e,{},l,n))!==null&&r!==void 0?r:e,e=new $c(e,t,a.filter)}else if(sI(a))u=e=po.makeFromTransform(e,a,t),s="number";else if(O_e(a))s="date",n.getWithExplicit(a.field).value===void 0&&(e=new gn(e,{[a.field]:s}),n.set(a.field,s,!1)),u=e=ho.makeFromTransform(e,a);else if(F_e(a))u=e=mi.makeFromTransform(e,a),s="number",pC(t)&&(e=new ss(e));else if(aI(a))u=e=d0.make(e,t,a,o++),s="derived";else if(E_e(a))u=e=new kc(e,a),s="number";else if(A_e(a))u=e=new Du(e,a),s="number";else if(k_e(a))u=e=na.makeFromTransform(e,a),s="derived";else if(D_e(a))u=e=new zy(e,a),s="derived";else if($_e(a))u=e=new By(e,a),s="derived";else if(y_e(a))u=e=new Wy(e,a),s="derived";else if(__e(a))e=new Gy(e,a);else if(C_e(a))u=e=Mu.makeFromTransform(e,a),s="derived";else if(v_e(a))u=e=new Iy(e,a),s="derived";else if(b_e(a))u=e=new qy(e,a),s="derived";else if(x_e(a))u=e=new Hy(e,a),s="derived";else if(w_e(a))u=e=new Uy(e,a),s="derived";else{U(Vbe(a));continue}if(u&&s!==void 0)for(const l of(i=u.producedFields())!==null&&i!==void 0?i:[])n.set(l,s,!1)}return e}function Vy(e){var t,n,r,i,o,a,s,u,l,c;let f=uCe(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,g=e.data,m=!(g&&(ns(g)||bc(g)||Vh(g)))&&e.parent?e.parent.component.data.ancestorParse.clone():new U_e;ns(g)?(yI(g)?f=new u0(f,g.sequence):oC(g)&&(f=new s0(f,g.graticule)),m.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(m.parseNothing=!0),f=(n=gn.makeExplicit(f,e,m))!==null&&n!==void 0?n:f,f=new ss(f);const y=e.parent&&Dc(e.parent);(bt(e)||vi(e))&&y&&(f=(r=po.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=lCe(f,e,m));const v=J$e(e),b=K$e(e);f=(i=gn.makeWithAncestors(f,{},Object.assign(Object.assign({},v),b),m))!==null&&i!==void 0?i:f,bt(e)&&(f=Mc.parseAll(f,e),f=f0.parseAll(f,e)),(bt(e)||vi(e))&&(y||(f=(o=po.makeFromEncoding(f,e))!==null&&o!==void 0?o:f),f=(a=ho.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=Sc.parseAllForSortIndex(f,e));const x=e.getDataName(Ze.Raw),w=new Tn(f,x,Ze.Raw,h);if(d[x]=w,f=w,bt(e)){const C=mi.makeFromEncoding(f,e);C&&(f=C,pC(e)&&(f=new ss(f))),f=(s=Mu.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=(u=na.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}bt(e)&&(f=(l=c0.make(f,e))!==null&&l!==void 0?l:f);const E=e.getDataName(Ze.Main),_=new Tn(f,E,Ze.Main,h);d[E]=_,f=_,bt(e)&&WAe(e,_);let $=null;if(vi(e)){const C=e.getName("facet");f=(c=sCe(f,e.facet))!==null&&c!==void 0?c:f,$=new Fc(f,e,C,_.getSource()),d[C]=$}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:w,main:_,facetRoot:$,ancestorParse:m})}class cCe extends VC{constructor(t,n,r,i){var o,a,s,u;super(t,"concat",n,r,i,t.resolve);(((a=(o=t.resolve)===null||o===void 0?void 0:o.axis)===null||a===void 0?void 0:a.x)==="shared"||((u=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||u===void 0?void 0:u.y)==="shared")&&U(Wbe),this.children=this.getChildren(t).map((l,c)=>tO(l,this,this.getName(`concat_${c}`),void 0,i))}parseData(){this.component.data=Vy(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of z(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return py(t)?t.vconcat:KS(t)?t.hconcat:t.concat}parseLayoutSize(){iCe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=DC(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function fCe(e){return e===!1||e===null}const dCe=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},xP),{labelExpr:1,encode:1}),fz=z(dCe);class JC extends Qo{constructor(t={},n={},r=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new JC(de(this.explicit),de(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!fCe(this.get(t))}hasOrientSignalRef(){return re(this.explicit.orient)}}function hCe(e,t,n){var r;const{encoding:i,config:o}=e,a=(r=Ct(i[t]))!==null&&r!==void 0?r:Ct(i[Yo(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return _u(l)?Object.assign({text:OS({fieldOrDatumDef:a,field:"datum.value",format:u,formatType:l,config:o})},n):n}function gCe(e){return io.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[wCe(n,e)]),t),{})}const pCe={bottom:"top",top:"bottom",left:"right",right:"left"};function mCe(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const o of e.children){o.parseAxesAndHeaders();for(const a of z(o.component.axes))r.axis[a]=MC(e.component.resolve,a),r.axis[a]==="shared"&&(n[a]=yCe(n[a],o.component.axes[a]),n[a]||(r.axis[a]="independent",delete n[a]))}for(const o of io){for(const a of e.children)if(!!a.component.axes[o]){if(r.axis[o]==="independent"){n[o]=((t=n[o])!==null&&t!==void 0?t:[]).concat(a.component.axes[o]);for(const s of a.component.axes[o]){const{value:u,explicit:l}=s.getWithExplicit("orient");if(!re(u)){if(i[u]>0&&!l){const c=pCe[u];i[u]>i[c]&&s.set("orient",c,!1)}i[u]++}}}delete a.component.axes[o]}if(r.axis[o]==="independent"&&n[o]&&n[o].length>1)for(const a of n[o])!!a.get("grid")&&!a.explicit.grid&&(a.implicit.grid=!1)}}function yCe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],o=t[r];if(!!i!=!!o)return;if(i&&o){const a=i.getWithExplicit("orient"),s=o.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;e[r]=vCe(i,o)}}}else return t.map(n=>n.clone());return e}function vCe(e,t){for(const n of fz){const r=ts(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,o)=>{switch(n){case"title":return hL(i,o);case"gridScale":return{explicit:i.explicit,value:vt(i.value,o.value)}}return vy(i,o,n,"axis")});e.setWithExplicit(n,r)}return e}function bCe(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(re(n.labelAngle)?n.labelAngle:Th(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===yB(r,i))return!0}return e===n[t]}const xCe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function wCe(e,t){var n,r,i;let o=t.axis(e);const a=new JC,s=Ct(t.encoding[e]),{mark:u,config:l}=t,c=(o==null?void 0:o.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=l.axis)===null||r===void 0?void 0:r.orient)||t$e(e),f=t.getScaleComponent(e).get("type"),d=VAe(e,f,c,t.config),h=o!==void 0?!o:SC("disable",l.style,o==null?void 0:o.style,d).configValue;if(a.set("disable",h,o!==void 0),h)return a;o=o||{};const g=ZAe(s,o,e,l.style,d),p={fieldOrDatumDef:s,axis:o,channel:e,model:t,scaleType:f,orient:c,labelAngle:g,mark:u,config:l};for(const v of fz){const b=v in gB?gB[v](p):wP(v)?o[v]:void 0,x=b!==void 0,w=bCe(b,v,o,t,e);if(x&&w)a.set(v,b,w);else{const{configValue:E=void 0,configFrom:_=void 0}=wP(v)&&v!=="values"?SC(v,l.style,o.style,d):{},$=E!==void 0;x&&!$?a.set(v,b,w):(_!=="vgAxisConfig"||xCe.has(v)&&$||Wh(E)||re(E))&&a.set(v,E,!1)}}const m=(i=o.encoding)!==null&&i!==void 0?i:{},y=bP.reduce((v,b)=>{var x;if(!a.hasAxisPart(b))return v;const w=AB((x=m[b])!==null&&x!==void 0?x:{},t),E=b==="labels"?hCe(t,e,w):w;return E!==void 0&&!We(E)&&(v[b]={update:E}),v},{});return We(y)||a.set("encode",y,!!o.encoding||o.labelAngle!==void 0),a}function _Ce({encoding:e,size:t}){for(const n of io){const r=Pr(n);fo(t[r])&&lo(e[n])&&(delete t[r],U($L(r)))}return t}function ECe(e,t,n){const r=Jn(e),i=Be("orient",r,n);if(r.orient=CCe(r.type,t,i),i!==void 0&&i!==r.orient&&U(lxe(r.orient,i)),r.type==="bar"&&r.orient){const s=Be("cornerRadiusEnd",r,n);if(s!==void 0){const u=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:N2e[r.orient];for(const l of u)r[l]=s;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}return Be("opacity",r,n)===void 0&&(r.opacity=$Ce(r.type,t)),Be("cursor",r,n)===void 0&&(r.cursor=ACe(r,t,n)),r}function ACe(e,t,n){return t.href||e.href||Be("href",e,n)?"pointer":e.cursor}function $Ce(e,t){if(ye([K1,_S,ES,AS],e)&&!PS(t))return .7}function SCe(e,t,{graticule:n}){if(n)return!1;const r=vu("filled",e,t),i=e.type;return vt(r,i!==K1&&i!==X1&&i!==J1)}function CCe(e,t,n){switch(e){case K1:case ES:case AS:case UL:case $2e:case A2e:return}const{x:r,y:i,x2:o,y2:a}=t;switch(e){case V1:if(Y(r)&&(kn(r.bin)||Y(i)&&i.aggregate&&!r.aggregate))return"vertical";if(Y(i)&&(kn(i.bin)||Y(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o&&(Y(r)&&r.type===xu&&!Je(r.bin)||TS(r)))return"horizontal";if(!a&&(Y(i)&&i.type===xu&&!Je(i.bin)||TS(i)))return"vertical"}case J1:if(o&&!(Y(r)&&kn(r.bin))&&a&&!(Y(i)&&kn(i.bin)))return;case Y1:if(a)return Y(i)&&kn(i.bin)?"horizontal":"vertical";if(o)return Y(r)&&kn(r.bin)?"vertical":"horizontal";if(e===J1){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case X1:case _S:{const s=lo(r),u=lo(i);if(n)return n;if(s&&!u)return e!=="tick"?"horizontal":"vertical";if(!s&&u)return e!=="tick"?"vertical":"horizontal";if(s&&u){const l=r,c=i,f=l.type===dc,d=c.type===dc;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate&&e!=="tick"?"horizontal":"vertical"}else return}}return"vertical"}const OCe={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),fn("x",e,{defaultPos:"mid"})),fn("y",e,{defaultPos:"mid"})),is(e,"radius","arc")),is(e,"theta","arc"))},FCe={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),_y("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),_y("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),hC(e))},kCe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),is(e,"x","bar")),is(e,"y","bar"))},DCe={vgMark:"shape",encodeEntry:e=>Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&Y(n)&&n.type===hc?{field:G(n,{expr:"datum"})}:{})]}},MCe={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),is(e,"x","image")),is(e,"y","image")),fC(e,"url"))},TCe={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),fn("x",e,{defaultPos:"mid"})),fn("y",e,{defaultPos:"mid"})),Lt("size",e,{vgChannel:"strokeWidth"})),hC(e))},NCe={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),fn("x",e,{defaultPos:"mid"})),fn("y",e,{defaultPos:"mid"})),Lt("size",e)),hC(e))};function ZC(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),fn("x",e,{defaultPos:"mid"})),fn("y",e,{defaultPos:"mid"})),Lt("size",e)),Lt("angle",e)),RCe(e,n,t))}function RCe(e,t,n){return n?{shape:{value:n}}:Lt("shape",e)}const jCe={vgMark:"symbol",encodeEntry:e=>ZC(e)},LCe={vgMark:"symbol",encodeEntry:e=>ZC(e,"circle")},PCe={vgMark:"symbol",encodeEntry:e=>ZC(e,"square")},ICe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),is(e,"x","rect")),is(e,"y","rect"))},BCe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),_y("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),_y("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),Lt("size",e,{vgChannel:"strokeWidth"}))}},zCe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Br(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),fn("x",e,{defaultPos:"mid"})),fn("y",e,{defaultPos:"mid"})),fC(e)),Lt("size",e,{vgChannel:"fontSize"})),Lt("angle",e)),jI("align",UCe(e.markDef,n,t))),jI("baseline",qCe(e.markDef,n,t))),fn("radius",e,{defaultPos:null})),fn("theta",e,{defaultPos:null}))}};function UCe(e,t,n){if(Be("align",e,n)===void 0)return"center"}function qCe(e,t,n){if(Be("baseline",e,n)===void 0)return"middle"}const HCe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",o=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Br(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),fn("x",e,{defaultPos:"mid",vgChannel:"xc"})),fn("y",e,{defaultPos:"mid",vgChannel:"yc"})),Lt("size",e,{defaultValue:WCe(e),vgChannel:i})),{[o]:rt(Be("thickness",n,t))})}};function WCe(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,o=i==="horizontal"?"width":"height",a=e.getScaleComponent(i==="horizontal"?"x":"y"),s=(t=Be("size",r,n,{vgChannel:o}))!==null&&t!==void 0?t:n.tick.bandSize;if(s!==void 0)return s;{const u=a?a.get("range"):void 0;return u&&Ka(u)&&yt(u.step)?u.step*3/4:my(n.view,o)*3/4}}const Xy={arc:OCe,area:FCe,bar:kCe,circle:LCe,geoshape:DCe,image:MCe,line:TCe,point:jCe,rect:ICe,rule:BCe,square:PCe,text:zCe,tick:HCe,trail:NCe};function GCe(e){if(ye([X1,Y1,S2e],e.mark)){const t=AP(e.mark,e.encoding);if(t.length>0)return YCe(e,t)}else if(e.mark===V1){const t=eS.some(n=>Be(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return VCe(e)}return QC(e)}const dz="faceted_path_";function YCe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:dz+e.requestDataName(Ze.Main),data:e.requestDataName(Ze.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:QC(e,{fromPrefix:dz})}]}const hz="stack_group_";function VCe(e){const[t]=QC(e,{fromPrefix:hz}),n=e.scaleName(e.stack.fieldChannel),r=(l={})=>e.vgField(e.stack.fieldChannel,l),i=(l,c)=>{const f=[r({prefix:"min",suffix:"start",expr:c}),r({prefix:"max",suffix:"start",expr:c}),r({prefix:"min",suffix:"end",expr:c}),r({prefix:"max",suffix:"end",expr:c})];return`${l}(${f.map(d=>`scale('${n}',${d})`).join(",")})`};let o,a;e.stack.fieldChannel==="x"?(o=Object.assign(Object.assign({},sc(t.encode.update,["y","yc","y2","height",...eS])),{x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update=Object.assign(Object.assign({},yr(t.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},sc(t.encode.update,["x","xc","x2","width"])),{y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update=Object.assign(Object.assign({},yr(t.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const l of eS){const c=vu(l,e.markDef,e.config);t.encode.update[l]?(o[l]=t.encode.update[l],delete t.encode.update[l]):c&&(o[l]=rt(c)),c&&(t.encode.update[l]={value:0})}const s=[];if(e.stack.groupbyChannel){const l=e.fieldDef(e.stack.groupbyChannel),c=G(l);c&&s.push(c),((l==null?void 0:l.bin)||(l==null?void 0:l.timeUnit))&&s.push(G(l,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((l,c)=>{if(t.encode.update[c])return Object.assign(Object.assign({},l),{[c]:t.encode.update[c]});{const f=vu(c,e.markDef,e.config);return f!==void 0?Object.assign(Object.assign({},l),{[c]:rt(f)}):l}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Ze.Main),name:hz+e.requestDataName(Ze.Main),groupby:s,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[t]}]}]}function XCe(e){var t;const{encoding:n,stack:r,mark:i,markDef:o,config:a}=e,s=n.order;if(!(!J(s)&&gi(s)&&z$(s.value)||!s&&z$(Be("order",o,a)))){if((J(s)||Y(s))&&!r)return cL(s,{expr:"datum"});if(Ja(i)){const u=o.orient==="horizontal"?"y":"x",l=n[u];if(Y(l)){const c=l.sort;if(J(c))return{field:G(l,{prefix:u,suffix:"sort_index",expr:"datum"})};if(uo(c))return{field:G({aggregate:PS(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})};if(oP(c)){const f=e.fieldDef(c.encoding);return{field:G(f,{expr:"datum"}),order:c.order}}else return c===null?void 0:{field:G(l,{binSuffix:((t=e.stack)===null||t===void 0?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}function QC(e,t={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=e,a=vt(r.clip,KCe(e),JCe(e)),s=uL(r),u=i.key,l=XCe(e),c=ZCe(e),f=Be("aria",r,o),d=Xy[n].postEncodingTransform?Xy[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Xy[n].vgMark},a?{clip:!0}:{}),s?{style:s}:{}),u?{key:u.field}:{}),l?{sort:l}:{}),c||{}),f===!1?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(Ze.Main)},encode:{update:Xy[n].encodeEntry(e)}}),d?{transform:d}:{})]}function KCe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function JCe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function ZCe(e){if(!e.component.selection)return null;const t=z(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=z(r.component.selection).length,r=r.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}class gz extends az{constructor(t,n,r,i={},o){var a;super(t,"unit",n,r,o,void 0,qP(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=so(t.mark)?Object.assign({},t.mark):{type:t.mark},u=s.type;s.filled===void 0&&(s.filled=SCe(s,o,{graticule:t.data&&oC(t.data)}));const l=this.encoding=cwe(t.encoding||{},u,s.filled,o);this.markDef=ECe(s,l,o),this.size=_Ce({encoding:l,size:qP(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=JP(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=((a=t.params)!==null&&a!==void 0?a:[]).filter(c=>VS(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===qL,r=t&&obe.some(i=>ue(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return U1.reduce((r,i)=>{var o;const a=Ct(n[i]);return a&&(r[i]=this.initScale((o=a.scale)!==null&&o!==void 0?o:{})),r},{})}initScale(t){const{domain:n,range:r}=t,i=Jn(t);return J(n)&&(i.domain=n.map(vr)),J(r)&&(i.range=r.map(vr)),i}initAxes(t){return io.reduce((n,r)=>{const i=t[r];if(ue(i)||r===at&&ue(t.x2)||r===$t&&ue(t.y2)){const o=ue(i)?i.axis:void 0;n[r]=o&&this.initAxis(Object.assign({},o))}return n},{})}initAxis(t){const n=z(t),r={};for(const i of n){const o=t[i];r[i]=Wh(o)?oL(o):vr(o)}return r}initLegends(t){return gbe.reduce((n,r)=>{const i=Ct(t[r]);if(i&&mbe(r)){const o=i.legend;n[r]=o&&Jn(o)}return n},{})}parseData(){this.component.data=Vy(this)}parseLayoutSize(){oCe(this)}parseSelections(){this.component.selection=HAe(this,this.selection)}parseMarkGroup(){this.component.mark=GCe(this)}parseAxesAndHeaders(){this.component.axes=gCe(this)}assembleSelectionTopLevelSignals(t){return nEe(this,t)}assembleSignals(){return[...dB(this),...eEe(this,[])]}assembleSelectionData(t){return rEe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return DC(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!Dc(this.parent))&&(n=$I(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};if(t!==void 0)return t;if(this.encoding.x||this.encoding.y)return"cell"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Au(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return co(n)}typedFieldDef(t){const n=this.fieldDef(t);return Ir(n)?n:null}}class eO extends VC{constructor(t,n,r,i,o){super(t,"layer",n,r,o,t.resolve,t.view);const a=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((s,u)=>{if(yy(s))return new eO(s,this,this.getName(`layer_${u}`),a,o);if(Jo(s))return new gz(s,this,this.getName(`layer_${u}`),a,o);throw new Error(nS(s))})}parseData(){this.component.data=Vy(this);for(const t of this.children)t.parseData()}parseLayoutSize(){rCe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of z(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){mCe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),dB(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),DC(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const r of this.children)for(const i of ft(r.assembleGroupStyle()))t.add(i);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return iEe(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),RB(this))}}function tO(e,t,n,r,i){if(ty(e))return new h0(e,t,n,i);if(yy(e))return new eO(e,t,n,r,i);if(Jo(e))return new gz(e,t,n,r,i);if(Rwe(e))return new cCe(e,t,n,i);throw new Error(nS(e))}var QCe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function eOe(e,t={}){t.logger&&Nxe(t.logger),t.fieldTitle&&pP(t.fieldTitle);try{const n=XP(Lj(t.config,e.config)),r=dI(e,n),i=tO(r,null,"",void 0,n);return i.parse(),hSe(i.component.data,i),{spec:nOe(i,tOe(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&Rxe(),t.fieldTitle&&ewe()}}function tOe(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):fe(t)&&(t={type:t}),i&&o&&I_e(t.type)){if(i==="step"&&o==="step")U(mL()),t.type="pad";else if(i==="step"||o==="step"){const a=i==="step"?"width":"height";U(mL(z1(a)));const s=a==="width"?"height":"width";t.type=B_e(s)}}return Object.assign(Object.assign(Object.assign({},z(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),gI(n,!1)),gI(e,!0))}function nOe(e,t,n={},r){const i=e.config?Kwe(e.config):void 0,o=[].concat(e.assembleSelectionData([]),QSe(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f}=t,d=QCe(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),d),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:o}),a.length>0?{projections:a}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...UP(f)])),i?{config:i}:{}),r?{usermeta:r}:{})}const rOe=jve.version;var iOe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:rOe,compile:eOe,normalize:dI,deepEqual:Ki,duplicate:de,pick:sc,omit:yr,stringify:Ke,hash:Ee,isNullOrFalse:z$,contains:ye,some:uc,every:U$,mergeDeep:Ij,unique:Ji,isEqual:Qve,setEqual:Bj,hasIntersection:q$,prefixGenerator:H$,fieldIntersection:W$,isEmpty:We,keys:z,vals:ln,entries:Ba,isBoolean:kh,varName:nt,logicalExpr:Dh,deleteNestedProperty:N1,titleCase:Mh,accessPathWithDatum:G$,flatAccessWithDatum:zj,replacePathInField:Rr,replaceAll:hu,removePathFromField:Y$,accessPathDepth:lc,getFirstDefined:vt,uniqueId:qj,resetIdCounter:tbe,internalField:Hj,isInternalField:Wj,normalizeAngle:Th,isNumeric:R1});function pz(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var oOe="vega-themes",aOe="2.10.0",sOe="Themes for stylized Vega and Vega-Lite visualizations.",uOe=["vega","vega-lite","themes","style"],lOe="BSD-3-Clause",cOe={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},fOe=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],dOe="build/vega-themes.js",hOe="build/vega-themes.module.js",gOe="build/vega-themes.min.js",pOe="build/vega-themes.min.js",mOe="build/vega-themes.module.d.ts",yOe={type:"git",url:"https://github.com/vega/vega-themes.git"},vOe=["src","build"],bOe={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},xOe={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},wOe={vega:"*","vega-lite":"*"},_Oe={name:oOe,version:aOe,description:sOe,keywords:uOe,license:lOe,author:cOe,contributors:fOe,main:dOe,module:hOe,unpkg:gOe,jsdelivr:pOe,types:mOe,repository:yOe,files:vOe,scripts:bOe,devDependencies:xOe,peerDependencies:wOe};const Tc="#fff",EOe="#888",AOe={background:"#333",title:{color:Tc,subtitleColor:Tc},style:{"guide-label":{fill:Tc},"guide-title":{fill:Tc}},axis:{domainColor:Tc,gridColor:EOe,tickColor:Tc}},Tu="#4572a7",$Oe={background:"#fff",arc:{fill:Tu},area:{fill:Tu},line:{stroke:Tu,strokeWidth:2},path:{stroke:Tu},rect:{fill:Tu},shape:{stroke:Tu},symbol:{fill:Tu,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Nu="#30a2da",nO="#cbcbcb",SOe="#999",COe="#333",mz="#f0f0f0",yz="#333",OOe={arc:{fill:Nu},area:{fill:Nu},axis:{domainColor:nO,grid:!0,gridColor:nO,gridWidth:1,labelColor:SOe,labelFontSize:10,titleColor:COe,tickColor:nO,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:mz,group:{fill:mz},legend:{labelColor:yz,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:yz,titleFontSize:14,titlePadding:10},line:{stroke:Nu,strokeWidth:2},path:{stroke:Nu,strokeWidth:.5},rect:{fill:Nu},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Nu},bar:{binSpacing:2,fill:Nu,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Ru="#000",FOe={group:{fill:"#e5e5e5"},arc:{fill:Ru},area:{fill:Ru},line:{stroke:Ru},path:{stroke:Ru},rect:{fill:Ru},shape:{stroke:Ru},symbol:{fill:Ru,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},kOe=22,DOe="normal",vz="Benton Gothic, sans-serif",bz=11.5,MOe="normal",ju="#82c6df",rO="Benton Gothic Bold, sans-serif",xz="normal",wz=13,g0={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},TOe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:rO,fontSize:kOe,fontWeight:DOe},arc:{fill:ju},area:{fill:ju},line:{stroke:ju,strokeWidth:2},path:{stroke:ju},rect:{fill:ju},shape:{stroke:ju},symbol:{fill:ju,size:30},axis:{labelFont:vz,labelFontSize:bz,labelFontWeight:MOe,titleFont:rO,titleFontSize:wz,titleFontWeight:xz},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:vz,labelFontSize:bz,symbolType:"square",titleFont:rO,titleFontSize:wz,titleFontWeight:xz},range:{category:g0["category-6"],diverging:g0["fireandice-6"],heatmap:g0["fire-7"],ordinal:g0["fire-7"],ramp:g0["fire-7"]}},Lu="#ab5787",Ky="#979797",NOe={background:"#f9f9f9",arc:{fill:Lu},area:{fill:Lu},line:{stroke:Lu},path:{stroke:Lu},rect:{fill:Lu},shape:{stroke:Lu},symbol:{fill:Lu,size:30},axis:{domainColor:Ky,domainWidth:.5,gridWidth:.2,labelColor:Ky,tickColor:Ky,tickWidth:.2,titleColor:Ky},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Pu="#3e5c69",ROe={background:"#fff",arc:{fill:Pu},area:{fill:Pu},line:{stroke:Pu},path:{stroke:Pu},rect:{fill:Pu},shape:{stroke:Pu},symbol:{fill:Pu},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},zr="#1696d2",_z="#000000",jOe="#FFFFFF",Jy="Lato",iO="Lato",LOe="Lato",POe="#DEDDDD",IOe=18,p0={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},BOe={background:jOe,title:{anchor:"start",fontSize:IOe,font:Jy},axisX:{domain:!0,domainColor:_z,domainWidth:1,grid:!1,labelFontSize:12,labelFont:iO,labelAngle:0,tickColor:_z,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Jy},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:POe,gridWidth:1,labelFontSize:12,labelFont:iO,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Jy,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:iO,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Jy,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:p0["six-groups-cat-1"],diverging:p0["diverging-colors"],heatmap:p0["diverging-colors"],ordinal:p0["six-groups-seq"],ramp:p0["shades-blue"]},area:{fill:zr},rect:{fill:zr},line:{color:zr,stroke:zr,strokeWidth:5},trail:{color:zr,stroke:zr,strokeWidth:0,size:1},path:{stroke:zr,strokeWidth:.5},point:{filled:!0},text:{font:LOe,color:zr,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:zr,stroke:null}},arc:{fill:zr},shape:{stroke:zr},symbol:{fill:zr,size:30}},Iu="#3366CC",Ez="#ccc",Zy="Arial, sans-serif",zOe={arc:{fill:Iu},area:{fill:Iu},path:{stroke:Iu},rect:{fill:Iu},shape:{stroke:Iu},symbol:{stroke:Iu},circle:{fill:Iu},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Zy,fontSize:12},"guide-title":{font:Zy,fontSize:12},"group-title":{font:Zy,fontSize:12}},title:{font:Zy,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Ez,tickColor:Ez,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},UOe=_Oe.version;var qOe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:AOe,excel:$Oe,fivethirtyeight:OOe,ggplot2:FOe,googlecharts:zOe,latimes:TOe,quartz:NOe,urbaninstitute:BOe,version:UOe,vox:ROe});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function HOe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function WOe(e,t,n){if(Q(e))return`[${e.map(r=>t(Fe(r)?r:Az(r,n))).join(", ")}]`;if(se(e)){let r="";const i=e,{title:o,image:a}=i,s=HOe(i,["title","image"]);o&&(r+=`<h2>${t(o)}</h2>`),a&&(r+=`<img src="${t(a)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const l of u){let c=s[l];c!==void 0&&(se(c)&&(c=Az(c,n)),r+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function GOe(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function Az(e,t){return JSON.stringify(e,GOe(t))}var YOe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const $z="vg-tooltip-element",VOe={offsetX:10,offsetY:10,id:$z,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:XOe,maxDepth:2,formatTooltip:WOe};function XOe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function KOe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return YOe.toString().replace($z,e)}function JOe(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}class ZOe{constructor(t){this.options=Object.assign(Object.assign({},VOe),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=KOe(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){var o;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),((o=document.fullscreenElement)!==null&&o!==void 0?o:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:u}=JOe(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${u}px; left: ${s}px`)}}function QOe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sz(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(l){n(l);return}s.done?t(u):Promise.resolve(u).then(r,i)}function Qy(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(u){Sz(o,r,i,a,s,"next",u)}function s(u){Sz(o,r,i,a,s,"throw",u)}a(void 0)})}}var Cz=Object.prototype,Bu=Cz.hasOwnProperty,mo,oO=typeof Symbol=="function"?Symbol:{},ev=oO.iterator||"@@iterator",e3e=oO.asyncIterator||"@@asyncIterator",tv=oO.toStringTag||"@@toStringTag";function Oz(e,t,n,r){var i=t&&t.prototype instanceof sO?t:sO,o=Object.create(i.prototype),a=new fO(r||[]);return o._invoke=o3e(e,n,a),o}function aO(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}var Fz="suspendedStart",t3e="suspendedYield",kz="executing",nv="completed",bi={};function sO(){}function rv(){}function Nc(){}var uO={};uO[ev]=function(){return this};var lO=Object.getPrototypeOf,iv=lO&&lO(lO(dO([])));iv&&iv!==Cz&&Bu.call(iv,ev)&&(uO=iv);var Rc=Nc.prototype=sO.prototype=Object.create(uO);rv.prototype=Rc.constructor=Nc;Nc.constructor=rv;Nc[tv]=rv.displayName="GeneratorFunction";function Dz(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function Mz(e){var t=typeof e=="function"&&e.constructor;return t?t===rv||(t.displayName||t.name)==="GeneratorFunction":!1}function n3e(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,Nc):(e.__proto__=Nc,tv in e||(e[tv]="GeneratorFunction")),e.prototype=Object.create(Rc),e}function r3e(e){return{__await:e}}function ov(e,t){function n(o,a,s,u){var l=aO(e[o],e,a);if(l.type==="throw")u(l.arg);else{var c=l.arg,f=c.value;return f&&typeof f=="object"&&Bu.call(f,"__await")?t.resolve(f.__await).then(function(d){n("next",d,s,u)},function(d){n("throw",d,s,u)}):t.resolve(f).then(function(d){c.value=d,s(c)},function(d){return n("throw",d,s,u)})}}var r;function i(o,a){function s(){return new t(function(u,l){n(o,a,u,l)})}return r=r?r.then(s,s):s()}this._invoke=i}Dz(ov.prototype);ov.prototype[e3e]=function(){return this};function i3e(e,t,n,r,i){i===void 0&&(i=Promise);var o=new ov(Oz(e,t,n,r),i);return Mz(t)?o:o.next().then(function(a){return a.done?a.value:o.next()})}function o3e(e,t,n){var r=Fz;return function(o,a){if(r===kz)throw new Error("Generator is already running");if(r===nv){if(o==="throw")throw a;return Nz()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=Tz(s,n);if(u){if(u===bi)continue;return u}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(r===Fz)throw r=nv,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);r=kz;var l=aO(e,t,n);if(l.type==="normal"){if(r=n.done?nv:t3e,l.arg===bi)continue;return{value:l.arg,done:n.done}}else l.type==="throw"&&(r=nv,n.method="throw",n.arg=l.arg)}}}function Tz(e,t){var n=e.iterator[t.method];if(n===mo){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=mo,Tz(e,t),t.method==="throw"))return bi;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return bi}var r=aO(n,e.iterator,t.arg);if(r.type==="throw")return t.method="throw",t.arg=r.arg,t.delegate=null,bi;var i=r.arg;if(!i)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,bi;if(i.done)t[e.resultName]=i.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=mo);else return i;return t.delegate=null,bi}Dz(Rc);Rc[tv]="Generator";Rc[ev]=function(){return this};Rc.toString=function(){return"[object Generator]"};function a3e(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function cO(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function fO(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(a3e,this),this.reset(!0)}function s3e(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function r(){for(;t.length;){var i=t.pop();if(i in e)return r.value=i,r.done=!1,r}return r.done=!0,r}}function dO(e){if(e){var t=e[ev];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var n=-1,r=function i(){for(;++n<e.length;)if(Bu.call(e,n))return i.value=e[n],i.done=!1,i;return i.value=mo,i.done=!0,i};return r.next=r}}return{next:Nz}}function Nz(){return{value:mo,done:!0}}fO.prototype={constructor:fO,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=mo,this.done=!1,this.delegate=null,this.method="next",this.arg=mo,this.tryEntries.forEach(cO),!t)for(var n in this)n.charAt(0)==="t"&&Bu.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=mo)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if(n.type==="throw")throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(l,c){return a.type="throw",a.arg=t,n.next=l,c&&(n.method="next",n.arg=mo),!!c}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if(o.tryLoc==="root")return r("end");if(o.tryLoc<=this.prev){var s=Bu.call(o,"catchLoc"),u=Bu.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else if(u){if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&Bu.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&(t==="break"||t==="continue")&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=n,o?(this.method="next",this.next=o.finallyLoc,bi):this.complete(a)},complete:function(t,n){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&n&&(this.next=n),bi},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),cO(r),bi}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var i=r.completion;if(i.type==="throw"){var o=i.arg;cO(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:dO(t),resultName:n,nextLoc:r},this.method==="next"&&(this.arg=mo),bi}};var ls={wrap:Oz,isGeneratorFunction:Mz,AsyncIterator:ov,mark:n3e,awrap:r3e,async:i3e,keys:s3e,values:dO};function u3e(e,t,n){var r=e.open(t),i=1e4,o=250,a=new URL(t),s=a.origin,u=~~(i/o);function l(f){f.source===r&&(u=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function c(){u<=0||(r.postMessage(n,s),setTimeout(c,o),u-=1)}setTimeout(c,o)}var l3e=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper.fit-x {
    width: 100%; }
  .vega-embed .chart-wrapper.fit-y {
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function Rz(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];c3e(e,a)}return e}function c3e(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];ef(e,i,t[i],!0)}}var hO;function jz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function cs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jz(Object(n),!0).forEach(function(r){QOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var fs=rve,m0=iOe,av=typeof window!="undefined"?window:void 0;m0===void 0&&av!==null&&av!==void 0&&(hO=av.vl)!==null&&hO!==void 0&&hO.compile&&(m0=av.vl);var f3e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},d3e={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},y0={vega:"Vega","vega-lite":"Vega-Lite"},sv={vega:fs.version,"vega-lite":m0?m0.version:"not available"},h3e={vega:e=>e,"vega-lite":(e,t)=>m0.compile(e,{config:t}).spec},g3e=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,p3e="chart-wrapper";function m3e(e){return typeof e=="function"}function Lz(e,t,n,r){var i="<html><head>".concat(t,'</head><body><pre><code class="json">'),o="</code></pre>".concat(n,"</body></html>"),a=window.open("");a.document.write(i+e+o),a.document.title="".concat(y0[r]," JSON Source")}function y3e(e,t){if(e.$schema){var n=pz(e.$schema);if(t&&t!==n.library){var r;console.warn("The given visualization spec is written in ".concat(y0[n.library],", but mode argument sets ").concat((r=y0[t])!==null&&r!==void 0?r:t,"."))}var i=n.library;return z3.satisfies(sv[i],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(y0[i]," ").concat(n.version,", but the current version of ").concat(y0[i]," is v").concat(sv[i],".")),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t!=null?t:"vega"}function v3e(e){return!!(e&&"load"in e)}function Pz(e){return v3e(e)?e:fs.loader(e)}function Iz(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function E3e(e,t){return gO.apply(this,arguments)}function gO(){return gO=Qy(ls.mark(function e(t,n){var r,i,o,a,s,u,l,c,f,d,h=arguments;return ls.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(o=h.length>2&&h[2]!==void 0?h[2]:{},!Fe(n)){p.next=10;break}return s=Pz(o.loader),p.t0=JSON,p.next=6,s.load(n);case 6:p.t1=p.sent,a=p.t0.parse.call(p.t0,p.t1),p.next=11;break;case 10:a=n;case 11:return u=Iz(a).loader,(!s||u)&&(s=Pz((l=o.loader)!==null&&l!==void 0?l:u)),p.next=15,Bz(Iz(a),s);case 15:return c=p.sent,p.next=18,Bz(o,s);case 18:return f=p.sent,d=cs(cs({},Rz(f,c)),{},{config:V0((r=f.config)!==null&&r!==void 0?r:{},(i=c.config)!==null&&i!==void 0?i:{})}),p.next=22,x3e(t,a,d,s);case 22:return p.abrupt("return",p.sent);case 23:case"end":return p.stop()}},e)})),gO.apply(this,arguments)}function Bz(e,t){return pO.apply(this,arguments)}function pO(){return pO=Qy(ls.mark(function e(t,n){var r,i,o;return ls.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!Fe(t.config)){s.next=8;break}return s.t1=JSON,s.next=4,n.load(t.config);case 4:s.t2=s.sent,s.t0=s.t1.parse.call(s.t1,s.t2),s.next=9;break;case 8:s.t0=(r=t.config)!==null&&r!==void 0?r:{};case 9:if(i=s.t0,!Fe(t.patch)){s.next=18;break}return s.t4=JSON,s.next=14,n.load(t.patch);case 14:s.t5=s.sent,s.t3=s.t4.parse.call(s.t4,s.t5),s.next=19;break;case 18:s.t3=t.patch;case 19:return o=s.t3,s.abrupt("return",cs(cs(cs({},t),o?{patch:o}:{}),i?{config:i}:{}));case 21:case"end":return s.stop()}},e)})),pO.apply(this,arguments)}function b3e(e){var t=e.getRootNode?e.getRootNode():document;if(t instanceof ShadowRoot)return{root:t,rootContainer:t};var n;return{root:document,rootContainer:(n=document.head)!==null&&n!==void 0?n:document.body}}function x3e(e,t){return mO.apply(this,arguments)}function mO(){return mO=Qy(ls.mark(function e(t,n){var r,i,o,a,s,u,l,c,f,d,h,g,p,m,y,v,b,x,w,E,_,$,C,O,A,D,F,T,S,M,P,B,H,ie,le,he,Ae,$e,Pe,It,tr,Nn,R,W,V,k,xe,X,Oe,we=arguments;return ls.wrap(function(wr){for(;;)switch(wr.prev=wr.next){case 0:if(Oe=function(){he&&document.removeEventListener("click",he),M.finalize()},c=we.length>2&&we[2]!==void 0?we[2]:{},f=we.length>3?we[3]:void 0,d=c.theme?V0(qOe[c.theme],(r=c.config)!==null&&r!==void 0?r:{}):c.config,h=eb(c.actions)?c.actions:Rz({},f3e,(i=c.actions)!==null&&i!==void 0?i:{}),g=cs(cs({},d3e),c.i18n),p=(o=c.renderer)!==null&&o!==void 0?o:"canvas",m=(a=c.logLevel)!==null&&a!==void 0?a:fs.Warn,y=(s=c.downloadFileName)!==null&&s!==void 0?s:"visualization",v=typeof t=="string"?document.querySelector(t):t,v){wr.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return c.defaultStyle!==!1&&(b="vega-embed-style",x=b3e(v),w=x.root,E=x.rootContainer,w.getElementById(b)||(_=document.createElement("style"),_.id=b,_.innerText=c.defaultStyle===void 0||c.defaultStyle===!0?l3e.toString():c.defaultStyle,E.appendChild(_))),$=y3e(n,c.mode),C=h3e[$](n,d),$==="vega-lite"&&C.$schema&&(O=pz(C.$schema),z3.satisfies(sv.vega,"^".concat(O.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(O.version,", but current version is v").concat(sv.vega,"."))),v.classList.add("vega-embed"),h&&v.classList.add("has-actions"),v.innerHTML="",A=v,h&&(D=document.createElement("div"),D.classList.add(p3e),v.appendChild(D),A=D),F=c.patch,F&&(F instanceof Function?C=F(C):C=M0(C,F,!0,!1).newDocument),c.formatLocale&&fs.formatLocale(c.formatLocale),c.timeFormatLocale&&fs.timeFormatLocale(c.timeFormatLocale),T=c.ast,S=fs.parse(C,$==="vega-lite"?{}:d,{ast:T}),M=new(c.viewClass||fs.View)(S,cs({loader:f,logLevel:m,renderer:p},T?{expr:(u=(l=fs.expressionInterpreter)!==null&&l!==void 0?l:c.expr)!==null&&u!==void 0?u:hve}:{})),M.addSignalListener("autosize",(xi,Rn)=>{var nr=Rn.type;nr=="fit-x"?(A.classList.add("fit-x"),A.classList.remove("fit-y")):nr=="fit-y"?(A.classList.remove("fit-x"),A.classList.add("fit-y")):nr=="fit"?A.classList.add("fit-x","fit-y"):A.classList.remove("fit-x","fit-y")}),c.tooltip!==!1&&(m3e(c.tooltip)?P=c.tooltip:P=new ZOe(c.tooltip===!0?{}:c.tooltip).call,M.tooltip(P)),B=c.hover,B===void 0&&(B=$==="vega"),B&&(H=typeof B=="boolean"?{}:B,ie=H.hoverSet,le=H.updateSet,M.hover(ie,le)),c&&(c.width!=null&&M.width(c.width),c.height!=null&&M.height(c.height),c.padding!=null&&M.padding(c.padding)),wr.next=36,M.initialize(A,c.bind).runAsync();case 36:if(h!==!1){if(Ae=v,c.defaultStyle!==!1&&($e=document.createElement("details"),$e.title=g.CLICK_TO_VIEW_ACTIONS,v.append($e),Ae=$e,Pe=document.createElement("summary"),Pe.innerHTML=g3e,$e.append(Pe),he=xi=>{$e.contains(xi.target)||$e.removeAttribute("open")},document.addEventListener("click",he)),It=document.createElement("div"),Ae.append(It),It.classList.add("vega-actions"),h===!0||h.export!==!1)for(tr=function(){var Rn=R[Nn];if(h===!0||h.export===!0||h.export[Rn]){var nr=g["".concat(Rn.toUpperCase(),"_ACTION")],zu=document.createElement("a");zu.text=nr,zu.href="#",zu.target="_blank",zu.download="".concat(y,".").concat(Rn),zu.addEventListener("mousedown",function(){var zz=Qy(ls.mark(function yO(Uz){var vO;return ls.wrap(function(jc){for(;;)switch(jc.prev=jc.next){case 0:return Uz.preventDefault(),jc.next=3,M.toImageURL(Rn,c.scaleFactor);case 3:vO=jc.sent,this.href=vO;case 5:case"end":return jc.stop()}},yO,this)}));return function(yO){return zz.apply(this,arguments)}}()),It.append(zu)}},Nn=0,R=["svg","png"];Nn<R.length;Nn++)tr();(h===!0||h.source!==!1)&&(W=document.createElement("a"),W.text=g.SOURCE_ACTION,W.href="#",W.addEventListener("click",function(xi){var Rn,nr;Lz(Dv(n),(Rn=c.sourceHeader)!==null&&Rn!==void 0?Rn:"",(nr=c.sourceFooter)!==null&&nr!==void 0?nr:"",$),xi.preventDefault()}),It.append(W)),$==="vega-lite"&&(h===!0||h.compiled!==!1)&&(V=document.createElement("a"),V.text=g.COMPILED_ACTION,V.href="#",V.addEventListener("click",function(xi){var Rn,nr;Lz(Dv(C),(Rn=c.sourceHeader)!==null&&Rn!==void 0?Rn:"",(nr=c.sourceFooter)!==null&&nr!==void 0?nr:"","vega"),xi.preventDefault()}),It.append(V)),(h===!0||h.editor!==!1)&&(xe=(k=c.editorUrl)!==null&&k!==void 0?k:"https://vega.github.io/editor/",X=document.createElement("a"),X.text=g.EDITOR_ACTION,X.href="#",X.addEventListener("click",function(xi){u3e(window,xe,{config:d,mode:$,renderer:p,spec:Dv(n)}),xi.preventDefault()}),It.append(X))}return wr.abrupt("return",{view:M,spec:n,vgSpec:C,finalize:Oe});case 38:case"end":return wr.stop()}},e)})),mO.apply(this,arguments)}export{E3e as e,_3e as s};
